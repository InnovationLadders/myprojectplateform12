var O3=Object.defineProperty;var P3=(e,t,r)=>t in e?O3(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Mg=(e,t,r)=>P3(e,typeof t!="symbol"?t+"":t,r);import{r as O,a as C3,u as Go,L as Ee,b as Dx,c as Rj,d as Mn,g as kt,R as Z,B as F3,e as I3,f as ot,N as Ks}from"./react-BFDv3ESv.js";import{i as D3,g as R3,a as M3,b as $3,e as L3,d as B3,c as De,s as Ge,f as Aa,h as Je,j as Va,k as Ie,u as Wt,l as hr,q as et,w as Ue,T as rn,m as fi,o as Pi,n as U3,p as W3,G as H3,r as z3,t as $g,v as V3,x as G3,y as K3,z as Rh,A as q3,B as X3,C as Mj,D as ys,E as Y3}from"./firebase-DPatElGj.js";import{M as J3,S as ut,G as rc,m as te,B as qs,U as xr,H as $j,L as xa,F as br,a as Br,b as Ht,c as Rl,d as Xs,e as wt,f as Ga,C as Ml,g as $l,h as lt,i as Yn,j as hi,k as tt,l as at,n as Mh,o as xo,p as Ta,q as ac,E as Rx,r as sr,P as Pr,s as js,t as jn,A as ar,D as iu,T as mi,u as nc,v as jt,w as pt,x as ze,X as Mr,R as Lj,y as Z3,z as Of,I as Q3,J as gn,K as En,N as Lr,O as Mx,Q as Pt,V as jr,W as Ys,Y as oa,Z as gt,_ as Pf,$ as Oa,a0 as Jn,a1 as Ll,a2 as sc,a3 as au,a4 as xi,a5 as e6,a6 as Tr,a7 as ir,a8 as Zn,a9 as Ko,aa as Lg,ab as pi,ac as od,ad as t6,ae as Bg,af as ld,ag as Bj,ah as ic,ai as B0,aj as bs,ak as ou,al as cd,am as r6,an as fa,ao as Cf,ap as oc,aq as Uj,ar as U0,as as W0,at as a6,au as n6,av as s6,aw as i6,ax as o6,ay as Ug,az as Wg,aA as Hg,aB as l6,aC as c6,aD as nu,aE as Wj,aF as d6}from"./ui-B44VrYmg.js";function u6(e,t){for(var r=0;r<t.length;r++){const a=t[r];if(typeof a!="string"&&!Array.isArray(a)){for(const s in a)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(a,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>a[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var Hj={exports:{}},Ff={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f6=O,h6=Symbol.for("react.element"),m6=Symbol.for("react.fragment"),x6=Object.prototype.hasOwnProperty,p6=f6.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,g6={key:!0,ref:!0,__self:!0,__source:!0};function zj(e,t,r){var a,s={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(a in t)x6.call(t,a)&&!g6.hasOwnProperty(a)&&(s[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps,t)s[a]===void 0&&(s[a]=t[a]);return{$$typeof:h6,type:e,key:i,ref:o,props:s,_owner:p6.current}}Ff.Fragment=m6;Ff.jsx=zj;Ff.jsxs=zj;Hj.exports=Ff;var n=Hj.exports,Vj,zg=C3;Vj=zg.createRoot,zg.hydrateRoot;const v6={apiKey:"AIzaSyCKlDIhgAIPif3q2J4TAyVSBpdrUQ2P1G8",authDomain:"my-project-plateform-react.firebaseapp.com",projectId:"my-project-plateform-react",storageBucket:"my-project-plateform-react.firebasestorage.app",messagingSenderId:"1092300975970",appId:"1:1092300975970:web:76e0d3717dbf899c7b463b",measurementId:"G-S28HDNJNMH"},$x=D3(v6),ml=R3($x),pe=M3($x),$h=$3($x);console.log("Using production Firebase services");let lu=navigator.onLine;const y6=async()=>{if(!lu){lu=!0;try{await L3(pe),console.log("Firestore network enabled - back online")}catch(e){console.warn("Failed to enable Firestore network:",e)}}},Gj=async()=>{if(lu){lu=!1;try{await B3(pe),console.log("Firestore network disabled - operating offline")}catch(e){console.warn("Failed to disable Firestore network:",e)}}};window.addEventListener("online",y6);window.addEventListener("offline",Gj);navigator.onLine||Gj();const Jr=async(e,t)=>{try{return await e()}catch(r){return console.warn("Firestore operation failed:",r.message),r.code==="unavailable"&&console.warn("Firestore unavailable - check your internet connection or Firebase configuration"),t}},b6=async()=>Jr(async()=>{const e=et(De(pe,"users"),Ue("role","==","school"),Ue("status","==","active"));return(await Je(e)).docs.map(r=>({id:r.id,name:r.data().name||"مدرسة بدون اسم",...r.data()}))},[]),w6=async()=>Jr(async()=>{const e=et(De(pe,"users"),Ue("role","==","teacher"),Ue("status","==","active"));return(await Je(e)).docs.map(r=>({id:r.id,name:r.data().name||"معلم بدون اسم",subject:r.data().subject,school_id:r.data().school_id,...r.data()}))},[]),j6=async e=>Jr(async()=>{const t=et(De(pe,"users"),Ue("role","==","teacher"),Ue("school_id","==",e),Ue("status","==","active"));return(await Je(t)).docs.map(a=>({id:a.id,name:a.data().name||"معلم بدون اسم",subject:a.data().subject,...a.data()}))},[]),N6=async e=>Jr(async()=>{const t=et(De(pe,"users"),Ue("role","==","school"),Ue("email","==",e)),r=await Je(t);if(r.empty)return{found:!1,message:"لم يتم العثور على مدرسة بهذا البريد الإلكتروني",count:0};const a=r.docs[0],s=a.id,i=a.data(),o=et(De(pe,"projects"),Ue("school_id","==",s)),l=await Je(o);return{found:!0,school:{id:s,name:i.name||"مدرسة",email:i.email},count:l.size,projects:l.docs.map(c=>({id:c.id,...c.data()}))}},{found:!1,message:"حدث خطأ أثناء البحث عن المدرسة",count:0}),_6=async()=>Jr(async()=>{const e=et(De(pe,"users"),Ue("role","==","consultant")),t=await Je(e);return console.log("Raw consultants data from Firestore:",t.docs.map(a=>({id:a.id,...a.data()}))),t.docs.map(a=>{const s=a.data(),i={id:a.id,name:s.name||"مستشار",title:s.subject||"مستشار",specialties:s.specializations||[],rating:s.rating||5,reviews:s.reviews_count||0,experience:s.experience_years?`${s.experience_years} سنوات`:"5+ سنوات",avatar:s.avatar_url||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",hourlyRate:s.hourly_rate||150,availability:"متاح",languages:s.languages||["العربية"],location:s.location||"الرياض، السعودية"};return console.log("Processed consultant object:",i),i})},[]),S6=async()=>Jr(async()=>(await Je(De(pe,"projects"))).docs.map(t=>{const r=t.data();return{id:t.id,...r,due_date:r.due_date?r.due_date.toDate().toISOString():null,created_at:r.created_at?r.created_at.toDate().toISOString():new Date().toISOString(),updated_at:r.updated_at?r.updated_at.toDate().toISOString():new Date().toISOString()}}),[]),Kj=async e=>Jr(async()=>{const t=await hr(Ie(pe,"projects",e));if(t.exists()){const r=t.data();return{id:t.id,...r,due_date:r.due_date?r.due_date.toDate().toISOString():null,created_at:r.created_at?r.created_at.toDate().toISOString():new Date().toISOString(),updated_at:r.updated_at?r.updated_at.toDate().toISOString():new Date().toISOString()}}return null},null),k6=async e=>Jr(async()=>{const t=await hr(Ie(pe,"users",e));if(!t.exists())return console.error("Teacher document not found"),[];const a=t.data().school_id;if(!a)return console.error("Teacher has no school_id"),[];const s=et(De(pe,"projects"),Ue("teacher_id","==",e)),o=(await Je(s)).docs.map(f=>{const h=f.data();return{id:f.id,...h,due_date:h.due_date?h.due_date.toDate().toISOString():null,created_at:h.created_at?h.created_at.toDate().toISOString():new Date().toISOString(),updated_at:h.updated_at?h.updated_at.toDate().toISOString():new Date().toISOString()}}),l=et(De(pe,"projects"),Ue("school_id","==",a),Ue("status","==","draft")),d=(await Je(l)).docs.map(f=>{const h=f.data();return{id:f.id,...h,due_date:h.due_date?h.due_date.toDate().toISOString():null,created_at:h.created_at?h.created_at.toDate().toISOString():new Date().toISOString(),updated_at:h.updated_at?h.updated_at.toDate().toISOString():new Date().toISOString()}}),u=new Map;return o.forEach(f=>{u.set(f.id,f)}),d.forEach(f=>{u.has(f.id)||u.set(f.id,f)}),Array.from(u.values())},[]),E6=async e=>Jr(async()=>{const t=et(De(pe,"projects"),Ue("school_id","==",e));return(await Je(t)).docs.map(a=>{const s=a.data();return{id:a.id,...s,due_date:s.due_date?s.due_date.toDate().toISOString():null,created_at:s.created_at?s.created_at.toDate().toISOString():new Date().toISOString(),updated_at:s.updated_at?s.updated_at.toDate().toISOString():new Date().toISOString()}})},[]),A6=async e=>Jr(async()=>{const t=et(De(pe,"project_students"),Ue("student_id","==",e)),a=(await Je(t)).docs.map(i=>i.data().project_id);if(a.length===0)return[];const s=[];for(const i of a){const o=await hr(Ie(pe,"projects",i));if(o.exists()){const l=o.data();s.push({id:o.id,...l,due_date:l.due_date?l.due_date.toDate().toISOString():null,created_at:l.created_at?l.created_at.toDate().toISOString():new Date().toISOString(),updated_at:l.updated_at?l.updated_at.toDate().toISOString():new Date().toISOString()})}}return s},[]),T6=async e=>{try{const t=e.dueDate||e.due_date?rn.fromDate(new Date(e.dueDate||e.due_date)):null;return{id:(await Aa(De(pe,"projects"),{...e,due_date:t,created_at:Ge(),updated_at:Ge(),status:e.status||"active",progress:e.progress||0})).id,...e,due_date:t?t.toDate().toISOString():null}}catch(t){throw console.error("Error creating project:",t),t}},Vg=async(e,t)=>{try{const r=Ie(pe,"projects",e),a={...t};(t.dueDate||t.due_date)&&(a.due_date=rn.fromDate(new Date(t.dueDate||t.due_date)),"dueDate"in a&&delete a.dueDate),a.updated_at=Ge(),await Wt(r,a)}catch(r){throw console.error("Error updating project:",r),r}},O6=async e=>{try{await Va(Ie(pe,"projects",e))}catch(t){throw console.error("Error deleting project:",t),t}},lc=async e=>Jr(async()=>{console.log("Fetching students for project:",e);const t=et(De(pe,"project_students"),Ue("project_id","==",e)),r=await Je(t);console.log("projectStudentsSnapshot.empty:",r.empty),console.log("Number of project_students documents found:",r.docs.length);const a=[];for(const s of r.docs){const i=s.data();console.log("Processing project_student document:",i);const o=await hr(Ie(pe,"users",i.student_id)),l=o.exists()?o.data():null;console.log("Fetched user document for student_id",i.student_id,"exists:",o.exists()),o.exists()||console.warn("User document not found for student_id:",i.student_id),a.push({id:s.id,...i,student:l})}return console.log("Final students array from getProjectStudents:",a),a},[]),Lh=async({project_id:e,student_id:t,role:r,created_at:a,status:s})=>{try{return(await Aa(De(pe,"project_students"),{project_id:e,student_id:t,role:r,created_at:a?rn.fromDate(new Date(a)):Ge(),status:s||"active"})).id}catch(i){throw console.error("Error adding student to project:",i),i}},P6=async(e,t)=>{try{const r=et(De(pe,"project_students"),Ue("project_id","==",e),Ue("student_id","==",t)),a=await Je(r);for(const s of a.docs)await Va(s.ref)}catch(r){throw console.error("Error removing student from project:",r),r}},Bh=async e=>Jr(async()=>{const t=et(De(pe,"project_tasks"),Ue("project_id","==",e),Pi("created_at","desc"));return(await Je(t)).docs.map(a=>{const s=a.data();return{id:a.id,...s,due_date:s.due_date?s.due_date.toDate().toISOString():null,created_at:s.created_at?s.created_at.toDate().toISOString():new Date().toISOString(),updated_at:s.updated_at?s.updated_at.toDate().toISOString():new Date().toISOString()}})},[]),C6=async e=>{try{const t=e.due_date?rn.fromDate(new Date(e.due_date)):null;return{id:(await Aa(De(pe,"project_tasks"),{...e,due_date:t,created_at:Ge(),updated_at:Ge()})).id,...e,due_date:t?t.toDate().toISOString():null}}catch(t){throw console.error("Error creating project task:",t),t}},F6=async()=>Jr(async()=>{const e=et(De(pe,"project_ideas"),Ue("status","==","approved"));return(await Je(e)).docs.map(a=>({id:a.id,views:0,downloads:0,rating:4.5,...a.data()})).sort((a,s)=>{var l,c,d,u;const i=((c=(l=a.created_at)==null?void 0:l.toDate)==null?void 0:c.call(l))||new Date(a.created_at||0);return(((u=(d=s.created_at)==null?void 0:d.toDate)==null?void 0:u.call(d))||new Date(s.created_at||0)).getTime()-i.getTime()})},[]),I6=async()=>Jr(async()=>{const e=et(De(pe,"project_ideas"));return(await Je(e)).docs.map(a=>({id:a.id,views:0,downloads:0,rating:4.5,...a.data()})).sort((a,s)=>{var l,c,d,u;const i=((c=(l=a.created_at)==null?void 0:l.toDate)==null?void 0:c.call(l))||new Date(a.created_at||0);return(((u=(d=s.created_at)==null?void 0:d.toDate)==null?void 0:u.call(d))||new Date(s.created_at||0)).getTime()-i.getTime()})},[]),D6=async e=>{try{const t={...e,views:e.views||0,downloads:e.downloads||0,rating:e.rating||4.5,status:e.status||"pending",created_at:Ge(),updated_at:Ge()};return{id:(await Aa(De(pe,"project_ideas"),t)).id,...t,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}}catch(t){throw console.error("Error creating project idea:",t),t}},R6=async(e,t)=>{try{const r=Ie(pe,"project_ideas",e),a={...t,updated_at:Ge()};return await Wt(r,a),!0}catch(r){throw console.error("Error updating project idea:",r),r}},M6=async e=>{try{return await Va(Ie(pe,"project_ideas",e)),!0}catch(t){throw console.error("Error deleting project idea:",t),t}},$6=async e=>{try{const t=Ie(pe,"project_ideas",e);await Wt(t,{views:fi(1)})}catch(t){throw console.error("Error incrementing project idea views:",t),t}},L6=async e=>{try{const t=Ie(pe,"project_ideas",e);await Wt(t,{downloads:fi(1)})}catch(t){throw console.error("Error incrementing project idea downloads:",t),t}},B6=async()=>{try{console.log("Starting cleanup of duplicate project ideas...");const e=De(pe,"project_ideas"),t=await Je(e);if(t.empty)return console.log("No project ideas found to clean up"),0;const r=new Map,a=[];t.docs.forEach(i=>{const o=i.data(),l=`${o.title}-${o.description}`;r.has(l)?a.push(i.id):r.set(l,i.id)}),console.log(`Found ${a.length} duplicate project ideas to delete`);let s=0;for(const i of a)await Va(Ie(pe,"project_ideas",i)),s++;return console.log(`Successfully deleted ${s} duplicate project ideas`),s}catch(e){throw console.error("Error deleting duplicate project ideas:",e),e}},U6=async()=>{try{console.log("Starting cleanup of duplicate learning resources...");const e=De(pe,"learning_resources"),t=await Je(e);if(t.empty)return console.log("No learning resources found to clean up"),0;const r=new Map,a=[];t.docs.forEach(i=>{const o=i.data(),l=`${o.title}-${o.type}`;r.has(l)?a.push(i.id):r.set(l,i.id)}),console.log(`Found ${a.length} duplicate learning resources to delete`);let s=0;for(const i of a)await Va(Ie(pe,"learning_resources",i)),s++;return console.log(`Successfully deleted ${s} duplicate learning resources`),s}catch(e){throw console.error("Error deleting duplicate learning resources:",e),e}},W6=async(e,t)=>{try{const r=Ie(pe,"users",e);await Wt(r,{...t,updated_at:Ge()})}catch(r){throw console.error("Error updating user:",r),r}},H6=async e=>Jr(async()=>{const t=et(De(pe,"users"),Ue("role","==","student"),Ue("school_id","==",e));return(await Je(t)).docs.map(a=>({id:a.id,...a.data()}))},[]),z6=async()=>Jr(async()=>{const e=De(pe,"summer_program_registrations"),t=et(e,Pi("createdAt","desc"));return(await Je(t)).docs.map(a=>{const s=a.data();return{id:a.id,fullName:s.fullName,email:s.email,phone:s.phone,parentPhone:s.parentPhone,city:s.city,idNumber:s.idNumber,school:s.school,grade:s.grade,educationAdministration:s.educationAdministration,hasParticipatedBefore:s.hasParticipatedBefore,previousProjects:s.previousProjects,interests:s.interests||[],howDidYouHear:s.howDidYouHear,notes:s.notes,status:s.status||"pending",createdAt:s.createdAt?s.createdAt.toDate():new Date,updatedAt:s.updatedAt?s.updatedAt.toDate():new Date}})},[]),V6=async e=>{try{const t=De(pe,"summer_program_registrations"),r={...e,status:"pending",createdAt:Ge(),updatedAt:Ge()};return(await Aa(t,r)).id}catch(t){throw console.error("Error adding summer program registration:",t),t}},Gg=async(e,t)=>{try{const r=Ie(pe,"summer_program_registrations",e);await Wt(r,{...t,updatedAt:Ge()})}catch(r){throw console.error("Error updating summer program registration:",r),r}},G6=async e=>{try{const t=Ie(pe,"summer_program_registrations",e);await Va(t)}catch(t){throw console.error("Error deleting summer program registration:",t),t}},qj=O.createContext(void 0),vt=()=>{const e=O.useContext(qj);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},K6=({children:e})=>{const[t,r]=O.useState(null),[a,s]=O.useState(!0),[i,o]=O.useState(!navigator.onLine);O.useEffect(()=>{const h=()=>o(!1),m=()=>o(!0);return window.addEventListener("online",h),window.addEventListener("offline",m),()=>{window.removeEventListener("online",h),window.removeEventListener("offline",m)}},[]),O.useEffect(()=>{const h=U3(ml,async m=>{var x,p,g,y,w,v,_;if(m)try{const b=await hr(Ie(pe,"users",m.uid));if(b.exists()){const j=b.data();r({id:m.uid,email:m.email||"",name:j.name||m.displayName||"",role:j.role||"student",avatar:j.avatar||m.photoURL,phone:j.phone,bio:j.bio,createdAt:((g=(p=(x=j.createdAt)==null?void 0:x.toDate)==null?void 0:p.call(x))==null?void 0:g.toISOString())||new Date().toISOString(),school_id:j.school_id,grade:j.grade,subject:j.subject,languages:j.languages,status:j.status||"active",specializations:j.specializations,experience_years:j.experience_years,hourly_rate:j.hourly_rate,rating:j.rating,reviews_count:j.reviews_count})}else{const j={id:m.uid,email:m.email||"",name:m.displayName||"مستخدم جديد",role:"student",avatar:m.photoURL,createdAt:new Date().toISOString(),status:"active"};r(j)}}catch(b){b.code==="unavailable"||b.code==="auth/network-request-failed"||b.code==="firestore/unavailable"||((y=b.message)==null?void 0:y.includes("offline"))||((w=b.message)==null?void 0:w.includes("client is offline"))||((v=b.message)==null?void 0:v.includes("network"))||((_=b.message)==null?void 0:_.includes("Could not reach Cloud Firestore backend"))?(console.warn("Operating in offline mode - using basic user profile:",b.message),o(!0)):console.error("Error fetching user profile:",b);const N={id:m.uid,email:m.email||"",name:m.displayName||"مستخدم جديد",role:"student",avatar:m.photoURL,createdAt:new Date().toISOString(),status:"active"};r(N)}else r(null);s(!1)});return()=>h()},[]);const f={user:t,loading:a,isOffline:i,login:async(h,m)=>{var x,p,g;try{const{user:y}=await G3(ml,h,m),w=await hr(Ie(pe,"users",y.uid));if(w.exists()){const v=w.data();r({id:y.uid,email:y.email||"",name:v.name||y.displayName||"",role:v.role||"student",avatar:v.avatar||y.photoURL,phone:v.phone,bio:v.bio,createdAt:((g=(p=(x=v.createdAt)==null?void 0:x.toDate)==null?void 0:p.call(x))==null?void 0:g.toISOString())||new Date().toISOString(),school_id:v.school_id,grade:v.grade,subject:v.subject,languages:v.languages,status:v.status||"active",specializations:v.specializations,experience_years:v.experience_years,hourly_rate:v.hourly_rate,rating:v.rating,reviews_count:v.reviews_count})}}catch(y){throw y.code==="auth/network-request-failed"||y.code==="unavailable"?(console.warn("Network request failed during login:",y.message),o(!0),new Error("فشل في الاتصال بالشبكة. يرجى التحقق من اتصال الإنترنت والمحاولة مرة أخرى.")):(console.error("Login error:",y),y)}},register:async(h,m,x)=>{try{const{user:p}=await V3(ml,h,m);let g="active";(x.role==="school"||x.role==="consultant")&&(g="pending"),console.log(`Registering new ${x.role} with initial status: ${g}`);let w={...{name:x.name,email:p.email,role:x.role||"student",phone:x.phone,bio:x.bio||"",createdAt:Ge(),updatedAt:Ge(),school_id:x.school_id,grade:x.grade,subject:x.subject,languages:x.languages||["العربية"],status:g}};x.role==="consultant"&&(w={...w,specializations:x.specializations||[],experience_years:x.experience_years||0,hourly_rate:x.hourly_rate||0,rating:5,reviews_count:0}),await $g(Ie(pe,"users",p.uid),w),r({id:p.uid,email:p.email||"",name:x.name||"",role:x.role||"student",avatar:p.photoURL,phone:x.phone,bio:x.bio||"",createdAt:new Date().toISOString(),school_id:x.school_id,grade:x.grade,subject:x.subject,languages:x.languages||["العربية"],status:g,specializations:x.role==="consultant"?x.specializations:void 0,experience_years:x.role==="consultant"?x.experience_years:void 0,hourly_rate:x.role==="consultant"?x.hourly_rate:void 0,rating:x.role==="consultant"?5:void 0,reviews_count:x.role==="consultant"?0:void 0})}catch(p){throw p.code==="auth/network-request-failed"||p.code==="unavailable"?(console.warn("Network request failed during registration:",p.message),o(!0),new Error("فشل في الاتصال بالشبكة. يرجى التحقق من اتصال الإنترنت والمحاولة مرة أخرى.")):(console.error("Registration error:",p),p)}},loginWithGoogle:async()=>{var h,m,x;try{const p=new H3,{user:g}=await z3(ml,p);(await hr(Ie(pe,"users",g.uid))).exists()||await $g(Ie(pe,"users",g.uid),{name:g.displayName||"",email:g.email,role:"student",avatar:g.photoURL,createdAt:Ge(),updatedAt:Ge(),status:"active"});const w=await hr(Ie(pe,"users",g.uid));if(w.exists()){const v=w.data();r({id:g.uid,email:g.email||"",name:v.name||g.displayName||"",role:v.role||"student",avatar:v.avatar||g.photoURL,phone:v.phone,bio:v.bio,createdAt:((x=(m=(h=v.createdAt)==null?void 0:h.toDate)==null?void 0:m.call(h))==null?void 0:x.toISOString())||new Date().toISOString(),school_id:v.school_id,grade:v.grade,subject:v.subject,languages:v.languages,status:v.status||"active",specializations:v.specializations,experience_years:v.experience_years,hourly_rate:v.hourly_rate,rating:v.rating,reviews_count:v.reviews_count})}}catch(p){throw p.code==="auth/network-request-failed"||p.code==="unavailable"?(console.warn("Network request failed during Google login:",p.message),o(!0),new Error("فشل في الاتصال بالشبكة. يرجى التحقق من اتصال الإنترنت والمحاولة مرة أخرى.")):(console.error("Google login error:",p),p)}},logout:async()=>{try{await W3(ml)}catch(h){console.error("Logout error:",h),r(null)}}};return n.jsx(qj.Provider,{value:f,children:e})},Xj=O.createContext(void 0),Lx=()=>{const e=O.useContext(Xj);if(e===void 0)throw new Error("useCart must be used within a CartProvider");return e},q6=({children:e})=>{const[t,r]=O.useState({}),[a,s]=O.useState([]);O.useEffect(()=>{const m=localStorage.getItem("cart"),x=localStorage.getItem("wishlist");if(m)try{r(JSON.parse(m))}catch(p){console.error("Error parsing saved cart:",p)}if(x)try{s(JSON.parse(x))}catch(p){console.error("Error parsing saved wishlist:",p)}},[]),O.useEffect(()=>{localStorage.setItem("cart",JSON.stringify(t))},[t]),O.useEffect(()=>{localStorage.setItem("wishlist",JSON.stringify(a))},[a]);const h={cart:t,wishlist:a,addToCart:m=>{r(x=>({...x,[m]:(x[m]||0)+1}))},removeFromCart:m=>{r(x=>{const p={...x};return p[m]>1?p[m]--:delete p[m],p})},updateQuantity:(m,x)=>{x<=0?r(p=>{const g={...p};return delete g[m],g}):r(p=>({...p,[m]:x}))},clearCart:()=>{r({})},toggleWishlist:m=>{s(x=>x.includes(m)?x.filter(p=>p!==m):[...x,m])},getTotalItems:()=>Object.values(t).reduce((m,x)=>m+x,0),getTotalPrice:m=>Object.entries(t).reduce((x,[p,g])=>{const y=m.find(w=>w.id===p);return x+(y?y.price*g:0)},0)};return n.jsx(Xj.Provider,{value:h,children:e})};function X6(){if(console&&console.warn){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];ni(t[0])&&(t[0]=`react-i18next:: ${t[0]}`),console.warn(...t)}}const Kg={};function Uh(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];ni(t[0])&&Kg[t[0]]||(ni(t[0])&&(Kg[t[0]]=new Date),X6(...t))}const Yj=(e,t)=>()=>{if(e.isInitialized)t();else{const r=()=>{setTimeout(()=>{e.off("initialized",r)},0),t()};e.on("initialized",r)}},qg=(e,t,r)=>{e.loadNamespaces(t,Yj(e,r))},Xg=(e,t,r,a)=>{ni(r)&&(r=[r]),r.forEach(s=>{e.options.ns.indexOf(s)<0&&e.options.ns.push(s)}),e.loadLanguages(t,Yj(e,a))},Y6=function(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const a=t.languages[0],s=t.options?t.options.fallbackLng:!1,i=t.languages[t.languages.length-1];if(a.toLowerCase()==="cimode")return!0;const o=(l,c)=>{const d=t.services.backendConnector.state[`${l}|${c}`];return d===-1||d===2};return r.bindI18n&&r.bindI18n.indexOf("languageChanging")>-1&&t.services.backendConnector.backend&&t.isLanguageChangingTo&&!o(t.isLanguageChangingTo,e)?!1:!!(t.hasResourceBundle(a,e)||!t.services.backendConnector.backend||t.options.resources&&!t.options.partialBundledLanguages||o(a,e)&&(!s||o(i,e)))},J6=function(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return!t.languages||!t.languages.length?(Uh("i18n.languages were undefined or empty",t.languages),!0):t.options.ignoreJSONStructure!==void 0?t.hasLoadedNamespace(e,{lng:r.lng,precheck:(s,i)=>{if(r.bindI18n&&r.bindI18n.indexOf("languageChanging")>-1&&s.services.backendConnector.backend&&s.isLanguageChangingTo&&!i(s.isLanguageChangingTo,e))return!1}}):Y6(e,t,r)},ni=e=>typeof e=="string",Z6=e=>typeof e=="object"&&e!==null,Q6=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,eE={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},tE=e=>eE[e],rE=e=>e.replace(Q6,tE);let Wh={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:rE};const aE=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Wh={...Wh,...e}},nE=()=>Wh;let Jj;const sE=e=>{Jj=e},iE=()=>Jj,oE={type:"3rdParty",init(e){aE(e.options.react),sE(e)}},lE=O.createContext();class cE{constructor(){Mg(this,"getUsedNamespaces",()=>Object.keys(this.usedNamespaces));this.usedNamespaces={}}addUsedNamespaces(t){t.forEach(r=>{this.usedNamespaces[r]||(this.usedNamespaces[r]=!0)})}}const dE=(e,t)=>{const r=O.useRef();return O.useEffect(()=>{r.current=e},[e,t]),r.current},Zj=(e,t,r,a)=>e.getFixedT(t,r,a),uE=(e,t,r,a)=>O.useCallback(Zj(e,t,r,a),[e,t,r,a]),yt=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{i18n:r}=t,{i18n:a,defaultNS:s}=O.useContext(lE)||{},i=r||a||iE();if(i&&!i.reportNamespaces&&(i.reportNamespaces=new cE),!i){Uh("You will need to pass in an i18next instance by using initReactI18next");const _=(j,N)=>ni(N)?N:Z6(N)&&ni(N.defaultValue)?N.defaultValue:Array.isArray(j)?j[j.length-1]:j,b=[_,{},!1];return b.t=_,b.i18n={},b.ready=!1,b}i.options.react&&i.options.react.wait!==void 0&&Uh("It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const o={...nE(),...i.options.react,...t},{useSuspense:l,keyPrefix:c}=o;let d=s||i.options&&i.options.defaultNS;d=ni(d)?[d]:d||["translation"],i.reportNamespaces.addUsedNamespaces&&i.reportNamespaces.addUsedNamespaces(d);const u=(i.isInitialized||i.initializedStoreOnce)&&d.every(_=>J6(_,i,o)),f=uE(i,t.lng||null,o.nsMode==="fallback"?d:d[0],c),h=()=>f,m=()=>Zj(i,t.lng||null,o.nsMode==="fallback"?d:d[0],c),[x,p]=O.useState(h);let g=d.join();t.lng&&(g=`${t.lng}${g}`);const y=dE(g),w=O.useRef(!0);O.useEffect(()=>{const{bindI18n:_,bindI18nStore:b}=o;w.current=!0,!u&&!l&&(t.lng?Xg(i,t.lng,d,()=>{w.current&&p(m)}):qg(i,d,()=>{w.current&&p(m)})),u&&y&&y!==g&&w.current&&p(m);const j=()=>{w.current&&p(m)};return _&&i&&i.on(_,j),b&&i&&i.store.on(b,j),()=>{w.current=!1,_&&i&&_.split(" ").forEach(N=>i.off(N,j)),b&&i&&b.split(" ").forEach(N=>i.store.off(N,j))}},[i,g]),O.useEffect(()=>{w.current&&u&&p(h)},[i,c,u]);const v=[x,i,u];if(v.t=x,v.i18n=i,v.ready=u,u||!u&&!l)return v;throw new Promise(_=>{t.lng?Xg(i,t.lng,d,()=>_()):qg(i,d,()=>_())})},fE=({onMenuClick:e})=>{const{user:t,logout:r}=vt(),{t:a,i18n:s}=yt(),[i,o]=O.useState(!1),[l,c]=O.useState(""),d=Go(),u=m=>{s.changeLanguage(m),o(!1)},f=m=>a(`roles.${m}`),h=()=>{l.trim()&&d(`/search-results?q=${encodeURIComponent(l.trim())}`)};return n.jsx("header",{className:"bg-white border-b border-gray-200 px-6 py-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("button",{onClick:e,className:"lg:hidden p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(J3,{className:"w-6 h-6 text-gray-600"})}),n.jsxs("div",{className:"relative hidden md:block",children:[n.jsx(ut,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:a("header.searchProjects"),className:"w-80 pl-4 pr-12 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:l,onChange:m=>c(m.target.value),onKeyPress:m=>{m.key==="Enter"&&h()}})]})]}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"relative",children:[n.jsxs("button",{onClick:()=>o(!i),className:"p-2 rounded-lg hover:bg-gray-100 transition-colors flex items-center gap-1",children:[n.jsx(rc,{className:"w-5 h-5 text-gray-600"}),n.jsx("span",{className:"text-sm",children:s.language==="ar"?"العربية":"English"})]}),i&&n.jsxs("div",{className:"absolute top-full right-0 mt-1 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:[n.jsx("button",{onClick:()=>u("ar"),className:`block w-full text-right px-4 py-2 text-sm hover:bg-gray-50 ${s.language==="ar"?"font-bold text-blue-600":""}`,children:"العربية"}),n.jsx("button",{onClick:()=>u("en"),className:`block w-full text-left px-4 py-2 text-sm hover:bg-gray-50 ${s.language==="en"?"font-bold text-blue-600":""}`,children:"English"})]})]}),n.jsxs(te.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"relative p-2 rounded-lg hover:bg-gray-100 transition-colors",children:[n.jsx(qs,{className:"w-6 h-6 text-gray-600"}),n.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:"3"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-sm font-medium text-gray-800",children:t==null?void 0:t.name}),n.jsx("p",{className:"text-xs text-gray-500",children:t!=null&&t.role?f(t.role):a("common.user")})]}),n.jsxs("div",{className:"relative group",children:[n.jsx("button",{className:"w-10 h-10 rounded-full overflow-hidden border-2 border-gray-200 hover:border-blue-500 transition-colors",children:t!=null&&t.avatar?n.jsx("img",{src:t.avatar,alt:t.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center",children:n.jsx(xr,{className:"w-5 h-5 text-white"})})}),n.jsx("div",{className:"absolute left-0 top-12 w-48 bg-white rounded-lg shadow-lg border border-gray-200 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50",children:n.jsxs("div",{className:"p-2",children:[n.jsx(Ee,{to:"/settings",className:"w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md block",children:a("header.profile")}),n.jsx(Ee,{to:"/settings",className:"w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md block",children:a("header.settings")}),n.jsx("hr",{className:"my-1"}),n.jsx("button",{onClick:r,className:"w-full text-right px-3 py-2 text-sm text-red-600 hover:bg-red-50 rounded-md",children:a("header.logout")})]})})]})]})]})]})})},hE=({isOpen:e,onClose:t,isMinimized:r,onToggleMinimize:a})=>{const s=Dx(),{user:i}=vt(),{t:o,i18n:l}=yt(),c=l.language==="ar",d=[{id:"home",icon:$j,label:o("sidebar.home"),path:"/"},{id:"project-ideas",icon:xa,label:o("sidebar.projectIdeas"),path:"/project-ideas"},{id:"projects",icon:br,label:o("sidebar.projects"),path:"/projects"},{id:"store",icon:Br,label:o("sidebar.store"),path:"/store"},{id:"consultations",icon:Ht,label:o("sidebar.consultations"),path:"/consultations"},{id:"gallery",icon:Rl,label:o("sidebar.gallery"),path:"/gallery"},{id:"ai-assistant",icon:Xs,label:o("sidebar.aiAssistant"),path:"/ai-assistant"},{id:"resources",icon:wt,label:o("sidebar.resources"),path:"/resources"},{id:"intellectual-property",icon:Ga,label:o("sidebar.intellectualProperty"),path:"/intellectual-property"}],f=(()=>{let h=[...d];return(i==null?void 0:i.role)==="teacher"?h.push({id:"students",icon:lt,label:o("sidebar.students"),path:"/students"},{id:"reports",icon:Yn,label:o("sidebar.reports"),path:"/reports"}):(i==null?void 0:i.role)==="consultant"?h.push({id:"consultant-dashboard",icon:hi,label:o("sidebar.consultantDashboard"),path:"/consultant-dashboard"},{id:"consultation-requests",icon:Ht,label:o("sidebar.consultationRequests"),path:"/consultation-requests"},{id:"consultant-schedule",icon:tt,label:o("sidebar.consultantSchedule"),path:"/consultant-schedule"},{id:"consultant-profile",icon:xr,label:o("sidebar.consultantProfile"),path:"/consultant-profile"},{id:"reviews",icon:at,label:o("sidebar.reviews"),path:"/reviews"}):(i==null?void 0:i.role)==="school"?h.push({id:"users",icon:lt,label:o("sidebar.teachersAndStudents"),path:"/users"},{id:"reports",icon:Yn,label:o("sidebar.reports"),path:"/reports"}):(i==null?void 0:i.role)==="admin"&&h.push({id:"admin-dashboard",icon:Mh,label:o("sidebar.adminDashboard"),path:"/admin-dashboard"},{id:"users",icon:lt,label:o("sidebar.users"),path:"/users"}),h.push({id:"settings",icon:xo,label:o("sidebar.settings"),path:"/settings"}),h})();return n.jsxs(n.Fragment,{children:[e&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden",onClick:t}),n.jsxs(te.div,{initial:!1,animate:{width:r?80:320},transition:{duration:.3,ease:"easeInOut"},className:`
          bg-white shadow-lg border-gray-200 z-50 flex-shrink-0
          ${e?"fixed inset-y-0 lg:relative":"hidden lg:flex lg:flex-col"}
          ${r?"w-20":"w-80"}
          ${c?"border-l":"border-r"}
          ${c?e?"right-0":"":e?"left-0":""}
        `,children:[n.jsx("div",{className:`p-6 border-gray-200 ${r?"px-4":""} border-b`,children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:`flex items-center gap-3 ${r?"justify-center":""}`,children:[n.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center overflow-hidden",children:n.jsx("img",{src:"/mashroui-logo.png",alt:o("appName"),className:"w-full h-full object-contain"})}),!r&&n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold text-gray-800",children:o("appName")}),n.jsx("p",{className:"text-sm text-gray-500",children:o("appTagline")})]})]}),n.jsx("button",{onClick:a,className:"hidden lg:flex p-2 rounded-lg hover:bg-gray-100 transition-colors",children:r?c?n.jsx(Ml,{className:"w-5 h-5 text-gray-600"}):n.jsx($l,{className:"w-5 h-5 text-gray-600"}):c?n.jsx($l,{className:"w-5 h-5 text-gray-600"}):n.jsx(Ml,{className:"w-5 h-5 text-gray-600"})}),n.jsx("button",{onClick:t,className:"lg:hidden p-2 rounded-lg hover:bg-gray-100 transition-colors",children:c?n.jsx($l,{className:"w-5 h-5 text-gray-600"}):n.jsx(Ml,{className:"w-5 h-5 text-gray-600"})})]})}),n.jsx("nav",{className:`p-4 space-y-2 overflow-y-auto flex-1 ${r?"px-2":""}`,children:f.map(h=>{const m=s.pathname===h.path;return n.jsxs("div",{className:"relative",children:[n.jsxs(Ee,{to:h.path,onClick:t,className:`flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-200 group ${m?"bg-gradient-to-r from-blue-500 via-purple-600 to-pink-600 text-white shadow-lg":"text-gray-600 hover:bg-gray-50 hover:text-gray-800"} ${r?"justify-center px-2":""}`,children:[n.jsx(h.icon,{className:"w-5 h-5 flex-shrink-0"}),!r&&n.jsx("span",{className:"font-medium",children:h.label})]}),r&&n.jsx("div",{className:`absolute ${c?"right-full":"left-full"} top-1/2 transform -translate-y-1/2 ${c?"mr-2":"ml-2"} bg-gray-800 text-white px-2 py-1 rounded text-sm opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10`,children:h.label})]},h.path)})})]})]})},mE=({children:e})=>{const[t,r]=O.useState(!1),[a,s]=O.useState(!1),{i18n:i}=yt(),o=i.language==="ar";return n.jsxs("div",{className:`min-h-screen bg-gray-50 flex ${o?"flex-row-reverse":"flex-row"}`,children:[n.jsx(hE,{isOpen:t,onClose:()=>r(!1),isMinimized:a,onToggleMinimize:()=>s(!a)}),n.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[n.jsx(fE,{onMenuClick:()=>r(!0)}),n.jsx("main",{className:"flex-1 p-6 overflow-auto",children:e})]})]})},xE=()=>{const{t:e}=yt(),[t,r]=O.useState(""),[a,s]=O.useState(""),[i,o]=O.useState(!1),[l,c]=O.useState(!1),[d,u]=O.useState(""),{login:f}=vt(),h=async m=>{m.preventDefault(),u(""),c(!0);try{await f(t,a)}catch(x){console.error("Auth error:",x);let p=e("auth.loginError");if(x instanceof Error){const g=x.message.toLowerCase();g.includes("invalid login credentials")||g.includes("invalid_credentials")||g.includes("user-not-found")||g.includes("wrong-password")?p=e("auth.loginError"):g.includes("email not confirmed")?p=e("auth.emailNotConfirmed"):g.includes("too many requests")?p=e("auth.tooManyRequests"):g.includes("network")||g.includes("fetch")?p=e("auth.networkError"):p=x.message}u(p)}finally{c(!1)}};return n.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center p-4",children:n.jsx("div",{className:"max-w-md w-full",children:n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-xl p-8",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx(te.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"w-20 h-20 rounded-2xl flex items-center justify-center mx-auto mb-4 overflow-hidden",children:n.jsx("img",{src:"/mashroui-logo.png",alt:e("appName"),className:"w-full h-full object-contain"})}),n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:e("appName")}),n.jsx("p",{className:"text-gray-600",children:e("appTagline")})]}),d&&n.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",children:d}),n.jsxs("form",{onSubmit:h,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("common.email")}),n.jsxs("div",{className:"relative",children:[n.jsx(Ta,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"email",value:t,onChange:m=>r(m.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:e("auth.enterEmail"),required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("common.password")}),n.jsxs("div",{className:"relative",children:[n.jsx(ac,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:i?"text":"password",value:a,onChange:m=>s(m.target.value),className:"w-full pr-12 pl-12 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:e("auth.enterPassword"),required:!0}),n.jsx("button",{type:"button",onClick:()=>o(!i),className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:i?n.jsx(Rx,{className:"w-5 h-5"}):n.jsx(sr,{className:"w-5 h-5"})})]})]}),n.jsx(te.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",disabled:l,className:"w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white py-3 rounded-xl font-medium hover:shadow-lg transition-all duration-200 disabled:opacity-70 disabled:cursor-not-allowed",children:l?n.jsxs("span",{className:"flex items-center justify-center",children:[n.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[n.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),n.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e("common.loading")]}):e("auth.login")})]}),n.jsxs("div",{className:"mt-6",children:[n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"absolute inset-0 flex items-center",children:n.jsx("div",{className:"w-full border-t border-gray-300"})}),n.jsx("div",{className:"relative flex justify-center text-sm",children:n.jsx("span",{className:"px-2 bg-white text-gray-500",children:e("auth.or")})})]}),n.jsxs("div",{className:"mt-6 grid grid-cols-2 gap-3",children:[n.jsxs(te.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"button",className:"w-full inline-flex justify-center py-3 px-4 border border-gray-300 rounded-xl bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 transition-colors",children:[n.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[n.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),n.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),n.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),n.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),n.jsx("span",{className:"mr-2",children:"Google"})]}),n.jsxs(te.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"button",className:"w-full inline-flex justify-center py-3 px-4 border border-gray-300 rounded-xl bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 transition-colors",children:[n.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:n.jsx("path",{fill:"currentColor",d:"M11.182.008C11.148-.03 9.923.023 8.857 1.18c-1.066 1.156-.902 2.482-.878 2.516s1.52.087 2.475-1.258.762-2.391.728-2.43m3.314 11.733c-.048-.096-2.325-1.234-2.113-3.422s1.675-2.789 1.698-2.854-.597-.79-1.254-1.157a3.7 3.7 0 0 0-1.563-.434c-.108-.003-.483-.095-1.254.116-.508.139-1.653.589-1.968.607-.316.018-1.256-.522-2.267-.665-.647-.125-1.333.131-1.824.328-.49.196-1.422.754-2.074 2.237-.652 1.482-.311 3.83-.067 4.56s.625 1.924 1.273 2.796c.576.984 1.34 1.667 1.659 1.899s1.219.386 1.843.067c.502-.308 1.408-.485 1.766-.472.357.013 1.061.154 1.782.539.571.197 1.111.115 1.652-.105.541-.221 1.324-1.059 2.238-2.758q.52-1.185.473-1.282"})}),n.jsx("span",{className:"mr-2",children:"Apple"})]})]})]}),n.jsx("div",{className:"mt-4 text-center",children:n.jsx(Ee,{to:"/summer-program-enrollment",className:"text-sm text-blue-600 hover:text-blue-800 transition-colors",children:'طلب الانضمام للبرنامج الصيفي "صيفي تك"'})}),n.jsx("div",{className:"mt-4 text-center",children:n.jsxs(Ee,{to:"/register",className:"text-sm text-blue-600 hover:text-blue-800 transition-colors",children:[e("auth.noAccount")," ",e("auth.createAccount")]})})]})})})},pE=()=>{const{register:e}=vt(),[t,r]=O.useState({name:"",email:"",password:"",confirmPassword:"",phone:"",role:"student",bio:"",school_id:"",grade:"",subject:"",specializations:[],experience_years:0,hourly_rate:150,languages:["العربية"]}),[a,s]=O.useState(!1),[i,o]=O.useState(!1),[l,c]=O.useState(""),[d,u]=O.useState([]),[f,h]=O.useState(!1),m=["الذكاء الاصطناعي","تعلم الآلة","الروبوتات","تطوير التطبيقات","تطوير الويب","قواعد البيانات","الأمن السيبراني","الشبكات","التصميم الجرافيكي","تجربة المستخدم","التسويق الرقمي","ريادة الأعمال","إدارة المشاريع","العلوم","الرياضيات","الفيزياء","الكيمياء","الأحياء","الهندسة الميكانيكية","الهندسة الكهربائية","الهندسة المدنية"],x=["العربية","الإنجليزية","الفرنسية","الإسبانية","الألمانية","الصينية","اليابانية","الروسية","الهندية","البرتغالية"];O.useEffect(()=>{(async()=>{try{h(!0),console.log("Fetching schools...");const _=await b6();if(console.log("Schools data received:",_),_&&Array.isArray(_)){const b=_.map(j=>({id:j.id,name:j.name||"مدرسة بدون اسم"}));console.log("Mapped schools:",b),u(b)}else console.log("No schools data or invalid format:",_),u([])}catch(_){console.error("Error fetching schools:",_),u([])}finally{h(!1)}})()},[]);const p=(v,_)=>{r(b=>({...b,[v]:_}))},g=v=>{r(_=>({..._,specializations:_.specializations.includes(v)?_.specializations.filter(b=>b!==v):[..._.specializations,v]}))},y=v=>{r(_=>({..._,languages:_.languages.includes(v)?_.languages.filter(b=>b!==v):[..._.languages,v]}))},w=async v=>{if(v.preventDefault(),c(""),t.password!==t.confirmPassword){c("كلمات المرور غير متطابقة");return}if(t.password.length<6){c("يجب أن تكون كلمة المرور 6 أحرف على الأقل");return}o(!0);try{await e(t.email,t.password,{name:t.name,role:t.role,phone:t.phone,bio:t.bio,school_id:t.school_id,grade:t.grade,subject:t.subject,specializations:t.specializations,experience_years:t.experience_years,hourly_rate:t.hourly_rate,languages:t.languages})}catch{c("حدث خطأ في إنشاء الحساب")}finally{o(!1)}};return n.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center p-4",children:n.jsx("div",{className:"max-w-2xl w-full",children:n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-xl p-8",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx(te.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"w-16 h-16 rounded-2xl flex items-center justify-center mx-auto mb-4 overflow-hidden",children:n.jsx("img",{src:"/mashroui-logo.png",alt:"مشروعي",className:"w-full h-full object-contain"})}),n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"إنشاء حساب جديد"}),n.jsx("p",{className:"text-gray-600",children:"انضم إلى منصة مشروعي"})]}),l&&n.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",children:l}),n.jsxs("form",{onSubmit:w,className:"space-y-6",children:[n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الاسم الكامل"}),n.jsxs("div",{className:"relative",children:[n.jsx(xr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:t.name,onChange:v=>p("name",v.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل اسمك الكامل",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"البريد الإلكتروني"}),n.jsxs("div",{className:"relative",children:[n.jsx(Ta,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"email",value:t.email,onChange:v=>p("email",v.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل بريدك الإلكتروني",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"كلمة المرور"}),n.jsxs("div",{className:"relative",children:[n.jsx(ac,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:a?"text":"password",value:t.password,onChange:v=>p("password",v.target.value),className:"w-full pr-12 pl-12 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل كلمة المرور",required:!0}),n.jsx("button",{type:"button",onClick:()=>s(!a),className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:a?n.jsx(Rx,{className:"w-5 h-5"}):n.jsx(sr,{className:"w-5 h-5"})})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تأكيد كلمة المرور"}),n.jsxs("div",{className:"relative",children:[n.jsx(ac,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:a?"text":"password",value:t.confirmPassword,onChange:v=>p("confirmPassword",v.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أعد إدخال كلمة المرور",required:!0})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم الهاتف"}),n.jsxs("div",{className:"relative",children:[n.jsx(Pr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"tel",value:t.phone,onChange:v=>p("phone",v.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"05xxxxxxxx"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نوع الحساب"}),n.jsxs("div",{className:"grid grid-cols-3 md:grid-cols-4 gap-3",children:[n.jsxs("label",{className:`flex items-center justify-center gap-2 p-4 border rounded-xl cursor-pointer transition-colors ${t.role==="student"?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"role",value:"student",checked:t.role==="student",onChange:()=>p("role","student"),className:"sr-only"}),n.jsx(js,{className:"w-5 h-5"}),n.jsx("span",{className:"font-medium",children:"طالب"})]}),n.jsxs("label",{className:`flex items-center justify-center gap-2 p-4 border rounded-xl cursor-pointer transition-colors ${t.role==="teacher"?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"role",value:"teacher",checked:t.role==="teacher",onChange:()=>p("role","teacher"),className:"sr-only"}),n.jsx(wt,{className:"w-5 h-5"}),n.jsx("span",{className:"font-medium",children:"معلم"})]}),n.jsxs("label",{className:`flex items-center justify-center gap-2 p-4 border rounded-xl cursor-pointer transition-colors ${t.role==="consultant"?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"role",value:"consultant",checked:t.role==="consultant",onChange:()=>p("role","consultant"),className:"sr-only"}),n.jsx(hi,{className:"w-5 h-5"}),n.jsx("span",{className:"font-medium",children:"مستشار"})]}),n.jsxs("label",{className:`flex items-center justify-center gap-2 p-4 border rounded-xl cursor-pointer transition-colors ${t.role==="school"?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"role",value:"school",checked:t.role==="school",onChange:()=>p("role","school"),className:"sr-only"}),n.jsx(jn,{className:"w-5 h-5"}),n.jsx("span",{className:"font-medium",children:"مدرسة"})]})]})]}),t.role==="student"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المدرسة"}),n.jsxs("div",{className:"relative",children:[n.jsx(jn,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsxs("select",{value:t.school_id,onChange:v=>p("school_id",v.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"",children:"اختر المدرسة"}),f?n.jsx("option",{disabled:!0,children:"جاري تحميل المدارس..."}):d.map(v=>n.jsx("option",{value:v.id,children:v.name},v.id))]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الصف الدراسي"}),n.jsxs("div",{className:"relative",children:[n.jsx(js,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:t.grade,onChange:v=>p("grade",v.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"مثال: الصف الثالث الثانوي"})]})]})]}),t.role==="teacher"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المدرسة"}),n.jsxs("div",{className:"relative",children:[n.jsx(jn,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsxs("select",{value:t.school_id,onChange:v=>p("school_id",v.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"",children:"اختر المدرسة"}),f?n.jsx("option",{disabled:!0,children:"جاري تحميل المدارس..."}):d.map(v=>n.jsx("option",{value:v.id,children:v.name},v.id))]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"التخصص"}),n.jsxs("div",{className:"relative",children:[n.jsx(wt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:t.subject,onChange:v=>p("subject",v.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"مثال: الرياضيات، العلوم، اللغة العربية"})]})]})]}),t.role==="consultant"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نبذة مهنية"}),n.jsx("textarea",{value:t.bio,onChange:v=>p("bio",v.target.value),rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"اكتب نبذة مختصرة عن خبرتك المهنية..."})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"التخصصات"}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:m.map(v=>n.jsxs("label",{className:`flex items-center gap-2 p-3 border rounded-lg cursor-pointer transition-colors ${t.specializations.includes(v)?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"checkbox",checked:t.specializations.includes(v),onChange:()=>g(v),className:"sr-only"}),n.jsx("span",{className:"text-sm",children:v})]},v))})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"سنوات الخبرة"}),n.jsxs("div",{className:"relative",children:[n.jsx(ar,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"number",value:t.experience_years,onChange:v=>p("experience_years",parseInt(v.target.value)||0),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"عدد سنوات الخبرة",min:"0"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"سعر الساعة (ريال سعودي)"}),n.jsxs("div",{className:"relative",children:[n.jsx(iu,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"number",value:t.hourly_rate,onChange:v=>p("hourly_rate",parseInt(v.target.value)||0),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"سعر الساعة",min:"0"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"اللغات"}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-2",children:x.map(v=>n.jsxs("label",{className:`flex items-center gap-2 p-3 border rounded-lg cursor-pointer transition-colors ${t.languages.includes(v)?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"checkbox",checked:t.languages.includes(v),onChange:()=>y(v),className:"sr-only"}),n.jsx("span",{className:"text-sm",children:v})]},v))})]})]}),t.role==="school"&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"معلومات المدرسة"}),n.jsx("textarea",{value:t.bio,onChange:v=>p("bio",v.target.value),rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"اكتب نبذة مختصرة عن المدرسة..."})]}),n.jsx(te.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",disabled:i,className:"w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white py-3 rounded-xl font-medium hover:shadow-lg transition-all duration-200 disabled:opacity-70 disabled:cursor-not-allowed",children:i?"جاري إنشاء الحساب...":"إنشاء حساب"})]}),n.jsx("div",{className:"mt-6 text-center",children:n.jsx(Ee,{to:"/login",className:"text-sm text-blue-600 hover:text-blue-800 transition-colors",children:"لديك حساب بالفعل؟ تسجيل الدخول"})})]})})})},gE=()=>{const{t:e}=yt(),t=[{icon:lt,label:e("home.stats.activeUsers"),value:"147",color:"from-blue-500 to-blue-600"},{icon:wt,label:e("home.stats.activeProjects"),value:"14",color:"from-green-500 to-green-600"},{icon:ar,label:e("home.stats.completedProjects"),value:"14",color:"from-purple-500 to-purple-600"},{icon:mi,label:e("home.stats.successRate"),value:"100%",color:"from-orange-500 to-orange-600"}],r=[{icon:wt,title:e("sidebar.projectIdeas"),description:e("home.featuresSection.description"),link:"/project-ideas",color:"from-yellow-400 to-orange-500"},{icon:lt,title:e("sidebar.projects"),description:e("home.featuresSection.description"),link:"/projects",color:"from-blue-500 to-purple-600"},{icon:Ht,title:e("sidebar.consultations"),description:e("home.featuresSection.description"),link:"/consultations",color:"from-green-500 to-teal-600"},{icon:Br,title:e("sidebar.store"),description:e("home.featuresSection.description"),link:"/store",color:"from-pink-500 to-rose-600"},{icon:Xs,title:e("sidebar.aiAssistant"),description:e("home.featuresSection.description"),link:"/ai-assistant",color:"from-indigo-500 to-blue-600"},{icon:Rl,title:e("sidebar.gallery"),description:e("home.featuresSection.description"),link:"/gallery",color:"from-purple-500 to-pink-600"}],a=[{name:"سارة أحمد",role:"معلمة علوم",content:"منصة مشروعي غيرت طريقة تدريسي تماماً. الطلاب أصبحوا أكثر تفاعلاً وإبداعاً.",avatar:"https://images.pexels.com/photos/774909/pexels-photo-774909.jpeg?auto=compress&cs=tinysrgb&w=150",rating:5},{name:"محمد علي",role:"طالب ثانوي",content:"تمكنت من تطوير مشروع روبوت متقدم بفضل الإرشادات والدعم المتاح في المنصة.",avatar:"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",rating:5},{name:"فاطمة خالد",role:"مديرة مدرسة",content:"المنصة ساعدتنا في تنظيم وإدارة مشاريع الطلاب بكفاءة عالية ومتابعة تقدمهم.",avatar:"https://images.pexels.com/photos/415829/pexels-photo-415829.jpeg?auto=compress&cs=tinysrgb&w=150",rating:5}];return n.jsxs("div",{className:"space-y-8",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-br from-blue-600 via-purple-600 to-pink-600 rounded-3xl p-8 text-white relative overflow-hidden",children:[n.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-20 rounded-3xl"}),n.jsxs("div",{className:"relative z-10",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx("div",{className:"w-16 h-16 bg-white bg-opacity-20 rounded-2xl flex items-center justify-center backdrop-blur-sm overflow-hidden",children:n.jsx("img",{src:"/mashroui-logo.png",alt:e("appName"),className:"w-full h-full object-contain"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-4xl font-bold mb-2",children:e("home.welcome")}),n.jsx("p",{className:"text-xl opacity-90",children:e("home.tagline")})]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-8 items-center",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-lg mb-6 opacity-90 leading-relaxed",children:e("home.description")}),n.jsxs("div",{className:"flex flex-wrap gap-4",children:[n.jsxs(Ee,{to:"/project-ideas",className:"bg-white text-blue-600 px-6 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(wt,{className:"w-5 h-5"}),e("home.exploreIdeas")]}),n.jsxs(Ee,{to:"/projects",className:"bg-white bg-opacity-20 text-white px-6 py-3 rounded-xl font-medium hover:bg-opacity-30 transition-all duration-200 backdrop-blur-sm flex items-center gap-2",children:[n.jsx(wt,{className:"w-5 h-5"}),e("home.manageProjects")]})]})]}),n.jsx("div",{className:"hidden md:block",children:n.jsx("div",{className:"rounded-2xl overflow-hidden shadow-2xl",children:n.jsx("img",{src:"https://alandalus.edu.sa/photos/1/makka%20(4).jpg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",alt:"طلاب يعملون على مشروع متقدم",className:"w-full h-full object-cover"})})})]})]})]}),n.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-6",children:t.map((s,i)=>n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:i*.1},className:"bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300",children:[n.jsx("div",{className:`w-12 h-12 bg-gradient-to-r ${s.color} rounded-xl flex items-center justify-center mb-4`,children:n.jsx(s.icon,{className:"w-6 h-6 text-white"})}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-1",children:s.value}),n.jsx("p",{className:"text-gray-600 text-sm",children:s.label})]},s.label))}),n.jsxs("div",{children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-8",children:[n.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-4",children:e("home.featuresSection.title")}),n.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:e("home.featuresSection.description")})]}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map((s,i)=>n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:i*.1},whileHover:{y:-5},className:"bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 group",children:[n.jsx("div",{className:`w-14 h-14 bg-gradient-to-r ${s.color} rounded-2xl flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300`,children:n.jsx(s.icon,{className:"w-7 h-7 text-white"})}),n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-3",children:s.title}),n.jsx("p",{className:"text-gray-600 mb-4 leading-relaxed",children:s.description}),n.jsxs(Ee,{to:s.link,className:"inline-flex items-center gap-2 text-blue-600 font-medium hover:text-blue-800 transition-colors",children:[e("home.featuresSection.exploreMore"),n.jsx(nc,{className:"w-4 h-4"})]})]},s.title))})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gray-50 rounded-3xl p-8",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-4",children:e("home.testimonials.title")}),n.jsx("p",{className:"text-gray-600",children:e("home.testimonials.subtitle")})]}),n.jsx("div",{className:"grid md:grid-cols-3 gap-6",children:a.map((s,i)=>n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:i*.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsx("div",{className:"flex items-center gap-1 mb-4",children:[...Array(s.rating)].map((o,l)=>n.jsx(at,{className:"w-5 h-5 text-yellow-400 fill-current"},l))}),n.jsxs("p",{className:"text-gray-700 mb-4 leading-relaxed",children:['"',s.content,'"']}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("img",{src:s.avatar,alt:s.name,className:"w-12 h-12 rounded-full object-cover"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-semibold text-gray-800",children:s.name}),n.jsx("p",{className:"text-sm text-gray-600",children:s.role})]})]})]},s.name))})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-green-500 to-teal-600 rounded-3xl p-8 text-white text-center",children:[n.jsx("h2",{className:"text-3xl font-bold mb-4",children:e("home.cta.title")}),n.jsx("p",{className:"text-xl mb-6 opacity-90",children:e("home.cta.description")}),n.jsxs("div",{className:"flex flex-wrap justify-center gap-4",children:[n.jsx(Ee,{to:"/project-ideas",className:"bg-white text-green-600 px-8 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200",children:e("home.cta.exploreIdeas")}),n.jsx(Ee,{to:"/projects",className:"bg-white bg-opacity-20 text-white px-8 py-3 rounded-xl font-medium hover:bg-opacity-30 transition-all duration-200 backdrop-blur-sm",children:e("home.cta.createProject")})]})]})]})},vE=()=>{const{user:e,logout:t}=vt(),{t:r}=yt(),a=(e==null?void 0:e.role)==="school",s=(e==null?void 0:e.role)==="consultant";return n.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center p-4",children:n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-xl p-8 max-w-2xl w-full",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("div",{className:"w-20 h-20 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(jt,{className:"w-10 h-10 text-yellow-600"})}),n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:r("pendingActivation.title")}),n.jsx("p",{className:"text-gray-600 text-lg",children:r(a?"pendingActivation.description.school":s?"pendingActivation.description.consultant":"pendingActivation.description.default")})]}),n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6 mb-6",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(pt,{className:"w-6 h-6 text-blue-600 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h2",{className:"font-semibold text-blue-800 mb-2",children:r("pendingActivation.whatHappensNext")}),n.jsxs("ul",{className:"space-y-2 text-blue-700",children:[n.jsxs("li",{children:["• ",r("pendingActivation.steps.review")]}),n.jsxs("li",{children:["• ",r("pendingActivation.steps.verify")]}),n.jsxs("li",{children:["• ",r("pendingActivation.steps.email")]}),n.jsxs("li",{children:["• ",r("pendingActivation.steps.timeframe")]})]})]})]})}),n.jsxs("div",{className:"border border-gray-200 rounded-xl p-6 mb-6",children:[n.jsx("h2",{className:"font-semibold text-gray-800 mb-4",children:r("pendingActivation.contactInfo")}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Ta,{className:"w-5 h-5 text-gray-500"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:r("common.email")}),n.jsx("p",{className:"font-medium",children:e==null?void 0:e.email})]})]}),(e==null?void 0:e.phone)&&n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Pr,{className:"w-5 h-5 text-gray-500"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:r("common.phone")}),n.jsx("p",{className:"font-medium",children:e.phone})]})]})]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[n.jsxs("div",{className:"border border-gray-200 rounded-xl p-4 flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:n.jsx(ze,{className:"w-5 h-5 text-green-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-800",children:r("pendingActivation.approvalStates.approved")}),n.jsx("p",{className:"text-sm text-gray-600",children:r("pendingActivation.approvalStates.approvedDesc")})]})]}),n.jsxs("div",{className:"border border-gray-200 rounded-xl p-4 flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:n.jsx(Mr,{className:"w-5 h-5 text-red-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-800",children:r("pendingActivation.approvalStates.rejected")}),n.jsx("p",{className:"text-sm text-gray-600",children:r("pendingActivation.approvalStates.rejectedDesc")})]})]})]}),n.jsx("div",{className:"bg-gray-50 rounded-xl p-6 mb-6",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(Ga,{className:"w-6 h-6 text-gray-600 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h2",{className:"font-semibold text-gray-800 mb-2",children:r("pendingActivation.needHelp")}),n.jsxs("p",{className:"text-gray-600 mb-4",children:[r("pendingActivation.helpText"),n.jsx("a",{href:"mailto:support@mashroui.com",className:"text-blue-600 hover:underline mx-1",children:"support@mashroui.com"})]})]})]})}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[n.jsxs("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center justify-center gap-2",children:[n.jsx(Lj,{className:"w-5 h-5"}),r("pendingActivation.refreshPage")]}),n.jsxs("button",{onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors flex items-center justify-center gap-2",children:[n.jsx(Z3,{className:"w-5 h-5"}),r("pendingActivation.logout")]})]})]})})},yE=()=>{const{t:e,i18n:t}=yt();Go();const[r,a]=O.useState({fullName:"",email:"",phone:"",parentPhone:"",city:"",idNumber:"",school:"",grade:"",educationAdministration:"",hasParticipatedBefore:!1,previousProjects:"",interests:[],howDidYouHear:"",notes:""}),[s,i]=O.useState(!1),[o,l]=O.useState(null),[c,d]=O.useState(!1),u=(x,p)=>{a(g=>({...g,[x]:p}))},f=x=>{a(p=>{const g=[...p.interests];return g.includes(x)?{...p,interests:g.filter(y=>y!==x)}:{...p,interests:[...g,x]}})},h=()=>{if(!r.fullName||!r.email||!r.phone||!r.parentPhone||!r.city||!r.idNumber||!r.school||!r.grade||!r.educationAdministration||!r.howDidYouHear||r.interests.length===0)return l(e("summerProgram.enrollmentForm.requiredField")),!1;if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.email))return l(e("summerProgram.enrollmentForm.invalidEmail")),!1;const p=/^\d{9,15}$/;return!p.test(r.phone.replace(/\D/g,""))||!p.test(r.parentPhone.replace(/\D/g,""))?(l(e("summerProgram.enrollmentForm.invalidPhone")),!1):r.idNumber.length<5?(l(e("summerProgram.enrollmentForm.invalidIdNumber")),!1):!0},m=async x=>{if(x.preventDefault(),!!h()){i(!0),l(null);try{await V6(r),d(!0),a({fullName:"",email:"",phone:"",parentPhone:"",city:"",idNumber:"",school:"",grade:"",educationAdministration:"",hasParticipatedBefore:!1,previousProjects:"",interests:[],howDidYouHear:"",notes:""}),window.scrollTo(0,0)}catch(p){console.error("Error submitting summer program registration:",p),l(e("summerProgram.enrollmentForm.errorMessage"))}finally{i(!1)}}};return n.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 py-12 px-4",children:n.jsxs("div",{className:"max-w-4xl mx-auto",children:[n.jsxs("div",{className:"mb-8 text-center",children:[n.jsx(Ee,{to:"/",className:"inline-block mb-6",children:n.jsx("img",{src:"/mashroui-logo.png",alt:e("appName"),className:"h-16 w-auto"})}),n.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-800 mb-2",children:e("summerProgram.title")}),n.jsx("p",{className:"text-lg text-gray-600",children:e("summerProgram.subtitle")})]}),n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-xl p-8",children:c?n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:n.jsx(ze,{className:"w-10 h-10 text-green-600"})}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:e("summerProgram.enrollmentForm.successMessage")}),n.jsx("p",{className:"text-gray-600 mb-8",children:"سيتم التواصل معك قريباً بخصوص البرنامج الصيفي. يمكنك العودة إلى الصفحة الرئيسية أو تسجيل الدخول إلى حسابك."}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[n.jsx(Ee,{to:"/",className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:"العودة للصفحة الرئيسية"}),n.jsx(Ee,{to:"/login",className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"تسجيل الدخول"})]})]}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-8",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:e("summerProgram.enrollmentForm.title")}),n.jsx("p",{className:"text-gray-600",children:e("summerProgram.enrollmentForm.subtitle")})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>t.changeLanguage("ar"),className:`px-3 py-1 rounded-lg ${t.language==="ar"?"bg-blue-500 text-white":"bg-gray-100"}`,children:"العربية"}),n.jsx("button",{onClick:()=>t.changeLanguage("en"),className:`px-3 py-1 rounded-lg ${t.language==="en"?"bg-blue-500 text-white":"bg-gray-100"}`,children:"English"})]})]}),o&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(pt,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:o})]}),n.jsxs("form",{onSubmit:m,className:"space-y-6",children:[n.jsxs("div",{className:"bg-blue-50 rounded-xl p-4 mb-6",children:[n.jsxs("h3",{className:"text-lg font-semibold text-blue-800 mb-4 flex items-center gap-2",children:[n.jsx(xr,{className:"w-5 h-5"}),t.language==="ar"?"المعلومات الشخصية":"Personal Information"]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.fullName")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(xr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:r.fullName,onChange:x=>u("fullName",x.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("summerProgram.enrollmentForm.fullNamePlaceholder"),required:!0})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.email")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(Ta,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"email",value:r.email,onChange:x=>u("email",x.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("summerProgram.enrollmentForm.emailPlaceholder"),required:!0})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.phone")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(Pr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"tel",value:r.phone,onChange:x=>u("phone",x.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("summerProgram.enrollmentForm.phonePlaceholder"),required:!0})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.parentPhone")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(Pr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"tel",value:r.parentPhone,onChange:x=>u("parentPhone",x.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("summerProgram.enrollmentForm.parentPhonePlaceholder"),required:!0})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.city")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(Of,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsxs("select",{value:r.city,onChange:x=>u("city",x.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[n.jsx("option",{value:"",children:e("summerProgram.enrollmentForm.cityPlaceholder")}),e("summerProgram.cities",{returnObjects:!0}).map(x=>n.jsx("option",{value:x,children:x},x))]})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.idNumber")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(Q3,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:r.idNumber,onChange:x=>u("idNumber",x.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("summerProgram.enrollmentForm.idNumberPlaceholder"),required:!0})]})]})]})]}),n.jsxs("div",{className:"bg-green-50 rounded-xl p-4 mb-6",children:[n.jsxs("h3",{className:"text-lg font-semibold text-green-800 mb-4 flex items-center gap-2",children:[n.jsx(gn,{className:"w-5 h-5"}),t.language==="ar"?"المعلومات التعليمية":"Educational Information"]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.school")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(gn,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:r.school,onChange:x=>u("school",x.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("summerProgram.enrollmentForm.schoolPlaceholder"),required:!0})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.grade")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(js,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsxs("select",{value:r.grade,onChange:x=>u("grade",x.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[n.jsx("option",{value:"",children:e("summerProgram.enrollmentForm.gradePlaceholder")}),e("summerProgram.grades",{returnObjects:!0}).map(x=>n.jsx("option",{value:x,children:x},x))]})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.educationAdministration")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(jn,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsxs("select",{value:r.educationAdministration,onChange:x=>u("educationAdministration",x.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[n.jsx("option",{value:"",children:e("summerProgram.enrollmentForm.educationAdministrationPlaceholder")}),e("summerProgram.educationAdministrations",{returnObjects:!0}).map(x=>n.jsx("option",{value:x,children:x},x))]})]})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.hasParticipatedBefore")," *"]}),n.jsxs("div",{className:"flex gap-4",children:[n.jsxs("label",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"radio",checked:r.hasParticipatedBefore===!0,onChange:()=>u("hasParticipatedBefore",!0),className:"w-4 h-4 text-blue-600"}),n.jsx("span",{children:e("summerProgram.enrollmentForm.yes")})]}),n.jsxs("label",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"radio",checked:r.hasParticipatedBefore===!1,onChange:()=>u("hasParticipatedBefore",!1),className:"w-4 h-4 text-blue-600"}),n.jsx("span",{children:e("summerProgram.enrollmentForm.no")})]})]})]}),r.hasParticipatedBefore&&n.jsxs("div",{className:"md:col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.previousProjects")," *"]}),n.jsx("textarea",{value:r.previousProjects,onChange:x=>u("previousProjects",x.target.value),rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("summerProgram.enrollmentForm.previousProjectsPlaceholder"),required:r.hasParticipatedBefore})]})]})]}),n.jsxs("div",{className:"bg-purple-50 rounded-xl p-4 mb-6",children:[n.jsxs("h3",{className:"text-lg font-semibold text-purple-800 mb-4 flex items-center gap-2",children:[n.jsx(wt,{className:"w-5 h-5"}),t.language==="ar"?"الاهتمامات والتفضيلات":"Interests and Preferences"]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.interests")," *"]}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:e("summerProgram.interests",{returnObjects:!0}).map(x=>n.jsxs("label",{className:`flex items-center gap-2 p-3 border rounded-lg cursor-pointer transition-colors ${r.interests.includes(x)?"bg-purple-100 border-purple-500 text-purple-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"checkbox",checked:r.interests.includes(x),onChange:()=>f(x),className:"sr-only"}),n.jsx("span",{className:"text-sm",children:x})]},x))})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.howDidYouHear")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(En,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsxs("select",{value:r.howDidYouHear,onChange:x=>u("howDidYouHear",x.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[n.jsx("option",{value:"",children:e("summerProgram.enrollmentForm.howDidYouHearPlaceholder")}),e("summerProgram.hearAboutUs",{returnObjects:!0}).map(x=>n.jsx("option",{value:x,children:x},x))]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("summerProgram.enrollmentForm.notes")}),n.jsxs("div",{className:"relative",children:[n.jsx(Lr,{className:"absolute right-3 top-3 w-5 h-5 text-gray-400"}),n.jsx("textarea",{value:r.notes,onChange:x=>u("notes",x.target.value),rows:4,className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("summerProgram.enrollmentForm.notesPlaceholder")})]})]})]})]}),n.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4 mb-6",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(En,{className:"w-6 h-6 text-yellow-600 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:t.language==="ar"?"معلومات مهمة":"Important Information"}),n.jsxs("ul",{className:"space-y-1 text-yellow-700 text-sm",children:[n.jsxs("li",{children:["• ",t.language==="ar"?"سيتم مراجعة طلبك والرد عليك في أقرب وقت ممكن.":"Your application will be reviewed and we will respond as soon as possible."]}),n.jsxs("li",{children:["• ",t.language==="ar"?"يرجى التأكد من صحة جميع المعلومات المقدمة.":"Please ensure all provided information is accurate."]}),n.jsxs("li",{children:["• ",t.language==="ar"?"سيتم التواصل معك عبر البريد الإلكتروني أو الهاتف المقدم.":"You will be contacted via the provided email or phone number."]}),n.jsxs("li",{children:["• ",t.language==="ar"?"البرنامج مخصص للطلاب في المرحلة المتوسطة والثانوية.":"The program is designed for middle and high school students."]})]})]})]})}),n.jsx("div",{className:"flex justify-end",children:n.jsx("button",{type:"submit",disabled:s,className:"px-8 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:s?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e("summerProgram.enrollmentForm.submitting")]}):n.jsxs(n.Fragment,{children:[n.jsx(Mx,{className:"w-5 h-5"}),e("summerProgram.enrollmentForm.submit")]})})})]})]})}),n.jsxs("div",{className:"mt-8 text-center text-gray-600 text-sm",children:[n.jsxs("p",{children:["© 2025 ",e("appName")," - ",e("appTagline")]}),n.jsxs("div",{className:"mt-2 flex justify-center gap-4",children:[n.jsx(Ee,{to:"/",className:"hover:text-blue-600 transition-colors",children:t.language==="ar"?"الصفحة الرئيسية":"Home"}),n.jsx(Ee,{to:"/login",className:"hover:text-blue-600 transition-colors",children:t.language==="ar"?"تسجيل الدخول":"Login"}),n.jsx(Ee,{to:"/register",className:"hover:text-blue-600 transition-colors",children:t.language==="ar"?"إنشاء حساب":"Register"})]})]})]})})},As=()=>{const[e,t]=O.useState([]),[r,a]=O.useState([]),[s,i]=O.useState(!0),[o,l]=O.useState(null),{user:c}=vt(),d=async()=>{try{i(!0),console.log("Fetching consultants...");const x=await _6();console.log("Consultants data received:",x),a(x||[])}catch(x){console.error("Error fetching consultants:",x),l(x instanceof Error?x.message:"حدث خطأ في تحميل المستشارين")}finally{i(!1)}},u=async()=>{if(c)try{i(!0),l(null);const x=De(pe,"consultations");let p;if(c.role==="student")p=et(x,Ue("student_id","==",c.id));else if(c.role==="teacher"||c.role==="consultant"){const w=et(x,Ue("mentor_id","==",c.id)),v=await Je(w),_=et(x,Ue("mentor_id","==",null)),b=await Je(_),j=[...v.docs,...b.docs];if(j.length===0){t([]),i(!1);return}const N=await Promise.all(j.map(async k=>{const S=k.data();let E=null;if(S.mentor_id)try{const P=Ie(pe,"users",S.mentor_id),C=await hr(P);C.exists()&&(E=C.data().name)}catch(P){console.error("Error fetching mentor data:",P)}return{id:k.id,mentor_id:S.mentor_id||null,mentor_name:E,student_id:S.student_id,project_id:S.project_id||null,topic:S.topic,description:S.description,type:S.type,status:S.status,method:S.method||"video",duration:S.duration||60,scheduledDate:S.scheduled_at?new Date(S.scheduled_at.toDate()).toISOString():void 0,preferredDate:S.preferred_date?new Date(S.preferred_date.toDate()).toISOString():void 0,completedAt:S.completed_at?new Date(S.completed_at.toDate()).toISOString():void 0,rating:S.rating,feedback:S.feedback,createdAt:S.created_at?new Date(S.created_at.toDate()).toISOString():new Date().toISOString()}}));t(N),i(!1);return}else p=x;const g=await Je(p);if(g.empty){t([]),i(!1);return}const y=await Promise.all(g.docs.map(async w=>{const v=w.data();let _=null;if(v.mentor_id)try{const b=Ie(pe,"users",v.mentor_id),j=await hr(b);j.exists()&&(_=j.data().name)}catch(b){console.error("Error fetching mentor data:",b)}return{id:w.id,mentor_id:v.mentor_id||null,mentor_name:_,student_id:v.student_id,project_id:v.project_id||null,topic:v.topic,description:v.description,type:v.type,status:v.status,method:v.method||"video",duration:v.duration||60,scheduledDate:v.scheduled_at?new Date(v.scheduled_at.toDate()).toISOString():void 0,preferredDate:v.preferred_date?new Date(v.preferred_date.toDate()).toISOString():void 0,completedAt:v.completed_at?new Date(v.completed_at.toDate()).toISOString():void 0,rating:v.rating,feedback:v.feedback,createdAt:v.created_at?new Date(v.created_at.toDate()).toISOString():new Date().toISOString()}}));t(y)}catch(x){console.error("Error fetching consultations:",x),l(x instanceof Error?x.message:"حدث خطأ في تحميل الاستشارات")}finally{i(!1)}},f=async x=>{if(!c)throw new Error("يجب تسجيل الدخول أولاً");try{const p=De(pe,"consultations"),g={student_id:c.id,mentor_id:x.mentor_id||null,project_id:x.project_id||null,topic:x.topic,description:x.description,type:x.type,status:x.status||"pending",method:x.method||"video",duration:x.duration||60,scheduled_at:x.scheduledDate?rn.fromDate(new Date(x.scheduledDate)):null,preferred_date:x.preferredDate?rn.fromDate(new Date(x.preferredDate)):null,created_at:Ge()},y=await Aa(p,g);return await u(),{id:y.id,...g}}catch(p){throw console.error("Error creating consultation:",p),p}},h=async(x,p)=>{try{const g=Ie(pe,"consultations",x),y={};p.status&&(y.status=p.status),p.mentor_id&&(y.mentor_id=p.mentor_id),p.scheduledDate&&(y.scheduled_at=rn.fromDate(new Date(p.scheduledDate))),p.completedAt&&(y.completed_at=rn.fromDate(new Date(p.completedAt))),p.rating!==void 0&&(y.rating=p.rating),p.feedback&&(y.feedback=p.feedback),y.updated_at=Ge(),await Wt(g,y),await u()}catch(g){throw console.error("Error updating consultation:",g),g}},m=async(x,p)=>{if(!c)throw new Error("يجب تسجيل الدخول أولاً");try{const g=Ie(pe,"consultations",x),y={mentor_id:c.id,status:"scheduled",updated_at:Ge()};p&&(y.scheduled_at=rn.fromDate(new Date(p))),await Wt(g,y),await u()}catch(g){throw console.error("Error accepting consultation:",g),g}};return O.useEffect(()=>{c&&(u(),d())},[c]),{consultations:e,consultants:r,loading:s,error:o,fetchConsultations:u,fetchConsultants:d,createConsultation:f,updateConsultation:h,acceptConsultation:m}},If=e=>{if(!e)return null;try{if(e instanceof rn)return e.toDate();if(e instanceof Date)return e;if(typeof e=="string"){if(!isNaN(Number(e)))return new Date(Number(e));const t=new Date(e);return isNaN(t.getTime())?null:t}return null}catch(t){return console.error("Error converting to Date object:",t),null}},Ze=(e,t)=>{const r=If(e);if(!r)return"غير محدد";const a={year:"numeric",month:"long",day:"numeric",calendar:"gregory"};return r.toLocaleDateString("ar-SA",{...a,...t})},Ol=e=>{const t=If(e);if(!t)return null;try{const r=new Date;r.setHours(0,0,0,0);const a=new Date(t);a.setHours(0,0,0,0);const s=a.getTime()-r.getTime();return Math.ceil(s/(1e3*60*60*24))}catch(r){return console.error("Error calculating days remaining:",r),null}},H0=e=>{const t=If(e);return t?t.toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit",calendar:"gregory"}):""},bE=e=>{const t=If(e);if(!t)return"";const a=Math.floor((new Date().getTime()-t.getTime())/1e3);if(a<60)return"الآن";const s=Math.floor(a/60);if(s<60)return`منذ ${s} دقيقة`;const i=Math.floor(s/60);if(i<24)return`منذ ${i} ساعة`;const o=Math.floor(i/24);if(o<30)return`منذ ${o} يوم`;const l=Math.floor(o/30);return l<12?`منذ ${l} شهر`:`منذ ${Math.floor(l/12)} سنة`},Ci=()=>{const[e,t]=O.useState([]),[r,a]=O.useState(!0),[s,i]=O.useState(null),{user:o}=vt(),l=async()=>{if(!o){console.log("No user found, skipping project fetch");return}try{a(!0),i(null),console.log("Fetching projects for user:",{id:o.id,role:o.role,school_id:o.school_id});let h=[];if(o.role==="teacher"){console.log("Fetching projects for teacher with ID:",o.id);const x=await k6(o.id);console.log("Teacher assigned projects fetched:",x.length);const p=et(De(pe,"projects"),Ue("school_id","==",o.school_id),Ue("status","==","draft")),y=(await Je(p)).docs.map(v=>{const _=v.data();return{id:v.id,..._,due_date:_.due_date?_.due_date.toDate().toISOString():null,created_at:_.created_at?_.created_at.toDate().toISOString():new Date().toISOString(),updated_at:_.updated_at?_.updated_at.toDate().toISOString():new Date().toISOString()}});console.log("School draft projects fetched:",y.length);const w=new Map;x.forEach(v=>{w.set(v.id,v)}),y.forEach(v=>{w.has(v.id)||w.set(v.id,v)}),h=Array.from(w.values()),console.log("Combined unique projects:",h.length)}else o.role==="student"?(console.log("Fetching projects for student with ID:",o.id),h=await A6(o.id),console.log("Student projects fetched:",h.length)):o.role==="school"?(console.log("Fetching projects for school user with Firebase UID:",o.id),h=await E6(o.id),console.log("School projects fetched:",h.length)):o.role==="admin"&&(console.log("Fetching all projects for admin user"),h=await S6(),console.log("All projects fetched:",h.length));console.log("Raw projects data:",h);const m=await Promise.all(h.map(async x=>{try{const p=await lc(x.id),g=await Bh(x.id);let y=0;try{const w=De(pe,"project_evaluations"),v=et(w,Ue("projectId","==",x.id)),_=await Je(v);if(_.empty)console.log(`No evaluation found for project ${x.id}, using default progress:`,y);else{const j=_.docs[0].data();j.criteria&&j.criteria.length>0&&(y=j.criteria[0].score||0,console.log(`Found evaluation for project ${x.id}, completion score:`,y))}}catch(w){console.error(`Error fetching evaluation for project ${x.id}:`,w)}return{...x,progress:y,students:p,tasks:g}}catch(p){return console.error("Error enhancing project:",x.id,p),{...x,progress:0,students:[],tasks:[]}}}));console.log("Enhanced projects:",m),t(m)}catch(h){console.error("Error fetching projects:",h),i(h instanceof Error?h.message:"حدث خطأ في تحميل المشاريع")}finally{a(!1)}},c=async h=>{if(!o)throw new Error("يجب تسجيل الدخول أولاً");try{const m=o.role==="school"?o.id:o.school_id,x=await T6({...h,teacher_id:o.role==="teacher"?o.id:null,school_id:m,progress:0});if(h.selectedStudentIds&&h.selectedStudentIds.length>0)for(let p=0;p<h.selectedStudentIds.length;p++){const g=h.selectedStudentIds[p];await Lh({project_id:x.id,student_id:g,role:p===0?"leader":"member"})}return await l(),x}catch(m){throw m}},d=async(h,m)=>{try{if(await Vg(h,m),m.selectedStudentIds){const x=await lc(h);for(const p of x)m.selectedStudentIds.includes(p.student_id)||await P6(h,p.student_id);for(let p=0;p<m.selectedStudentIds.length;p++){const g=m.selectedStudentIds[p];x.find(w=>w.student_id===g)||await Lh({project_id:h,student_id:g,role:p===0?"leader":"member"})}}await l()}catch(x){throw x}},u=async h=>{try{await Vg(h,{status:"archived"}),await l()}catch(m){throw m}},f=async h=>{try{await O6(h),await l()}catch(m){throw m}};return O.useEffect(()=>{o&&l()},[o]),{projects:e,loading:r,error:s,fetchProjects:l,createProject:c,updateProject:d,archiveProject:u,deleteProject:f}},wE=({onClose:e,onSubmit:t})=>{const{user:r}=vt(),{projects:a}=Ci(),[s,i]=O.useState({topic:"",description:"",type:"technical",method:"video",duration:60,project_id:"",preferredDate:""}),[o,l]=O.useState(!1),[c,d]=O.useState(null),u=[{id:"technical",name:"استشارة تقنية",description:"استشارة في مجال التقنية والبرمجة"},{id:"academic",name:"استشارة أكاديمية",description:"استشارة في المجالات الأكاديمية والتعليمية"},{id:"career",name:"استشارة مهنية",description:"استشارة في التطوير المهني والوظيفي"},{id:"project",name:"استشارة مشروع",description:"استشارة متعلقة بمشروع محدد"}],f=[{id:"video",name:"مكالمة فيديو",icon:jr},{id:"phone",name:"مكالمة صوتية",icon:Pr},{id:"chat",name:"محادثة نصية",icon:Lr}],h=[{value:30,label:"30 دقيقة"},{value:60,label:"ساعة واحدة"},{value:90,label:"ساعة ونصف"},{value:120,label:"ساعتان"}],m=(g,y)=>{i(w=>({...w,[g]:y}))},x=async g=>{if(g.preventDefault(),!s.topic||!s.description){d("يرجى ملء جميع الحقول المطلوبة");return}l(!0),d(null);try{await t(s)}catch(y){console.error("Error submitting consultation request:",y),d(y instanceof Error?y.message:"حدث خطأ في إرسال طلب الاستشارة")}finally{l(!1)}},p=a.filter(g=>g.status==="active");return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(Ht,{className:"w-6 h-6 text-blue-600"}),"طلب استشارة جديدة"]}),n.jsx("button",{onClick:e,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Pt,{className:"w-5 h-5 text-gray-600"})})]}),c&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(pt,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:c})]}),n.jsxs("form",{onSubmit:x,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"عنوان الاستشارة *"}),n.jsx("input",{type:"text",value:s.topic,onChange:g=>m("topic",g.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل عنوان الاستشارة",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"وصف الاستشارة *"}),n.jsx("textarea",{value:s.description,onChange:g=>m("description",g.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"اشرح تفاصيل الاستشارة واحتياجاتك بوضوح",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نوع الاستشارة *"}),n.jsx("div",{className:"grid grid-cols-2 gap-3",children:u.map(g=>n.jsxs("label",{className:`flex items-center gap-3 p-3 border rounded-xl cursor-pointer transition-colors ${s.type===g.id?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"type",value:g.id,checked:s.type===g.id,onChange:()=>m("type",g.id),className:"sr-only"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:g.name}),n.jsx("p",{className:"text-xs text-gray-500",children:g.description})]})]},g.id))})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"طريقة الاستشارة *"}),n.jsx("div",{className:"space-y-2",children:f.map(g=>n.jsxs("label",{className:`flex items-center gap-3 p-3 border rounded-xl cursor-pointer transition-colors ${s.method===g.id?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"method",value:g.id,checked:s.method===g.id,onChange:()=>m("method",g.id),className:"sr-only"}),n.jsx(g.icon,{className:"w-5 h-5"}),n.jsx("span",{children:g.name})]},g.id))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"مدة الاستشارة *"}),n.jsx("div",{className:"space-y-2",children:h.map(g=>n.jsxs("label",{className:`flex items-center gap-3 p-3 border rounded-xl cursor-pointer transition-colors ${s.duration===g.value?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"duration",value:g.value,checked:s.duration===g.value,onChange:()=>m("duration",g.value),className:"sr-only"}),n.jsx(jt,{className:"w-5 h-5"}),n.jsx("span",{children:g.label})]},g.value))})]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المشروع المرتبط (اختياري)"}),n.jsxs("select",{value:s.project_id,onChange:g=>m("project_id",g.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"",children:"بدون مشروع"}),p.map(g=>n.jsx("option",{value:g.id,children:g.title},g.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"التاريخ المفضل (اختياري)"}),n.jsxs("div",{className:"relative",children:[n.jsx(tt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"datetime-local",value:s.preferredDate,onChange:g=>m("preferredDate",g.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]}),n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx("div",{className:"text-blue-500 mt-1",children:n.jsx(En,{className:"w-5 h-5"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-blue-800 mb-1",children:"معلومات مهمة"}),n.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[n.jsx("li",{children:"• سيتم مراجعة طلبك وتعيين معلم مناسب في أقرب وقت"}),n.jsx("li",{children:"• سيتم إرسال رابط الاستشارة قبل الموعد بـ 15 دقيقة"}),n.jsx("li",{children:"• يمكنك إلغاء الاستشارة قبل 24 ساعة من الموعد"})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[n.jsx("button",{type:"button",onClick:e,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{type:"submit",disabled:o,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:o?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الإرسال..."]}):n.jsxs(n.Fragment,{children:[n.jsx(ze,{className:"w-5 h-5"}),"إرسال الطلب"]})})]})]})]})})},jE=({consultation:e,onClose:t,onUpdate:r})=>{const[a,s]=O.useState(e.rating||0),[i,o]=O.useState(e.feedback||""),[l,c]=O.useState(!1),[d,u]=O.useState(null),[f,h]=O.useState(!1),m=v=>{switch(v){case"video":return n.jsx(jr,{className:"w-5 h-5"});case"phone":return n.jsx(Pr,{className:"w-5 h-5"});case"chat":return n.jsx(Lr,{className:"w-5 h-5"});default:return n.jsx(Ht,{className:"w-5 h-5"})}},x=v=>{switch(v){case"video":return"مكالمة فيديو";case"phone":return"مكالمة صوتية";case"chat":return"محادثة نصية";case"screen_share":return"مشاركة الشاشة";default:return v}},p=v=>{switch(v){case"pending":return"bg-yellow-100 text-yellow-800";case"scheduled":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},g=v=>{switch(v){case"pending":return"في الانتظار";case"scheduled":return"مجدولة";case"completed":return"مكتملة";case"cancelled":return"ملغية";default:return v}},y=async()=>{if(a===0){u("يرجى اختيار تقييم");return}c(!0),u(null);try{await r(e.id,{rating:a,feedback:i,status:"completed"})}catch(v){console.error("Error submitting rating:",v),u(v instanceof Error?v.message:"حدث خطأ في إرسال التقييم")}finally{c(!1)}},w=async()=>{if(confirm("هل أنت متأكد من إلغاء هذه الاستشارة؟")){c(!0);try{await r(e.id,{status:"cancelled"})}catch(v){console.error("Error cancelling consultation:",v),u(v instanceof Error?v.message:"حدث خطأ في إلغاء الاستشارة")}finally{c(!1)}}};return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(Ht,{className:"w-6 h-6 text-blue-600"}),"تفاصيل الاستشارة"]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Pt,{className:"w-5 h-5 text-gray-600"})})]}),d&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(AlertTriangle,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:d})]}),n.jsx("div",{className:"flex items-center gap-4 p-4 bg-blue-50 rounded-xl mb-6",children:n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("h4",{className:"font-semibold text-gray-800",children:e.mentor_name||"معلم غير معين"}),n.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${p(e.status)}`,children:g(e.status)})]}),n.jsx("p",{className:"text-gray-600 text-sm",children:"معلم"})]})}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsxs("h4",{className:"font-medium text-gray-800 mb-2 flex items-center gap-2",children:[n.jsx(Ht,{className:"w-5 h-5 text-blue-600"}),"موضوع الاستشارة"]}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsx("h5",{className:"font-semibold text-gray-800 mb-2",children:e.topic}),n.jsx("p",{className:"text-gray-700",children:e.description})]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"تفاصيل الاستشارة"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[m(e.method),n.jsxs("span",{children:["طريقة الاستشارة: ",x(e.method)]})]}),n.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[n.jsx(jt,{className:"w-5 h-5"}),n.jsxs("span",{children:["المدة: ",e.duration," دقيقة"]})]}),n.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[n.jsx(tt,{className:"w-5 h-5"}),n.jsxs("span",{children:["تاريخ الإنشاء: ",Ze(e.createdAt)]})]})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"معلومات الموعد"}),n.jsxs("div",{className:"space-y-3",children:[e.scheduledDate?n.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[n.jsx(tt,{className:"w-5 h-5 text-blue-600"}),n.jsxs("span",{children:["موعد الاستشارة: ",Ze(e.scheduledDate,{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",calendar:"gregory"})]})]}):e.preferredDate?n.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[n.jsx(tt,{className:"w-5 h-5 text-yellow-600"}),n.jsxs("span",{children:["الموعد المفضل: ",Ze(e.preferredDate,{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",calendar:"gregory"})]})]}):n.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[n.jsx(tt,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{children:"لم يتم تحديد موعد بعد"})]}),e.status==="scheduled"&&n.jsx("div",{className:"mt-2",children:n.jsxs("a",{href:"https://meet.google.com/new",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[n.jsx(jr,{className:"w-4 h-4"}),"انضمام للاستشارة"]})})]})]})]}),e.status==="completed"&&e.rating?n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"تقييمك للاستشارة"}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-1 mb-2",children:[[1,2,3,4,5].map(v=>n.jsx(at,{className:`w-6 h-6 ${v<=e.rating?"text-yellow-400 fill-current":"text-gray-300"}`},v)),n.jsxs("span",{className:"text-gray-700 mr-2",children:[e.rating,"/5"]})]}),e.feedback&&n.jsx("p",{className:"text-gray-700",children:e.feedback})]})]}):e.status==="completed"&&!f?n.jsx("div",{className:"text-center py-4",children:n.jsx("button",{onClick:()=>h(!0),className:"px-6 py-3 bg-yellow-500 text-white rounded-xl hover:bg-yellow-600 transition-colors",children:"تقييم الاستشارة"})}):f&&n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"تقييم الاستشارة"}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsx("div",{className:"flex items-center justify-center gap-2 mb-4",children:[1,2,3,4,5].map(v=>n.jsx("button",{type:"button",onClick:()=>s(v),className:"focus:outline-none",children:n.jsx(at,{className:`w-8 h-8 ${v<=a?"text-yellow-400 fill-current":"text-gray-300"}`})},v))}),n.jsx("textarea",{value:i,onChange:v=>o(v.target.value),placeholder:"اكتب تعليقك حول الاستشارة...",rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),n.jsx("div",{className:"flex justify-end mt-3",children:n.jsx("button",{type:"button",onClick:y,disabled:l,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:l?"جاري الإرسال...":"إرسال التقييم"})})]})]}),n.jsxs("div",{className:"flex justify-between pt-4 border-t border-gray-200",children:[n.jsx("div",{children:(e.status==="pending"||e.status==="scheduled")&&n.jsx("button",{type:"button",onClick:w,disabled:l,className:"px-6 py-3 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:l?"جاري الإلغاء...":"إلغاء الاستشارة"})}),n.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 bg-gray-200 text-gray-800 rounded-xl hover:bg-gray-300 transition-colors",children:"إغلاق"})]})]})]})})},Qj=({consultant:e,onClose:t,onSubmit:r})=>{const{t:a}=yt(),[s,i]=O.useState({topic:"",description:"",type:"technical",method:"video",duration:60,scheduledDate:""}),[o,l]=O.useState(!1),[c,d]=O.useState(null),u=[{id:"technical",name:"استشارة تقنية"},{id:"academic",name:"استشارة أكاديمية"},{id:"career",name:"استشارة مهنية"},{id:"project",name:"استشارة مشروع"}],f=[{id:"video",name:"مكالمة فيديو",icon:jr},{id:"phone",name:"مكالمة صوتية",icon:Pr},{id:"chat",name:"محادثة نصية",icon:Lr}],h=[{value:30,label:"30 دقيقة",price:e.hourlyRate/2},{value:60,label:"ساعة واحدة",price:e.hourlyRate},{value:90,label:"ساعة ونصف",price:e.hourlyRate*1.5},{value:120,label:"ساعتان",price:e.hourlyRate*2}],x=(()=>{const v=[],_=new Date;for(let b=1;b<=7;b++){const j=new Date(_);j.setDate(j.getDate()+b);const N=new Date(j);N.setHours(10,0,0,0),v.push(N);const k=new Date(j);k.setHours(14,0,0,0),v.push(k);const S=new Date(j);S.setHours(18,0,0,0),v.push(S)}return v})(),p=(v,_)=>{i(b=>({...b,[v]:_}))},g=async v=>{if(v.preventDefault(),!s.topic||!s.description||!s.scheduledDate){d("يرجى ملء جميع الحقول المطلوبة");return}l(!0),d(null);try{await r({...s,mentor_id:e.id,status:"scheduled"})}catch(_){console.error("Error booking consultation:",_),d(_ instanceof Error?_.message:"حدث خطأ في حجز الاستشارة")}finally{l(!1)}},y=h.find(v=>v.value===s.duration),w=y?y.price:e.hourlyRate;return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(tt,{className:"w-6 h-6 text-indigo-600"}),"حجز استشارة مع ",e.name]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Pt,{className:"w-5 h-5 text-gray-600"})})]}),c&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(pt,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:c})]}),n.jsxs("div",{className:"flex items-center gap-4 p-4 bg-indigo-50 rounded-xl mb-6",children:[n.jsx("img",{src:e.avatar,alt:e.name,className:"w-16 h-16 rounded-full object-cover"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-semibold text-gray-800",children:e.name}),n.jsx("p",{className:"text-gray-600",children:e.title}),n.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsxs("span",{className:"text-sm",children:[e.rating," (",e.reviews," تقييم)"]})]})]})]}),n.jsxs("form",{onSubmit:g,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"عنوان الاستشارة *"}),n.jsx("input",{type:"text",value:s.topic,onChange:v=>p("topic",v.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"أدخل عنوان الاستشارة",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"وصف الاستشارة *"}),n.jsx("textarea",{value:s.description,onChange:v=>p("description",v.target.value),rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"اشرح تفاصيل الاستشارة واحتياجاتك بوضوح",required:!0})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نوع الاستشارة *"}),n.jsx("select",{value:s.type,onChange:v=>p("type",v.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0,children:u.map(v=>n.jsx("option",{value:v.id,children:v.name},v.id))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"طريقة الاستشارة *"}),n.jsx("div",{className:"grid grid-cols-3 gap-2",children:f.map(v=>n.jsxs("label",{className:`flex items-center justify-center gap-2 p-3 border rounded-xl cursor-pointer transition-colors ${s.method===v.id?"bg-indigo-50 border-indigo-500 text-indigo-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"method",value:v.id,checked:s.method===v.id,onChange:()=>p("method",v.id),className:"sr-only"}),n.jsx(v.icon,{className:"w-5 h-5"}),n.jsx("span",{children:v.name})]},v.id))})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"مدة الاستشارة *"}),n.jsx("div",{className:"grid grid-cols-4 gap-2",children:h.map(v=>n.jsxs("label",{className:`flex flex-col items-center p-3 border rounded-xl cursor-pointer transition-colors ${s.duration===v.value?"bg-indigo-50 border-indigo-500 text-indigo-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"duration",value:v.value,checked:s.duration===v.value,onChange:()=>p("duration",v.value),className:"sr-only"}),n.jsx(jt,{className:"w-5 h-5 mb-1"}),n.jsx("span",{children:v.label}),n.jsxs("span",{className:"text-xs mt-1",children:[v.price," ر.س"]})]},v.value))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"اختر موعد الاستشارة *"}),n.jsx("div",{className:"grid grid-cols-3 gap-2 max-h-48 overflow-y-auto p-2",children:x.map((v,_)=>n.jsxs("label",{className:`flex flex-col items-center p-3 border rounded-xl cursor-pointer transition-colors ${s.scheduledDate===v.toISOString()?"bg-indigo-50 border-indigo-500 text-indigo-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"scheduledDate",value:v.toISOString(),checked:s.scheduledDate===v.toISOString(),onChange:()=>p("scheduledDate",v.toISOString()),className:"sr-only"}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"font-medium",children:v.toLocaleDateString("ar-SA",{weekday:"short",day:"numeric",month:"short"})}),n.jsx("div",{className:"text-sm",children:v.toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit"})})]})]},_))})]}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsx("h4",{className:"font-medium text-gray-800 mb-3",children:"ملخص الحجز"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:["سعر الاستشارة (",y==null?void 0:y.label,")"]}),n.jsxs("span",{children:[w," ر.س"]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"ضريبة القيمة المضافة (15%)"}),n.jsxs("span",{children:[(w*.15).toFixed(2)," ر.س"]})]}),n.jsx("div",{className:"border-t border-gray-200 pt-2 mt-2",children:n.jsxs("div",{className:"flex justify-between font-bold",children:[n.jsx("span",{children:"المجموع"}),n.jsxs("span",{children:[(w*1.15).toFixed(2)," ر.س"]})]})})]})]}),n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx("div",{className:"text-blue-500 mt-1",children:n.jsx(En,{className:"w-5 h-5"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-blue-800 mb-1",children:"معلومات مهمة"}),n.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[n.jsx("li",{children:"• سيتم إرسال رابط الاستشارة قبل الموعد بـ 15 دقيقة"}),n.jsx("li",{children:"• يمكنك إلغاء الاستشارة قبل 24 ساعة من الموعد"}),n.jsx("li",{children:"• سيتم خصم المبلغ عند تأكيد الحجز"})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[n.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{type:"submit",disabled:o,className:"px-6 py-3 bg-indigo-500 text-white rounded-xl hover:bg-indigo-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:o?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الحجز..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Ys,{className:"w-5 h-5"}),"تأكيد الحجز"]})})]})]})]})})},NE=()=>{const{t:e,i18n:t}=yt(),[r,a]=O.useState("my-consultations"),[s,i]=O.useState("all"),[o,l]=O.useState("all"),[c,d]=O.useState(""),[u,f]=O.useState(!1),[h,m]=O.useState(null),[x,p]=O.useState(null),[g,y]=O.useState(!1),{consultations:w,consultants:v,loading:_,error:b,fetchConsultations:j,fetchConsultants:N,createConsultation:k,updateConsultation:S}=As();O.useEffect(()=>{console.log("i18n initialization status:",{language:t.language,isInitialized:t.isInitialized,availableLanguages:t.languages})},[t.language,t.isInitialized]),O.useEffect(()=>{N()},[]);const E=[{id:"all",name:e("consultations.types.all")},{id:"technical",name:e("consultations.types.technical")},{id:"academic",name:e("consultations.types.academic")},{id:"career",name:e("consultations.types.career")},{id:"project",name:e("consultations.types.project")}],P=[{id:"all",name:e("consultations.statuses.all"),color:"bg-yellow-100 text-yellow-800",icon:jt},{id:"pending",name:e("consultations.statuses.pending"),color:"bg-yellow-100 text-yellow-800",icon:jt},{id:"scheduled",name:e("consultations.statuses.scheduled"),color:"bg-blue-100 text-blue-800",icon:tt},{id:"completed",name:e("consultations.statuses.completed"),color:"bg-green-100 text-green-800",icon:ze},{id:"cancelled",name:e("consultations.statuses.cancelled"),color:"bg-red-100 text-red-800",icon:Mr}],C=w.filter(V=>{const B=s==="all"||V.type===s,L=o==="all"||V.status===o,ee=V.topic.toLowerCase().includes(c.toLowerCase())||V.description.toLowerCase().includes(c.toLowerCase());return B&&L&&ee}),T=V=>P.find(L=>L.id===V)||{name:V,color:"bg-gray-100 text-gray-800",icon:oa},M=V=>{switch(V){case"video":return n.jsx(jr,{className:"w-4 h-4"});case"phone":return n.jsx(Pr,{className:"w-4 h-4"});case"chat":return n.jsx(Lr,{className:"w-4 h-4"});default:return n.jsx(Ht,{className:"w-4 h-4"})}},A=V=>{switch(V){case"video":return e("consultations.methods.video");case"phone":return e("consultations.methods.phone");case"chat":return e("consultations.methods.chat");case"screen_share":return e("consultations.methods.screenShare");default:return V}},F=async V=>{try{await k(V),f(!1),y(!1),j()}catch(B){console.error("Error creating consultation:",B)}},H=async(V,B)=>{try{await S(V,B),m(null),j()}catch(L){console.error("Error updating consultation:",L)}};return _?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):b?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(oa,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:b})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(Ht,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("consultations.title")}),n.jsx("p",{className:"opacity-90",children:e("consultations.subtitle")})]})]}),n.jsxs("button",{onClick:()=>f(!0),className:"bg-white text-blue-600 px-6 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(gt,{className:"w-5 h-5"}),e("consultations.requestConsultation")]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:w.length}),n.jsx("div",{className:"text-sm opacity-80",children:e("consultations.stats.total")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:w.filter(V=>V.status==="scheduled").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("consultations.stats.scheduled")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:w.filter(V=>V.status==="completed").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("consultations.stats.completed")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:w.filter(V=>V.status==="pending").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("consultations.stats.pending")})]})]})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[n.jsx("div",{className:"border-b border-gray-200",children:n.jsxs("nav",{className:"flex",children:[n.jsx("button",{onClick:()=>a("my-consultations"),className:`px-4 py-4 font-medium text-sm border-b-2 ${r==="my-consultations"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e("consultations.tabs.myConsultations")}),n.jsx("button",{onClick:()=>a("search-consultants"),className:`px-4 py-4 font-medium text-sm border-b-2 ${r==="search-consultants"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e("consultations.tabs.searchConsultants")})]})}),r==="my-consultations"&&n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 mb-6",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ut,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("consultations.searchPlaceholder"),value:c,onChange:V=>d(V.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsx("select",{value:s,onChange:V=>i(V.target.value),className:"px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:E.map(V=>n.jsx("option",{value:V.id,children:V.name},V.id))}),n.jsx("select",{value:o,onChange:V=>l(V.target.value),className:"px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:P.map(V=>n.jsx("option",{value:V.id,children:V.name},V.id))})]}),n.jsx("div",{className:"space-y-4",children:C.map((V,B)=>{const L=T(V.status);return n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:B*.1},className:"border border-gray-200 rounded-xl p-6 hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:V.topic}),n.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${L.color}`,children:L.name})]}),n.jsx("p",{className:"text-gray-600 mb-2",children:V.description}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[n.jsxs("span",{children:[e("consultations.consultant"),": ",V.mentor_name||e("consultations.unassigned")]}),n.jsx("span",{children:"•"}),n.jsxs("span",{className:"flex items-center gap-1",children:[M(V.method),A(V.method)]}),n.jsx("span",{children:"•"}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(jt,{className:"w-4 h-4"}),V.duration," ",e("consultations.minutes")]})]})]}),n.jsxs("div",{className:"text-right",children:[V.status==="scheduled"&&V.scheduledDate&&n.jsxs("div",{className:"text-sm",children:[n.jsx("div",{className:"font-medium text-gray-800",children:e("consultations.appointmentTime")}),n.jsx("div",{className:"text-gray-600",children:Ze(V.scheduledDate,{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",calendar:"gregory"})})]}),V.status==="completed"&&V.rating&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"text-sm font-medium",children:V.rating})]})]})]}),V.status==="completed"&&V.feedback&&n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mt-4",children:[n.jsxs("h4",{className:"font-medium text-gray-800 mb-2",children:[e("consultations.yourFeedback"),":"]}),n.jsx("p",{className:"text-gray-700 text-sm",children:V.feedback})]}),n.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-gray-200",children:[n.jsxs("div",{className:"text-sm text-gray-500",children:[e("consultations.created"),": ",Ze(V.createdAt)]}),n.jsxs("div",{className:"flex gap-2",children:[V.status==="scheduled"&&n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:()=>window.open("https://meet.google.com/new","_blank"),className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-sm flex items-center gap-2",children:[n.jsx(jr,{className:"w-4 h-4"}),e("consultations.joinConsultation")]}),n.jsx("button",{onClick:()=>m(V.id),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm",children:e("consultations.reschedule")})]}),V.status==="pending"&&n.jsx("button",{onClick:()=>m(V.id),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm",children:e("consultations.editRequest")}),V.status==="completed"&&!V.rating&&n.jsx("button",{onClick:()=>m(V.id),className:"px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 transition-colors text-sm",children:e("consultations.rateConsultation")}),n.jsx("button",{onClick:()=>m(V.id),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm",children:e("consultations.viewDetails")})]})]})]},V.id)})}),C.length===0&&n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(Ht,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("consultations.noConsultations")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("consultations.startByRequesting")}),n.jsx("button",{onClick:()=>f(!0),className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:e("consultations.requestNewConsultation")})]})]}),r==="search-consultants"&&n.jsxs("div",{className:"p-6",children:[n.jsx("div",{className:"mb-6",children:n.jsxs("div",{className:"relative",children:[n.jsx(ut,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("consultations.searchConsultantPlaceholder"),value:c,onChange:V=>d(V.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),!1,t.isInitialized?n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:v.map((V,B)=>n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:B*.1},className:"bg-white border border-gray-200 rounded-2xl p-6 hover:shadow-lg transition-all duration-300",children:[n.jsxs("div",{className:"text-center mb-4",children:[n.jsx("img",{src:V.avatar,alt:V.name,className:"w-20 h-20 rounded-full object-cover mx-auto mb-3"}),n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-1",children:V.name}),n.jsx("p",{className:"text-gray-600 text-sm mb-2",children:V.title}),n.jsxs("div",{className:"flex items-center justify-center gap-1 mb-2",children:[n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"font-medium",children:V.rating}),n.jsxs("span",{className:"text-gray-500 text-sm",children:["(",V.reviews," ",e("search.reviews"),")"]})]})]}),n.jsxs("div",{className:"space-y-3 mb-4",children:[n.jsxs("div",{children:[n.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-1",children:[e("search.specialties"),":"]}),n.jsxs("div",{className:"flex flex-wrap gap-1",children:[(V.specialties||[]).slice(0,3).map((L,ee)=>n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-lg",children:L},ee)),(V.specialties||[]).length>3&&n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["+",(V.specialties||[]).length-3]})]})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsxs("span",{className:"text-gray-600",children:[e("search.price"),":"]}),n.jsxs("span",{className:"font-medium text-blue-600",children:[V.hourlyRate," ",e("search.pricePerHour")]})]})]}),n.jsx("button",{onClick:()=>{p(V.id),y(!0)},className:"w-full bg-blue-500 text-white py-2 rounded-xl hover:bg-blue-600 transition-colors font-medium",children:e("search.bookConsultation")})]},V.id))}):n.jsx("div",{className:"flex justify-center py-8",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}),v.length===0&&n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(xr,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("consultations.noConsultants")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("consultations.noConsultantsAvailable")}),n.jsx(Ee,{to:"/search",className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:e("consultations.advancedSearch")})]})]})]}),u&&n.jsx(wE,{onClose:()=>f(!1),onSubmit:F}),h&&n.jsx(jE,{consultation:w.find(V=>V.id===h),onClose:()=>m(null),onUpdate:H}),g&&x&&n.jsx(Qj,{consultant:v.find(V=>V.id===x),onClose:()=>{p(null),y(!1)},onSubmit:F}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-6",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center",children:n.jsx(En,{className:"w-5 h-5 text-indigo-600"})}),n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:e("consultations.howToUse.title")})]}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm",children:[n.jsxs("h4",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[n.jsx("span",{className:"w-6 h-6 bg-indigo-100 rounded-full flex items-center justify-center text-sm text-indigo-600",children:"1"}),e("consultations.howToUse.step1.title")]}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("consultations.howToUse.step1.description")})]}),n.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm",children:[n.jsxs("h4",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[n.jsx("span",{className:"w-6 h-6 bg-indigo-100 rounded-full flex items-center justify-center text-sm text-indigo-600",children:"2"}),e("consultations.howToUse.step2.title")]}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("consultations.howToUse.step2.description")})]}),n.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm",children:[n.jsxs("h4",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[n.jsx("span",{className:"w-6 h-6 bg-indigo-100 rounded-full flex items-center justify-center text-sm text-indigo-600",children:"3"}),e("consultations.howToUse.step3.title")]}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("consultations.howToUse.step3.description")})]})]})]})]})},_E=()=>{const{t:e}=yt(),{consultations:t,loading:r,error:a}=As(),[s,i]=O.useState("all"),[o,l]=O.useState(""),c=t.filter(m=>{const x=s==="all"||m.status===s,p=m.topic.toLowerCase().includes(o.toLowerCase())||m.description.toLowerCase().includes(o.toLowerCase());return x&&p}),d=m=>{switch(m){case"pending":return"bg-yellow-100 text-yellow-800";case"scheduled":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},u=m=>{switch(m){case"pending":return e("consultations.statuses.pending");case"scheduled":return e("consultations.statuses.scheduled");case"completed":return e("consultations.statuses.completed");case"cancelled":return e("consultations.statuses.cancelled");default:return m}},f=m=>{switch(m){case"video":return n.jsx(jr,{className:"w-4 h-4"});case"phone":return n.jsx(Pr,{className:"w-4 h-4"});case"chat":return n.jsx(Lr,{className:"w-4 h-4"});default:return n.jsx(Ht,{className:"w-4 h-4"})}},h=m=>{switch(m){case"video":return e("consultations.methods.video");case"phone":return e("consultations.methods.phone");case"chat":return e("consultations.methods.chat");default:return m}};return r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(pt,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:a})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(br,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("myConsultations.title")}),n.jsx("p",{className:"opacity-90",children:e("myConsultations.subtitle")})]})]}),n.jsxs(Ee,{to:"/consultations",className:"bg-white text-blue-600 px-6 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(gt,{className:"w-5 h-5"}),e("myConsultations.newRequest")]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.length}),n.jsx("div",{className:"text-sm opacity-80",children:e("myConsultations.stats.total")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.filter(m=>m.status==="pending").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("myConsultations.stats.pending")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.filter(m=>m.status==="scheduled").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("myConsultations.stats.scheduled")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.filter(m=>m.status==="completed").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("myConsultations.stats.completed")})]})]})]}),n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ut,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("myConsultations.searchPlaceholder"),value:o,onChange:m=>l(m.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("select",{value:s,onChange:m=>i(m.target.value),className:"px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:e("myConsultations.filters.allStatuses")}),n.jsx("option",{value:"pending",children:e("consultations.statuses.pending")}),n.jsx("option",{value:"scheduled",children:e("consultations.statuses.scheduled")}),n.jsx("option",{value:"completed",children:e("consultations.statuses.completed")}),n.jsx("option",{value:"cancelled",children:e("consultations.statuses.cancelled")})]})]})}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:[e("myConsultations.showing")," ",c.length," ",e("myConsultations.of")," ",t.length," ",e("myConsultations.request")]})}),n.jsx("div",{className:"space-y-4",children:c.map((m,x)=>n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:x*.1},className:"bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition-all",children:[n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:m.topic}),n.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${d(m.status)}`,children:u(m.status)})]}),n.jsx("p",{className:"text-gray-600 mb-2",children:m.description}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[n.jsxs("span",{children:[e("consultations.consultant"),": ",m.mentor_name||e("consultations.unassigned")]}),n.jsx("span",{children:"•"}),n.jsxs("span",{className:"flex items-center gap-1",children:[f(m.method),h(m.method)]}),n.jsx("span",{children:"•"}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(jt,{className:"w-4 h-4"}),m.duration," ",e("consultations.minutes")]})]})]}),n.jsxs("div",{className:"relative group/menu",children:[n.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Pf,{className:"w-5 h-5 text-gray-400"})}),n.jsx("div",{className:"absolute left-0 top-10 w-48 bg-white rounded-lg shadow-lg border border-gray-200 opacity-0 invisible group-hover/menu:opacity-100 group-hover/menu:visible transition-all duration-200 z-10",children:n.jsxs("div",{className:"p-2",children:[n.jsxs("button",{className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:[n.jsx(sr,{className:"w-4 h-4"}),e("myConsultations.actions.viewDetails")]}),m.status==="pending"&&n.jsxs("button",{className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:[n.jsx(Oa,{className:"w-4 h-4"}),e("myConsultations.actions.editRequest")]}),m.status!=="completed"&&m.status!=="cancelled"&&n.jsxs("button",{className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-red-600 hover:bg-red-50 rounded-md",children:[n.jsx(Mr,{className:"w-4 h-4"}),e("myConsultations.actions.cancelRequest")]})]})})]})]}),n.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[n.jsxs("div",{className:"text-sm text-gray-500",children:[e("myConsultations.createdAt"),": ",Ze(m.createdAt)]}),n.jsxs("div",{className:"flex gap-2",children:[m.status==="scheduled"&&m.scheduledDate&&n.jsxs("div",{className:"text-sm",children:[n.jsxs("span",{className:"font-medium text-gray-800",children:[e("consultations.appointmentTime"),":"]})," ",n.jsx("span",{className:"text-blue-600",children:Ze(m.scheduledDate,{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",calendar:"gregory"})})]}),m.status==="scheduled"&&n.jsxs("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm flex items-center gap-2",children:[n.jsx(jr,{className:"w-4 h-4"}),e("consultations.joinConsultation")]}),m.status==="completed"&&!m.rating&&n.jsx("button",{className:"px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 transition-colors text-sm",children:e("consultations.rateConsultation")})]})]})]},m.id))}),c.length===0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(br,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("myConsultations.noRequests")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("myConsultations.noRequestsMatch")}),n.jsxs("div",{className:"flex justify-center gap-4",children:[n.jsxs(Ee,{to:"/create-request",className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2",children:[n.jsx(gt,{className:"w-4 h-4"}),e("myConsultations.newRequest")]}),n.jsx("button",{onClick:()=>{i("all"),l("")},className:"px-6 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("common.resetFilters")})]})]})]})},SE=()=>{const{t:e}=yt(),t=Go(),{createConsultation:r}=As(),{projects:a}=Ci(),[s,i]=O.useState({topic:"",description:"",type:"technical",method:"video",duration:60,project_id:"",preferredDate:""}),[o,l]=O.useState(!1),[c,d]=O.useState(null),u=[{id:"technical",name:e("consultations.types.technical"),description:e("consultations.typeDescriptions.technical")},{id:"academic",name:e("consultations.types.academic"),description:e("consultations.typeDescriptions.academic")},{id:"career",name:e("consultations.types.career"),description:e("consultations.typeDescriptions.career")},{id:"project",name:e("consultations.types.project"),description:e("consultations.typeDescriptions.project")}],f=[{id:"video",name:e("consultations.methods.video"),icon:jr},{id:"phone",name:e("consultations.methods.phone"),icon:Pr},{id:"chat",name:e("consultations.methods.chat"),icon:Lr}],h=[{value:30,label:e("consultations.durations.30min")},{value:60,label:e("consultations.durations.60min")},{value:90,label:e("consultations.durations.90min")},{value:120,label:e("consultations.durations.120min")}],m=(g,y)=>{i(w=>({...w,[g]:y}))},x=async g=>{if(g.preventDefault(),!s.topic||!s.description){d(e("consultations.errors.requiredFields"));return}l(!0),d(null);try{await r({...s,status:"pending"}),t("/my-consultations")}catch(y){console.error("Error submitting consultation request:",y),d(y instanceof Error?y.message:e("consultations.errors.submissionFailed"))}finally{l(!1)}},p=a.filter(g=>g.status==="active");return n.jsxs("div",{className:"space-y-6",children:[n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-lg p-6",children:n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx(Ee,{to:"/my-consultations",className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Jn,{className:"w-6 h-6 text-gray-600"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:e("consultations.createRequest.title")}),n.jsx("p",{className:"text-gray-600",children:e("consultations.createRequest.subtitle")})]})]})}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl shadow-lg p-6",children:[c&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(pt,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:c})]}),n.jsxs("form",{onSubmit:x,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("consultations.form.topic")," *"]}),n.jsx("input",{type:"text",value:s.topic,onChange:g=>m("topic",g.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("consultations.form.topicPlaceholder"),required:!0})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("consultations.form.description")," *"]}),n.jsx("textarea",{value:s.description,onChange:g=>m("description",g.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("consultations.form.descriptionPlaceholder"),required:!0})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("consultations.form.type")," *"]}),n.jsx("div",{className:"grid grid-cols-2 gap-3",children:u.map(g=>n.jsxs("label",{className:`flex items-center gap-3 p-3 border rounded-xl cursor-pointer transition-colors ${s.type===g.id?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"type",value:g.id,checked:s.type===g.id,onChange:()=>m("type",g.id),className:"sr-only"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:g.name}),n.jsx("p",{className:"text-xs text-gray-500",children:g.description})]})]},g.id))})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("consultations.form.method")," *"]}),n.jsx("div",{className:"space-y-2",children:f.map(g=>n.jsxs("label",{className:`flex items-center gap-3 p-3 border rounded-xl cursor-pointer transition-colors ${s.method===g.id?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"method",value:g.id,checked:s.method===g.id,onChange:()=>m("method",g.id),className:"sr-only"}),n.jsx(g.icon,{className:"w-5 h-5"}),n.jsx("span",{children:g.name})]},g.id))})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("consultations.form.duration")," *"]}),n.jsx("div",{className:"space-y-2",children:h.map(g=>n.jsxs("label",{className:`flex items-center gap-3 p-3 border rounded-xl cursor-pointer transition-colors ${s.duration===g.value?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"duration",value:g.value,checked:s.duration===g.value,onChange:()=>m("duration",g.value),className:"sr-only"}),n.jsx(jt,{className:"w-5 h-5"}),n.jsx("span",{children:g.label})]},g.value))})]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("consultations.form.relatedProject")}),n.jsxs("div",{className:"relative",children:[n.jsx(Ll,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsxs("select",{value:s.project_id,onChange:g=>m("project_id",g.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"",children:e("consultations.form.noProject")}),p.map(g=>n.jsx("option",{value:g.id,children:g.title},g.id))]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("consultations.form.preferredDate")}),n.jsxs("div",{className:"relative",children:[n.jsx(tt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"datetime-local",value:s.preferredDate,onChange:g=>m("preferredDate",g.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]}),n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx("div",{className:"text-blue-500 mt-1",children:n.jsx(En,{className:"w-5 h-5"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-blue-800 mb-1",children:e("consultations.importantInfo.title")}),n.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[n.jsxs("li",{children:["• ",e("consultations.importantInfo.review")]}),n.jsxs("li",{children:["• ",e("consultations.importantInfo.link")]}),n.jsxs("li",{children:["• ",e("consultations.importantInfo.cancel")]})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[n.jsx(Ee,{to:"/my-consultations",className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("common.cancel")}),n.jsx("button",{type:"submit",disabled:o,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:o?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e("consultations.submitting")]}):n.jsxs(n.Fragment,{children:[n.jsx(ze,{className:"w-5 h-5"}),e("consultations.submitRequest")]})})]})]})]})]})},kE=()=>{const{t:e}=yt(),{user:t}=vt(),r=(t==null?void 0:t.role)==="student",a=(t==null?void 0:t.role)==="admin",[s,i]=O.useState("profile"),[o,l]=O.useState(!1),[c,d]=O.useState({name:(t==null?void 0:t.name)||"",email:(t==null?void 0:t.email)||"",phone:(t==null?void 0:t.phone)||"",bio:(t==null?void 0:t.bio)||"",currentPassword:"",newPassword:"",confirmPassword:""}),[u,f]=O.useState({emailNotifications:!0,pushNotifications:!0,projectUpdates:!0,weeklyReports:!1,marketingEmails:!1}),[h,m]=O.useState({theme:"light",language:"ar",fontSize:"medium",animations:!0}),[x,p]=O.useState(!1),[g,y]=O.useState(null),[w,v]=O.useState(!1),_=[{id:"profile",name:e("settings.sections.profile"),icon:xr},{id:"notifications",name:e("settings.sections.notifications"),icon:qs},{id:"security",name:e("settings.sections.security"),icon:Ga},{id:"appearance",name:e("settings.sections.appearance"),icon:sc},{id:"language",name:e("settings.sections.language"),icon:rc},{id:"data",name:e("settings.sections.data"),icon:au}],b=(N,k)=>{if(N.startsWith("notifications.")){const S=N.split(".")[1];f(E=>({...E,[S]:k}))}else if(N.startsWith("appearance.")){const S=N.split(".")[1];m(E=>({...E,[S]:k}))}else d(S=>({...S,[N]:k}))},j=async()=>{if(!t){y(e("settings.errors.loginRequired"));return}p(!0),y(null),v(!1);try{const N={name:c.name,phone:c.phone,bio:c.bio,notifications_settings:u,appearance_settings:h};await W6(t.id,N),v(!0),setTimeout(()=>{v(!1)},3e3)}catch(N){console.error("Error saving settings:",N),y(N instanceof Error?N.message:e("settings.errors.saveFailed"))}finally{p(!1)}};return n.jsxs("div",{className:"space-y-6",children:[n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-gray-600 to-gray-800 rounded-2xl p-6 text-white",children:n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(xo,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("settings.title")}),n.jsx("p",{className:"opacity-90",children:e("settings.subtitle")})]})]})}),n.jsxs("div",{className:"grid lg:grid-cols-4 gap-6",children:[n.jsx(te.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.1},className:"lg:col-span-1",children:n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:e("settings.settingsSections")}),n.jsx("nav",{className:"space-y-2",children:_.map(N=>n.jsxs("button",{onClick:()=>i(N.id),className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${s===N.id?"bg-blue-500 text-white shadow-lg":"text-gray-700 hover:bg-gray-50"}`,children:[n.jsx(N.icon,{className:"w-5 h-5"}),n.jsx("span",{className:"font-medium",children:N.name})]},N.id))})]})}),n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"lg:col-span-3",children:n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[w&&n.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg mb-6 flex items-center gap-2",children:[n.jsx(ze,{className:"w-5 h-5"}),n.jsx("span",{children:e("settings.saveSuccess")})]}),g&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-center gap-2",children:[n.jsx(pt,{className:"w-5 h-5"}),n.jsx("span",{children:g})]}),s==="profile"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx(xr,{className:"w-6 h-6 text-blue-600"}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:e("settings.profile.title")})]}),n.jsxs("div",{className:"flex items-center gap-6",children:[n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:(t==null?void 0:t.avatar)||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",alt:"Profile",className:"w-24 h-24 rounded-full object-cover"}),n.jsx("button",{className:"absolute bottom-0 right-0 w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center hover:bg-blue-600 transition-colors",children:n.jsx(xi,{className:"w-4 h-4"})})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold text-gray-800",children:e("settings.profile.profilePicture")}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("settings.profile.pictureRequirements")}),n.jsxs("div",{className:"flex gap-2 mt-2",children:[n.jsx("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm",children:e("settings.profile.changePicture")}),n.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm",children:e("settings.profile.remove")})]})]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("settings.profile.fullName")}),n.jsx("input",{type:"text",value:c.name,onChange:N=>b("name",N.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("common.email")}),n.jsx("input",{type:"email",value:c.email,onChange:N=>b("email",N.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("common.phone")}),n.jsx("input",{type:"tel",value:c.phone,onChange:N=>b("phone",N.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("settings.profile.timezone")}),n.jsxs("select",{className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{children:e("settings.profile.timezones.riyadh")}),n.jsx("option",{children:e("settings.profile.timezones.cairo")}),n.jsx("option",{children:e("settings.profile.timezones.dubai")})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("settings.profile.bio")}),n.jsx("textarea",{value:c.bio,onChange:N=>b("bio",N.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("settings.profile.bioPlaceholder")})]})]}),s==="notifications"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx(qs,{className:"w-6 h-6 text-blue-600"}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:e("settings.notifications.title")})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-xl",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Ta,{className:"w-5 h-5 text-gray-600"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-800",children:e("settings.notifications.emailNotifications")}),n.jsx("p",{className:"text-sm text-gray-600",children:e("settings.notifications.emailNotificationsDesc")})]})]}),n.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:u.emailNotifications,onChange:N=>b("notifications.emailNotifications",N.target.checked),className:"sr-only peer"}),n.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),n.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-xl",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(e6,{className:"w-5 h-5 text-gray-600"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-800",children:e("settings.notifications.pushNotifications")}),n.jsx("p",{className:"text-sm text-gray-600",children:e("settings.notifications.pushNotificationsDesc")})]})]}),n.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:u.pushNotifications,onChange:N=>b("notifications.pushNotifications",N.target.checked),className:"sr-only peer"}),n.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),n.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-xl",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Lj,{className:"w-5 h-5 text-gray-600"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-800",children:e("settings.notifications.projectUpdates")}),n.jsx("p",{className:"text-sm text-gray-600",children:e("settings.notifications.projectUpdatesDesc")})]})]}),n.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:u.projectUpdates,onChange:N=>b("notifications.projectUpdates",N.target.checked),className:"sr-only peer"}),n.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),n.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-xl",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Tr,{className:"w-5 h-5 text-gray-600"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-800",children:e("settings.notifications.weeklyReports")}),n.jsx("p",{className:"text-sm text-gray-600",children:e("settings.notifications.weeklyReportsDesc")})]})]}),n.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:u.weeklyReports,onChange:N=>b("notifications.weeklyReports",N.target.checked),className:"sr-only peer"}),n.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]})]}),s==="security"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx(Ga,{className:"w-6 h-6 text-blue-600"}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:e("settings.security.title")})]}),n.jsxs("div",{className:"border border-gray-200 rounded-xl p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:e("settings.security.changePassword")}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("settings.security.currentPassword")}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:o?"text":"password",value:c.currentPassword,onChange:N=>b("currentPassword",N.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),n.jsx("button",{type:"button",onClick:()=>l(!o),className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:o?n.jsx(Rx,{className:"w-5 h-5"}):n.jsx(sr,{className:"w-5 h-5"})})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("settings.security.newPassword")}),n.jsx("input",{type:"password",value:c.newPassword,onChange:N=>b("newPassword",N.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("settings.security.confirmNewPassword")}),n.jsx("input",{type:"password",value:c.confirmPassword,onChange:N=>b("confirmPassword",N.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsx("button",{className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:e("settings.security.updatePassword")})]})]}),n.jsx("div",{className:"border border-gray-200 rounded-xl p-6",children:n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:e("settings.security.twoFactorAuth")}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("settings.security.twoFactorAuthDesc")})]}),n.jsx("button",{className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:e("settings.security.enable")})]})}),n.jsxs("div",{className:"border border-gray-200 rounded-xl p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:e("settings.security.loginSessions")}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:e("settings.security.chromeWindows")}),n.jsxs("p",{className:"text-sm text-gray-600",children:[e("settings.security.riyadhSaudiArabia")," - ",e("settings.security.activeNow")]})]}),n.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full",children:e("settings.security.currentSession")})]}),n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:e("settings.security.safariIphone")}),n.jsxs("p",{className:"text-sm text-gray-600",children:[e("settings.security.jeddahSaudiArabia")," - ",e("settings.security.twoDaysAgo")]})]}),n.jsx("button",{className:"text-red-600 hover:text-red-800 text-sm",children:e("settings.security.endSession")})]})]})]})]}),s==="appearance"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx(sc,{className:"w-6 h-6 text-blue-600"}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:e("settings.appearance.title")})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:e("settings.appearance.theme")}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[n.jsx("input",{type:"radio",name:"theme",value:"light",checked:h.theme==="light",onChange:N=>b("appearance.theme",N.target.value),className:"text-blue-600"}),n.jsx("span",{children:e("settings.appearance.lightTheme")})]}),n.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[n.jsx("input",{type:"radio",name:"theme",value:"dark",checked:h.theme==="dark",onChange:N=>b("appearance.theme",N.target.value),className:"text-blue-600"}),n.jsx("span",{children:e("settings.appearance.darkTheme")})]}),n.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[n.jsx("input",{type:"radio",name:"theme",value:"auto",checked:h.theme==="auto",onChange:N=>b("appearance.theme",N.target.value),className:"text-blue-600"}),n.jsx("span",{children:e("settings.appearance.autoTheme")})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:e("settings.appearance.fontSize")}),n.jsxs("select",{value:h.fontSize,onChange:N=>b("appearance.fontSize",N.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"small",children:e("settings.appearance.small")}),n.jsx("option",{value:"medium",children:e("settings.appearance.medium")}),n.jsx("option",{value:"large",children:e("settings.appearance.large")})]})]})]}),n.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-xl",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-800",children:e("settings.appearance.animations")}),n.jsx("p",{className:"text-sm text-gray-600",children:e("settings.appearance.animationsDesc")})]}),n.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:h.animations,onChange:N=>b("appearance.animations",N.target.checked),className:"sr-only peer"}),n.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]}),s==="language"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx(rc,{className:"w-6 h-6 text-blue-600"}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:e("settings.language.title")})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:e("settings.language.interfaceLanguage")}),n.jsxs("select",{value:h.language,onChange:N=>b("appearance.language",N.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"ar",children:e("settings.language.arabic")}),n.jsx("option",{value:"en",children:e("settings.language.english")}),n.jsx("option",{value:"fr",children:e("settings.language.french")})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:e("settings.language.timezone")}),n.jsxs("select",{className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{children:e("settings.language.timezones.riyadh")}),n.jsx("option",{children:e("settings.language.timezones.cairo")}),n.jsx("option",{children:e("settings.language.timezones.dubai")})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:e("settings.language.dateFormat")}),n.jsxs("select",{className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{children:"DD/MM/YYYY"}),n.jsx("option",{children:"MM/DD/YYYY"}),n.jsx("option",{children:"YYYY-MM-DD"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:e("settings.language.timeFormat")}),n.jsxs("select",{className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{children:e("settings.language.timeFormats.24hour")}),n.jsx("option",{children:e("settings.language.timeFormats.12hour")})]})]})]})]}),s==="data"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx(au,{className:"w-6 h-6 text-blue-600"}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:e("settings.data.title")})]}),!r&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"border border-gray-200 rounded-xl p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:e("settings.data.exportData")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("settings.data.exportDataDesc")}),n.jsxs("button",{className:"flex items-center gap-2 px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:[n.jsx(Tr,{className:"w-5 h-5"}),e("settings.data.exportData")]})]}),n.jsxs("div",{className:"border border-gray-200 rounded-xl p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:e("settings.data.importData")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("settings.data.importDataDesc")}),n.jsxs("button",{className:"flex items-center gap-2 px-6 py-3 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors",children:[n.jsx(xi,{className:"w-5 h-5"}),e("settings.data.importData")]})]}),a&&n.jsx("div",{className:"border border-red-200 rounded-xl p-6 bg-red-50",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(pt,{className:"w-6 h-6 text-red-600 mt-1"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:e("settings.data.deleteAccount")}),n.jsx("p",{className:"text-red-700 mb-4",children:e("settings.data.deleteAccountWarning")}),n.jsxs("button",{className:"flex items-center gap-2 px-6 py-3 bg-red-600 text-white rounded-xl hover:bg-red-700 transition-colors",children:[n.jsx(ir,{className:"w-5 h-5"}),e("settings.data.permanentlyDeleteAccount")]})]})]})})]}),r&&n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(au,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"إدارة البيانات"}),n.jsx("p",{className:"text-gray-600",children:"لا تتوفر خيارات إدارة البيانات للطلاب. يرجى التواصل مع المعلم أو مدير المدرسة للمساعدة."})]})]}),n.jsx("div",{className:"flex justify-end pt-6 border-t border-gray-200",children:n.jsx("button",{onClick:j,disabled:x,className:"flex items-center gap-2 px-8 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:x?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e("settings.saving")]}):n.jsxs(n.Fragment,{children:[n.jsx(Zn,{className:"w-5 h-5"}),e("settings.saveChanges")]})})})]})})]})]})},EE=()=>{const{t:e}=yt(),{user:t}=vt(),r=(t==null?void 0:t.role)==="student",a=(t==null?void 0:t.role)==="teacher",s=(t==null?void 0:t.role)==="school",i=(t==null?void 0:t.role)==="admin",o=Dx(),c=new URLSearchParams(o.search).get("search")||"",[d,u]=O.useState("all"),[f,h]=O.useState(c),[m,x]=O.useState(!1),{projects:p,loading:g,error:y,archiveProject:w,deleteProject:v}=Ci();O.useEffect(()=>{const M=new URLSearchParams(o.search).get("search")||"";h(M)},[o.search]);const _=[{id:"all",name:e("projects.statuses.all"),color:"bg-gray-500"},{id:"draft",name:e("projects.statuses.draft"),color:"bg-gray-500"},{id:"active",name:e("projects.statuses.active"),color:"bg-blue-500"},{id:"completed",name:e("projects.statuses.completed"),color:"bg-green-500"},{id:"archived",name:e("projects.statuses.archived"),color:"bg-purple-500"}],b=p.filter(T=>{const M=d==="all"||T.status===d,A=T.title.toLowerCase().includes(f.toLowerCase())||T.description.toLowerCase().includes(f.toLowerCase());return M&&A}),j=T=>{switch(T){case"draft":return n.jsx(Oa,{className:"w-4 h-4"});case"active":return n.jsx(pi,{className:"w-4 h-4"});case"completed":return n.jsx(ze,{className:"w-4 h-4"});case"archived":return n.jsx(Lg,{className:"w-4 h-4"});default:return n.jsx(Ll,{className:"w-4 h-4"})}},N=T=>{switch(T){case"draft":return e("projects.statuses.draft");case"active":return e("projects.statuses.active");case"completed":return e("projects.statuses.completed");case"archived":return e("projects.statuses.archived");default:return T}},k=T=>{switch(T){case"draft":return"bg-gray-100 text-gray-800";case"active":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"archived":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},S=T=>{switch(T){case"stem":return e("projects.categories.stem");case"entrepreneurship":return e("projects.categories.entrepreneurship");case"volunteer":return e("projects.categories.volunteer");case"ethics":return e("projects.categories.ethics");default:return T}},E=async T=>{if(window.confirm("هل أنت متأكد من أرشفة هذا المشروع؟"))try{await w(T)}catch(M){console.error("Error archiving project:",M),alert("حدث خطأ أثناء أرشفة المشروع")}},P=async T=>{if(window.confirm("هل أنت متأكد من حذف هذا المشروع؟ هذا الإجراء لا يمكن التراجع عنه."))try{await v(T)}catch(M){console.error("Error deleting project:",M),alert("حدث خطأ أثناء حذف المشروع")}},C=T=>{var M;return!!(i||s||a&&T.teacher_id===(t==null?void 0:t.id)||a&&T.status==="draft"&&T.school_id===(t==null?void 0:t.school_id)||r&&T.status==="draft"&&((M=T.students)!=null&&M.some(A=>A.student_id===(t==null?void 0:t.id))))};return g?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):y?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(oa,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:y})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-green-600 to-teal-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(Ll,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("projects.title")}),n.jsx("p",{className:"opacity-90",children:e("projects.subtitle")})]})]}),n.jsxs(Ee,{to:"/projects/new",className:"bg-white text-green-600 px-6 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(gt,{className:"w-5 h-5"}),e("projects.newProject")]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:p.length}),n.jsx("div",{className:"text-sm opacity-80",children:e("projects.stats.total")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:p.filter(T=>T.status==="active").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("projects.stats.active")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:p.filter(T=>T.status==="completed").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("projects.stats.completed")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:p.length>0?(Math.round(p.reduce((T,M)=>T+(M.progress||0),0)/p.length*10)/10).toFixed(1):0}),n.jsx("div",{className:"text-sm opacity-80",children:e("projects.stats.averageProgress")})]})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ut,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("projects.searchPlaceholder"),value:f,onChange:T=>h(T.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),n.jsxs("button",{onClick:()=>x(!m),className:"lg:hidden flex items-center gap-2 px-4 py-3 bg-gray-100 rounded-xl hover:bg-gray-200 transition-colors",children:[n.jsx(Ko,{className:"w-5 h-5"}),e("common.filter")]})]}),n.jsxs("div",{className:`mt-4 ${m?"block":"hidden lg:block"}`,children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("projects.projectStatus")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:_.map(T=>n.jsxs("button",{onClick:()=>u(T.id),className:`flex items-center gap-2 px-4 py-2 rounded-xl transition-all ${d===T.id?`${T.color} text-white shadow-lg`:"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[j(T.id),T.name]},T.id))})]})]}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:[e("projects.showing")," ",b.length," ",e("projects.of")," ",p.length," ",e("projects.project")]})}),n.jsx("div",{className:"grid lg:grid-cols-2 gap-6",children:b.map((T,M)=>{var A,F,H,V;return n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:M*.1},className:"bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition-all duration-300 group",children:[n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-medium flex items-center gap-1 ${k(T.status)}`,children:[j(T.status),N(T.status)]}),n.jsx("span",{className:"text-xs text-gray-500",children:S(T.category)})]}),n.jsx(Ee,{to:`/projects/${T.id}`,className:"text-xl font-bold text-gray-800 hover:text-blue-600 transition-colors line-clamp-2",children:T.title})]}),C(T)&&n.jsxs("div",{className:"relative group/menu",children:[n.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Pf,{className:"w-5 h-5 text-gray-400"})}),n.jsx("div",{className:"absolute left-0 top-10 w-48 bg-white rounded-lg shadow-lg border border-gray-200 opacity-0 invisible group-hover/menu:opacity-100 group-hover/menu:visible transition-all duration-200 z-10",children:n.jsxs("div",{className:"p-2",children:[n.jsxs(Ee,{to:`/projects/${T.id}`,className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:[n.jsx(sr,{className:"w-4 h-4"}),e("projects.actions.viewDetails")]}),n.jsxs(Ee,{to:`/projects/${T.id}/edit`,className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:[n.jsx(Oa,{className:"w-4 h-4"}),e("projects.actions.edit")]}),n.jsxs("button",{onClick:()=>E(T.id),className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:[n.jsx(Lg,{className:"w-4 h-4"}),e("projects.actions.archive")]}),n.jsx("hr",{className:"my-1"}),n.jsxs("button",{onClick:()=>P(T.id),className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-red-600 hover:bg-red-50 rounded-md",children:[n.jsx(ir,{className:"w-4 h-4"}),e("projects.actions.delete")]})]})})]})]}),n.jsx("p",{className:"text-gray-600 mb-4 line-clamp-2 leading-relaxed",children:T.description}),n.jsxs("div",{className:"mb-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"text-sm font-medium text-gray-700",children:e("projects.progress")}),n.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[T.progress.toFixed(1),"/10"]})]}),n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:n.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${T.progress>=9?"bg-green-500":T.progress>=5?"bg-blue-500":"bg-yellow-500"}`,style:{width:`${T.progress/10*100}%`}})})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4 text-center",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"text-lg font-bold text-gray-800",children:[((A=T.tasks)==null?void 0:A.filter(B=>B.status==="completed").length)||0,"/",((F=T.tasks)==null?void 0:F.length)||0]}),n.jsx("div",{className:"text-xs text-gray-500",children:e("projects.tasks")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-lg font-bold text-gray-800",children:((H=T.students)==null?void 0:H.length)||0}),n.jsx("div",{className:"text-xs text-gray-500",children:e("projects.students")})]}),n.jsxs("div",{children:[n.jsx("div",{className:`text-lg font-bold ${T.due_date&&Ol(T.due_date)<0?"text-red-600":T.due_date&&Ol(T.due_date)<=7?"text-yellow-600":"text-green-600"}`,children:T.due_date?Ol(T.due_date)<0?e("projects.overdue"):`${Ol(T.due_date)} ${e("projects.days")}`:"--"}),n.jsx("div",{className:"text-xs text-gray-500",children:e("projects.remaining")})]})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsxs("div",{className:"flex -space-x-2",children:[(V=T.students)==null?void 0:V.slice(0,4).map((B,L)=>{var ee,I,K;return n.jsx("img",{src:((ee=B.student)==null?void 0:ee.avatar_url)||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",alt:(I=B.student)==null?void 0:I.name,className:"w-8 h-8 rounded-full border-2 border-white object-cover",title:(K=B.student)==null?void 0:K.name},B.id)}),T.students&&T.students.length>4&&n.jsxs("div",{className:"w-8 h-8 rounded-full bg-gray-200 border-2 border-white flex items-center justify-center text-xs font-medium text-gray-600",children:["+",T.students.length-4]})]}),n.jsxs("span",{className:"mr-3 text-sm text-gray-500",children:[e("projects.lastUpdate"),": ",Ze(T.updated_at)]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[T.rating&&n.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"}),T.rating.toFixed(1)]}),n.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[n.jsx(tt,{className:"w-4 h-4"}),T.due_date?Ze(T.due_date):e("projects.notSpecified")]})]})]})]},T.id)})}),b.length===0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(Ll,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("projects.noProjects")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("projects.startCreating")}),n.jsxs("div",{className:"flex justify-center gap-4",children:[n.jsxs(Ee,{to:"/projects/new",className:"px-6 py-2 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors flex items-center gap-2",children:[n.jsx(gt,{className:"w-4 h-4"}),e("projects.createNewProject")]}),n.jsx("button",{onClick:()=>{u("all"),h("")},className:"px-6 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("common.resetFilters")})]})]})]})},AE=[{name:"درجة الإنجاز",score:0,maxScore:10,weight:.2,comments:""},{name:"جودة العمل",score:0,maxScore:10,weight:.25,comments:""},{name:"التواصل والتعاون",score:0,maxScore:10,weight:.15,comments:""},{name:"الإبداع والابتكار",score:0,maxScore:10,weight:.2,comments:""},{name:"جودة العرض والتوثيق",score:0,maxScore:10,weight:.2,comments:""}],e2=e=>{const[t,r]=O.useState([]),[a,s]=O.useState(null),[i,o]=O.useState(!0),[l,c]=O.useState(null),{user:d}=vt(),u=async g=>{if(d)try{o(!0);const y=De(pe,"project_evaluations"),w=et(y,Ue("projectId","==",g)),_=(await Je(w)).docs.map(j=>{const N=j.data();return{id:j.id,projectId:N.projectId,teacherId:N.teacherId,criteria:N.criteria||[],totalScore:N.totalScore||0,maxTotalScore:N.maxTotalScore||0,percentage:N.percentage||0,feedback:N.feedback||"",createdAt:N.createdAt?new Date(N.createdAt.toDate()).toISOString():new Date().toISOString(),updatedAt:N.updatedAt?new Date(N.updatedAt.toDate()).toISOString():new Date().toISOString()}});r(_);const b=_.find(j=>j.teacherId===d.id);s(b||{id:"",projectId:g,teacherId:d.id,criteria:[...AE],totalScore:0,maxTotalScore:50,percentage:0,feedback:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()})}catch(y){console.error("Error fetching project evaluations:",y),c(y instanceof Error?y.message:"حدث خطأ في تحميل تقييمات المشروع")}finally{o(!1)}},f=g=>{let y=0,w=0;g.forEach(_=>{y+=_.score*_.weight,w+=_.maxScore*_.weight});const v=w>0?y/w*100:0;return{total:y,percentage:Math.round(v)}},h=g=>{const y=g.find(w=>w.name==="درجة الإنجاز");return console.log("Completion criterion found:",y),y?(console.log("Completion criterion score:",y.score),console.log("Completion criterion maxScore:",y.maxScore),y.score):(console.log("No completion criterion found, returning 0"),0)},m=(g,y,w)=>{if(!a)return;const v=[...a.criteria];v[g]={...v[g],score:Math.min(Math.max(0,y),v[g].maxScore),comments:w||v[g].comments};const{total:_,percentage:b}=f(v);s({...a,criteria:v,totalScore:_,percentage:b})},x=g=>{a&&s({...a,feedback:g})},p=async()=>{if(!d||!a||!e)throw new Error("بيانات غير كافية لحفظ التقييم");try{console.log("Submitting evaluation with currentEvaluation:",a);const g=a==null?void 0:a.criteria.find(b=>b.name==="درجة الإنجاز");console.log("Completion criterion before save:",g);const{total:y,percentage:w}=f(a.criteria),v=h(a.criteria);console.log("Final completion score to be saved:",v);const _={projectId:e,teacherId:d.id,criteria:a.criteria,totalScore:y,maxTotalScore:a.maxTotalScore,percentage:w,feedback:a.feedback,updatedAt:Ge()};if(a.id){const b=Ie(pe,"project_evaluations",a.id);await Wt(b,_);const j=Ie(pe,"projects",e);return console.log("Updating project with ID:",e),console.log("Setting rating to:",w/20),await Wt(j,{rating:w/20,updatedAt:Ge()}),{...a,..._,id:a.id}}else{_.createdAt=Ge();const b=De(pe,"project_evaluations"),j=await Aa(b,_),N=Ie(pe,"projects",e);return console.log("Updating project with ID:",e),console.log("Setting rating to:",w/20),await Wt(N,{rating:w/20,updatedAt:Ge()}),{...a,..._,id:j.id}}}catch(g){throw console.error("Error saving evaluation:",g),g}};return O.useEffect(()=>{e&&d&&u(e)},[e,d]),{evaluations:t,currentEvaluation:a,loading:i,error:l,fetchProjectEvaluations:u,updateCriterionScore:m,updateFeedback:x,saveEvaluation:p}},TE=({projectId:e,onSaved:t})=>{const{currentEvaluation:r,loading:a,error:s,updateCriterionScore:i,updateFeedback:o,saveEvaluation:l}=e2(e),[c,d]=O.useState(!1),[u,f]=O.useState(null),[h,m]=O.useState(!1),x=(v,_)=>{i(v,_)},p=(v,_)=>{i(v,(r==null?void 0:r.criteria[v].score)||0,_)},g=v=>{o(v)},y=async v=>{v.preventDefault(),d(!0),f(null),m(!1);try{console.log("Submitting evaluation with currentEvaluation:",r);const _=r==null?void 0:r.criteria.find(b=>b.name==="درجة الإنجاز");console.log("Completion criterion before save:",_),await l(),m(!0),t&&t(),setTimeout(()=>{m(!1)},3e3)}catch(_){console.error("Error saving evaluation:",_),f(_ instanceof Error?_.message:"حدث خطأ في حفظ التقييم")}finally{d(!1)}},w=v=>{switch(v){case"درجة الإنجاز":return n.jsx(od,{className:"w-5 h-5"});case"جودة العمل":return n.jsx(ar,{className:"w-5 h-5"});case"التواصل والتعاون":return n.jsx(lt,{className:"w-5 h-5"});case"الإبداع والابتكار":return n.jsx(xa,{className:"w-5 h-5"});case"جودة العرض والتوثيق":return n.jsx(Yn,{className:"w-5 h-5"});default:return n.jsx(at,{className:"w-5 h-5"})}};return a?n.jsx("div",{className:"flex items-center justify-center p-8",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):s?n.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 text-red-700",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(pt,{className:"w-5 h-5"}),n.jsx("p",{className:"font-medium",children:"حدث خطأ"})]}),n.jsx("p",{children:s})]}):r?n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[n.jsx(ar,{className:"w-6 h-6 text-blue-600"}),"تقييم المشروع"]}),h&&n.jsx("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4 text-green-700 mb-6",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ze,{className:"w-5 h-5"}),n.jsx("p",{children:"تم حفظ التقييم بنجاح"})]})}),u&&n.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 text-red-700 mb-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(pt,{className:"w-5 h-5"}),n.jsx("p",{className:"font-medium",children:"حدث خطأ"})]}),n.jsx("p",{children:u})]}),n.jsxs("form",{onSubmit:y,children:[n.jsx("div",{className:"mb-6 text-center",children:n.jsxs("div",{className:"w-32 h-32 bg-blue-50 rounded-full flex flex-col items-center justify-center mx-auto",children:[n.jsxs("span",{className:"text-3xl font-bold text-blue-600",children:[r.percentage,"%"]}),n.jsx("span",{className:"text-sm text-blue-600",children:"الدرجة النهائية"})]})}),n.jsxs("div",{className:"space-y-6 mb-8",children:[n.jsx("h4",{className:"font-semibold text-gray-800 mb-4",children:"معايير التقييم"}),r.criteria.map((v,_)=>n.jsxs("div",{className:"border border-gray-200 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[w(v.name),n.jsx("h5",{className:"font-medium text-gray-800",children:v.name}),n.jsxs("span",{className:"text-sm text-gray-500",children:["(",v.weight*100,"%)"]})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("span",{className:"font-bold text-blue-600",children:v.score}),n.jsxs("span",{className:"text-gray-500",children:["/ ",v.maxScore]})]})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("input",{type:"range",min:"0",max:v.maxScore,step:"0.5",value:v.score,onChange:b=>x(_,parseFloat(b.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-600"}),n.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[n.jsx("span",{children:"0"}),n.jsx("span",{children:v.maxScore/4}),n.jsx("span",{children:v.maxScore/2}),n.jsx("span",{children:v.maxScore*3/4}),n.jsx("span",{children:v.maxScore})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ملاحظات"}),n.jsx("textarea",{value:v.comments,onChange:b=>p(_,b.target.value),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"أضف ملاحظاتك حول هذا المعيار..."})]})]},_))]}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("label",{className:"block font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[n.jsx(Lr,{className:"w-5 h-5 text-blue-600"}),"التعليق العام"]}),n.jsx("textarea",{value:r.feedback,onChange:v=>g(v.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أضف تعليقك العام على المشروع وتوصياتك للطلاب..."})]}),n.jsx("div",{className:"flex justify-end",children:n.jsx("button",{type:"submit",disabled:c,className:"px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:c?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"جاري الحفظ..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Zn,{className:"w-5 h-5"}),"حفظ التقييم"]})})})]})]}):n.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4 text-yellow-700",children:n.jsx("p",{children:"لا يمكن تحميل نموذج التقييم. يرجى المحاولة مرة أخرى لاحقاً."})})},OE=({evaluation:e,teacherName:t="المعلم"})=>{const r=o=>new Date(o).toLocaleDateString("ar-SA",{year:"numeric",month:"long",day:"numeric"}),a=o=>{switch(o){case"درجة الإنجاز":return n.jsx(od,{className:"w-4 h-4"});case"جودة العمل":return n.jsx(ar,{className:"w-4 h-4"});case"التواصل والتعاون":return n.jsx(lt,{className:"w-4 h-4"});case"الإبداع والابتكار":return n.jsx(xa,{className:"w-4 h-4"});case"جودة العرض والتوثيق":return n.jsx(Yn,{className:"w-4 h-4"});default:return n.jsx(at,{className:"w-4 h-4"})}},s=(o,l)=>{const c=o/l*100;return c>=90?"text-green-600":c>=75?"text-blue-600":c>=60?"text-yellow-600":"text-red-600"},i=o=>o>=90?"ممتاز":o>=80?"جيد جداً":o>=70?"جيد":o>=60?"مقبول":"ضعيف";return n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(ar,{className:"w-6 h-6 text-blue-600"}),"ملخص التقييم"]}),n.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-1",children:[n.jsx(tt,{className:"w-4 h-4"}),r(e.updatedAt)]})]}),n.jsx("div",{className:"flex items-center justify-center mb-6",children:n.jsxs("div",{className:"w-32 h-32 bg-blue-50 rounded-full flex flex-col items-center justify-center",children:[n.jsxs("span",{className:"text-3xl font-bold text-blue-600",children:[e.percentage,"%"]}),n.jsx("span",{className:"text-sm text-blue-600",children:i(e.percentage)})]})}),n.jsxs("div",{className:"space-y-4 mb-6",children:[n.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"تفاصيل التقييم"}),e.criteria.map((o,l)=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[a(o.name),n.jsx("span",{className:"font-medium text-gray-800",children:o.name})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("span",{className:`font-bold ${s(o.score,o.maxScore)}`,children:o.score}),n.jsxs("span",{className:"text-gray-500",children:["/ ",o.maxScore]})]})]},l))]}),e.feedback&&n.jsxs("div",{className:"mb-4",children:[n.jsxs("h4",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[n.jsx(Lr,{className:"w-5 h-5 text-blue-600"}),"التعليق العام"]}),n.jsx("div",{className:"bg-gray-50 p-4 rounded-xl",children:n.jsx("p",{className:"text-gray-700 whitespace-pre-line",children:e.feedback})})]}),n.jsxs("div",{className:"text-sm text-gray-500 text-left",children:["تم التقييم بواسطة: ",t]})]})},PE=({projectId:e})=>{const{user:t}=vt(),[r,a]=O.useState([]),[s,i]=O.useState(""),[o,l]=O.useState(!0),[c,d]=O.useState(!1),[u,f]=O.useState(null),[h,m]=O.useState(null),[x,p]=O.useState(0),[g,y]=O.useState(!1),w=O.useRef(null),v=O.useRef(null),[_,b]=O.useState(null),[j,N]=O.useState(""),[k,S]=O.useState(null),[E,P]=O.useState(null),[C,T]=O.useState([]);O.useEffect(()=>{var Q;(Q=w.current)==null||Q.scrollIntoView({behavior:"smooth"})},[r]),O.useEffect(()=>{if(!e)return;l(!0),f(null);const Q=De(pe,"chat_messages"),q=et(Q,Ue("project_id","==",e)),se=K3(q,async D=>{var we,Ae;const ve=[];for(const ce of D.docs){const he=ce.data();let oe;try{if(he.user_id){const Ve=Ie(pe,"users",he.user_id),ct=await hr(Ve);if(ct.exists()){const nt=ct.data();oe={name:nt.name||"مستخدم غير معروف",avatar_url:nt.avatar_url,role:nt.role}}}}catch(Ve){console.error("Error fetching user info:",Ve)}ve.push({id:ce.id,project_id:he.project_id,user_id:he.user_id,message:he.message,message_type:he.message_type||"text",media_url:he.media_url,reply_to:he.reply_to,created_at:((we=he.created_at)==null?void 0:we.toDate())||new Date,updated_at:(Ae=he.updated_at)==null?void 0:Ae.toDate(),seen_by:he.seen_by||[],user:oe})}if(ve.sort((ce,he)=>ce.created_at.getTime()-he.created_at.getTime()),a(ve),l(!1),t&&ve.length>0){const ce=ve[ve.length-1];ce.user_id!==t.id&&K(ce.id)}},D=>{console.error("Error fetching messages:",D),f("حدث خطأ في تحميل الرسائل"),l(!1)});return()=>se()},[e,t]);const M=async()=>{if(!(!t||!e)&&!(!s.trim()&&!h)){d(!0),f(null);try{let Q="",q="text";if(h){y(!0),h.type.startsWith("image/")?q="image":h.type.startsWith("video/")?q="video":q="file";const se=Rh($h,`project_chats/${e}/${Date.now()}_${h.name}`),D=X3(se,h);D.on("state_changed",ve=>{const we=ve.bytesTransferred/ve.totalBytes*100;p(we)},ve=>{console.error("Error uploading file:",ve),f("حدث خطأ في رفع الملف"),y(!1)},async()=>{Q=await Mj(D.snapshot.ref),await Aa(De(pe,"chat_messages"),{project_id:e,user_id:t.id,message:s.trim()||`تم إرسال ${q==="image"?"صورة":q==="video"?"فيديو":"ملف"}`,message_type:q,media_url:Q,created_at:Ge(),updated_at:Ge(),seen_by:[t.id]}),i(""),m(null),p(0),y(!1),d(!1)})}else await Aa(De(pe,"chat_messages"),{project_id:e,user_id:t.id,message:s.trim(),message_type:"text",created_at:Ge(),updated_at:Ge(),seen_by:[t.id]}),i(""),d(!1)}catch(Q){console.error("Error sending message:",Q),f("حدث خطأ في إرسال الرسالة"),d(!1)}}},A=Q=>{Q.target.files&&Q.target.files.length>0&&m(Q.target.files[0])},F=()=>{m(null),v.current&&(v.current.value="")},H=(Q,q)=>{b(Q),N(q)},V=async Q=>{if(j.trim())try{const q=Ie(pe,"chat_messages",Q);await Wt(q,{message:j,updated_at:Ge()}),b(null),N("")}catch(q){console.error("Error updating message:",q),f("حدث خطأ في تحديث الرسالة")}},B=()=>{b(null),N("")},L=Q=>{S(Q)},ee=async Q=>{try{const q=r.find(D=>D.id===Q),se=Ie(pe,"chat_messages",Q);if(await Va(se),q!=null&&q.media_url)try{const Ae=new URL(q.media_url).pathname.split("?")[0].match(/\/o\/(.+)$/);if(Ae&&Ae[1]){const ce=decodeURIComponent(Ae[1]),he=Rh($h,ce);await q3(he)}}catch(D){console.error("Error deleting file from storage:",D)}S(null)}catch(q){console.error("Error deleting message:",q),f("حدث خطأ في حذف الرسالة")}},I=()=>{S(null)},K=async Q=>{if(t)try{const q=Ie(pe,"chat_messages",Q),se=await hr(q);if(se.exists()){const ve=se.data().seen_by||[];ve.includes(t.id)||await Wt(q,{seen_by:[...ve,t.id]})}}catch(q){console.error("Error marking message as seen:",q)}},z=async Q=>{try{const q=Ie(pe,"chat_messages",Q),se=await hr(q);if(se.exists()){const ve=se.data().seen_by||[],we=[];for(const Ae of ve){const ce=Ie(pe,"users",Ae),he=await hr(ce);if(he.exists()){const oe=he.data();we.push({id:Ae,name:oe.name||"مستخدم غير معروف",avatar_url:oe.avatar_url,role:oe.role})}}T(we),P(Q)}}catch(q){console.error("Error fetching seen by users:",q)}},W=()=>{P(null),T([])},re=Q=>Q.toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit",hour12:!0,calendar:"gregory"}),xe=Q=>Q.toLocaleDateString("ar-SA",{weekday:"long",year:"numeric",month:"long",day:"numeric",calendar:"gregory"}),me={};return r.forEach(Q=>{const q=xe(Q.created_at);me[q]||(me[q]=[]),me[q].push(Q)}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg flex flex-col h-[600px]",children:[n.jsx("div",{className:"p-4 border-b border-gray-200",children:n.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(lt,{className:"w-5 h-5 text-blue-600"}),"محادثة الفريق"]})}),n.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:o?n.jsx("div",{className:"flex items-center justify-center h-full",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):u?n.jsx("div",{className:"flex items-center justify-center h-full text-red-500",children:u}):r.length===0?n.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:[n.jsx(Xs,{className:"w-12 h-12 text-gray-300 mb-2"}),n.jsx("p",{children:"لا توجد رسائل بعد"}),n.jsx("p",{className:"text-sm",children:"ابدأ المحادثة مع فريق المشروع"})]}):n.jsxs("div",{className:"space-y-6",children:[Object.entries(me).map(([Q,q])=>n.jsxs("div",{children:[n.jsx("div",{className:"flex justify-center mb-4",children:n.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-600 text-xs rounded-full",children:Q})}),n.jsx("div",{className:"space-y-4",children:q.map(se=>{var D,ve;return n.jsx(te.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:`flex ${se.user_id===(t==null?void 0:t.id)?"justify-end":"justify-start"}`,children:n.jsxs("div",{className:`flex gap-3 max-w-[80%] ${se.user_id===(t==null?void 0:t.id)?"flex-row-reverse":""}`,children:[n.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 overflow-hidden",children:(D=se.user)!=null&&D.avatar_url?n.jsx("img",{src:se.user.avatar_url,alt:se.user.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:`w-full h-full ${se.user_id===(t==null?void 0:t.id)?"bg-blue-500":"bg-gradient-to-r from-purple-500 to-pink-500"} flex items-center justify-center`,children:n.jsx(xr,{className:"w-4 h-4 text-white"})})}),n.jsxs("div",{className:"relative group",children:[n.jsxs("div",{className:`rounded-2xl p-4 ${se.user_id===(t==null?void 0:t.id)?"bg-blue-500 text-white":"bg-gray-100 text-gray-800"}`,children:[se.user_id!==(t==null?void 0:t.id)&&n.jsx("p",{className:"font-medium text-sm mb-1",children:((ve=se.user)==null?void 0:ve.name)||"مستخدم غير معروف"}),_===se.id?n.jsxs("div",{className:"mb-2",children:[n.jsx("textarea",{value:j,onChange:we=>N(we.target.value),className:`w-full p-2 rounded border ${se.user_id===(t==null?void 0:t.id)?"bg-blue-50 text-gray-800 border-blue-300":"bg-white border-gray-300"}`,rows:2}),n.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[n.jsx("button",{onClick:()=>V(se.id),className:"p-1 bg-green-500 text-white rounded",children:n.jsx(t6,{className:"w-4 h-4"})}),n.jsx("button",{onClick:B,className:"p-1 bg-gray-500 text-white rounded",children:n.jsx(Pt,{className:"w-4 h-4"})})]})]}):n.jsxs(n.Fragment,{children:[se.message_type==="text"&&n.jsx("p",{className:"whitespace-pre-line",children:se.message}),se.message_type==="image"&&se.media_url&&n.jsxs("div",{className:"mb-2",children:[n.jsx("img",{src:se.media_url,alt:"صورة",className:"rounded-lg max-w-full max-h-60 object-contain"}),se.message&&n.jsx("p",{className:"mt-2",children:se.message})]}),se.message_type==="video"&&se.media_url&&n.jsxs("div",{className:"mb-2",children:[n.jsx("video",{src:se.media_url,controls:!0,className:"rounded-lg max-w-full max-h-60"}),se.message&&n.jsx("p",{className:"mt-2",children:se.message})]}),se.message_type==="file"&&se.media_url&&n.jsxs("div",{className:"mb-2",children:[n.jsxs("a",{href:se.media_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 bg-white bg-opacity-20 p-2 rounded-lg",children:[n.jsx(Bg,{className:"w-4 h-4"}),n.jsx("span",{className:"truncate",children:"تحميل الملف"})]}),se.message&&n.jsx("p",{className:"mt-2",children:se.message})]})]}),n.jsxs("div",{className:`flex items-center justify-between text-xs mt-2 ${se.user_id===(t==null?void 0:t.id)?"text-blue-100":"text-gray-500"}`,children:[n.jsxs("span",{children:[re(se.created_at),se.updated_at&&" (معدل)"]}),se.user_id===(t==null?void 0:t.id)&&se.seen_by&&se.seen_by.length>1&&n.jsxs("button",{onClick:()=>z(se.id),className:"flex items-center gap-1 hover:underline",children:[n.jsx(sr,{className:"w-3 h-3"}),se.seen_by.length-1]})]})]}),se.user_id===(t==null?void 0:t.id)&&n.jsx("div",{className:"absolute top-2 left-2 opacity-0 group-hover:opacity-100 transition-opacity",children:n.jsxs("div",{className:"relative",children:[n.jsx("button",{className:`p-1 rounded-full ${se.user_id===(t==null?void 0:t.id)?"bg-blue-400 hover:bg-blue-600":"bg-gray-200 hover:bg-gray-300"} text-white`,children:n.jsx(Pf,{className:"w-3 h-3"})}),n.jsxs("div",{className:"absolute left-0 top-full mt-1 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-10 hidden group-hover:block",children:[n.jsxs("button",{onClick:()=>H(se.id,se.message),className:"flex items-center gap-2 px-3 py-1 hover:bg-gray-100 w-full text-right text-sm text-gray-700",children:[n.jsx(Oa,{className:"w-3 h-3"}),"تعديل"]}),n.jsxs("button",{onClick:()=>L(se.id),className:"flex items-center gap-2 px-3 py-1 hover:bg-gray-100 w-full text-right text-sm text-red-600",children:[n.jsx(ir,{className:"w-3 h-3"}),"حذف"]})]})]})})]})]})},se.id)})})]},Q)),n.jsx("div",{ref:w})]})}),k&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-sm w-full",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"تأكيد الحذف"}),n.jsx("p",{className:"text-gray-600 mb-6",children:"هل أنت متأكد من حذف هذه الرسالة؟ لا يمكن التراجع عن هذا الإجراء."}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{onClick:I,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{onClick:()=>ee(k),className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:"حذف"})]})]})}),E&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-sm w-full",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"شاهد الرسالة"}),n.jsx("button",{onClick:W,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Pt,{className:"w-5 h-5 text-gray-600"})})]}),n.jsx("div",{className:"max-h-60 overflow-y-auto",children:C.length>0?n.jsx("div",{className:"space-y-3",children:C.map(Q=>n.jsxs("div",{className:"flex items-center gap-3 p-2 hover:bg-gray-50 rounded-lg",children:[n.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden",children:Q.avatar_url?n.jsx("img",{src:Q.avatar_url,alt:Q.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full bg-gray-300 flex items-center justify-center",children:n.jsx(xr,{className:"w-4 h-4 text-gray-600"})})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:Q.name}),n.jsx("p",{className:"text-xs text-gray-500",children:Q.role||"مستخدم"})]})]},Q.id))}):n.jsx("p",{className:"text-center text-gray-500 py-4",children:"لم يشاهد أحد هذه الرسالة بعد"})})]})}),h&&n.jsx("div",{className:"px-4 py-2 border-t border-gray-200",children:n.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-2 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[h.type.startsWith("image/")?n.jsx(ld,{className:"w-4 h-4 text-blue-500"}):h.type.startsWith("video/")?n.jsx(jr,{className:"w-4 h-4 text-purple-500"}):n.jsx(Bg,{className:"w-4 h-4 text-gray-500"}),n.jsx("span",{className:"text-sm truncate max-w-[200px]",children:h.name}),g&&n.jsx("div",{className:"w-20 h-2 bg-gray-200 rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-blue-500",style:{width:`${x}%`}})})]}),n.jsx("button",{onClick:F,className:"p-1 hover:bg-gray-200 rounded-full",children:n.jsx(Pt,{className:"w-4 h-4 text-gray-500"})})]})}),n.jsx("div",{className:"p-4 border-t border-gray-200",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"file",ref:v,onChange:A,className:"hidden"}),n.jsx("button",{onClick:()=>{var Q;return(Q=v.current)==null?void 0:Q.click()},disabled:g||c,className:"p-2 rounded-full hover:bg-gray-100 transition-colors disabled:opacity-50",children:n.jsx(Bj,{className:"w-5 h-5 text-gray-500"})}),n.jsx("div",{className:"flex-1 relative",children:n.jsx("input",{type:"text",value:s,onChange:Q=>i(Q.target.value),onKeyPress:Q=>Q.key==="Enter"&&!Q.shiftKey&&M(),placeholder:"اكتب رسالتك هنا...",disabled:g||c,className:"w-full px-4 py-2 border border-gray-300 rounded-full focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"})}),n.jsx("button",{onClick:M,disabled:!s.trim()&&!h||g||c,className:"p-2 rounded-full bg-blue-500 text-white hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:bg-gray-300",children:n.jsx(Mx,{className:"w-5 h-5"})})]})})]})},Bx=()=>{const[e,t]=O.useState([]),[r,a]=O.useState(!0),[s,i]=O.useState(null),{user:o}=vt(),l=async()=>{if(!(!o||!o.school_id))try{a(!0);const c=await H6(o.school_id);t(c)}catch(c){i(c instanceof Error?c.message:"حدث خطأ في تحميل الطلاب")}finally{a(!1)}};return O.useEffect(()=>{o&&o.school_id&&l()},[o]),{students:e,loading:r,error:s,fetchStudents:l}},CE=({projectId:e,maxStudents:t,currentStudents:r,onClose:a,onSuccess:s})=>{const{students:i,loading:o,error:l}=Bx(),[c,d]=O.useState(""),[u,f]=O.useState([]),[h,m]=O.useState(!1),[x,p]=O.useState(null),g=r.map(b=>b.student_id),w=i.filter(b=>!g.includes(b.id)).filter(b=>b.name.toLowerCase().includes(c.toLowerCase())||b.email.toLowerCase().includes(c.toLowerCase())||b.grade&&b.grade.toLowerCase().includes(c.toLowerCase())),v=b=>{f(j=>j.includes(b)?j.filter(N=>N!==b):r.length+j.length>=t?j:[...j,b])},_=async()=>{if(u.length!==0){m(!0),p(null);try{for(const b of u)await Lh({project_id:e,student_id:b,role:"member",created_at:new Date().toISOString(),status:"active"});s(),a()}catch(b){console.error("Error adding students to project:",b),p(b instanceof Error?b.message:"حدث خطأ في إضافة الطلاب")}finally{m(!1)}}};return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(ic,{className:"w-6 h-6 text-blue-600"}),"إضافة طلاب للمشروع"]}),n.jsx("button",{onClick:a,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Pt,{className:"w-5 h-5 text-gray-600"})})]}),x&&n.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-4",children:x}),n.jsxs("div",{className:"relative mb-4",children:[n.jsx(ut,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"البحث بالاسم أو البريد الإلكتروني...",value:c,onChange:b=>d(b.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),u.length>0&&n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 mb-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("span",{className:"text-blue-800 font-medium",children:["تم اختيار ",u.length," طالب",r.length>0&&` (${r.length} موجود بالفعل)`]}),n.jsx("button",{onClick:()=>f([]),className:"text-blue-600 hover:text-blue-800 text-sm",children:"إلغاء الكل"})]})}),n.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto mb-6",children:o?n.jsx("div",{className:"flex items-center justify-center py-8",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):l?n.jsx("div",{className:"text-center py-8 text-red-500",children:l}):w.length>0?w.map(b=>n.jsxs("div",{className:`flex items-center gap-4 p-4 border rounded-xl transition-all cursor-pointer hover:shadow-md ${u.includes(b.id)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>v(b.id),children:[n.jsx("input",{type:"checkbox",checked:u.includes(b.id),onChange:()=>v(b.id),disabled:!u.includes(b.id)&&r.length+u.length>=t,className:"text-blue-600"}),n.jsx("img",{src:b.avatar_url||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",alt:b.name,className:"w-12 h-12 rounded-full object-cover"}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("h3",{className:"font-semibold text-gray-800",children:b.name}),u.includes(b.id)&&n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:"محدد"})]}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Ta,{className:"w-4 h-4"}),b.email]}),b.grade&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(js,{className:"w-4 h-4"}),b.grade]})]})]})]},b.id)):n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(lt,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا يوجد طلاب"}),n.jsx("p",{className:"text-gray-600",children:c?"لم يتم العثور على طلاب يطابقون البحث":"لا يوجد طلاب متاحين للإضافة"})]})}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-6",children:[n.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"معلومات مهمة:"}),n.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[n.jsxs("li",{children:["• يمكنك اختيار حتى ",t-r.length," طلاب إضافيين"]}),n.jsxs("li",{children:["• يوجد حالياً ",r.length," طالب في المشروع"]}),n.jsxs("li",{children:["• الحد الأقصى للطلاب في هذا المشروع هو ",t]}),n.jsx("li",{children:"• يمكنك تعديل دور الطالب لاحقاً (قائد/عضو)"})]})]}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{onClick:a,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{onClick:_,disabled:u.length===0||h,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:h?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الإضافة..."]}):n.jsxs(n.Fragment,{children:[n.jsx(ic,{className:"w-5 h-5"}),"إضافة الطلاب (",u.length,")"]})})]})]})})},FE=({projectId:e,students:t,onClose:r,onSuccess:a})=>{const{user:s}=vt(),[i,o]=O.useState({title:"",description:"",assigned_to:"",status:"pending",priority:"medium",due_date:""}),[l,c]=O.useState(!1),[d,u]=O.useState(null),f=(m,x)=>{o(p=>({...p,[m]:x}))},h=async m=>{if(m.preventDefault(),!i.title){u("يرجى إدخال عنوان المهمة");return}if(!i.due_date){u("يرجى تحديد تاريخ الاستحقاق");return}c(!0),u(null);try{await C6({project_id:e,title:i.title,description:i.description,assigned_to:i.assigned_to||null,status:i.status,priority:i.priority,progress:i.status==="completed"?100:i.status==="in_progress"?50:0,due_date:i.due_date,created_by:s==null?void 0:s.id,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}),a(),r()}catch(x){console.error("Error creating task:",x),u(x instanceof Error?x.message:"حدث خطأ في إنشاء المهمة")}finally{c(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(ze,{className:"w-6 h-6 text-blue-600"}),"إضافة مهمة جديدة"]}),n.jsx("button",{onClick:r,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Pt,{className:"w-5 h-5 text-gray-600"})})]}),d&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(pt,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:d})]}),n.jsxs("form",{onSubmit:h,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"عنوان المهمة *"}),n.jsx("input",{type:"text",value:i.title,onChange:m=>f("title",m.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل عنوان المهمة",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"وصف المهمة"}),n.jsx("textarea",{value:i.description,onChange:m=>f("description",m.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"اكتب وصفاً تفصيلياً للمهمة"})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تعيين إلى"}),n.jsxs("select",{value:i.assigned_to,onChange:m=>f("assigned_to",m.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"",children:"غير معين"}),t.map(m=>{var x;return n.jsxs("option",{value:m.student_id,children:[((x=m.student)==null?void 0:x.name)||"طالب غير معروف"," ",m.role==="leader"?"(قائد الفريق)":""]},m.student_id)})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ الاستحقاق *"}),n.jsxs("div",{className:"relative",children:[n.jsx(tt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"date",value:i.due_date,onChange:m=>f("due_date",m.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الحالة"}),n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.jsxs("label",{className:`flex items-center justify-center gap-2 p-3 border rounded-xl cursor-pointer transition-colors ${i.status==="pending"?"bg-yellow-50 border-yellow-500 text-yellow-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"status",value:"pending",checked:i.status==="pending",onChange:()=>f("status","pending"),className:"sr-only"}),n.jsx(jt,{className:"w-5 h-5"}),n.jsx("span",{children:"في الانتظار"})]}),n.jsxs("label",{className:`flex items-center justify-center gap-2 p-3 border rounded-xl cursor-pointer transition-colors ${i.status==="in_progress"?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"status",value:"in_progress",checked:i.status==="in_progress",onChange:()=>f("status","in_progress"),className:"sr-only"}),n.jsx(jt,{className:"w-5 h-5"}),n.jsx("span",{children:"قيد التنفيذ"})]}),n.jsxs("label",{className:`flex items-center justify-center gap-2 p-3 border rounded-xl cursor-pointer transition-colors ${i.status==="completed"?"bg-green-50 border-green-500 text-green-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"status",value:"completed",checked:i.status==="completed",onChange:()=>f("status","completed"),className:"sr-only"}),n.jsx(ze,{className:"w-5 h-5"}),n.jsx("span",{children:"مكتمل"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الأولوية"}),n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.jsxs("label",{className:`flex items-center justify-center gap-2 p-3 border rounded-xl cursor-pointer transition-colors ${i.priority==="low"?"bg-green-50 border-green-500 text-green-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"priority",value:"low",checked:i.priority==="low",onChange:()=>f("priority","low"),className:"sr-only"}),n.jsx(B0,{className:"w-5 h-5"}),n.jsx("span",{children:"منخفضة"})]}),n.jsxs("label",{className:`flex items-center justify-center gap-2 p-3 border rounded-xl cursor-pointer transition-colors ${i.priority==="medium"?"bg-yellow-50 border-yellow-500 text-yellow-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"priority",value:"medium",checked:i.priority==="medium",onChange:()=>f("priority","medium"),className:"sr-only"}),n.jsx(B0,{className:"w-5 h-5"}),n.jsx("span",{children:"متوسطة"})]}),n.jsxs("label",{className:`flex items-center justify-center gap-2 p-3 border rounded-xl cursor-pointer transition-colors ${i.priority==="high"?"bg-red-50 border-red-500 text-red-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"priority",value:"high",checked:i.priority==="high",onChange:()=>f("priority","high"),className:"sr-only"}),n.jsx(B0,{className:"w-5 h-5"}),n.jsx("span",{children:"عالية"})]})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[n.jsx("button",{type:"button",onClick:r,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{type:"submit",disabled:l,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:l?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الإنشاء..."]}):n.jsxs(n.Fragment,{children:[n.jsx(ze,{className:"w-5 h-5"}),"إنشاء المهمة"]})})]})]})]})})},IE=()=>{var he;const{t:e}=yt(),{id:t}=Rj(),[r,a]=O.useState("overview"),[s,i]=O.useState(null),[o,l]=O.useState([]),[c,d]=O.useState([]),[u,f]=O.useState(!0),[h,m]=O.useState(null),{user:x}=vt(),{evaluations:p,loading:g}=e2(t),[y,w]=O.useState(!1),[v,_]=O.useState(!1),{fetchProjects:b,updateProject:j}=Ci(),[N,k]=O.useState(null),[S,E]=O.useState([]),[P,C]=O.useState(!1),[T,M]=O.useState(null),[A,F]=O.useState(!1),[H,V]=O.useState(!1),B=(x==null?void 0:x.role)==="student",L=(x==null?void 0:x.role)==="teacher",ee=(x==null?void 0:x.role)==="school",I=(x==null?void 0:x.role)==="admin",K=(x==null?void 0:x.id)===(s==null?void 0:s.teacher_id),z=(L||ee||I)&&(s==null?void 0:s.status)==="draft",W=async()=>{if(t)try{f(!0);const oe=await Kj(t);if(!oe){m("المشروع غير موجود"),f(!1);return}const Ve=await lc(t);console.log("Students data received in ProjectDetails:",Ve);const ct=await Bh(t);let nt=0;try{const At=De(pe,"project_evaluations"),Xt=et(At,Ue("projectId","==",t)),er=await Je(Xt);if(er.empty)console.log(`No evaluation found for project ${t}, using default progress:`,nt);else{const la=er.docs[0].data();la.criteria&&la.criteria.length>0&&(nt=la.criteria[0].score||0,console.log(`Found evaluation for project ${t}, completion score:`,nt))}}catch(At){console.error(`Error fetching evaluation for project ${t}:`,At)}if(console.log("Original due_date:",oe.due_date),i({...oe,progress:nt,due_date:oe.due_date}),l(Ve),d(ct),oe.status==="draft"){if(L)k(x.id),C(!1);else if(ee){const At=await j6(x.id);E(At),C(!0),k(oe.teacher_id||null)}else if(I){const At=await w6();E(At),C(!0),k(oe.teacher_id||null)}}else k(oe.teacher_id||null),C(!1)}catch(oe){console.error("Error fetching project details:",oe),m(oe instanceof Error?oe.message:"حدث خطأ في تحميل تفاصيل المشروع")}finally{f(!1)}};O.useEffect(()=>{W()},[t,x]);const re=async()=>{if(t)try{const oe=await lc(t);l(oe)}catch(oe){console.error("Error refreshing students:",oe)}},xe=async()=>{if(t)try{const oe=await Bh(t);d(oe)}catch(oe){console.error("Error refreshing tasks:",oe)}},me=async()=>{await W(),await b()},Q=async()=>{if((ee||I)&&!N){M(e("projectDetails.errors.selectTeacherRequired"));return}F(!0),M(null),V(!1);try{await j(t||"",{status:"active",teacher_id:N}),V(!0),await W(),await b(),setTimeout(()=>{V(!1)},3e3)}catch(oe){console.error("Error approving project:",oe),M(oe instanceof Error?oe.message:"حدث خطأ في اعتماد المشروع")}finally{F(!1)}},q=oe=>{switch(oe){case"completed":return"bg-green-100 text-green-800";case"in_progress":return"bg-blue-100 text-blue-800";case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},se=oe=>{switch(oe){case"completed":return"مكتمل";case"in_progress":return"قيد التنفيذ";case"pending":return"في الانتظار";default:return oe}},D=oe=>{switch(oe){case"document":return n.jsx(br,{className:"w-5 h-5"});case"video":return n.jsx(jr,{className:"w-5 h-5"});case"image":return n.jsx(ld,{className:"w-5 h-5"});case"link":return n.jsx(ou,{className:"w-5 h-5"});default:return n.jsx(br,{className:"w-5 h-5"})}};if(u)return n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})});if(h||!s)return n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(oa,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:h||"لم يتم العثور على المشروع"}),n.jsx(Ee,{to:"/projects",className:"mt-4 inline-block px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:"العودة إلى المشاريع"})]})});const ve=c.filter(oe=>oe.status==="completed").length,we=c.length,Ae=s.due_date?Ol(s.due_date):null;console.log("Project due_date:",s.due_date),console.log("Days remaining:",Ae);const ce=I||ee||K||L&&s.status==="draft"&&s.school_id===(x==null?void 0:x.school_id)||B&&s.status==="draft"&&o.some(oe=>oe.student_id===(x==null?void 0:x.id));return n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx(Ee,{to:"/projects",className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Jn,{className:"w-6 h-6 text-gray-600"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:s.title}),n.jsx("p",{className:"text-gray-600",children:s.description})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(bs,{className:"w-5 h-5 text-gray-600"})}),ce&&n.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(xo,{className:"w-5 h-5 text-gray-600"})})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 mb-6",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mx-auto mb-2",children:n.jsx(od,{className:"w-8 h-8 text-blue-600"})}),n.jsxs("div",{className:"text-2xl font-bold text-gray-800",children:[s.progress.toFixed(1),"/10"]}),n.jsx("div",{className:"text-sm text-gray-600",children:"درجة الإنجاز"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-2xl flex items-center justify-center mx-auto mb-2",children:n.jsx(ze,{className:"w-8 h-8 text-green-600"})}),n.jsxs("div",{className:"text-2xl font-bold text-gray-800",children:[ve,"/",we]}),n.jsx("div",{className:"text-sm text-gray-600",children:"المهام"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-purple-100 rounded-2xl flex items-center justify-center mx-auto mb-2",children:n.jsx(lt,{className:"w-8 h-8 text-purple-600"})}),n.jsx("div",{className:"text-2xl font-bold text-gray-800",children:o.length}),n.jsx("div",{className:"text-sm text-gray-600",children:"الطلاب"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-orange-100 rounded-2xl flex items-center justify-center mx-auto mb-2",children:n.jsx(tt,{className:"w-8 h-8 text-orange-600"})}),n.jsx("div",{className:`text-2xl font-bold ${Ae!==null?Ae<0?"text-red-600":Ae<=7?"text-yellow-600":"text-green-600":"text-gray-600"}`,children:Ae!==null?Ae<0?"متأخر":`${Ae} يوم`:"--"}),n.jsx("div",{className:"text-sm text-gray-600",children:"يوم متبقي"})]})]}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"text-sm font-medium text-gray-700",children:"درجة الإنجاز"}),n.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[s.progress.toFixed(1),"/10"]})]}),n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:n.jsx("div",{className:"h-3 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full transition-all duration-300",style:{width:`${s.progress/10*100}%`}})})]}),s.status==="draft"&&z&&n.jsx(te.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-xl",children:n.jsxs("div",{className:"flex items-start gap-4",children:[n.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:n.jsx(ze,{className:"w-5 h-5 text-blue-600"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-2",children:e("projectDetails.approveProject")}),H&&n.jsxs("div",{className:"bg-green-100 border border-green-200 text-green-700 px-4 py-3 rounded-lg mb-4 flex items-center gap-2",children:[n.jsx(ze,{className:"w-5 h-5"}),n.jsx("span",{children:e("projectDetails.projectApproved")})]}),T&&n.jsxs("div",{className:"bg-red-100 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-4 flex items-center gap-2",children:[n.jsx(oa,{className:"w-5 h-5"}),n.jsx("span",{children:T})]}),n.jsxs("div",{className:"space-y-4",children:[P&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-blue-700 mb-2",children:e("projectDetails.supervisorTeacher")}),n.jsxs("select",{value:N||"",onChange:oe=>k(oe.target.value||null),className:"w-full px-4 py-3 border border-blue-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"",children:e("projectDetails.selectTeacher")}),S.map(oe=>n.jsxs("option",{value:oe.id,children:[oe.name," ",oe.subject?`(${oe.subject})`:""]},oe.id))]})]}),L&&!P&&n.jsx("p",{className:"text-blue-700 mb-4",children:e("projectDetails.assignedToYou")}),n.jsx("button",{onClick:Q,disabled:A||!N&&(ee||I),className:"px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:A?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e("projectDetails.approving")]}):n.jsxs(n.Fragment,{children:[n.jsx(ze,{className:"w-5 h-5"}),e("projectDetails.approveProject")]})})]})]})]})}),n.jsx("div",{className:"border-b border-gray-200",children:n.jsx("nav",{className:"flex space-x-8",children:[{id:"overview",name:"نظرة عامة",icon:Yn},{id:"tasks",name:"المهام",icon:ze},{id:"team",name:"الفريق",icon:lt},{id:"resources",name:"الموارد",icon:br},{id:"chat",name:"المحادثة",icon:Ht},{id:"evaluation",name:"التقييم",icon:ar}].map(oe=>n.jsxs("button",{onClick:()=>a(oe.id),className:`flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm transition-colors ${r===oe.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[n.jsx(oe.icon,{className:"w-4 h-4"}),oe.name]},oe.id))})})]}),n.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"lg:col-span-2",children:[r==="overview"&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"space-y-6",children:[n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"أهداف المشروع"}),n.jsx("div",{className:"space-y-3",children:s.objectives&&s.objectives.map((oe,Ve)=>n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center mt-0.5",children:n.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full"})}),n.jsx("p",{className:"text-gray-700 leading-relaxed",children:oe})]},Ve))})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"النشاط الأخير"}),c.length>0?n.jsx("div",{className:"space-y-4",children:c.slice(0,3).map(oe=>n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${oe.status==="completed"?"bg-green-100":oe.status==="in_progress"?"bg-blue-100":"bg-yellow-100"}`,children:oe.status==="completed"?n.jsx(ze,{className:"w-5 h-5 text-green-600"}):n.jsx(jt,{className:"w-5 h-5 text-blue-600"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("span",{className:"font-medium text-gray-800",children:oe.title}),n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${q(oe.status)}`,children:se(oe.status)})]}),n.jsx("p",{className:"text-gray-700 text-sm leading-relaxed",children:oe.description}),n.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["تاريخ الاستحقاق: ",Ze(oe.due_date)]})]})]},oe.id))}):n.jsx("p",{className:"text-gray-600 text-center py-4",children:"لا يوجد نشاط حديث"})]})]}),r==="tasks"&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"المهام"}),ce&&n.jsxs("button",{onClick:()=>_(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:[n.jsx(gt,{className:"w-4 h-4"}),"مهمة جديدة"]})]}),n.jsx("div",{className:"space-y-4",children:c.length>0?c.map(oe=>{var Ve,ct;return n.jsxs("div",{className:"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h4",{className:"font-semibold text-gray-800",children:oe.title}),n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${q(oe.status)}`,children:se(oe.status)})]}),n.jsx("p",{className:"text-gray-600 text-sm mb-2",children:oe.description}),n.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[n.jsxs("span",{children:["المسؤول: ",((ct=(Ve=o.find(nt=>nt.student_id===oe.assigned_to))==null?void 0:Ve.student)==null?void 0:ct.name)||"غير محدد"]}),n.jsxs("span",{children:["الموعد النهائي: ",Ze(oe.due_date)]})]})]}),ce&&n.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Oa,{className:"w-4 h-4 text-gray-400"})})]}),oe.status==="in_progress"&&oe.progress&&n.jsxs("div",{className:"mt-3",children:[n.jsxs("div",{className:"flex items-center justify-between mb-1",children:[n.jsx("span",{className:"text-xs text-gray-600",children:"التقدم"}),n.jsxs("span",{className:"text-xs text-gray-600",children:[oe.progress,"%"]})]}),n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:n.jsx("div",{className:"h-2 bg-blue-500 rounded-full transition-all duration-300",style:{width:`${oe.progress}%`}})})]})]},oe.id)}):n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(ze,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا توجد مهام"}),n.jsx("p",{className:"text-gray-600",children:"لم يتم إضافة مهام لهذا المشروع بعد"})]})})]}),r==="team"&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"فريق العمل"}),ce&&n.jsxs("button",{onClick:()=>w(!0),className:"flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors",children:[n.jsx(gt,{className:"w-4 h-4"}),"إضافة عضو"]})]}),n.jsx("div",{className:"space-y-4",children:o.length>0?o.map(oe=>{var Ve,ct,nt,At;return n.jsxs("div",{className:"flex items-center gap-4 p-4 border border-gray-200 rounded-xl hover:shadow-md transition-all",children:[n.jsx("img",{src:((Ve=oe.student)==null?void 0:Ve.avatar_url)||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",alt:((ct=oe.student)==null?void 0:ct.name)||"طالب",className:"w-16 h-16 rounded-full object-cover"}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("h4",{className:"font-semibold text-gray-800",children:((nt=oe.student)==null?void 0:nt.name)||"طالب غير معروف"}),oe.role==="leader"&&n.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs font-medium rounded-full",children:"قائد الفريق"})]}),n.jsx("p",{className:"text-gray-600 text-sm",children:((At=oe.student)==null?void 0:At.email)||"بريد إلكتروني غير متوفر"}),n.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-500",children:[n.jsxs("span",{children:["المهام المكتملة: ",c.filter(Xt=>Xt.assigned_to===oe.student_id&&Xt.status==="completed").length]}),n.jsxs("span",{children:["المهام النشطة: ",c.filter(Xt=>Xt.assigned_to===oe.student_id&&Xt.status==="in_progress").length]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Ht,{className:"w-4 h-4 text-gray-400"})}),ce&&n.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Oa,{className:"w-4 h-4 text-gray-400"})})]})]},oe.id)}):n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(lt,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا يوجد طلاب"}),n.jsx("p",{className:"text-gray-600",children:"لم يتم إضافة طلاب لهذا المشروع بعد"})]})})]}),r==="resources"&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"الموارد"}),ce&&n.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors",children:[n.jsx(xi,{className:"w-4 h-4"}),"رفع ملف"]})]}),n.jsx("div",{className:"space-y-4",children:s.resources&&s.resources.length>0?s.resources.map(oe=>{var Ve,ct;return n.jsxs("div",{className:"flex items-center gap-4 p-4 border border-gray-200 rounded-xl hover:shadow-md transition-all",children:[n.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-xl flex items-center justify-center",children:D(oe.type)}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h4",{className:"font-semibold text-gray-800 mb-1",children:oe.title}),n.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[n.jsxs("span",{children:["رفع بواسطة: ",((ct=(Ve=o.find(nt=>nt.student_id===oe.uploaded_by))==null?void 0:Ve.student)==null?void 0:ct.name)||"غير معروف"]}),n.jsx("span",{children:Ze(oe.created_at)})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Tr,{className:"w-4 h-4 text-gray-400"})}),n.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(bs,{className:"w-4 h-4 text-gray-400"})})]})]},oe.id)}):n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(br,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا توجد موارد"}),n.jsx("p",{className:"text-gray-600",children:"لم يتم إضافة موارد لهذا المشروع بعد"})]})})]}),r==="chat"&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-6",children:"محادثة الفريق"}),n.jsx(PE,{projectId:t||""})]}),r==="evaluation"&&n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"space-y-6",children:L&&K?n.jsx(TE,{projectId:t||"",onSaved:me}):n.jsx(n.Fragment,{children:g?n.jsx("div",{className:"flex items-center justify-center p-8",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):p.length>0?n.jsx(OE,{evaluation:p[0],teacherName:s.teacher_name||"المعلم"}):n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(ar,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا يوجد تقييم"}),n.jsx("p",{className:"text-gray-600",children:"لم يتم تقييم المشروع بعد من قبل المعلم"})]})})})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.2},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"معلومات المشروع"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-gray-500 mb-1",children:"الحالة"}),n.jsx("div",{className:"mt-1",children:n.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:[n.jsx(pi,{className:"w-4 h-4"}),se(s.status)]})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-gray-500 mb-1",children:"الفئة"}),n.jsx("p",{className:"mt-1 text-gray-800",children:s.category==="stem"?"العلوم والتقنية":s.category==="entrepreneurship"?"ريادة الأعمال":s.category==="volunteer"?"التطوع":s.category==="ethics"?"الأخلاق":s.category})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-gray-500 mb-1",children:"الموضوع"}),n.jsx("p",{className:"mt-1 text-gray-800",children:s.subject})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-gray-500 mb-1",children:"تاريخ البداية"}),n.jsx("p",{className:"mt-1 text-gray-800",children:Ze(s.created_at)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-gray-500 mb-1",children:"الموعد النهائي"}),n.jsx("p",{className:"mt-1 text-gray-800",children:Ze(s.due_date)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-gray-500 mb-1",children:e("projectDetails.supervisorTeacher")}),n.jsx("p",{className:"mt-1 text-gray-800",children:s.teacher_id?((he=S.find(oe=>oe.id===s.teacher_id))==null?void 0:he.name)||"معلم غير معروف":"غير محدد"})]}),s.rating&&n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-gray-500 mb-1",children:"التقييم"}),n.jsxs("div",{className:"mt-1 flex items-center gap-1",children:[n.jsx("div",{className:"flex items-center",children:[1,2,3,4,5].map(oe=>n.jsx(at,{className:`w-5 h-5 ${oe<=s.rating?"text-yellow-400 fill-current":"text-gray-300"}`},oe))}),n.jsxs("span",{className:"text-gray-600 text-sm",children:["(",s.rating.toFixed(1),")"]})]})]})]})]}),ce&&n.jsxs(te.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.3},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"إجراءات سريعة"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("button",{onClick:()=>_(!0),className:"w-full flex items-center gap-3 px-4 py-3 text-right bg-blue-50 text-blue-700 rounded-xl hover:bg-blue-100 transition-colors",children:[n.jsx(gt,{className:"w-5 h-5"}),"إضافة مهمة جديدة"]}),n.jsxs("button",{onClick:()=>w(!0),className:"w-full flex items-center gap-3 px-4 py-3 text-right bg-green-50 text-green-700 rounded-xl hover:bg-green-100 transition-colors",children:[n.jsx(lt,{className:"w-5 h-5"}),"دعوة عضو جديد"]}),n.jsxs("button",{className:"w-full flex items-center gap-3 px-4 py-3 text-right bg-purple-50 text-purple-700 rounded-xl hover:bg-purple-100 transition-colors",children:[n.jsx(xi,{className:"w-5 h-5"}),"رفع ملف"]}),n.jsxs("button",{className:"w-full flex items-center gap-3 px-4 py-3 text-right bg-orange-50 text-orange-700 rounded-xl hover:bg-orange-100 transition-colors",children:[n.jsx(bs,{className:"w-5 h-5"}),"مشاركة المشروع"]}),L&&K&&n.jsxs("button",{onClick:()=>a("evaluation"),className:"w-full flex items-center gap-3 px-4 py-3 text-right bg-yellow-50 text-yellow-700 rounded-xl hover:bg-yellow-100 transition-colors",children:[n.jsx(ar,{className:"w-5 h-5"}),"تقييم المشروع"]})]})]}),n.jsxs(te.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.4},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"أعضاء الفريق"}),n.jsx("div",{className:"space-y-3",children:o.length>0?o.map(oe=>{var Ve,ct,nt;return n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("img",{src:((Ve=oe.student)==null?void 0:Ve.avatar_url)||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",alt:((ct=oe.student)==null?void 0:ct.name)||"طالب",className:"w-10 h-10 rounded-full object-cover"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium text-gray-800 text-sm",children:((nt=oe.student)==null?void 0:nt.name)||"طالب غير معروف"}),n.jsx("p",{className:"text-xs text-gray-500",children:oe.role==="leader"?"قائد الفريق":"عضو"})]}),n.jsx("button",{className:"p-1 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Ht,{className:"w-4 h-4 text-gray-400"})})]},oe.id)}):n.jsx("p",{className:"text-gray-600 text-center py-2",children:"لا يوجد أعضاء في الفريق"})})]})]})]}),y&&n.jsx(CE,{projectId:t||"",maxStudents:s.max_students||5,currentStudents:o,onClose:()=>w(!1),onSuccess:re}),v&&n.jsx(FE,{projectId:t||"",students:o,onClose:()=>_(!1),onSuccess:xe})]})},DE=()=>{var T,M;const{t:e}=yt(),t=Go(),{user:r}=vt(),{students:a}=Bx(),{createProject:s}=Ci(),[i,o]=O.useState(1),[l,c]=O.useState([]),[d,u]=O.useState(""),[f,h]=O.useState(!1),m=(r==null?void 0:r.role)==="student"?"draft":"active",[x,p]=O.useState({title:"",description:"",problemSolved:"",category:"",subject:"",difficulty:"",duration:"",objectives:[""],materials:[""],steps:[""],due_date:"",maxStudents:5,status:m,selectedStudentIds:[]});O.useEffect(()=>{p(A=>({...A,selectedStudentIds:l}))},[l]);const g=(A,F)=>{p(H=>({...H,[A]:F}))},y=(A,F,H)=>{p(V=>({...V,[A]:V[A].map((B,L)=>L===F?H:B)}))},w=A=>{p(F=>({...F,[A]:[...F[A],""]}))},v=(A,F)=>{p(H=>({...H,[A]:H[A].filter((V,B)=>B!==F)}))},_=A=>{c(F=>F.includes(A)?F.filter(H=>H!==A):C.length+F.length>=x.maxStudents?F:[...F,A])},b=async()=>{try{h(!0),await s({...x,progress:0,due_date:x.due_date}),t("/projects")}catch(A){console.error("Error creating project:",A),alert(e("createProject.errors.creationFailed"))}finally{h(!1)}},j=()=>{i<5&&o(i+1)},N=()=>{i>1&&o(i-1)},k=[{number:1,title:e("createProject.steps.basicInfo"),icon:br},{number:2,title:e("createProject.steps.detailsObjectives"),icon:od},{number:3,title:e("createProject.steps.materialsSteps"),icon:wt},{number:4,title:e("createProject.steps.finalSettings"),icon:tt},{number:5,title:e("createProject.steps.addStudents"),icon:lt}],S=[{id:"stem",name:e("projects.categories.stem"),description:e("createProject.categories.stemDesc")},{id:"entrepreneurship",name:e("projects.categories.entrepreneurship"),description:e("createProject.categories.entrepreneurshipDesc")},{id:"volunteer",name:e("projects.categories.volunteer"),description:e("createProject.categories.volunteerDesc")},{id:"ethics",name:e("projects.categories.ethics"),description:e("createProject.categories.ethicsDesc")}],E=[{id:"beginner",name:e("projectIdeas.difficulties.beginner"),description:e("createProject.difficulties.beginnerDesc")},{id:"intermediate",name:e("projectIdeas.difficulties.intermediate"),description:e("createProject.difficulties.intermediateDesc")},{id:"advanced",name:e("projectIdeas.difficulties.advanced"),description:e("createProject.difficulties.advancedDesc")}],P=a.filter(A=>A.name.toLowerCase().includes(d.toLowerCase())||A.email.toLowerCase().includes(d.toLowerCase())),C=[];return n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx(Ee,{to:"/projects",className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Jn,{className:"w-6 h-6 text-gray-600"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:e("createProject.title")}),n.jsx("p",{className:"text-gray-600",children:e("createProject.subtitle")})]})]}),n.jsx("div",{className:"flex items-center justify-between mb-6",children:k.map((A,F)=>n.jsxs("div",{className:"flex items-center",children:[n.jsxs("div",{className:`flex items-center gap-3 ${F<k.length-1?"flex-1":""}`,children:[n.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${i>=A.number?"bg-blue-500 text-white":"bg-gray-200 text-gray-600"}`,children:n.jsx(A.icon,{className:"w-6 h-6"})}),n.jsx("div",{className:"hidden md:block",children:n.jsx("p",{className:`font-medium ${i>=A.number?"text-blue-600":"text-gray-600"}`,children:A.title})})]}),F<k.length-1&&n.jsx("div",{className:`hidden md:block flex-1 h-1 mx-4 ${i>A.number?"bg-blue-500":"bg-gray-200"}`})]},A.number))})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl shadow-lg p-6",children:[i===1&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("createProject.steps.basicInfo")}),n.jsx("p",{className:"text-gray-600",children:e("createProject.startWithBasicInfo")})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.title")," *"]}),n.jsx("input",{type:"text",value:x.title,onChange:A=>g("title",A.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("createProject.form.titlePlaceholder")})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.description")," *"]}),n.jsx("textarea",{value:x.description,onChange:A=>g("description",A.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("createProject.form.descriptionPlaceholder")})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.problemSolved")}),n.jsx("textarea",{value:x.problemSolved,onChange:A=>g("problemSolved",A.target.value),rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("createProject.form.problemSolvedPlaceholder")})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.category")," *"]}),n.jsx("div",{className:"space-y-2",children:S.map(A=>n.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[n.jsx("input",{type:"radio",name:"category",value:A.id,checked:x.category===A.id,onChange:F=>g("category",F.target.value),className:"text-blue-600"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:A.name}),n.jsx("p",{className:"text-sm text-gray-600",children:A.description})]})]},A.id))})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.subject")," *"]}),n.jsx("input",{type:"text",value:x.subject,onChange:A=>g("subject",A.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("createProject.form.subjectPlaceholder")}),n.jsxs("div",{className:"mt-4",children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.difficulty")," *"]}),n.jsx("div",{className:"space-y-2",children:E.map(A=>n.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[n.jsx("input",{type:"radio",name:"difficulty",value:A.id,checked:x.difficulty===A.id,onChange:F=>g("difficulty",F.target.value),className:"text-blue-600"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:A.name}),n.jsx("p",{className:"text-sm text-gray-600",children:A.description})]})]},A.id))})]})]})]})]}),i===2&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("createProject.steps.detailsObjectives")}),n.jsx("p",{className:"text-gray-600",children:e("createProject.defineObjectives")})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.duration")," *"]}),n.jsx("input",{type:"text",value:x.duration,onChange:A=>g("duration",A.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("createProject.form.durationPlaceholder")})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.maxStudents")}),n.jsx("input",{type:"number",value:x.maxStudents,onChange:A=>g("maxStudents",parseInt(A.target.value)),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"1",max:"20"})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.objectives")," *"]}),n.jsxs("div",{className:"space-y-3",children:[x.objectives.map((A,F)=>n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"text",value:A,onChange:H=>y("objectives",F,H.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`${e("createProject.form.objective")} ${F+1}`}),x.objectives.length>1&&n.jsx("button",{onClick:()=>v("objectives",F),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(Pt,{className:"w-5 h-5"})})]},F)),n.jsxs("button",{onClick:()=>w("objectives"),className:"flex items-center gap-2 px-4 py-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",children:[n.jsx(gt,{className:"w-4 h-4"}),e("createProject.form.addNewObjective")]})]})]})]}),i===3&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("createProject.steps.materialsSteps")}),n.jsx("p",{className:"text-gray-600",children:e("createProject.defineMaterialsSteps")})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.materials")}),n.jsxs("div",{className:"space-y-3",children:[x.materials.map((A,F)=>n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"text",value:A,onChange:H=>y("materials",F,H.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`${e("createProject.form.material")} ${F+1}`}),x.materials.length>1&&n.jsx("button",{onClick:()=>v("materials",F),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(Pt,{className:"w-5 h-5"})})]},F)),n.jsxs("button",{onClick:()=>w("materials"),className:"flex items-center gap-2 px-4 py-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",children:[n.jsx(gt,{className:"w-4 h-4"}),e("createProject.form.addNewMaterial")]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.implementationSteps")}),n.jsxs("div",{className:"space-y-3",children:[x.steps.map((A,F)=>n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-8 h-8 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-sm font-medium mt-2",children:F+1}),n.jsx("textarea",{value:A,onChange:H=>y("steps",F,H.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`${e("createProject.form.step")} ${F+1}`,rows:2}),x.steps.length>1&&n.jsx("button",{onClick:()=>v("steps",F),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors mt-2",children:n.jsx(Pt,{className:"w-5 h-5"})})]},F)),n.jsxs("button",{onClick:()=>w("steps"),className:"flex items-center gap-2 px-4 py-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",children:[n.jsx(gt,{className:"w-4 h-4"}),e("createProject.form.addNewStep")]})]})]})]}),i===4&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("createProject.steps.finalSettings")}),n.jsx("p",{className:"text-gray-600",children:e("createProject.setDeadlineStatus")})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.deadline")}),n.jsx("input",{type:"date",value:x.due_date,onChange:A=>g("due_date",A.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.status")}),n.jsxs("select",{value:x.status,onChange:A=>g("status",A.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:!0,children:[n.jsx("option",{value:"draft",children:e("projects.statuses.draft")}),n.jsx("option",{value:"active",children:e("projects.statuses.active")})]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:e("createProject.projectSummary")}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("common.title"),":"]}),n.jsx("span",{className:"font-medium",children:x.title||e("createProject.notSpecified")})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("common.category"),":"]}),n.jsx("span",{className:"font-medium",children:((T=S.find(A=>A.id===x.category))==null?void 0:T.name)||e("createProject.notSpecified")})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.form.difficulty"),":"]}),n.jsx("span",{className:"font-medium",children:((M=E.find(A=>A.id===x.difficulty))==null?void 0:M.name)||e("createProject.notSpecified")})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.form.duration"),":"]}),n.jsx("span",{className:"font-medium",children:x.duration||e("createProject.notSpecified")})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.objectivesCount"),":"]}),n.jsx("span",{className:"font-medium",children:x.objectives.filter(A=>A.trim()).length})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.materialsCount"),":"]}),n.jsx("span",{className:"font-medium",children:x.materials.filter(A=>A.trim()).length})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.stepsCount"),":"]}),n.jsx("span",{className:"font-medium",children:x.steps.filter(A=>A.trim()).length})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.initialProgress"),":"]}),n.jsx("span",{className:"font-medium",children:"0/10"})]})]})]})]}),i===5&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("createProject.steps.addStudents")}),n.jsx("p",{className:"text-gray-600",children:e("createProject.chooseParticipatingStudents")})]}),n.jsxs("div",{className:"relative",children:[n.jsx(ut,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("createProject.searchStudentsPlaceholder"),value:d,onChange:A=>u(A.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.length>0&&n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-blue-800 font-medium",children:e("createProject.selectedStudents",{count:l.length,max:x.maxStudents})}),n.jsx("button",{onClick:()=>c([]),className:"text-blue-600 hover:text-blue-800 text-sm",children:e("common.clearAll")})]})}),n.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:P.length>0?P.map(A=>n.jsxs("div",{className:`flex items-center gap-4 p-4 border rounded-xl transition-all cursor-pointer hover:shadow-md ${l.includes(A.id)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>_(A.id),children:[n.jsx("input",{type:"checkbox",checked:l.includes(A.id),onChange:()=>_(A.id),disabled:!l.includes(A.id)&&C.length+l.length>=x.maxStudents,className:"text-blue-600"}),n.jsx("img",{src:A.avatar_url||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",alt:A.name,className:"w-12 h-12 rounded-full object-cover"}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("h3",{className:"font-semibold text-gray-800",children:A.name}),l.includes(A.id)&&n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:e("createProject.selected")})]}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Ta,{className:"w-4 h-4"}),A.email]}),A.grade&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(js,{className:"w-4 h-4"}),A.grade]})]})]})]},A.id)):n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(lt,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:e("createProject.noStudents")}),n.jsx("p",{className:"text-gray-600",children:e(d?"createProject.noStudentsMatch":"createProject.noStudentsAvailable")})]})}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsxs("h4",{className:"font-medium text-gray-800 mb-2",children:[e("createProject.importantInfo"),":"]}),n.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[n.jsxs("li",{children:["• ",e("createProject.onlySchoolStudents")]}),n.jsxs("li",{children:["• ",e("createProject.canAddUpTo",{max:x.maxStudents})]}),n.jsxs("li",{children:["• ",e("createProject.canModifyLater")]}),n.jsxs("li",{children:["• ",e("createProject.searchIncludesNameEmail")]})]})]})]}),n.jsxs("div",{className:"flex justify-between pt-6 border-t border-gray-200",children:[n.jsx("div",{children:i>1&&n.jsx("button",{onClick:N,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("common.previous")})}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx(Ee,{to:"/projects",className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("common.cancel")}),i<5?n.jsx("button",{onClick:j,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:e("common.next")}):n.jsxs("button",{onClick:b,disabled:f,className:"px-6 py-3 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(Zn,{className:"w-5 h-5"}),e(f?"createProject.creating":"createProject.createProject")]})]})]})]})]})},RE=()=>{var V,B;const{t:e}=yt(),t=Go(),{id:r}=Rj(),{user:a}=vt(),{students:s}=Bx(),{updateProject:i}=Ci(),[o,l]=O.useState(1),[c,d]=O.useState([]),[u,f]=O.useState([]),[h,m]=O.useState(""),[x,p]=O.useState(!0),[g,y]=O.useState(null),[w,v]=O.useState([]);a==null||a.role,a==null||a.role,a==null||a.role,a==null||a.role;const[_,b]=O.useState({title:"",description:"",category:"",subject:"",difficulty:"",duration:"",objectives:[""],materials:[""],steps:[""],due_date:"",maxStudents:5,status:"draft",selectedStudentIds:[]});O.useEffect(()=>{(async()=>{var ee,I,K;if(!r){y("Project ID is missing"),p(!1);return}try{p(!0),y(null);const z=await Kj(r);if(!z){y("المشروع غير موجود"),p(!1);return}const W=await lc(r);v(W);const re=W.map(me=>me.student_id);f(re);let xe="";z.due_date&&(xe=new Date(z.due_date).toISOString().split("T")[0]),b({title:z.title||"",description:z.description||"",category:z.category||"",subject:z.subject||"",difficulty:z.difficulty||"",duration:z.duration||"",objectives:(ee=z.objectives)!=null&&ee.length?z.objectives:[""],materials:(I=z.materials)!=null&&I.length?z.materials:[""],steps:(K=z.steps)!=null&&K.length?z.steps:[""],due_date:xe,maxStudents:z.max_students||5,status:z.status||"draft",selectedStudentIds:re}),p(!1)}catch(z){console.error("Error fetching project data:",z),y(z instanceof Error?z.message:"حدث خطأ في تحميل بيانات المشروع"),p(!1)}})()},[r]),O.useEffect(()=>{if(a&&a.school_id&&s.length>0){const L=s.filter(ee=>ee.school_id===a.school_id);d(L)}},[a,s]),O.useEffect(()=>{b(L=>({...L,selectedStudentIds:u}))},[u]);const j=(L,ee)=>{b(I=>({...I,[L]:ee}))},N=(L,ee,I)=>{b(K=>({...K,[L]:K[L].map((z,W)=>W===ee?I:z)}))},k=L=>{b(ee=>({...ee,[L]:[...ee[L],""]}))},S=(L,ee)=>{b(I=>({...I,[L]:I[L].filter((K,z)=>z!==ee)}))},E=L=>{f(ee=>ee.includes(L)?ee.filter(I=>I!==L):ee.length>=_.maxStudents?(alert(`لا يمكن إضافة أكثر من ${_.maxStudents} طلاب لهذا المشروع`),ee):[...ee,L])},P=async()=>{var L,ee,I;if(!r){y("Project ID is missing");return}try{p(!0),y(null);const K={..._,objectives:((L=_.objectives)==null?void 0:L.filter(z=>z.trim()))||[],materials:((ee=_.materials)==null?void 0:ee.filter(z=>z.trim()))||[],steps:((I=_.steps)==null?void 0:I.filter(z=>z.trim()))||[],max_students:_.maxStudents,selectedStudentIds:u};await i(r,K),t("/projects")}catch(K){console.error("Error updating project:",K),y(K instanceof Error?K.message:"حدث خطأ في تحديث المشروع"),p(!1)}},C=()=>{o<5&&l(o+1)},T=()=>{o>1&&l(o-1)},M=[{number:1,title:e("createProject.steps.basicInfo"),icon:br},{number:2,title:e("createProject.steps.detailsObjectives"),icon:od},{number:3,title:e("createProject.steps.materialsSteps"),icon:wt},{number:4,title:e("createProject.steps.finalSettings"),icon:tt},{number:5,title:e("createProject.steps.addStudents"),icon:lt}],A=[{id:"stem",name:e("projects.categories.stem"),description:e("createProject.categories.stemDesc")},{id:"entrepreneurship",name:e("projects.categories.entrepreneurship"),description:e("createProject.categories.entrepreneurshipDesc")},{id:"volunteer",name:e("projects.categories.volunteer"),description:e("createProject.categories.volunteerDesc")},{id:"ethics",name:e("projects.categories.ethics"),description:e("createProject.categories.ethicsDesc")}],F=[{id:"beginner",name:e("projectIdeas.difficulties.beginner"),description:e("createProject.difficulties.beginnerDesc")},{id:"intermediate",name:e("projectIdeas.difficulties.intermediate"),description:e("createProject.difficulties.intermediateDesc")},{id:"advanced",name:e("projectIdeas.difficulties.advanced"),description:e("createProject.difficulties.advancedDesc")}],H=c.filter(L=>{var ee,I;return((ee=L.name)==null?void 0:ee.toLowerCase().includes(h.toLowerCase()))||((I=L.email)==null?void 0:I.toLowerCase().includes(h.toLowerCase()))||L.grade&&L.grade.toLowerCase().includes(h.toLowerCase())});return x?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):g?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(oa,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:g}),n.jsx(Ee,{to:"/projects",className:"mt-4 inline-block px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:"العودة إلى المشاريع"})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx(Ee,{to:"/projects",className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Jn,{className:"w-6 h-6 text-gray-600"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:e("editProject.title")}),n.jsx("p",{className:"text-gray-600",children:e("editProject.subtitle")})]})]}),n.jsx("div",{className:"flex items-center justify-between mb-6",children:M.map((L,ee)=>n.jsxs("div",{className:"flex items-center",children:[n.jsxs("div",{className:`flex items-center gap-3 ${ee<M.length-1?"flex-1":""}`,children:[n.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${o>=L.number?"bg-blue-500 text-white":"bg-gray-200 text-gray-600"}`,children:n.jsx(L.icon,{className:"w-6 h-6"})}),n.jsx("div",{className:"hidden md:block",children:n.jsx("p",{className:`font-medium ${o>=L.number?"text-blue-600":"text-gray-600"}`,children:L.title})})]}),ee<M.length-1&&n.jsx("div",{className:`hidden md:block flex-1 h-1 mx-4 ${o>L.number?"bg-blue-500":"bg-gray-200"}`})]},L.number))})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl shadow-lg p-6",children:[o===1&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("createProject.steps.basicInfo")}),n.jsx("p",{className:"text-gray-600",children:e("editProject.modifyBasicInfo")})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.title")," *"]}),n.jsx("input",{type:"text",value:_.title,onChange:L=>j("title",L.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("createProject.form.titlePlaceholder")})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.description")," *"]}),n.jsx("textarea",{value:_.description,onChange:L=>j("description",L.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("createProject.form.descriptionPlaceholder")})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.category")," *"]}),n.jsx("div",{className:"space-y-2",children:A.map(L=>n.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[n.jsx("input",{type:"radio",name:"category",value:L.id,checked:_.category===L.id,onChange:ee=>j("category",ee.target.value),className:"text-blue-600"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:L.name}),n.jsx("p",{className:"text-sm text-gray-600",children:L.description})]})]},L.id))})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.subject")," *"]}),n.jsx("input",{type:"text",value:_.subject,onChange:L=>j("subject",L.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("createProject.form.subjectPlaceholder")}),n.jsxs("div",{className:"mt-4",children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.difficulty")," *"]}),n.jsx("div",{className:"space-y-2",children:F.map(L=>n.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[n.jsx("input",{type:"radio",name:"difficulty",value:L.id,checked:_.difficulty===L.id,onChange:ee=>j("difficulty",ee.target.value),className:"text-blue-600"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:L.name}),n.jsx("p",{className:"text-sm text-gray-600",children:L.description})]})]},L.id))})]})]})]})]}),o===2&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("createProject.steps.detailsObjectives")}),n.jsx("p",{className:"text-gray-600",children:e("editProject.modifyObjectives")})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.duration")," *"]}),n.jsx("input",{type:"text",value:_.duration,onChange:L=>j("duration",L.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("createProject.form.durationPlaceholder")})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.maxStudents")}),n.jsx("input",{type:"number",value:_.maxStudents,onChange:L=>j("maxStudents",parseInt(L.target.value)),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"1",max:"20"})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.objectives")," *"]}),n.jsxs("div",{className:"space-y-3",children:[_.objectives.map((L,ee)=>n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"text",value:L,onChange:I=>N("objectives",ee,I.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`${e("createProject.form.objective")} ${ee+1}`}),_.objectives.length>1&&n.jsx("button",{onClick:()=>S("objectives",ee),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(Pt,{className:"w-5 h-5"})})]},ee)),n.jsxs("button",{onClick:()=>k("objectives"),className:"flex items-center gap-2 px-4 py-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",children:[n.jsx(gt,{className:"w-4 h-4"}),e("createProject.form.addNewObjective")]})]})]})]}),o===3&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("createProject.steps.materialsSteps")}),n.jsx("p",{className:"text-gray-600",children:e("editProject.modifyMaterialsSteps")})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.materials")}),n.jsxs("div",{className:"space-y-3",children:[_.materials.map((L,ee)=>n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"text",value:L,onChange:I=>N("materials",ee,I.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`${e("createProject.form.material")} ${ee+1}`}),_.materials.length>1&&n.jsx("button",{onClick:()=>S("materials",ee),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(Pt,{className:"w-5 h-5"})})]},ee)),n.jsxs("button",{onClick:()=>k("materials"),className:"flex items-center gap-2 px-4 py-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",children:[n.jsx(gt,{className:"w-4 h-4"}),e("createProject.form.addNewMaterial")]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.implementationSteps")}),n.jsxs("div",{className:"space-y-3",children:[_.steps.map((L,ee)=>n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-8 h-8 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-sm font-medium mt-2",children:ee+1}),n.jsx("textarea",{value:L,onChange:I=>N("steps",ee,I.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`${e("createProject.form.step")} ${ee+1}`,rows:2}),_.steps.length>1&&n.jsx("button",{onClick:()=>S("steps",ee),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors mt-2",children:n.jsx(Pt,{className:"w-5 h-5"})})]},ee)),n.jsxs("button",{onClick:()=>k("steps"),className:"flex items-center gap-2 px-4 py-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",children:[n.jsx(gt,{className:"w-4 h-4"}),e("createProject.form.addNewStep")]})]})]})]}),o===4&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("createProject.steps.finalSettings")}),n.jsx("p",{className:"text-gray-600",children:e("editProject.modifyDeadlineStatus")})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.deadline")}),n.jsx("input",{type:"date",value:_.due_date,onChange:L=>j("due_date",L.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.status")}),n.jsxs("select",{value:_.status,onChange:L=>j("status",L.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:!0,children:[n.jsx("option",{value:"draft",children:e("projects.statuses.draft")}),n.jsx("option",{value:"active",children:e("projects.statuses.active")}),n.jsx("option",{value:"completed",children:e("projects.statuses.completed")}),n.jsx("option",{value:"archived",children:e("projects.statuses.archived")})]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:e("createProject.projectSummary")}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("common.title"),":"]}),n.jsx("span",{className:"font-medium",children:_.title||e("createProject.notSpecified")})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("common.category"),":"]}),n.jsx("span",{className:"font-medium",children:((V=A.find(L=>L.id===_.category))==null?void 0:V.name)||e("createProject.notSpecified")})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.form.difficulty"),":"]}),n.jsx("span",{className:"font-medium",children:((B=F.find(L=>L.id===_.difficulty))==null?void 0:B.name)||e("createProject.notSpecified")})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.form.duration"),":"]}),n.jsx("span",{className:"font-medium",children:_.duration||e("createProject.notSpecified")})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.objectivesCount"),":"]}),n.jsx("span",{className:"font-medium",children:_.objectives.filter(L=>L.trim()).length})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.materialsCount"),":"]}),n.jsx("span",{className:"font-medium",children:_.materials.filter(L=>L.trim()).length})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.stepsCount"),":"]}),n.jsx("span",{className:"font-medium",children:_.steps.filter(L=>L.trim()).length})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("editProject.studentsCount"),":"]}),n.jsxs("span",{className:"font-medium",children:[u.length," ",e("editProject.outOf")," ",_.maxStudents]})]})]})]})]}),o===5&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("editProject.manageStudents")}),n.jsx("p",{className:"text-gray-600",children:e("editProject.addRemoveStudents")})]}),n.jsxs("div",{className:"relative",children:[n.jsx(ut,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("createProject.searchStudentsPlaceholder"),value:h,onChange:L=>m(L.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),u.length>0&&n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-blue-800 font-medium",children:e("createProject.selectedStudents",{count:u.length,max:_.maxStudents})}),n.jsx("button",{onClick:()=>f([]),className:"text-blue-600 hover:text-blue-800 text-sm",children:e("common.clearAll")})]})}),n.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:H.length>0?H.map(L=>n.jsxs("div",{className:`flex items-center gap-4 p-4 border rounded-xl transition-all cursor-pointer hover:shadow-md ${u.includes(L.id)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>E(L.id),children:[n.jsx("input",{type:"checkbox",checked:u.includes(L.id),onChange:()=>E(L.id),disabled:!u.includes(L.id)&&u.length>=_.maxStudents,className:"text-blue-600"}),n.jsx("img",{src:L.avatar_url||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",alt:L.name,className:"w-12 h-12 rounded-full object-cover"}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("h3",{className:"font-semibold text-gray-800",children:L.name}),u.includes(L.id)&&n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:e("createProject.selected")})]}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Ta,{className:"w-4 h-4"}),L.email]}),L.grade&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(xr,{className:"w-4 h-4"}),L.grade]})]})]})]},L.id)):n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(lt,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:e("createProject.noStudents")}),n.jsx("p",{className:"text-gray-600",children:e(h?"createProject.noStudentsMatch":"createProject.noStudentsAvailable")})]})}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsxs("h4",{className:"font-medium text-gray-800 mb-2",children:[e("createProject.importantInfo"),":"]}),n.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[n.jsxs("li",{children:["• ",e("createProject.onlySchoolStudents")]}),n.jsxs("li",{children:["• ",e("createProject.canAddUpTo",{max:_.maxStudents})]}),n.jsxs("li",{children:["• ",e("editProject.changesWillAffect")]}),n.jsxs("li",{children:["• ",e("createProject.searchIncludesNameEmail")]})]})]})]}),n.jsxs("div",{className:"flex justify-between pt-6 border-t border-gray-200",children:[n.jsx("div",{children:o>1&&n.jsx("button",{onClick:T,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("common.previous")})}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx(Ee,{to:"/projects",className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("common.cancel")}),o<5?n.jsx("button",{onClick:C,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:e("common.next")}):n.jsxs("button",{onClick:P,disabled:x,className:"px-6 py-3 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(Zn,{className:"w-5 h-5"}),e(x?"editProject.saving":"editProject.saveChanges")]})]})]})]})]})},Ux=()=>{const[e,t]=O.useState([]),[r,a]=O.useState(!0),[s,i]=O.useState(null),{user:o}=vt(),l=(o==null?void 0:o.role)==="admin",c=async()=>{try{a(!0),i(null);const g=l?await I6():await F6();t(g)}catch(g){console.error("Error fetching project ideas:",g),i(g instanceof Error?g.message:"حدث خطأ في تحميل أفكار المشاريع")}finally{a(!1)}},d=async g=>{try{a(!0),i(null);const y={...g,views:0,downloads:0,rating:4.5,status:"pending"},w=await D6(y);return l&&t(v=>[w,...v]),w}catch(y){throw console.error("Error adding project idea:",y),i(y instanceof Error?y.message:"حدث خطأ في إضافة فكرة المشروع"),y}finally{a(!1)}},u=async(g,y)=>{try{return a(!0),i(null),await R6(g,y),t(w=>w.map(v=>v.id===g?{...v,...y}:v)),!0}catch(w){throw console.error("Error updating project idea:",w),i(w instanceof Error?w.message:"حدث خطأ في تحديث فكرة المشروع"),w}finally{a(!1)}},f=async g=>{try{return a(!0),i(null),await M6(g),t(y=>y.filter(w=>w.id!==g)),!0}catch(y){throw console.error("Error deleting project idea:",y),i(y instanceof Error?y.message:"حدث خطأ في حذف فكرة المشروع"),y}finally{a(!1)}},h=async g=>{try{await $6(g),t(y=>y.map(w=>w.id===g?{...w,views:w.views+1}:w))}catch(y){console.error("Error incrementing views:",y)}},m=async g=>{try{await L6(g),t(y=>y.map(w=>w.id===g?{...w,downloads:w.downloads+1}:w))}catch(y){console.error("Error incrementing downloads:",y)}},x=async g=>{if(!l)throw new Error("Only admins can approve ideas");return await u(g,{status:"approved"})},p=async(g,y)=>{if(!l)throw new Error("Only admins can reject ideas");return await u(g,{status:"rejected",feedback:y})};return O.useEffect(()=>{c()},[l]),{projectIdeas:e,loading:r,error:s,fetchProjectIdeas:c,addIdea:d,editIdea:u,removeIdea:f,incrementViews:h,incrementDownloads:m,approveIdea:x,rejectIdea:p,isAdmin:l}},t2=({isOpen:e,onClose:t,onSubmit:r,editingIdea:a})=>{var v,_,b,j;const[s,i]=O.useState({title:"",description:"",category:"stem",difficulty:"beginner",duration:"",subject:"",image:"",objectives:[""],materials:[""],steps:[""],tags:[]}),[o,l]=O.useState(""),[c,d]=O.useState(!1),[u,f]=O.useState(null);O.useEffect(()=>{var N,k,S;i(a?{...a,objectives:(N=a.objectives)!=null&&N.length?a.objectives:[""],materials:(k=a.materials)!=null&&k.length?a.materials:[""],steps:(S=a.steps)!=null&&S.length?a.steps:[""],tags:a.tags||[]}:{title:"",description:"",category:"stem",difficulty:"beginner",duration:"",subject:"",image:"",objectives:[""],materials:[""],steps:[""],tags:[]}),l(""),f(null)},[a,e]);const h=(N,k)=>{i(S=>({...S,[N]:k}))},m=(N,k,S)=>{i(E=>{var P;return{...E,[N]:(P=E[N])==null?void 0:P.map((C,T)=>T===k?S:C)}})},x=N=>{i(k=>({...k,[N]:[...k[N]||[],""]}))},p=(N,k)=>{i(S=>{var E;return{...S,[N]:(E=S[N])==null?void 0:E.filter((P,C)=>C!==k)}})},g=()=>{o.trim()&&(i(N=>({...N,tags:[...N.tags||[],o.trim()]})),l(""))},y=N=>{i(k=>{var S;return{...k,tags:(S=k.tags)==null?void 0:S.filter((E,P)=>P!==N)}})},w=async N=>{var S,E,P;if(N.preventDefault(),!s.title||!s.description||!s.category||!s.difficulty){f("يرجى ملء جميع الحقول المطلوبة");return}const k={...s,objectives:((S=s.objectives)==null?void 0:S.filter(C=>C.trim()))||[],materials:((E=s.materials)==null?void 0:E.filter(C=>C.trim()))||[],steps:((P=s.steps)==null?void 0:P.filter(C=>C.trim()))||[]};d(!0),f(null);try{await r(k),t()}catch(C){console.error("Error submitting idea:",C),f(C instanceof Error?C.message:"حدث خطأ في حفظ فكرة المشروع")}finally{d(!1)}};return e?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(xa,{className:"w-6 h-6 text-blue-600"}),a?"تعديل فكرة مشروع":"إضافة فكرة مشروع جديدة"]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Pt,{className:"w-5 h-5 text-gray-600"})})]}),u&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(pt,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:u})]}),n.jsxs("form",{onSubmit:w,className:"space-y-6",children:[n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"عنوان المشروع *"}),n.jsx("input",{type:"text",value:s.title,onChange:N=>h("title",N.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل عنوان المشروع",required:!0})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"وصف المشروع *"}),n.jsx("textarea",{value:s.description,onChange:N=>h("description",N.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"اكتب وصفاً شاملاً للمشروع وأهدافه",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"فئة المشروع *"}),n.jsxs("select",{value:s.category,onChange:N=>h("category",N.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[n.jsx("option",{value:"stem",children:"العلوم والتقنية"}),n.jsx("option",{value:"entrepreneurship",children:"ريادة الأعمال"}),n.jsx("option",{value:"volunteer",children:"التطوع"}),n.jsx("option",{value:"ethics",children:"الأخلاق"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"مستوى الصعوبة *"}),n.jsxs("select",{value:s.difficulty,onChange:N=>h("difficulty",N.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[n.jsx("option",{value:"beginner",children:"مبتدئ"}),n.jsx("option",{value:"intermediate",children:"متوسط"}),n.jsx("option",{value:"advanced",children:"متقدم"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المدة المتوقعة"}),n.jsxs("div",{className:"relative",children:[n.jsx(jt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:s.duration,onChange:N=>h("duration",N.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"مثال: 6-8 أسابيع"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الموضوع/المادة"}),n.jsxs("div",{className:"relative",children:[n.jsx(wt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:s.subject,onChange:N=>h("subject",N.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"مثال: الفيزياء، البرمجة، التسويق"})]})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رابط الصورة"}),n.jsxs("div",{className:"relative",children:[n.jsx(ld,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"url",value:s.image,onChange:N=>h("image",N.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل رابط صورة المشروع"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"أهداف المشروع"}),n.jsxs("div",{className:"space-y-3",children:[(v=s.objectives)==null?void 0:v.map((N,k)=>n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-8 h-8 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-sm font-medium",children:k+1}),n.jsx("input",{type:"text",value:N,onChange:S=>m("objectives",k,S.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`الهدف ${k+1}`}),s.objectives.length>1&&n.jsx("button",{type:"button",onClick:()=>p("objectives",k),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(ir,{className:"w-5 h-5"})})]},k)),n.jsxs("button",{type:"button",onClick:()=>x("objectives"),className:"flex items-center gap-2 px-4 py-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",children:[n.jsx(gt,{className:"w-4 h-4"}),"إضافة هدف جديد"]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المواد والأدوات المطلوبة"}),n.jsxs("div",{className:"space-y-3",children:[(_=s.materials)==null?void 0:_.map((N,k)=>n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"text",value:N,onChange:S=>m("materials",k,S.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`المادة ${k+1}`}),s.materials.length>1&&n.jsx("button",{type:"button",onClick:()=>p("materials",k),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(ir,{className:"w-5 h-5"})})]},k)),n.jsxs("button",{type:"button",onClick:()=>x("materials"),className:"flex items-center gap-2 px-4 py-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",children:[n.jsx(gt,{className:"w-4 h-4"}),"إضافة مادة جديدة"]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"خطوات تنفيذ المشروع"}),n.jsxs("div",{className:"space-y-3",children:[(b=s.steps)==null?void 0:b.map((N,k)=>n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-8 h-8 bg-green-100 text-green-600 rounded-full flex items-center justify-center text-sm font-medium mt-2",children:k+1}),n.jsx("textarea",{value:N,onChange:S=>m("steps",k,S.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`الخطوة ${k+1}`,rows:2}),s.steps.length>1&&n.jsx("button",{type:"button",onClick:()=>p("steps",k),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors mt-2",children:n.jsx(ir,{className:"w-5 h-5"})})]},k)),n.jsxs("button",{type:"button",onClick:()=>x("steps"),className:"flex items-center gap-2 px-4 py-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",children:[n.jsx(gt,{className:"w-4 h-4"}),"إضافة خطوة جديدة"]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الكلمات المفتاحية"}),n.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:(j=s.tags)==null?void 0:j.map((N,k)=>n.jsxs("div",{className:"flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-800 rounded-full",children:[n.jsx("span",{children:N}),n.jsx("button",{type:"button",onClick:()=>y(k),className:"w-4 h-4 rounded-full flex items-center justify-center hover:bg-blue-200",children:n.jsx(Pt,{className:"w-3 h-3"})})]},k))}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(cd,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:o,onChange:N=>l(N.target.value),onKeyPress:N=>N.key==="Enter"&&(N.preventDefault(),g()),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أضف كلمة مفتاحية"})]}),n.jsx("button",{type:"button",onClick:g,className:"px-4 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:"إضافة"})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[n.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{type:"submit",disabled:c,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:c?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الحفظ..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Zn,{className:"w-5 h-5"}),a?"حفظ التغييرات":"إضافة المشروع"]})})]})]})]})}):null},ME=()=>{const{t:e}=yt(),{user:t}=vt(),r=(t==null?void 0:t.role)==="admin",{projectIdeas:a,loading:s,error:i,addIdea:o,incrementViews:l,incrementDownloads:c}=Ux(),[d,u]=O.useState("all"),[f,h]=O.useState("all"),[m,x]=O.useState(""),[p,g]=O.useState(!1),[y,w]=O.useState(null),[v,_]=O.useState(!1),[b,j]=O.useState(!1),N=[{id:"all",name:e("projectIdeas.categories.all"),icon:wt,color:"from-gray-500 to-gray-600"},{id:"stem",name:e("projectIdeas.categories.stem"),icon:r6,color:"from-blue-500 to-blue-600"},{id:"entrepreneurship",name:e("projectIdeas.categories.entrepreneurship"),icon:hi,color:"from-green-500 to-green-600"},{id:"volunteer",name:e("projectIdeas.categories.volunteer"),icon:fa,color:"from-red-500 to-red-600"},{id:"ethics",name:e("projectIdeas.categories.ethics"),icon:Ga,color:"from-purple-500 to-purple-600"}],k=[{id:"all",name:e("projectIdeas.difficulties.all")},{id:"beginner",name:e("projectIdeas.difficulties.beginner")},{id:"intermediate",name:e("projectIdeas.difficulties.intermediate")},{id:"advanced",name:e("projectIdeas.difficulties.advanced")}],S=a.filter(F=>{if(!r&&F.status!=="approved")return!1;const H=d==="all"||F.category===d,V=f==="all"||F.difficulty===f,B=F.title.toLowerCase().includes(m.toLowerCase())||F.description.toLowerCase().includes(m.toLowerCase());return H&&V&&B}),E=async F=>{try{await l(F);const H=a.find(V=>V.id===F);H&&w(H)}catch(H){console.error("Error incrementing views:",H)}},P=async F=>{var H,V,B,L;try{await c(F);const ee=a.find(I=>I.id===F);if(ee){const I=`
# ${ee.title}

## الوصف
${ee.description}

## الفئة
${A(ee.category)}

## مستوى الصعوبة
${M(ee.difficulty)}

## المدة المتوقعة
${ee.duration||"غير محدد"}

## الموضوع/المادة
${ee.subject||"غير محدد"}

## الأهداف
${((H=ee.objectives)==null?void 0:H.map(re=>`- ${re}`).join(`
`))||"لا توجد أهداف محددة"}

## المواد المطلوبة
${((V=ee.materials)==null?void 0:V.map(re=>`- ${re}`).join(`
`))||"لا توجد مواد محددة"}

## خطوات التنفيذ
${((B=ee.steps)==null?void 0:B.map((re,xe)=>`${xe+1}. ${re}`).join(`
`))||"لا توجد خطوات محددة"}

## الكلمات المفتاحية
${((L=ee.tags)==null?void 0:L.map(re=>`#${re}`).join(" "))||"لا توجد كلمات مفتاحية"}
        `,K=new Blob([I],{type:"text/plain;charset=utf-8"}),z=URL.createObjectURL(K),W=document.createElement("a");W.href=z,W.download=`${ee.title.replace(/\s+/g,"_")}.txt`,document.body.appendChild(W),W.click(),document.body.removeChild(W),URL.revokeObjectURL(z)}}catch(ee){console.error("Error incrementing downloads:",ee)}},C=async F=>{try{await o(F),_(!1),j(!0),setTimeout(()=>{j(!1)},5e3)}catch(H){throw console.error("Error adding idea:",H),H}},T=F=>{switch(F){case"beginner":return"bg-green-100 text-green-800";case"intermediate":return"bg-yellow-100 text-yellow-800";case"advanced":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},M=F=>{switch(F){case"beginner":return e("projectIdeas.difficulties.beginner");case"intermediate":return e("projectIdeas.difficulties.intermediate");case"advanced":return e("projectIdeas.difficulties.advanced");default:return F}},A=F=>{switch(F){case"stem":return e("projectIdeas.categories.stem");case"entrepreneurship":return e("projectIdeas.categories.entrepreneurship");case"volunteer":return e("projectIdeas.categories.volunteer");case"ethics":return e("projectIdeas.categories.ethics");default:return F}};return s?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):i?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(oa,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:i})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(xa,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("projectIdeas.title")}),n.jsx("p",{className:"opacity-90",children:e("projectIdeas.subtitle")})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:S.length}),n.jsx("div",{className:"text-sm opacity-80",children:e("projectIdeas.stats.projectIdeas")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:N.length-1}),n.jsx("div",{className:"text-sm opacity-80",children:e("projectIdeas.stats.differentCategories")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:k.length-1}),n.jsx("div",{className:"text-sm opacity-80",children:e("projectIdeas.stats.difficultyLevels")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"100%"}),n.jsx("div",{className:"text-sm opacity-80",children:e("projectIdeas.stats.free")})]})]})]}),b&&n.jsxs(te.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-green-50 border border-green-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(ze,{className:"w-6 h-6 text-green-500 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-green-800 mb-1",children:"تم إرسال فكرة المشروع بنجاح"}),n.jsx("p",{className:"text-green-700",children:"تم استلام فكرة المشروع وسيتم مراجعتها من قبل مدير النظام. سيتم نشرها بعد الموافقة عليها."})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ut,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("projectIdeas.searchPlaceholder"),value:m,onChange:F=>x(F.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("button",{onClick:()=>g(!p),className:"lg:hidden flex items-center gap-2 px-4 py-3 bg-gray-100 rounded-xl hover:bg-gray-200 transition-colors",children:[n.jsx(Ko,{className:"w-5 h-5"}),e("common.filter")]})]}),n.jsxs("div",{className:`mt-4 space-y-4 ${p?"block":"hidden lg:block"}`,children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("projectIdeas.filters.categories")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:N.map(F=>n.jsxs("button",{onClick:()=>u(F.id),className:`flex items-center gap-2 px-4 py-2 rounded-xl transition-all ${d===F.id?`bg-gradient-to-r ${F.color} text-white shadow-lg`:"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[n.jsx(F.icon,{className:"w-4 h-4"}),F.name]},F.id))})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("projectIdeas.filters.difficulty")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:k.map(F=>n.jsx("button",{onClick:()=>h(F.id),className:`px-4 py-2 rounded-xl transition-all ${f===F.id?"bg-blue-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:F.name},F.id))})]})]})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("p",{className:"text-gray-600",children:[e("projectIdeas.showing")," ",S.length," ",e("projectIdeas.of")," ",r?a.length:S.length," ",e("projectIdeas.idea")]}),n.jsxs("button",{onClick:()=>_(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:[n.jsx(gt,{className:"w-4 h-4"}),e("projectIdeas.suggestNewIdea")]})]}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:S.map((F,H)=>n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:H*.1},className:"bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 group",children:[n.jsxs("div",{className:"relative h-48 overflow-hidden",children:[n.jsx("img",{src:F.image||"https://images.pexels.com/photos/3184465/pexels-photo-3184465.jpeg?auto=compress&cs=tinysrgb&w=400",alt:F.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"}),n.jsx("div",{className:"absolute top-4 right-4",children:n.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${T(F.difficulty)}`,children:M(F.difficulty)})}),n.jsxs("div",{className:"absolute top-4 left-4 flex gap-2",children:[n.jsxs("div",{className:"bg-black bg-opacity-50 text-white px-2 py-1 rounded-lg text-xs flex items-center gap-1",children:[n.jsx(sr,{className:"w-3 h-3"}),F.views]}),n.jsxs("div",{className:"bg-black bg-opacity-50 text-white px-2 py-1 rounded-lg text-xs flex items-center gap-1",children:[n.jsx(Tr,{className:"w-3 h-3"}),F.downloads]})]})]}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"text-sm font-medium",children:F.rating})]}),n.jsx("span",{className:"text-gray-300",children:"•"}),n.jsx("span",{className:"text-sm text-gray-600",children:F.subject||A(F.category)})]}),n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2 group-hover:text-blue-600 transition-colors",children:F.title}),n.jsx("p",{className:"text-gray-600 mb-4 line-clamp-3 leading-relaxed",children:F.description}),n.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-4",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(jt,{className:"w-4 h-4"}),F.duration||e("resources.defaultDuration")]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(lt,{className:"w-4 h-4"}),e("projectIdeas.teamwork")]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{className:"flex-1 bg-blue-500 text-white py-2 px-4 rounded-xl hover:bg-blue-600 transition-colors font-medium",onClick:()=>E(F.id),children:e("projectIdeas.viewDetails")}),n.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",onClick:()=>P(F.id),children:n.jsx(Tr,{className:"w-4 h-4"})})]})]})]},F.id))}),S.length===0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(ut,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("projectIdeas.noResults")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("projectIdeas.tryChangingFilters")}),n.jsx("button",{onClick:()=>{u("all"),h("all"),x("")},className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:e("common.resetFilters")})]}),y&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:n.jsx(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3},className:"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:n.jsxs("div",{className:"relative",children:[n.jsxs("div",{className:"relative h-64 bg-gradient-to-r from-blue-600 to-purple-600",children:[y.image?n.jsx("img",{src:y.image,alt:y.title,className:"w-full h-full object-cover opacity-50"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(xa,{className:"w-24 h-24 text-white opacity-20"})}),n.jsx("button",{onClick:()=>w(null),className:"absolute top-4 right-4 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-70 transition-colors",children:n.jsx(Pt,{className:"w-6 h-6"})}),n.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black to-transparent p-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${T(y.difficulty)}`,children:M(y.difficulty)}),n.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium",children:A(y.category)})]}),n.jsx("h2",{className:"text-2xl font-bold text-white",children:y.title})]})]}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-6",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"الوصف"}),n.jsx("p",{className:"text-gray-600 leading-relaxed mb-4",children:y.description}),y.tags&&y.tags.length>0&&n.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:y.tags.map((F,H)=>n.jsxs("span",{className:"px-3 py-1 bg-gray-100 text-gray-600 text-sm rounded-lg",children:["#",F]},H))})]}),n.jsx("div",{children:n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"معلومات المشروع"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"المدة المتوقعة"}),n.jsx("p",{className:"font-medium",children:y.duration||"غير محدد"})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"الموضوع/المادة"}),n.jsx("p",{className:"font-medium",children:y.subject||"غير محدد"})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"التقييم"}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"font-medium",children:y.rating})]})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"المشاهدات"}),n.jsx("p",{className:"font-medium",children:y.views})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"التنزيلات"}),n.jsx("p",{className:"font-medium",children:y.downloads})]})]})]})})]}),y.objectives&&y.objectives.length>0&&n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"أهداف المشروع"}),n.jsx("div",{className:"space-y-2",children:y.objectives.map((F,H)=>n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center mt-0.5",children:n.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full"})}),n.jsx("p",{className:"text-gray-700",children:F})]},H))})]}),y.materials&&y.materials.length>0&&n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"المواد والأدوات المطلوبة"}),n.jsx("div",{className:"grid md:grid-cols-2 gap-2",children:y.materials.map((F,H)=>n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[n.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),n.jsx("span",{className:"text-gray-700",children:F})]},H))})]}),y.steps&&y.steps.length>0&&n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"خطوات تنفيذ المشروع"}),n.jsx("div",{className:"space-y-3",children:y.steps.map((F,H)=>n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:H+1}),n.jsx("div",{className:"bg-gray-50 p-3 rounded-lg flex-1",children:n.jsx("p",{className:"text-gray-700",children:F})})]},H))})]}),n.jsxs("div",{className:"flex justify-between pt-4 border-t border-gray-200",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[n.jsx(sr,{className:"w-5 h-5"}),n.jsxs("span",{children:[y.views," مشاهدة"]})]}),n.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[n.jsx(Tr,{className:"w-5 h-5"}),n.jsxs("span",{children:[y.downloads," تنزيل"]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:()=>P(y.id),className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2",children:[n.jsx(Tr,{className:"w-5 h-5"}),"تنزيل"]}),n.jsx("button",{onClick:()=>w(null),className:"px-6 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إغلاق"})]})]})]})]})})}),v&&n.jsx(t2,{isOpen:v,onClose:()=>_(!1),onSubmit:C,editingIdea:null}),n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"bg-blue-50 border border-blue-200 rounded-2xl p-6",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(En,{className:"w-6 h-6 text-blue-500 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-bold text-blue-800 mb-2",children:"اقتراح فكرة مشروع جديدة"}),n.jsx("p",{className:"text-blue-700 mb-4",children:"يمكنك اقتراح فكرة مشروع جديدة ليتم إضافتها إلى قائمة أفكار المشاريع. سيتم مراجعة الفكرة من قبل مدير النظام قبل نشرها."}),n.jsxs("button",{onClick:()=>_(!0),className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2 mx-auto",children:[n.jsx(gt,{className:"w-4 h-4"}),"اقتراح فكرة جديدة"]})]})]})})]})},$E=()=>{const[e,t]=O.useState([]),[r,a]=O.useState(!0),[s,i]=O.useState(null),o=async()=>{try{a(!0);const m=De(pe,"gallery_projects"),x=et(m,Pi("created_at","desc"),ys(20)),g=(await Je(x)).docs.map(y=>{const w=y.data();return{id:y.id,title:w.title||"مشروع بدون عنوان",description:w.description||"لا يوجد وصف",category:w.category||"عام",students:w.students||[],school:w.school||"مدرسة غير معروفة",teacher:w.teacher||"معلم غير معروف",completedAt:w.completed_at?new Date(w.completed_at.toDate()).toISOString():new Date().toISOString(),rating:w.rating||4.5,views:w.views||0,likes:w.likes||0,images:w.images||["https://images.pexels.com/photos/3184465/pexels-photo-3184465.jpeg?auto=compress&cs=tinysrgb&w=600"],video:w.video,tags:w.tags||[],awards:w.awards||[],featured:w.featured||!1}});t(g)}catch(m){console.error("Error fetching gallery projects:",m),i(m instanceof Error?m.message:"حدث خطأ في تحميل معرض المشاريع")}finally{a(!1)}},l=async m=>{try{const x=Ie(pe,"gallery_projects",m);await Wt(x,{views:fi(1)}),t(p=>p.map(g=>g.id===m?{...g,views:g.views+1}:g))}catch(x){console.error("Error incrementing views:",x)}},c=async m=>{try{const x=Ie(pe,"gallery_projects",m);await Wt(x,{likes:fi(1)}),t(p=>p.map(g=>g.id===m?{...g,likes:g.likes+1}:g))}catch(x){console.error("Error incrementing likes:",x)}},d=async m=>{try{let x=m.images||[];const p=De(pe,"gallery_projects"),y={id:(await Aa(p,{title:m.title,description:m.description,category:m.category,students:m.students,school:m.school,teacher:m.teacher,completed_at:Ge(),rating:m.rating||4.5,views:0,likes:0,images:x,video:m.video,tags:m.tags||[],awards:m.awards||[],featured:m.featured||!1,created_at:Ge(),updated_at:Ge()})).id,title:m.title||"مشروع بدون عنوان",description:m.description||"لا يوجد وصف",category:m.category||"عام",students:m.students||[],school:m.school||"مدرسة غير معروفة",teacher:m.teacher||"معلم غير معروف",completedAt:new Date().toISOString(),rating:m.rating||4.5,views:0,likes:0,images:x,video:m.video,tags:m.tags||[],awards:m.awards||[],featured:m.featured||!1};return t(w=>[y,...w]),y}catch(x){throw console.error("Error adding gallery project:",x),x}},u=async(m,x)=>{try{const p=Ie(pe,"gallery_projects",m);return await Wt(p,{title:x.title,description:x.description,category:x.category,students:x.students,school:x.school,teacher:x.teacher,images:x.images,video:x.video,tags:x.tags,awards:x.awards,featured:x.featured,updated_at:Ge()}),t(g=>g.map(y=>y.id===m?{...y,...x}:y)),{id:m,...x}}catch(p){throw console.error("Error updating gallery project:",p),p}},f=async m=>{try{const x=Ie(pe,"gallery_projects",m);return await Va(x),t(p=>p.filter(g=>g.id!==m)),!0}catch(x){throw console.error("Error deleting gallery project:",x),x}},h=async m=>{try{const x=Rh($h,`gallery/${Date.now()}_${m.name}`);return await Y3(x,m),await Mj(x)}catch(x){throw console.error("Error uploading image:",x),x}};return O.useEffect(()=>{o()},[]),{projects:e,loading:r,error:s,fetchGalleryProjects:o,incrementViews:l,incrementLikes:c,addGalleryProject:d,updateGalleryProject:u,deleteGalleryProject:f,uploadImage:h}},LE=[{id:"all",name:"جميع المشاريع"},{id:"stem",name:"العلوم والتقنية"},{id:"entrepreneurship",name:"ريادة الأعمال"},{id:"volunteer",name:"التطوع"},{id:"ethics",name:"الأخلاق"}],Yg=[{id:"all",name:"جميع المدارس"},{id:"school1",name:"مدرسة الملك عبدالعزيز"},{id:"school2",name:"مدرسة الأمير محمد"},{id:"school3",name:"مدرسة النور الأهلية"},{id:"school4",name:"مدرسة المستقبل"}],BE=[{id:"latest",name:"الأحدث"},{id:"popular",name:"الأكثر شعبية"},{id:"rating",name:"الأعلى تقييماً"},{id:"views",name:"الأكثر مشاهدة"}],UE=()=>{const{projects:e,loading:t,error:r,incrementViews:a,incrementLikes:s}=$E(),[i,o]=O.useState("all"),[l,c]=O.useState("all"),[d,u]=O.useState("latest"),[f,h]=O.useState(""),[m,x]=O.useState("grid"),[p,g]=O.useState([]),[y,w]=O.useState(null),v=e.filter(S=>{var T;const E=i==="all"||S.category===i,P=l==="all"||S.school===((T=Yg.find(M=>M.id===l))==null?void 0:T.name),C=S.title.toLowerCase().includes(f.toLowerCase())||S.description.toLowerCase().includes(f.toLowerCase())||S.tags.some(M=>M.toLowerCase().includes(f.toLowerCase()))||S.school.toLowerCase().includes(f.toLowerCase())||S.teacher.toLowerCase().includes(f.toLowerCase())||S.students.some(M=>M.toLowerCase().includes(f.toLowerCase()));return E&&P&&C}).sort((S,E)=>{switch(d){case"popular":return E.likes-S.likes;case"rating":return E.rating-S.rating;case"views":return E.views-S.views;case"latest":default:return new Date(E.completedAt).getTime()-new Date(S.completedAt).getTime()}}),_=S=>{p.includes(S)?g(E=>E.filter(P=>P!==S)):(g(E=>[...E,S]),s(S))},b=S=>{a(S),w(S)},j=S=>{switch(S){case"stem":return"العلوم والتقنية";case"entrepreneurship":return"ريادة الأعمال";case"volunteer":return"التطوع";case"ethics":return"الأخلاق";default:return S}},N=S=>{if(navigator.share)navigator.share({title:S.title,text:S.description,url:window.location.href+"?project="+S.id}).catch(E=>console.log("Error sharing",E));else{const E=window.location.href+"?project="+S.id;navigator.clipboard.writeText(E),alert("تم نسخ رابط المشروع إلى الحافظة")}};O.useEffect(()=>{const E=new URLSearchParams(window.location.search).get("project");E&&(w(E),a(E))},[]);const k=y?e.find(S=>S.id===y):null;return t?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-pink-500"})}):r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Rl,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:r})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-pink-600 to-rose-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(Rl,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"معرض المشاريع"}),n.jsx("p",{className:"opacity-90",children:"استكشف المشاريع المميزة والملهمة من طلابنا"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.length}),n.jsx("div",{className:"text-sm opacity-80",children:"مشروع معروض"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.filter(S=>S.featured).length}),n.jsx("div",{className:"text-sm opacity-80",children:"مشروع مميز"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.reduce((S,E)=>S+E.views,0).toLocaleString()}),n.jsx("div",{className:"text-sm opacity-80",children:"إجمالي المشاهدات"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.reduce((S,E)=>S+E.likes,0)}),n.jsx("div",{className:"text-sm opacity-80",children:"إجمالي الإعجابات"})]})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 mb-4",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ut,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"البحث في المشاريع...",value:f,onChange:S=>h(S.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-pink-500 focus:border-transparent"})]}),n.jsx("select",{value:d,onChange:S=>u(S.target.value),className:"px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-pink-500 focus:border-transparent",children:BE.map(S=>n.jsx("option",{value:S.id,children:S.name},S.id))}),n.jsxs("div",{className:"flex border border-gray-300 rounded-xl overflow-hidden",children:[n.jsx("button",{onClick:()=>x("grid"),className:`px-4 py-3 ${m==="grid"?"bg-pink-500 text-white":"bg-white text-gray-700 hover:bg-gray-50"} transition-colors`,children:"شبكة"}),n.jsx("button",{onClick:()=>x("list"),className:`px-4 py-3 ${m==="list"?"bg-pink-500 text-white":"bg-white text-gray-700 hover:bg-gray-50"} transition-colors`,children:"قائمة"})]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:"الفئات"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:LE.map(S=>n.jsx("button",{onClick:()=>o(S.id),className:`px-4 py-2 rounded-xl transition-all ${i===S.id?"bg-pink-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:S.name},S.id))})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:"المدارس"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:Yg.map(S=>n.jsx("button",{onClick:()=>c(S.id),className:`px-4 py-2 rounded-xl transition-all ${l===S.id?"bg-pink-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:S.name},S.id))})]})]})]}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:["عرض ",v.length," من أصل ",e.length," مشروع"]})}),m==="grid"?n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:v.map((S,E)=>n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:E*.1},className:"bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 group",children:[n.jsxs("div",{className:"relative h-48 overflow-hidden",children:[n.jsx("img",{src:S.images[0],alt:S.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"}),S.featured&&n.jsxs("div",{className:"absolute top-4 right-4 bg-yellow-500 text-white px-2 py-1 rounded-lg text-sm font-medium flex items-center gap-1",children:[n.jsx(ar,{className:"w-3 h-3"}),"مميز"]}),S.video&&n.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:n.jsx("button",{className:"w-16 h-16 bg-white bg-opacity-20 rounded-full flex items-center justify-center backdrop-blur-sm",children:n.jsx(pi,{className:"w-8 h-8 text-white ml-1"})})}),n.jsxs("div",{className:"absolute bottom-4 left-4 flex gap-2",children:[n.jsxs("div",{className:"bg-black bg-opacity-50 text-white px-2 py-1 rounded-lg text-xs flex items-center gap-1",children:[n.jsx(sr,{className:"w-3 h-3"}),S.views.toLocaleString()]}),n.jsxs("div",{className:"bg-black bg-opacity-50 text-white px-2 py-1 rounded-lg text-xs flex items-center gap-1",children:[n.jsx(fa,{className:"w-3 h-3"}),S.likes]})]})]}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"text-sm font-medium",children:S.rating})]}),n.jsx("span",{className:"text-gray-300",children:"•"}),n.jsx("span",{className:"text-sm text-gray-600",children:j(S.category)})]}),n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2 group-hover:text-pink-600 transition-colors line-clamp-2",children:S.title}),n.jsx("p",{className:"text-gray-600 mb-4 line-clamp-3 leading-relaxed",children:S.description}),n.jsxs("div",{className:"flex flex-col gap-1 mb-3",children:[n.jsxs("div",{className:"text-sm text-gray-600",children:[n.jsx("span",{className:"font-medium",children:"المدرسة:"})," ",S.school]}),n.jsxs("div",{className:"text-sm text-gray-600",children:[n.jsx("span",{className:"font-medium",children:"المعلم:"})," ",S.teacher]})]}),n.jsxs("div",{className:"flex flex-wrap gap-1 mb-4",children:[S.tags.slice(0,3).map((P,C)=>n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["#",P]},C)),S.tags.length>3&&n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["+",S.tags.length-3]})]}),S.awards&&S.awards.length>0&&n.jsx("div",{className:"mb-4",children:n.jsxs("div",{className:"flex items-center gap-1 text-yellow-600 text-sm",children:[n.jsx(ar,{className:"w-4 h-4"}),n.jsx("span",{className:"font-medium",children:S.awards[0]}),S.awards.length>1&&n.jsxs("span",{className:"text-gray-500",children:["+",S.awards.length-1]})]})}),n.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-4",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(lt,{className:"w-4 h-4"}),S.students.length," طالب"]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(tt,{className:"w-4 h-4"}),Ze(S.completedAt)]})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>_(S.id),className:`p-2 rounded-lg transition-colors ${p.includes(S.id)?"bg-red-100 text-red-600":"bg-gray-100 text-gray-600 hover:bg-red-100 hover:text-red-600"}`,children:n.jsx(fa,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>N(S),className:"p-2 rounded-lg bg-gray-100 text-gray-600 hover:bg-blue-100 hover:text-blue-600 transition-colors",children:n.jsx(bs,{className:"w-4 h-4"})})]}),n.jsx("button",{onClick:()=>b(S.id),className:"px-4 py-2 bg-pink-500 text-white rounded-lg hover:bg-pink-600 transition-colors text-sm font-medium",children:"عرض التفاصيل"})]})]})]},S.id))}):n.jsx("div",{className:"space-y-4",children:v.map((S,E)=>n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:E*.1},className:"bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition-all duration-300",children:n.jsxs("div",{className:"flex gap-6",children:[n.jsxs("div",{className:"relative w-48 h-32 rounded-xl overflow-hidden flex-shrink-0",children:[n.jsx("img",{src:S.images[0],alt:S.title,className:"w-full h-full object-cover"}),S.featured&&n.jsxs("div",{className:"absolute top-2 right-2 bg-yellow-500 text-white px-2 py-1 rounded-lg text-xs font-medium flex items-center gap-1",children:[n.jsx(ar,{className:"w-3 h-3"}),"مميز"]})]}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:S.title}),n.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:j(S.category)})]}),n.jsx("p",{className:"text-gray-600 line-clamp-2",children:S.description}),n.jsxs("div",{className:"flex flex-col gap-1 mt-2",children:[n.jsxs("div",{className:"text-sm text-gray-600",children:[n.jsx("span",{className:"font-medium",children:"المدرسة:"})," ",S.school]}),n.jsxs("div",{className:"text-sm text-gray-600",children:[n.jsx("span",{className:"font-medium",children:"المعلم:"})," ",S.teacher]})]})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"text-sm font-medium",children:S.rating})]})]}),n.jsx("div",{className:"flex flex-wrap gap-1 mb-3",children:S.tags.map((P,C)=>n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["#",P]},C))}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(lt,{className:"w-4 h-4"}),S.students.length," طالب"]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(sr,{className:"w-4 h-4"}),S.views.toLocaleString()," مشاهدة"]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(fa,{className:"w-4 h-4"}),S.likes," إعجاب"]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(tt,{className:"w-4 h-4"}),Ze(S.completedAt)]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>_(S.id),className:`p-2 rounded-lg transition-colors ${p.includes(S.id)?"bg-red-100 text-red-600":"bg-gray-100 text-gray-600 hover:bg-red-100 hover:text-red-600"}`,children:n.jsx(fa,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>N(S),className:"p-2 rounded-lg bg-gray-100 text-gray-600 hover:bg-blue-100 hover:text-blue-600 transition-colors",children:n.jsx(bs,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>b(S.id),className:"px-4 py-2 bg-pink-500 text-white rounded-lg hover:bg-pink-600 transition-colors text-sm font-medium",children:"عرض التفاصيل"})]})]})]})]})},S.id))}),v.length===0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(Rl,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"لم يتم العثور على مشاريع"}),n.jsx("p",{className:"text-gray-600 mb-4",children:"جرب تغيير معايير البحث أو الفلاتر"}),n.jsx("button",{onClick:()=>{o("all"),c("all"),h("")},className:"px-6 py-2 bg-pink-500 text-white rounded-xl hover:bg-pink-600 transition-colors",children:"إعادة تعيين الفلاتر"})]}),y&&k&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 z-50 flex items-center justify-center p-4 overflow-y-auto",children:n.jsx("div",{className:"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:n.jsxs("div",{className:"relative",children:[n.jsxs("div",{className:"relative h-80 bg-gray-900",children:[n.jsx("img",{src:k.images[0],alt:k.title,className:"w-full h-full object-contain"}),n.jsx("button",{onClick:()=>w(null),className:"absolute top-4 right-4 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-70 transition-colors",children:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),k.images.length>1&&n.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-2",children:k.images.map((S,E)=>n.jsx("button",{className:`w-3 h-3 rounded-full ${E===0?"bg-white":"bg-white bg-opacity-50"}`},E))}),k.video&&n.jsxs("a",{href:k.video,target:"_blank",rel:"noopener noreferrer",className:"absolute bottom-4 right-4 bg-pink-500 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-pink-600 transition-colors",children:[n.jsx(pi,{className:"w-4 h-4"}),"مشاهدة الفيديو"]})]}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:k.title}),k.featured&&n.jsxs("span",{className:"bg-yellow-100 text-yellow-800 px-2 py-1 rounded-lg text-sm font-medium flex items-center gap-1",children:[n.jsx(ar,{className:"w-4 h-4"}),"مميز"]})]}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-6",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"وصف المشروع"}),n.jsx("p",{className:"text-gray-600 leading-relaxed mb-4",children:k.description}),n.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:k.tags.map((S,E)=>n.jsxs("span",{className:"px-3 py-1 bg-gray-100 text-gray-600 text-sm rounded-lg flex items-center gap-1",children:[n.jsx(cd,{className:"w-4 h-4"}),S]},E))}),k.awards&&k.awards.length>0&&n.jsxs("div",{className:"mb-4",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"الجوائز"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:k.awards.map((S,E)=>n.jsxs("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 text-sm rounded-lg flex items-center gap-1",children:[n.jsx(ar,{className:"w-4 h-4"}),S]},E))})]})]}),n.jsx("div",{children:n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"معلومات المشروع"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"المدرسة"}),n.jsx("p",{className:"font-medium",children:k.school})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"المعلم المشرف"}),n.jsx("p",{className:"font-medium",children:k.teacher})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"تاريخ الإنجاز"}),n.jsx("p",{className:"font-medium",children:Ze(k.completedAt)})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"التقييم"}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"font-medium",children:k.rating})]})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"الفئة"}),n.jsx("p",{className:"font-medium",children:j(k.category)})]})]})]})})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"فريق العمل"}),n.jsx("div",{className:"flex flex-wrap gap-3",children:k.students.map((S,E)=>n.jsxs("div",{className:"bg-gray-100 rounded-full px-4 py-2 text-sm flex items-center gap-2",children:[n.jsx("div",{className:"w-6 h-6 bg-gray-300 rounded-full flex items-center justify-center text-xs text-gray-700",children:S.charAt(0)}),n.jsx("span",{children:S})]},E))})]}),n.jsxs("div",{className:"flex items-center justify-between border-t border-gray-200 pt-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[n.jsx(sr,{className:"w-5 h-5"}),n.jsxs("span",{children:[k.views.toLocaleString()," مشاهدة"]})]}),n.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[n.jsx(fa,{className:"w-5 h-5"}),n.jsxs("span",{children:[k.likes," إعجاب"]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>_(k.id),className:`p-2 rounded-lg transition-colors ${p.includes(k.id)?"bg-red-100 text-red-600":"bg-gray-100 text-gray-600 hover:bg-red-100 hover:text-red-600"}`,children:n.jsx(fa,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>N(k),className:"p-2 rounded-lg bg-gray-100 text-gray-600 hover:bg-blue-100 hover:text-blue-600 transition-colors",children:n.jsx(bs,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>w(null),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors",children:"إغلاق"})]})]})]})]})})})]})},WE=async()=>{try{const e=await Je(De(pe,"store_items")),t=[];return e.forEach(r=>{const a=r.data();t.push({id:r.id,name:a.name||"",description:a.description||"",price:a.price||0,originalPrice:a.original_price,category:a.category||"",features:a.features||[],tags:a.tags||[],image:a.image_url||"",rating:a.rating||5,reviews:a.reviews_count||0,views:a.views_count||0,inStock:a.in_stock||!1,stockQuantity:a.stock_quantity||0,discount:a.discount_percentage,featured:a.featured||!1})}),t}catch(e){throw console.error("Error fetching store items from Firestore:",e),e}},Df=()=>{const[e,t]=O.useState([]),[r,a]=O.useState(!0),[s,i]=O.useState(null),o=async()=>{try{a(!0),i(null),console.log("Fetching store items...");const h=await WE();console.log(`Found ${h.length} store items`),t(h)}catch(h){console.error("Error fetching store items:",h),i(h instanceof Error?h.message:"حدث خطأ في تحميل المنتجات")}finally{a(!1)}},l=async h=>{try{const m=Ie(pe,"store_items",h);await Wt(m,{views_count:fi(1)}),t(x=>x.map(p=>p.id===h?{...p,views:p.views+1}:p))}catch(m){console.error("Error incrementing views:",m)}},c=async h=>{try{a(!0),i(null);const m={name:h.name,description:h.description,price:h.price,original_price:h.originalPrice??null,category:h.category,features:h.features||[],tags:h.tags||[],image_url:h.image,rating:h.rating||5,reviews_count:0,views_count:0,in_stock:h.inStock,stock_quantity:h.stockQuantity||0,discount_percentage:h.discount??null,featured:h.featured||!1,created_at:Ge(),updated_at:Ge()},p={id:(await Aa(De(pe,"store_items"),m)).id,name:h.name,description:h.description,price:h.price,originalPrice:h.originalPrice,category:h.category,features:h.features||[],tags:h.tags||[],image:h.image,rating:h.rating||5,reviews:0,views:0,inStock:h.inStock,stockQuantity:h.stockQuantity||0,discount:h.discount,featured:h.featured||!1};return t(g=>[p,...g]),p}catch(m){throw console.error("Error creating store item:",m),i(m instanceof Error?m.message:"حدث خطأ في إضافة المنتج"),m}finally{a(!1)}},d=async(h,m)=>{try{a(!0),i(null);const x=Ie(pe,"store_items",h),p={updated_at:Ge()};return m.name!==void 0&&(p.name=m.name),m.description!==void 0&&(p.description=m.description),m.price!==void 0&&(p.price=m.price),m.originalPrice!==void 0&&(p.original_price=m.originalPrice??null),m.category!==void 0&&(p.category=m.category),m.features!==void 0&&(p.features=m.features),m.tags!==void 0&&(p.tags=m.tags),m.image!==void 0&&(p.image_url=m.image),m.rating!==void 0&&(p.rating=m.rating),m.inStock!==void 0&&(p.in_stock=m.inStock),m.stockQuantity!==void 0&&(p.stock_quantity=m.stockQuantity),m.discount!==void 0&&(p.discount_percentage=m.discount??null),m.featured!==void 0&&(p.featured=m.featured),await Wt(x,p),t(g=>g.map(y=>y.id===h?{...y,...m}:y)),{id:h,...m}}catch(x){throw console.error("Error updating store item:",x),i(x instanceof Error?x.message:"حدث خطأ في تحديث المنتج"),x}finally{a(!1)}},u=async h=>{try{a(!0),i(null);const m=Ie(pe,"store_items",h);return await Va(m),t(x=>x.filter(p=>p.id!==h)),!0}catch(m){throw console.error("Error deleting store item:",m),i(m instanceof Error?m.message:"حدث خطأ في حذف المنتج"),m}finally{a(!1)}},f=async()=>{try{a(!0),i(null),console.log("Deleting all store items...");const h=De(pe,"store_items"),m=await Je(h);if(m.empty)return console.log("No store items to delete"),0;let x=0;for(const p of m.docs)await Va(p.ref),x++;return console.log(`Successfully deleted ${x} store items`),t([]),x}catch(h){throw console.error("Error deleting all store items:",h),i(h instanceof Error?h.message:"حدث خطأ في حذف جميع المنتجات"),h}finally{a(!1)}};return O.useEffect(()=>{o()},[]),{storeItems:e,loading:r,error:s,fetchStoreItems:o,incrementViews:l,createStoreItem:c,updateStoreItem:d,deleteStoreItem:u,deleteAllStoreItems:f}},HE=({isOpen:e,onClose:t,onSubmit:r,editingItem:a})=>{var k,S;const[s,i]=O.useState({name:"",description:"",price:0,originalPrice:void 0,category:"electronics",features:[""],tags:[],image:"",rating:5,inStock:!0,stockQuantity:1,discount:void 0,featured:!1}),[o,l]=O.useState(""),[c,d]=O.useState(""),[u,f]=O.useState(!1),[h,m]=O.useState(null),[x,p]=O.useState(null);O.useEffect(()=>{var E;i(a?{...a,features:(E=a.features)!=null&&E.length?a.features:[""],tags:a.tags||[]}:{name:"",description:"",price:0,originalPrice:void 0,category:"electronics",features:[""],tags:[],image:"",rating:5,inStock:!0,stockQuantity:1,discount:void 0,featured:!1}),l(""),d(""),m(null),p(null)},[a,e]);const g=[{id:"electronics",name:"الإلكترونيات"},{id:"tools",name:"الأدوات"},{id:"materials",name:"المواد"},{id:"books",name:"الكتب"},{id:"software",name:"البرمجيات"}],y=(E,P)=>{i(C=>({...C,[E]:P}))},w=(E,P)=>{i(C=>{var T;return{...C,features:((T=C.features)==null?void 0:T.map((M,A)=>A===E?P:M))||[]}})},v=()=>{c.trim()?(i(E=>({...E,features:[...E.features||[],c.trim()]})),d("")):i(E=>({...E,features:[...E.features||[],""]}))},_=E=>{i(P=>{var C;return{...P,features:((C=P.features)==null?void 0:C.filter((T,M)=>M!==E))||[]}})},b=()=>{o.trim()&&(i(E=>({...E,tags:[...E.tags||[],o.trim()]})),l(""))},j=E=>{i(P=>{var C;return{...P,tags:((C=P.tags)==null?void 0:C.filter((T,M)=>M!==E))||[]}})},N=async E=>{var C;if(E.preventDefault(),!s.name||!s.description||!s.price||!s.category||!s.image){m("يرجى ملء جميع الحقول المطلوبة");return}const P={...s,features:((C=s.features)==null?void 0:C.filter(T=>T.trim()))||[]};f(!0),m(null),p(null);try{await r(P),p(a?"تم تحديث المنتج بنجاح":"تم إضافة المنتج بنجاح"),setTimeout(()=>{t()},1500)}catch(T){console.error("Error submitting store item:",T),m(T instanceof Error?T.message:"حدث خطأ في حفظ المنتج")}finally{f(!1)}};return e?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(Br,{className:"w-6 h-6 text-purple-600"}),a?"تعديل منتج":"إضافة منتج جديد"]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Pt,{className:"w-5 h-5 text-gray-600"})})]}),h&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(pt,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:h})]}),x&&n.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(ze,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:x})]}),n.jsxs("form",{onSubmit:N,className:"space-y-6",children:[n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"اسم المنتج *"}),n.jsx("input",{type:"text",value:s.name,onChange:E=>y("name",E.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل اسم المنتج",required:!0})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"وصف المنتج *"}),n.jsx("textarea",{value:s.description,onChange:E=>y("description",E.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"اكتب وصفاً تفصيلياً للمنتج",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الفئة *"}),n.jsx("select",{value:s.category,onChange:E=>y("category",E.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0,children:g.map(E=>n.jsx("option",{value:E.id,children:E.name},E.id))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رابط الصورة *"}),n.jsxs("div",{className:"relative",children:[n.jsx(ld,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"url",value:s.image,onChange:E=>y("image",E.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل رابط صورة المنتج",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"السعر *"}),n.jsxs("div",{className:"relative",children:[n.jsx(iu,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"number",value:s.price,onChange:E=>y("price",parseFloat(E.target.value)||0),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل سعر المنتج",min:"0",step:"0.01",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"السعر الأصلي (اختياري)"}),n.jsxs("div",{className:"relative",children:[n.jsx(iu,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"number",value:s.originalPrice||"",onChange:E=>y("originalPrice",E.target.value?parseFloat(E.target.value):void 0),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل السعر الأصلي قبل الخصم",min:"0",step:"0.01"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نسبة الخصم (اختياري)"}),n.jsxs("div",{className:"relative",children:[n.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:"%"}),n.jsx("input",{type:"number",value:s.discount||"",onChange:E=>y("discount",E.target.value?parseFloat(E.target.value):void 0),className:"w-full px-4 py-3 pr-10 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل نسبة الخصم",min:"0",max:"100"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"التقييم"}),n.jsxs("div",{className:"relative",children:[n.jsx(at,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"number",value:s.rating,onChange:E=>y("rating",parseFloat(E.target.value)||5),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل تقييم المنتج",min:"1",max:"5",step:"0.1"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الكمية المتوفرة"}),n.jsxs("div",{className:"relative",children:[n.jsx(Cf,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"number",value:s.stockQuantity,onChange:E=>y("stockQuantity",parseInt(E.target.value)||0),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل الكمية المتوفرة",min:"0"})]})]}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",id:"inStock",checked:s.inStock,onChange:E=>y("inStock",E.target.checked),className:"w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),n.jsx("label",{htmlFor:"inStock",className:"mr-2 block text-sm text-gray-900",children:"متوفر في المخزون"})]}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",id:"featured",checked:s.featured,onChange:E=>y("featured",E.target.checked),className:"w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),n.jsx("label",{htmlFor:"featured",className:"mr-2 block text-sm text-gray-900",children:"منتج مميز"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"مميزات المنتج"}),n.jsxs("div",{className:"space-y-3",children:[(k=s.features)==null?void 0:k.map((E,P)=>n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"text",value:E,onChange:C=>w(P,C.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:`الميزة ${P+1}`}),s.features&&s.features.length>1&&n.jsx("button",{type:"button",onClick:()=>_(P),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(ir,{className:"w-5 h-5"})})]},P)),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"text",value:c,onChange:E=>d(E.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل ميزة جديدة"}),n.jsx("button",{type:"button",onClick:v,className:"px-4 py-3 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors",children:n.jsx(gt,{className:"w-5 h-5"})})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الكلمات المفتاحية"}),n.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:(S=s.tags)==null?void 0:S.map((E,P)=>n.jsxs("div",{className:"flex items-center gap-1 px-3 py-1 bg-purple-100 text-purple-800 rounded-full",children:[n.jsx("span",{children:E}),n.jsx("button",{type:"button",onClick:()=>j(P),className:"w-4 h-4 rounded-full flex items-center justify-center hover:bg-purple-200",children:n.jsx(Pt,{className:"w-3 h-3"})})]},P))}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(cd,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:o,onChange:E=>l(E.target.value),onKeyPress:E=>E.key==="Enter"&&(E.preventDefault(),b()),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أضف كلمة مفتاحية"})]}),n.jsx("button",{type:"button",onClick:b,className:"px-4 py-3 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors",children:"إضافة"})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[n.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{type:"submit",disabled:u,className:"px-6 py-3 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:u?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الحفظ..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Zn,{className:"w-5 h-5"}),a?"حفظ التغييرات":"إضافة المنتج"]})})]})]})]})}):null},Jg=({isOpen:e,onClose:t,onConfirm:r,itemName:a,isDeleting:s})=>e?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(pt,{className:"w-6 h-6 text-red-600"}),"تأكيد الحذف"]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Pt,{className:"w-5 h-5 text-gray-600"})})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("p",{className:"text-gray-700",children:"هل أنت متأكد من حذف المنتج التالي؟"}),n.jsxs("p",{className:"font-semibold text-gray-800 mt-2",children:['"',a,'"']}),n.jsx("p",{className:"text-red-600 text-sm mt-4",children:"هذا الإجراء لا يمكن التراجع عنه."})]}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{onClick:r,disabled:s,className:"px-6 py-3 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:s?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الحذف..."]}):n.jsxs(n.Fragment,{children:[n.jsx(ir,{className:"w-5 h-5"}),"تأكيد الحذف"]})})]})]})}):null,zE=({isOpen:e,onClose:t,item:r,onAddToCart:a,onToggleWishlist:s,isInWishlist:i})=>{const{t:o}=yt();if(!e||!r)return null;const l=async()=>{const c={title:r.name,text:r.description,url:window.location.href};if(navigator.share)try{await navigator.share(c)}catch{try{await navigator.clipboard.writeText(window.location.href),alert("تم نسخ رابط المنتج إلى الحافظة")}catch(u){console.error("Error copying to clipboard:",u),alert("حدث خطأ في المشاركة")}}else try{await navigator.clipboard.writeText(window.location.href),alert("تم نسخ رابط المنتج إلى الحافظة")}catch(d){console.error("Error copying to clipboard:",d),alert("حدث خطأ في المشاركة")}};return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:n.jsx(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:n.jsxs("div",{className:"relative",children:[n.jsx("button",{onClick:t,className:"absolute top-4 right-4 z-10 p-2 bg-white rounded-full shadow-md hover:bg-gray-100 transition-colors",children:n.jsx(Pt,{className:"w-5 h-5 text-gray-600"})}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-0",children:[n.jsx("div",{className:"h-full bg-gray-100 flex items-center justify-center p-8",children:n.jsx("img",{src:r.image,alt:r.name,className:"max-w-full max-h-[400px] object-contain"})}),n.jsxs("div",{className:"p-8",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm",children:r.category==="electronics"?o("store.categories.electronics"):r.category==="tools"?o("store.categories.tools"):r.category==="materials"?o("store.categories.materials"):r.category==="books"?o("store.categories.books"):r.category==="software"?o("store.categories.software"):r.category}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(at,{className:"w-5 h-5 text-yellow-400 fill-current"}),n.jsx("span",{className:"font-medium",children:r.rating}),n.jsxs("span",{className:"text-gray-500",children:["(",r.reviews," ",o("store.reviews"),")"]})]})]}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:r.name}),n.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[n.jsxs("span",{className:"text-3xl font-bold text-purple-600",children:[r.price," ",o("store.currency")]}),r.originalPrice&&n.jsxs("span",{className:"text-xl text-gray-400 line-through",children:[r.originalPrice," ",o("store.currency")]}),r.discount&&n.jsxs("span",{className:"px-2 py-1 bg-red-500 text-white rounded-lg text-sm font-medium",children:["-",r.discount,"%"]})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"الوصف"}),n.jsx("p",{className:"text-gray-600 leading-relaxed",children:r.description})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"المميزات"}),n.jsx("ul",{className:"space-y-2",children:r.features.map((c,d)=>n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx(ze,{className:"w-5 h-5 text-green-500 mt-0.5 flex-shrink-0"}),n.jsx("span",{className:"text-gray-700",children:c})]},d))})]}),r.tags&&r.tags.length>0&&n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"الكلمات المفتاحية"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:r.tags.map((c,d)=>n.jsxs("span",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm flex items-center gap-1",children:[n.jsx(cd,{className:"w-3 h-3"}),c]},d))})]}),n.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[n.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${r.inStock?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:r.inStock?o("store.inStock"):o("store.outOfStock")}),r.inStock&&n.jsxs("span",{className:"text-sm text-gray-600",children:["(",r.stockQuantity," قطعة متوفرة)"]})]}),n.jsxs("div",{className:"flex gap-3 mb-6",children:[n.jsxs("button",{onClick:()=>a(r.id),disabled:!r.inStock,className:"flex-1 bg-purple-500 text-white py-3 px-4 rounded-xl hover:bg-purple-600 transition-colors font-medium disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[n.jsx(Br,{className:"w-5 h-5"}),o("store.addToCart")]}),n.jsx("button",{onClick:()=>s(r.id),className:`p-3 rounded-xl transition-colors ${i?"bg-red-500 text-white":"bg-gray-100 text-gray-600 hover:bg-red-100 hover:text-red-600"}`,children:n.jsx(fa,{className:"w-5 h-5"})}),n.jsx("button",{onClick:l,className:"p-3 bg-gray-100 text-gray-600 rounded-xl hover:bg-gray-200 transition-colors",children:n.jsx(bs,{className:"w-5 h-5"})})]}),n.jsxs(Ee,{to:"/cart",className:"w-full py-3 px-4 bg-gray-800 text-white rounded-xl hover:bg-gray-900 transition-colors font-medium flex items-center justify-center gap-2 mb-6",children:[n.jsx(Br,{className:"w-5 h-5"}),"الذهاب إلى سلة التسوق"]}),n.jsxs("div",{className:"border-t border-gray-200 pt-6 space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:n.jsx(oc,{className:"w-5 h-5 text-green-600"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800",children:"شحن مجاني"}),n.jsx("p",{className:"text-sm text-gray-600",children:"للطلبات فوق 200 ريال"})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:n.jsx(Cf,{className:"w-5 h-5 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800",children:"ضمان الجودة"}),n.jsx("p",{className:"text-sm text-gray-600",children:"ضمان استرجاع لمدة 30 يوم"})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:n.jsx(jt,{className:"w-5 h-5 text-purple-600"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800",children:"توصيل سريع"}),n.jsx("p",{className:"text-sm text-gray-600",children:"خلال 2-5 أيام عمل"})]})]})]})]})]})]})})})},VE=()=>{const{t:e}=yt(),{user:t}=vt(),r=(t==null?void 0:t.role)==="admin",{storeItems:a,loading:s,error:i,incrementViews:o,createStoreItem:l,updateStoreItem:c,deleteStoreItem:d,deleteAllStoreItems:u}=Df(),{cart:f,wishlist:h,addToCart:m,removeFromCart:x,toggleWishlist:p,getTotalItems:g,getTotalPrice:y}=Lx(),[w,v]=O.useState("all"),[_,b]=O.useState(""),[j,N]=O.useState(!1),[k,S]=O.useState(null),[E,P]=O.useState(!1),[C,T]=O.useState(!1),[M,A]=O.useState(null),[F,H]=O.useState(!1),[V,B]=O.useState(!1),[L,ee]=O.useState(!1),[I,K]=O.useState(!1),[z,W]=O.useState(null);O.useEffect(()=>{r&&ee(!0)},[r]);const re=[{id:"all",name:e("store.categories.all")},{id:"electronics",name:e("store.categories.electronics")},{id:"tools",name:e("store.categories.tools")},{id:"materials",name:e("store.categories.materials")},{id:"books",name:e("store.categories.books")},{id:"software",name:e("store.categories.software")}],xe=a.filter(ce=>{const he=w==="all"||ce.category===w,oe=ce.name.toLowerCase().includes(_.toLowerCase())||ce.description.toLowerCase().includes(_.toLowerCase());return he&&oe}),me=ce=>{o(ce);const he=a.find(oe=>oe.id===ce);he&&(W(he),K(!0))},Q=()=>{S(null),N(!0)},q=ce=>{S(ce),N(!0)},se=ce=>{A(ce),P(!0)},D=()=>{T(!0)},ve=async()=>{if(M){H(!0);try{await d(M.id),P(!1)}catch(ce){console.error("Error deleting item:",ce)}finally{H(!1),A(null)}}},we=async()=>{B(!0);try{await u(),T(!1)}catch(ce){console.error("Error deleting all items:",ce)}finally{B(!1)}},Ae=async ce=>{k?await c(k.id,ce):await l(ce)};return s?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-purple-500"})}):i?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(oa,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:i})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-purple-600 to-pink-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(Br,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("store.title")}),n.jsx("p",{className:"opacity-90",children:e("store.subtitle")})]})]}),n.jsxs("div",{className:"flex items-center gap-4",children:[r&&n.jsxs("button",{onClick:()=>ee(!L),className:"bg-white bg-opacity-20 text-white px-4 py-2 rounded-xl hover:bg-opacity-30 transition-all duration-200 backdrop-blur-sm flex items-center gap-2",children:[n.jsx(xo,{className:"w-5 h-5"}),L?"وضع المستخدم":"وضع الإدارة"]}),!L&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"relative",children:n.jsxs("button",{className:"bg-white bg-opacity-20 text-white px-4 py-2 rounded-xl hover:bg-opacity-30 transition-all duration-200 backdrop-blur-sm flex items-center gap-2",children:[n.jsx(fa,{className:"w-5 h-5"}),e("store.wishlist")," (",h.length,")"]})}),n.jsxs("div",{className:"relative",children:[n.jsxs(Ee,{to:"/cart",className:"bg-white text-purple-600 px-4 py-2 rounded-xl hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(Br,{className:"w-5 h-5"}),e("store.cart")," (",g(),")"]}),g()>0&&n.jsx("span",{className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:g()})]})]}),r&&L&&n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:Q,className:"bg-white text-purple-600 px-6 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(gt,{className:"w-5 h-5"}),"إضافة منتج جديد"]}),n.jsxs("button",{onClick:D,className:"bg-red-500 text-white px-6 py-3 rounded-xl font-medium hover:bg-red-600 transition-all duration-200 flex items-center gap-2",children:[n.jsx(ir,{className:"w-5 h-5"}),"حذف جميع المنتجات"]})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:a.length}),n.jsx("div",{className:"text-sm opacity-80",children:e("store.stats.availableProducts")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:re.length-1}),n.jsx("div",{className:"text-sm opacity-80",children:e("store.stats.categories")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"24/7"}),n.jsx("div",{className:"text-sm opacity-80",children:e("store.stats.customerSupport")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e("store.stats.freeShipping")}),n.jsx("div",{className:"text-sm opacity-80",children:e("store.stats.shipping")})]})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsx("div",{className:"flex flex-col lg:flex-row gap-4 mb-4",children:n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ut,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("store.searchPlaceholder"),value:_,onChange:ce=>b(ce.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("store.filters.categories")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:re.map(ce=>n.jsx("button",{onClick:()=>v(ce.id),className:`px-4 py-2 rounded-xl transition-all ${w===ce.id?"bg-purple-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:ce.name},ce.id))})]})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("p",{className:"text-gray-600",children:[e("store.showing")," ",xe.length," ",e("store.of")," ",a.length," ",e("store.product")]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"text-sm text-gray-600",children:[e("store.sortBy"),":"]}),n.jsxs("select",{className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[n.jsx("option",{children:e("store.sortOptions.newest")}),n.jsx("option",{children:e("store.sortOptions.priceLowToHigh")}),n.jsx("option",{children:e("store.sortOptions.priceHighToLow")}),n.jsx("option",{children:e("store.sortOptions.rating")})]})]})]}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:xe.map((ce,he)=>n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:he*.1},className:"bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 group",children:[n.jsxs("div",{className:"relative h-48 overflow-hidden",children:[n.jsx("img",{src:ce.image,alt:ce.name,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"}),ce.discount&&n.jsxs("div",{className:"absolute top-4 right-4 bg-red-500 text-white px-2 py-1 rounded-lg text-sm font-medium",children:["-",ce.discount,"%"]}),n.jsx("div",{className:"absolute top-4 left-4",children:L?n.jsxs("div",{className:"flex gap-1",children:[n.jsx("button",{onClick:()=>q(ce),className:"p-2 rounded-full bg-white bg-opacity-80 text-blue-600 hover:bg-blue-500 hover:text-white transition-all",children:n.jsx(Oa,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>se(ce),className:"p-2 rounded-full bg-white bg-opacity-80 text-red-600 hover:bg-red-500 hover:text-white transition-all",children:n.jsx(ir,{className:"w-4 h-4"})})]}):n.jsx("button",{onClick:()=>p(ce.id),className:`p-2 rounded-full transition-all ${h.includes(ce.id)?"bg-red-500 text-white":"bg-white bg-opacity-80 text-gray-600 hover:bg-red-500 hover:text-white"}`,children:n.jsx(fa,{className:"w-4 h-4"})})}),n.jsx("div",{className:"absolute bottom-4 left-4",children:n.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-medium ${ce.inStock?"bg-green-500 text-white":"bg-red-500 text-white"}`,children:ce.inStock?e("store.inStock"):e("store.outOfStock")})})]}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"text-sm font-medium",children:ce.rating})]}),n.jsx("span",{className:"text-gray-300",children:"•"}),n.jsxs("span",{className:"text-sm text-gray-600",children:["(",ce.reviews," ",e("store.reviews"),")"]})]}),n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2 group-hover:text-purple-600 transition-colors",children:ce.name}),n.jsx("p",{className:"text-gray-600 mb-4 line-clamp-2 leading-relaxed",children:ce.description}),n.jsx("div",{className:"mb-4",children:n.jsxs("div",{className:"flex flex-wrap gap-1",children:[ce.features.slice(0,2).map((oe,Ve)=>n.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:oe},Ve)),ce.features.length>2&&n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["+",ce.features.length-2," ",e("store.more")]})]})}),n.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[n.jsxs("span",{className:"text-2xl font-bold text-purple-600",children:[ce.price," ",e("store.currency")]}),ce.originalPrice&&n.jsxs("span",{className:"text-lg text-gray-400 line-through",children:[ce.originalPrice," ",e("store.currency")]})]}),n.jsx("div",{className:"flex gap-2",children:L?n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:()=>q(ce),className:"flex-1 bg-blue-500 text-white py-2 px-4 rounded-xl hover:bg-blue-600 transition-colors font-medium flex items-center justify-center gap-2",children:[n.jsx(Oa,{className:"w-4 h-4"}),"تعديل"]}),n.jsx("button",{onClick:()=>se(ce),className:"px-4 py-2 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors",children:n.jsx(ir,{className:"w-4 h-4"})})]}):n.jsxs(n.Fragment,{children:[f[ce.id]?n.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[n.jsx("button",{onClick:()=>x(ce.id),className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:n.jsx(Uj,{className:"w-4 h-4"})}),n.jsx("span",{className:"flex-1 text-center font-medium",children:f[ce.id]}),n.jsx("button",{onClick:()=>m(ce.id),className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:n.jsx(gt,{className:"w-4 h-4"})})]}):n.jsxs("button",{onClick:()=>m(ce.id),disabled:!ce.inStock,className:"flex-1 bg-purple-500 text-white py-2 px-4 rounded-xl hover:bg-purple-600 transition-colors font-medium disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[n.jsx(Br,{className:"w-4 h-4"}),e("store.addToCart")]}),n.jsx("button",{onClick:()=>me(ce.id),className:"px-4 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:n.jsx(sr,{className:"w-4 h-4"})})]})})]})]},ce.id))}),xe.length===0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(ut,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("store.noProductsFound")}),n.jsx("p",{className:"text-gray-600 mb-4",children:a.length===0?e("store.noProductsInStore"):e("store.tryChangingFilters")}),n.jsxs("div",{className:"flex justify-center gap-4",children:[r&&L&&n.jsxs("button",{onClick:Q,className:"px-6 py-2 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors flex items-center gap-2",children:[n.jsx(gt,{className:"w-4 h-4"}),"إضافة منتج جديد"]}),a.length>0&&n.jsx("button",{onClick:()=>{v("all"),b("")},className:"px-6 py-2 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors",children:e("common.resetFilters")})]})]}),!L&&g()>0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"fixed bottom-6 right-6 bg-white rounded-2xl shadow-2xl p-6 border border-gray-200 z-50",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:e("store.cartSummary")}),n.jsxs("div",{className:"space-y-2 mb-4",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{children:[e("store.numberOfProducts"),":"]}),n.jsx("span",{className:"font-medium",children:g()})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{children:[e("store.total"),":"]}),n.jsxs("span",{className:"font-bold text-purple-600",children:[y(a).toFixed(2)," ",e("store.currency")]})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(Ee,{to:"/cart",className:"flex-1 bg-purple-500 text-white py-2 px-4 rounded-xl hover:bg-purple-600 transition-colors font-medium",children:e("store.checkout")}),n.jsx(Ee,{to:"/cart",className:"px-4 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("store.viewCart")})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gray-50 rounded-2xl p-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6 text-center",children:e("store.whyChooseUs")}),n.jsxs("div",{className:"grid md:grid-cols-4 gap-6",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(oc,{className:"w-8 h-8 text-green-600"})}),n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:e("store.features.freeShipping")}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("store.features.freeShippingDesc")})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(Ga,{className:"w-8 h-8 text-blue-600"})}),n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:e("store.features.qualityGuarantee")}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("store.features.qualityGuaranteeDesc")})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-purple-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(Ys,{className:"w-8 h-8 text-purple-600"})}),n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:e("store.features.securePayment")}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("store.features.securePaymentDesc")})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-orange-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(Cf,{className:"w-8 h-8 text-orange-600"})}),n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:e("store.features.easyReturns")}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("store.features.easyReturnsDesc")})]})]})]}),n.jsx(HE,{isOpen:j,onClose:()=>N(!1),onSubmit:Ae,editingItem:k}),n.jsx(Jg,{isOpen:E,onClose:()=>P(!1),onConfirm:ve,itemName:(M==null?void 0:M.name)||"",isDeleting:F}),n.jsx(Jg,{isOpen:C,onClose:()=>T(!1),onConfirm:we,itemName:"جميع المنتجات",isDeleting:V}),n.jsx(zE,{isOpen:I,onClose:()=>K(!1),item:z,onAddToCart:m,onToggleWishlist:p,isInWishlist:z?h.includes(z.id):!1})]})},r2=30,Hh=200,a2=.15,GE=()=>{const{t:e}=yt(),{cart:t,wishlist:r,addToCart:a,removeFromCart:s,updateQuantity:i,clearCart:o,toggleWishlist:l,getTotalItems:c,getTotalPrice:d}=Lx(),{storeItems:u,loading:f,error:h}=Df(),[m,x]=O.useState(""),[p,g]=O.useState(null),[y,w]=O.useState(null),[v,_]=O.useState(!1),[b,j]=O.useState(0),N=Object.entries(t).map(([M,A])=>({item:u.find(H=>H.id===M),quantity:A})).filter(({item:M})=>M!==void 0),k=d(u),S=k>Hh?0:r2,E=k*a2,P=k+S+E-b,C=M=>{window.confirm("هل أنت متأكد من حذف هذا المنتج من السلة؟")&&i(M,0)},T=()=>{if(!m.trim()){g("يرجى إدخال كود الخصم");return}_(!0),g(null),w(null),setTimeout(()=>{if(m.toUpperCase()==="DISCOUNT20"){const M=k*.2;j(M),w("تم تطبيق الخصم بنجاح!")}else g("كود الخصم غير صالح");_(!1)},1e3)};return f?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-purple-500"})}):h?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(pt,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:h})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-purple-600 to-pink-600 rounded-2xl p-6 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(Br,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"سلة التسوق"}),n.jsx("p",{className:"opacity-90",children:"مراجعة وإدارة منتجاتك"})]})]})}),n.jsx("div",{className:"flex items-center",children:n.jsxs(Ee,{to:"/store",className:"flex items-center gap-2 text-purple-600 hover:text-purple-800 transition-colors",children:[n.jsx(Jn,{className:"w-5 h-5"}),n.jsx("span",{children:"العودة إلى المتجر"})]})}),n.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[n.jsx("div",{className:"lg:col-span-2",children:n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800",children:["المنتجات (",c(),")"]}),N.length>0&&n.jsxs("button",{onClick:()=>o(),className:"text-red-600 hover:text-red-800 transition-colors text-sm flex items-center gap-1",children:[n.jsx(ir,{className:"w-4 h-4"}),"حذف الكل"]})]}),N.length>0?n.jsx("div",{className:"space-y-4",children:N.map(({item:M,quantity:A})=>M&&n.jsxs("div",{className:"flex items-center gap-4 p-4 border border-gray-200 rounded-xl hover:shadow-md transition-all",children:[n.jsx("div",{className:"w-20 h-20 rounded-lg overflow-hidden flex-shrink-0",children:n.jsx("img",{src:M.image,alt:M.name,className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"font-medium text-gray-800 mb-1",children:M.name}),n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 mb-2",children:[n.jsxs("span",{children:["الفئة: ",M.category==="electronics"?e("store.categories.electronics"):M.category==="tools"?e("store.categories.tools"):M.category==="materials"?e("store.categories.materials"):M.category==="books"?e("store.categories.books"):M.category==="software"?e("store.categories.software"):M.category]}),M.inStock?n.jsx("span",{className:"text-green-600",children:"متوفر"}):n.jsx("span",{className:"text-red-600",children:"غير متوفر"})]}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>s(M.id),className:"p-1 border border-gray-300 rounded hover:bg-gray-100 transition-colors",children:n.jsx(Uj,{className:"w-4 h-4"})}),n.jsx("span",{className:"w-8 text-center",children:A}),n.jsx("button",{onClick:()=>a(M.id),className:"p-1 border border-gray-300 rounded hover:bg-gray-100 transition-colors",children:n.jsx(gt,{className:"w-4 h-4"})})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>l(M.id),className:`p-1 rounded transition-colors ${r.includes(M.id)?"text-red-600 hover:text-red-800":"text-gray-400 hover:text-red-600"}`,children:n.jsx(fa,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>C(M.id),className:"p-1 text-gray-400 hover:text-red-600 transition-colors",children:n.jsx(ir,{className:"w-4 h-4"})})]})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("div",{className:"text-lg font-bold text-purple-600",children:[M.price," ",e("store.currency")]}),n.jsxs("div",{className:"text-sm text-gray-500",children:["الإجمالي: ",(M.price*A).toFixed(2)," ",e("store.currency")]})]})]},M.id))}):n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(Br,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"سلة التسوق فارغة"}),n.jsx("p",{className:"text-gray-600 mb-4",children:"لم تقم بإضافة أي منتجات إلى سلة التسوق بعد"}),n.jsxs(Ee,{to:"/store",className:"px-6 py-2 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors inline-flex items-center gap-2",children:[n.jsx(Br,{className:"w-4 h-4"}),"تسوق الآن"]})]}),N.length>10&&n.jsx("div",{className:"flex justify-center mt-6",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{className:"p-2 rounded-lg border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:n.jsx(Ml,{className:"w-5 h-5"})}),n.jsx("span",{className:"px-4 py-2",children:"صفحة 1 من 2"}),n.jsx("button",{className:"p-2 rounded-lg border border-gray-300 hover:bg-gray-50",children:n.jsx($l,{className:"w-5 h-5"})})]})})]})}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"space-y-6",children:[n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-6",children:"ملخص الطلب"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"المجموع الفرعي"}),n.jsxs("span",{className:"font-medium",children:[k.toFixed(2)," ",e("store.currency")]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"الشحن"}),S===0?n.jsx("span",{className:"text-green-600",children:"مجاني"}):n.jsxs("span",{className:"font-medium",children:[S.toFixed(2)," ",e("store.currency")]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"ضريبة القيمة المضافة (15%)"}),n.jsxs("span",{className:"font-medium",children:[E.toFixed(2)," ",e("store.currency")]})]}),b>0&&n.jsxs("div",{className:"flex justify-between text-green-600",children:[n.jsx("span",{children:"الخصم"}),n.jsxs("span",{className:"font-medium",children:["-",b.toFixed(2)," ",e("store.currency")]})]}),n.jsx("div",{className:"border-t border-gray-200 pt-4 mt-2",children:n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-lg font-bold text-gray-800",children:"الإجمالي"}),n.jsxs("span",{className:"text-lg font-bold text-purple-600",children:[P.toFixed(2)," ",e("store.currency")]})]})})]}),n.jsxs("div",{className:"mt-6",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"كود الخصم"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"text",value:m,onChange:M=>x(M.target.value),placeholder:"أدخل كود الخصم",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),n.jsx("button",{onClick:T,disabled:v,className:"px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:v?"جاري التطبيق...":"تطبيق"})]}),p&&n.jsx("p",{className:"mt-2 text-sm text-red-600",children:p}),y&&n.jsx("p",{className:"mt-2 text-sm text-green-600",children:y}),n.jsx("p",{className:"mt-2 text-xs text-gray-500",children:'جرب كود "DISCOUNT20" للحصول على خصم 20%'})]}),n.jsxs(Ee,{to:"/checkout",className:`w-full mt-6 px-6 py-3 bg-purple-600 text-white rounded-xl font-medium flex items-center justify-center gap-2 ${N.length===0?"opacity-50 cursor-not-allowed pointer-events-none":"hover:bg-purple-700 transition-colors"}`,children:[n.jsx(Ys,{className:"w-5 h-5"}),"المتابعة للدفع"]})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h2",{className:"text-lg font-bold text-gray-800 mb-4",children:"معلومات الشحن"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:n.jsx(oc,{className:"w-5 h-5 text-green-600"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800",children:"شحن مجاني"}),n.jsxs("p",{className:"text-sm text-gray-600",children:["للطلبات فوق ",Hh," ريال"]})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:n.jsx(Cf,{className:"w-5 h-5 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800",children:"توصيل سريع"}),n.jsx("p",{className:"text-sm text-gray-600",children:"خلال 2-5 أيام عمل"})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:n.jsx(Ga,{className:"w-5 h-5 text-purple-600"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800",children:"ضمان الجودة"}),n.jsx("p",{className:"text-sm text-gray-600",children:"ضمان استرجاع لمدة 30 يوم"})]})]})]})]})]})]})]})},KE=()=>{const{t:e}=yt(),t=Go(),{user:r}=vt(),{cart:a,clearCart:s,getTotalItems:i,getTotalPrice:o}=Lx(),{storeItems:l,loading:c,error:d}=Df(),[u,f]=O.useState({fullName:(r==null?void 0:r.name)||"",email:(r==null?void 0:r.email)||"",phone:(r==null?void 0:r.phone)||"",address:"",city:"",postalCode:"",country:"Saudi Arabia",notes:"",saveInfo:!0,paymentMethod:"credit-card",cardNumber:"",cardName:"",cardExpiry:"",cardCvv:"",agreeToTerms:!1}),[h,m]=O.useState(!1),[x,p]=O.useState(null),[g,y]=O.useState(!1),[w,v]=O.useState(null),[_,b]=O.useState(!0),[j,N]=O.useState(!0),[k,S]=O.useState(!0),E=Object.entries(a).map(([L,ee])=>({item:l.find(K=>K.id===L),quantity:ee})).filter(({item:L})=>L!==void 0),P=o(l),C=P>Hh?0:r2,T=P*a2,M=P+C+T,A=(L,ee)=>{f(I=>({...I,[L]:ee}))},F=()=>{if(!u.fullName||!u.email||!u.phone||!u.address||!u.city)return p("يرجى ملء جميع الحقول المطلوبة"),!1;if(!u.agreeToTerms)return p("يجب الموافقة على الشروط والأحكام للمتابعة"),!1;if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u.email))return p("يرجى إدخال بريد إلكتروني صحيح"),!1;if(!/^\d{9,15}$/.test(u.phone.replace(/\D/g,"")))return p("يرجى إدخال رقم هاتف صحيح"),!1;if(u.paymentMethod==="credit-card"){if(!u.cardNumber||!u.cardName||!u.cardExpiry||!u.cardCvv)return p("يرجى إدخال جميع تفاصيل بطاقة الائتمان"),!1;if(!/^\d{16}$/.test(u.cardNumber.replace(/\D/g,"")))return p("يرجى إدخال رقم بطاقة صحيح (16 رقم)"),!1;if(!/^(0[1-9]|1[0-2])\/([0-9]{2})$/.test(u.cardExpiry))return p("يرجى إدخال تاريخ انتهاء صلاحية صحيح (MM/YY)"),!1;if(!/^\d{3,4}$/.test(u.cardCvv))return p("يرجى إدخال رمز CVV صحيح (3-4 أرقام)"),!1}return p(null),!0},H=async L=>{if(L.preventDefault(),!!F()){m(!0);try{await new Promise(I=>setTimeout(I,2e3));const ee=Math.floor(1e5+Math.random()*9e5).toString();v(ee),s(),y(!0)}catch(ee){console.error("Error processing order:",ee),p("حدث خطأ أثناء معالجة الطلب. يرجى المحاولة مرة أخرى.")}finally{m(!1)}}},V=L=>{const I=L.replace(/\s+/g,"").replace(/[^0-9]/gi,"").match(/\d{4,16}/g),K=I&&I[0]||"",z=[];for(let W=0,re=K.length;W<re;W+=4)z.push(K.substring(W,W+4));return z.length?z.join(" "):L},B=L=>{const ee=L.replace(/\s+/g,"").replace(/[^0-9]/gi,"");return ee.length>=2?`${ee.substring(0,2)}/${ee.substring(2,4)}`:ee};return c?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-purple-500"})}):d?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(pt,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:d})]})}):E.length===0&&!g?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Br,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"سلة التسوق فارغة"}),n.jsx("p",{className:"text-gray-600 mb-4",children:"يرجى إضافة منتجات إلى سلة التسوق قبل المتابعة للدفع"}),n.jsxs(Ee,{to:"/store",className:"px-6 py-2 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors inline-flex items-center gap-2",children:[n.jsx(Br,{className:"w-4 h-4"}),"تسوق الآن"]})]})}):g?n.jsxs("div",{className:"space-y-6",children:[n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-green-600 to-teal-600 rounded-2xl p-6 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(ze,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"تم إتمام الطلب بنجاح"}),n.jsx("p",{className:"opacity-90",children:"شكراً لك على الطلب!"})]})]})}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl shadow-lg p-8 text-center",children:[n.jsx("div",{className:"w-24 h-24 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:n.jsx(ze,{className:"w-12 h-12 text-green-600"})}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"تم استلام طلبك"}),n.jsxs("p",{className:"text-gray-600 mb-6",children:["لقد تم استلام طلبك بنجاح وسيتم معالجته في أقرب وقت ممكن.",n.jsx("br",{}),"سيتم إرسال تأكيد الطلب إلى بريدك الإلكتروني."]}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-6 mb-6 inline-block",children:[n.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:["رقم الطلب: #",w]}),n.jsx("p",{className:"text-gray-600",children:"يرجى الاحتفاظ بهذا الرقم للرجوع إليه في المستقبل"})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[n.jsx(Ee,{to:"/store",className:"px-6 py-3 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors",children:"العودة إلى المتجر"}),n.jsx("button",{onClick:()=>t("/"),className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"الذهاب إلى الصفحة الرئيسية"})]})]})]}):n.jsxs("div",{className:"space-y-6",children:[n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-purple-600 to-pink-600 rounded-2xl p-6 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(Ys,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"إتمام الطلب"}),n.jsx("p",{className:"opacity-90",children:"أدخل بيانات الشحن والدفع"})]})]})}),n.jsx("div",{className:"flex items-center",children:n.jsxs(Ee,{to:"/cart",className:"flex items-center gap-2 text-purple-600 hover:text-purple-800 transition-colors",children:[n.jsx(Jn,{className:"w-5 h-5"}),n.jsx("span",{children:"العودة إلى سلة التسوق"})]})}),n.jsx("form",{onSubmit:H,children:n.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[x&&n.jsxs(te.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl flex items-start gap-2",children:[n.jsx(pt,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:x})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[n.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between cursor-pointer",onClick:()=>b(!_),children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:n.jsx(oc,{className:"w-5 h-5 text-purple-600"})}),n.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"معلومات الشحن"})]}),_?n.jsx(U0,{className:"w-5 h-5 text-gray-500"}):n.jsx(W0,{className:"w-5 h-5 text-gray-500"})]}),_&&n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الاسم الكامل *"}),n.jsxs("div",{className:"relative",children:[n.jsx(xr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:u.fullName,onChange:L=>A("fullName",L.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل الاسم الكامل",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"البريد الإلكتروني *"}),n.jsxs("div",{className:"relative",children:[n.jsx(Ta,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"email",value:u.email,onChange:L=>A("email",L.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل البريد الإلكتروني",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم الهاتف *"}),n.jsxs("div",{className:"relative",children:[n.jsx(Pr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"tel",value:u.phone,onChange:L=>A("phone",L.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل رقم الهاتف",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المدينة *"}),n.jsxs("div",{className:"relative",children:[n.jsx(jn,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:u.city,onChange:L=>A("city",L.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل المدينة",required:!0})]})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"العنوان *"}),n.jsxs("div",{className:"relative",children:[n.jsx($j,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:u.address,onChange:L=>A("address",L.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل العنوان بالتفصيل",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الرمز البريدي"}),n.jsxs("div",{className:"relative",children:[n.jsx(Of,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:u.postalCode,onChange:L=>A("postalCode",L.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل الرمز البريدي"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الدولة"}),n.jsxs("div",{className:"relative",children:[n.jsx(rc,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsxs("select",{value:u.country,onChange:L=>A("country",L.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[n.jsx("option",{value:"Saudi Arabia",children:"المملكة العربية السعودية"}),n.jsx("option",{value:"United Arab Emirates",children:"الإمارات العربية المتحدة"}),n.jsx("option",{value:"Kuwait",children:"الكويت"}),n.jsx("option",{value:"Bahrain",children:"البحرين"}),n.jsx("option",{value:"Oman",children:"عمان"}),n.jsx("option",{value:"Qatar",children:"قطر"})]})]})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ملاحظات إضافية"}),n.jsx("textarea",{value:u.notes,onChange:L=>A("notes",L.target.value),rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أي ملاحظات خاصة بالطلب أو الشحن"})]})]}),n.jsx("div",{className:"mt-4",children:n.jsxs("label",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",checked:u.saveInfo,onChange:L=>A("saveInfo",L.target.checked),className:"w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),n.jsx("span",{className:"mr-2 text-sm text-gray-700",children:"حفظ هذه المعلومات للطلبات القادمة"})]})})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[n.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between cursor-pointer",onClick:()=>N(!j),children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:n.jsx(Ys,{className:"w-5 h-5 text-purple-600"})}),n.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"طريقة الدفع"})]}),j?n.jsx(U0,{className:"w-5 h-5 text-gray-500"}):n.jsx(W0,{className:"w-5 h-5 text-gray-500"})]}),j&&n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"space-y-4 mb-6",children:[n.jsxs("label",{className:"flex items-center p-4 border border-gray-200 rounded-xl cursor-pointer hover:bg-gray-50 transition-colors",children:[n.jsx("input",{type:"radio",name:"paymentMethod",value:"credit-card",checked:u.paymentMethod==="credit-card",onChange:()=>A("paymentMethod","credit-card"),className:"text-purple-600"}),n.jsxs("div",{className:"mr-3",children:[n.jsx("p",{className:"font-medium text-gray-800",children:"بطاقة ائتمان"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Visa, Mastercard, American Express"})]}),n.jsxs("div",{className:"mr-auto flex gap-2",children:[n.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/5/5e/Visa_Inc._logo.svg/2560px-Visa_Inc._logo.svg.png",alt:"Visa",className:"h-6"}),n.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/2/2a/Mastercard-logo.svg/1280px-Mastercard-logo.svg.png",alt:"Mastercard",className:"h-6"}),n.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/f/fa/American_Express_logo_%282018%29.svg/1200px-American_Express_logo_%282018%29.svg.png",alt:"American Express",className:"h-6"})]})]}),n.jsxs("label",{className:"flex items-center p-4 border border-gray-200 rounded-xl cursor-pointer hover:bg-gray-50 transition-colors",children:[n.jsx("input",{type:"radio",name:"paymentMethod",value:"mada",checked:u.paymentMethod==="mada",onChange:()=>A("paymentMethod","mada"),className:"text-purple-600"}),n.jsxs("div",{className:"mr-3",children:[n.jsx("p",{className:"font-medium text-gray-800",children:"مدى"}),n.jsx("p",{className:"text-sm text-gray-600",children:"الدفع ببطاقة مدى"})]}),n.jsx("div",{className:"mr-auto",children:n.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/ar/b/b0/Mada_Logo.png",alt:"Mada",className:"h-6"})})]}),n.jsxs("label",{className:"flex items-center p-4 border border-gray-200 rounded-xl cursor-pointer hover:bg-gray-50 transition-colors",children:[n.jsx("input",{type:"radio",name:"paymentMethod",value:"apple-pay",checked:u.paymentMethod==="apple-pay",onChange:()=>A("paymentMethod","apple-pay"),className:"text-purple-600"}),n.jsxs("div",{className:"mr-3",children:[n.jsx("p",{className:"font-medium text-gray-800",children:"Apple Pay"}),n.jsx("p",{className:"text-sm text-gray-600",children:"الدفع باستخدام Apple Pay"})]}),n.jsx("div",{className:"mr-auto",children:n.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/b/b0/Apple_Pay_logo.svg/2560px-Apple_Pay_logo.svg.png",alt:"Apple Pay",className:"h-6"})})]}),n.jsxs("label",{className:"flex items-center p-4 border border-gray-200 rounded-xl cursor-pointer hover:bg-gray-50 transition-colors",children:[n.jsx("input",{type:"radio",name:"paymentMethod",value:"cash-on-delivery",checked:u.paymentMethod==="cash-on-delivery",onChange:()=>A("paymentMethod","cash-on-delivery"),className:"text-purple-600"}),n.jsxs("div",{className:"mr-3",children:[n.jsx("p",{className:"font-medium text-gray-800",children:"الدفع عند الاستلام"}),n.jsx("p",{className:"text-sm text-gray-600",children:"ادفع نقداً عند استلام الطلب"})]})]})]}),u.paymentMethod==="credit-card"&&n.jsxs("div",{className:"space-y-4 border-t border-gray-200 pt-4",children:[n.jsx("h3",{className:"font-medium text-gray-800 mb-2",children:"تفاصيل البطاقة"}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم البطاقة *"}),n.jsxs("div",{className:"relative",children:[n.jsx(Ys,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:u.cardNumber,onChange:L=>A("cardNumber",V(L.target.value)),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"XXXX XXXX XXXX XXXX",maxLength:19,required:u.paymentMethod==="credit-card"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الاسم على البطاقة *"}),n.jsxs("div",{className:"relative",children:[n.jsx(xr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:u.cardName,onChange:L=>A("cardName",L.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"الاسم كما يظهر على البطاقة",required:u.paymentMethod==="credit-card"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ الانتهاء *"}),n.jsx("input",{type:"text",value:u.cardExpiry,onChange:L=>A("cardExpiry",B(L.target.value)),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"MM/YY",maxLength:5,required:u.paymentMethod==="credit-card"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رمز الأمان (CVV) *"}),n.jsxs("div",{className:"relative",children:[n.jsx(ac,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:u.cardCvv,onChange:L=>A("cardCvv",L.target.value.replace(/\D/g,"").slice(0,4)),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"XXX",maxLength:4,required:u.paymentMethod==="credit-card"})]})]})]})]}),n.jsx("div",{className:"mt-6 bg-gray-50 p-4 rounded-xl",children:n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(ac,{className:"w-4 h-4 text-green-600"}),n.jsx("span",{children:"جميع المعاملات مشفرة وآمنة. بياناتك محمية."})]})})]})]}),n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"bg-white rounded-2xl shadow-lg p-6",children:n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx("input",{type:"checkbox",id:"agreeToTerms",checked:u.agreeToTerms,onChange:L=>A("agreeToTerms",L.target.checked),className:"mt-1 w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500",required:!0}),n.jsxs("label",{htmlFor:"agreeToTerms",className:"text-sm text-gray-700",children:["أوافق على ",n.jsx("a",{href:"#",className:"text-purple-600 hover:underline",children:"الشروط والأحكام"})," و ",n.jsx("a",{href:"#",className:"text-purple-600 hover:underline",children:"سياسة الخصوصية"})]})]})})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"space-y-6",children:[n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[n.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between cursor-pointer",onClick:()=>S(!k),children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:n.jsx(Br,{className:"w-5 h-5 text-purple-600"})}),n.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"ملخص الطلب"})]}),k?n.jsx(U0,{className:"w-5 h-5 text-gray-500"}):n.jsx(W0,{className:"w-5 h-5 text-gray-500"})]}),k&&n.jsxs("div",{className:"p-6",children:[n.jsx("div",{className:"space-y-4 mb-6",children:E.map(({item:L,quantity:ee})=>L&&n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-16 h-16 rounded-lg overflow-hidden flex-shrink-0",children:n.jsx("img",{src:L.image,alt:L.name,className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h4",{className:"font-medium text-gray-800 text-sm",children:L.name}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("span",{className:"text-sm text-gray-500",children:["الكمية: ",ee]}),n.jsxs("span",{className:"font-medium text-purple-600",children:[(L.price*ee).toFixed(2)," ",e("store.currency")]})]})]})]},L.id))}),n.jsxs("div",{className:"space-y-3 border-t border-gray-200 pt-4",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"المجموع الفرعي"}),n.jsxs("span",{className:"font-medium",children:[P.toFixed(2)," ",e("store.currency")]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"الشحن"}),C===0?n.jsx("span",{className:"text-green-600",children:"مجاني"}):n.jsxs("span",{className:"font-medium",children:[C.toFixed(2)," ",e("store.currency")]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"ضريبة القيمة المضافة (15%)"}),n.jsxs("span",{className:"font-medium",children:[T.toFixed(2)," ",e("store.currency")]})]}),n.jsx("div",{className:"border-t border-gray-200 pt-3 mt-2",children:n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-lg font-bold text-gray-800",children:"الإجمالي"}),n.jsxs("span",{className:"text-lg font-bold text-purple-600",children:[M.toFixed(2)," ",e("store.currency")]})]})})]})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("button",{type:"submit",disabled:h,className:"w-full px-6 py-3 bg-purple-600 text-white rounded-xl hover:bg-purple-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:h?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"جاري معالجة الطلب..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Ys,{className:"w-5 h-5"}),"إتمام الطلب"]})}),n.jsxs("div",{className:"mt-4 flex items-center justify-center gap-4 text-sm text-gray-500",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Ga,{className:"w-4 h-4"}),n.jsx("span",{children:"دفع آمن"})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(oc,{className:"w-4 h-4"}),n.jsx("span",{children:"شحن سريع"})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(ze,{className:"w-4 h-4"}),n.jsx("span",{children:"ضمان الجودة"})]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-2xl p-6",children:[n.jsx("h3",{className:"font-medium text-gray-800 mb-2",children:"بحاجة إلى مساعدة؟"}),n.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"إذا كان لديك أي أسئلة أو استفسارات حول طلبك، يرجى التواصل مع فريق خدمة العملاء."}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors text-sm",children:"اتصل بنا"}),n.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors text-sm",children:"الأسئلة الشائعة"})]})]})]})]})})]})},qE=[{icon:xa,titleKey:"aiAssistant.features.projectIdeas.title",descriptionKey:"aiAssistant.features.projectIdeas.description",color:"from-yellow-400 to-orange-500"},{icon:n6,titleKey:"aiAssistant.features.programming.title",descriptionKey:"aiAssistant.features.programming.description",color:"from-blue-500 to-purple-600"},{icon:s6,titleKey:"aiAssistant.features.problemSolving.title",descriptionKey:"aiAssistant.features.problemSolving.description",color:"from-green-500 to-teal-600"},{icon:wt,titleKey:"aiAssistant.features.research.title",descriptionKey:"aiAssistant.features.research.description",color:"from-indigo-500 to-blue-600"},{icon:sc,titleKey:"aiAssistant.features.design.title",descriptionKey:"aiAssistant.features.design.description",color:"from-pink-500 to-rose-600"},{icon:rc,titleKey:"aiAssistant.features.languages.title",descriptionKey:"aiAssistant.features.languages.description",color:"from-purple-500 to-pink-600"}],XE=["aiAssistant.quickPrompts.aiProject","aiAssistant.quickPrompts.programming","aiAssistant.quickPrompts.mathProblem","aiAssistant.quickPrompts.entrepreneurship","aiAssistant.quickPrompts.presentation","aiAssistant.quickPrompts.timeManagement"],YE=[{id:"1",type:"user",message:"aiAssistant.mockConversation.user1",timestamp:"2024-01-21T10:00:00Z"},{id:"2",type:"assistant",message:"aiAssistant.mockConversation.assistant1",timestamp:"2024-01-21T10:00:30Z"},{id:"3",type:"user",message:"aiAssistant.mockConversation.user2",timestamp:"2024-01-21T10:01:00Z"},{id:"4",type:"assistant",message:"aiAssistant.mockConversation.assistant2",timestamp:"2024-01-21T10:01:45Z"}],JE=()=>{const{t:e}=yt(),[t,r]=O.useState(YE.map(u=>({...u,message:e(u.message)}))),[a,s]=O.useState(""),[i,o]=O.useState(!1),l=async()=>{if(!a.trim())return;const u={id:Date.now().toString(),type:"user",message:a,timestamp:new Date().toISOString()};r(f=>[...f,u]),s(""),o(!0),setTimeout(()=>{const f={id:(Date.now()+1).toString(),type:"assistant",message:e("aiAssistant.simulatedResponse"),timestamp:new Date().toISOString()};r(h=>[...h,f]),o(!1)},2e3)},c=u=>{s(e(u))},d=u=>new Date(u).toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit"});return n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(Xs,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("aiAssistant.title")}),n.jsx("p",{className:"opacity-90",children:e("aiAssistant.subtitle")})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"24/7"}),n.jsx("div",{className:"text-sm opacity-80",children:e("aiAssistant.stats.alwaysAvailable")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"∞"}),n.jsx("div",{className:"text-sm opacity-80",children:e("aiAssistant.stats.unlimitedQuestions")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"6"}),n.jsx("div",{className:"text-sm opacity-80",children:e("aiAssistant.stats.specializations")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"AI"}),n.jsx("div",{className:"text-sm opacity-80",children:e("aiAssistant.stats.artificialIntelligence")})]})]})]}),n.jsxs("div",{className:"grid lg:grid-cols-4 gap-6",children:[n.jsxs(te.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.1},className:"lg:col-span-1 space-y-4",children:[n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[n.jsx(a6,{className:"w-5 h-5 text-purple-600"}),e("aiAssistant.howCanIHelp")]}),n.jsx("div",{className:"space-y-3",children:qE.map((u,f)=>n.jsx(te.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.4,delay:f*.1},className:"group cursor-pointer",children:n.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-xl hover:bg-gray-50 transition-colors",children:[n.jsx("div",{className:`w-10 h-10 bg-gradient-to-r ${u.color} rounded-lg flex items-center justify-center flex-shrink-0`,children:n.jsx(u.icon,{className:"w-5 h-5 text-white"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800 group-hover:text-purple-600 transition-colors",children:e(u.titleKey)}),n.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:e(u.descriptionKey)})]})]})},f))})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:e("aiAssistant.quickPrompts.title")}),n.jsx("div",{className:"space-y-2",children:XE.map((u,f)=>n.jsx("button",{onClick:()=>c(u),className:"w-full text-right p-3 text-sm text-gray-700 hover:bg-purple-50 hover:text-purple-700 rounded-lg transition-colors",children:e(u)},f))})]})]}),n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"lg:col-span-3",children:n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg h-[600px] flex flex-col",children:[n.jsx("div",{className:"p-6 border-b border-gray-200",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center",children:n.jsx(Xs,{className:"w-6 h-6 text-white"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-gray-800",children:e("aiAssistant.chatHeader.title")}),n.jsxs("p",{className:"text-sm text-green-600 flex items-center gap-1",children:[n.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e("aiAssistant.chatHeader.online")]})]})]})}),n.jsxs("div",{className:"flex-1 p-6 overflow-y-auto space-y-4",children:[t.map(u=>n.jsx(te.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:`flex ${u.type==="user"?"justify-end":"justify-start"}`,children:n.jsxs("div",{className:`flex gap-3 max-w-[80%] ${u.type==="user"?"flex-row-reverse":""}`,children:[n.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${u.type==="user"?"bg-blue-500":"bg-gradient-to-r from-purple-500 to-pink-500"}`,children:u.type==="user"?n.jsx(xr,{className:"w-4 h-4 text-white"}):n.jsx(Xs,{className:"w-4 h-4 text-white"})}),n.jsxs("div",{className:`rounded-2xl p-4 ${u.type==="user"?"bg-blue-500 text-white":"bg-gray-100 text-gray-800"}`,children:[n.jsx("p",{className:"whitespace-pre-line leading-relaxed",children:u.message}),n.jsx("p",{className:`text-xs mt-2 ${u.type==="user"?"text-blue-100":"text-gray-500"}`,children:d(u.timestamp)})]})]})},u.id)),i&&n.jsx(te.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex justify-start",children:n.jsxs("div",{className:"flex gap-3 max-w-[80%]",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-purple-500 to-pink-500 flex items-center justify-center flex-shrink-0",children:n.jsx(Xs,{className:"w-4 h-4 text-white"})}),n.jsx("div",{className:"bg-gray-100 rounded-2xl p-4",children:n.jsxs("div",{className:"flex gap-1",children:[n.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),n.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),n.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})]})})]}),n.jsxs("div",{className:"p-6 border-t border-gray-200",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("button",{className:"p-3 rounded-xl bg-gray-100 hover:bg-gray-200 transition-colors",children:n.jsx(Bj,{className:"w-5 h-5 text-gray-600"})}),n.jsx("div",{className:"flex-1 relative",children:n.jsx("input",{type:"text",value:a,onChange:u=>s(u.target.value),onKeyPress:u=>u.key==="Enter"&&l(),placeholder:e("aiAssistant.inputPlaceholder"),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"})}),n.jsx("button",{className:"p-3 rounded-xl bg-gray-100 hover:bg-gray-200 transition-colors",children:n.jsx(i6,{className:"w-5 h-5 text-gray-600"})}),n.jsx("button",{onClick:l,disabled:!a.trim(),className:"p-3 rounded-xl bg-purple-500 hover:bg-purple-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:n.jsx(Mx,{className:"w-5 h-5 text-white"})})]}),n.jsx("div",{className:"mt-3 text-center",children:n.jsx("p",{className:"text-xs text-gray-500",children:e("aiAssistant.disclaimer")})})]})]})})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-6",children:[n.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[n.jsx(o6,{className:"w-6 h-6 text-purple-600"}),e("aiAssistant.tips.title")]}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"bg-white rounded-xl p-4",children:[n.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:e("aiAssistant.tips.beSpecific.title")}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("aiAssistant.tips.beSpecific.description")})]}),n.jsxs("div",{className:"bg-white rounded-xl p-4",children:[n.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:e("aiAssistant.tips.provideContext.title")}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("aiAssistant.tips.provideContext.description")})]}),n.jsxs("div",{className:"bg-white rounded-xl p-4",children:[n.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:e("aiAssistant.tips.askForExamples.title")}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("aiAssistant.tips.askForExamples.description")})]})]})]})]})},Wx=()=>{const[e,t]=O.useState([]),[r,a]=O.useState(!0),[s,i]=O.useState(null),o=async m=>{try{a(!0);const x=De(pe,"learning_resources");let p;m?p=et(x,Ue("type","==",m),ys(50)):p=et(x,Pi("created_at","desc"),ys(50));let y=(await Je(p)).docs.map(w=>{const v=w.data();return{id:w.id,title:v.title,description:v.description,type:v.type,category:v.category,author:v.author,duration:v.duration,difficulty:v.difficulty,rating:v.rating||4.5,views:v.views_count||0,likes:v.likes_count||0,thumbnail:v.thumbnail,contentUrl:v.contentUrl||v.content_url,watchUrl:v.watch_url||v.contentUrl||v.content_url,embedUrl:v.embed_url||v.videoUrl||v.video_url,tags:v.tags||[],featured:v.featured||!1,createdAt:v.created_at?new Date(v.created_at.toDate()).toISOString():new Date().toISOString(),lessons:v.lessons,certificate:v.certificate,fileSize:v.fileSize||v.file_size,episodes:v.episodes,downloadUrl:v.downloadUrl||v.download_url,videoUrl:v.videoUrl||v.video_url}});m&&(y=y.sort((w,v)=>new Date(v.createdAt).getTime()-new Date(w.createdAt).getTime())),t(y)}catch(x){console.error("Error fetching learning resources:",x),i(x instanceof Error?x.message:"حدث خطأ في تحميل المصادر التعليمية")}finally{a(!1)}},l=async m=>{try{const x=Ie(pe,"learning_resources",m);await Wt(x,{views_count:fi(1)}),t(p=>p.map(g=>g.id===m?{...g,views:g.views+1}:g))}catch(x){console.error("Error incrementing views:",x)}},c=async m=>{try{const x=Ie(pe,"learning_resources",m);await Wt(x,{likes_count:fi(1)}),t(p=>p.map(g=>g.id===m?{...g,likes:g.likes+1}:g))}catch(x){console.error("Error incrementing likes:",x)}},d=async m=>{try{const x=De(pe,"learning_resources");let p=m.watchUrl,g=m.embedUrl;if(m.type==="video"&&m.videoUrl){if(m.videoUrl.includes("embed")&&!p){const v=m.videoUrl.split("/").pop();v&&(p=`https://www.youtube.com/watch?v=${v}`)}if(m.videoUrl.includes("watch")&&!g){const v=new URL(m.videoUrl).searchParams.get("v");v&&(g=`https://www.youtube.com/embed/${v}`)}}const y={title:m.title||"",description:m.description||"",type:m.type||"video",category:m.category||"",author:m.author||"",duration:m.duration||null,difficulty:m.difficulty||null,rating:m.rating||4.5,views_count:0,likes_count:0,thumbnail:m.thumbnail||null,content_url:p||m.contentUrl||null,video_url:g||m.videoUrl||null,watch_url:p||m.watchUrl||m.contentUrl||null,embed_url:g||m.embedUrl||m.videoUrl||null,tags:m.tags||[],featured:m.featured||!1,created_at:Ge(),updated_at:Ge()};m.type==="course"?(y.lessons=m.lessons,y.certificate=m.certificate):m.type==="template"?(y.file_size=m.fileSize,y.download_url=m.downloadUrl):m.type==="podcast"&&(y.episodes=m.episodes);const w=await Aa(x,y);return await o(),{id:w.id,...y}}catch(x){throw console.error("Error creating learning resource:",x),x}},u=async(m,x)=>{try{const p=Ie(pe,"learning_resources",m);let g=x.watchUrl,y=x.embedUrl;if(x.type==="video"&&x.videoUrl){if(x.videoUrl.includes("embed")&&!g){const v=x.videoUrl.split("/").pop();v&&(g=`https://www.youtube.com/watch?v=${v}`)}if(x.videoUrl.includes("watch")&&!y){const v=new URL(x.videoUrl).searchParams.get("v");v&&(y=`https://www.youtube.com/embed/${v}`)}}const w={updated_at:Ge()};return x.title!==void 0&&(w.title=x.title),x.description!==void 0&&(w.description=x.description),x.type!==void 0&&(w.type=x.type),x.category!==void 0&&(w.category=x.category),x.author!==void 0&&(w.author=x.author),x.duration!==void 0&&(w.duration=x.duration),x.difficulty!==void 0&&(w.difficulty=x.difficulty),x.thumbnail!==void 0&&(w.thumbnail=x.thumbnail),x.contentUrl!==void 0&&(w.content_url=x.contentUrl),x.videoUrl!==void 0&&(w.video_url=x.videoUrl),g!==void 0&&(w.watch_url=g),y!==void 0&&(w.embed_url=y),x.tags!==void 0&&(w.tags=x.tags),x.featured!==void 0&&(w.featured=x.featured),x.type==="course"?(x.lessons!==void 0&&(w.lessons=x.lessons),x.certificate!==void 0&&(w.certificate=x.certificate)):x.type==="template"?(x.fileSize!==void 0&&(w.file_size=x.fileSize),x.downloadUrl!==void 0&&(w.download_url=x.downloadUrl)):x.type==="podcast"&&x.episodes!==void 0&&(w.episodes=x.episodes),await Wt(p,w),await o(),{id:m,...x}}catch(p){throw console.error("Error updating learning resource:",p),p}},f=async m=>{try{const x=Ie(pe,"learning_resources",m);return await Va(x),t(p=>p.filter(g=>g.id!==m)),!0}catch(x){throw console.error("Error deleting learning resource:",x),x}},h=async()=>{try{const m=await U6();return await o(),m}catch(m){throw console.error("Error cleaning up duplicate resources:",m),m}};return O.useEffect(()=>{o()},[]),{resources:e,loading:r,error:s,fetchResources:o,incrementViews:l,incrementLikes:c,createResource:d,updateResource:u,deleteResource:f,cleanupDuplicateResources:h}},ZE=()=>{const{t:e}=yt(),{resources:t,loading:r,error:a,incrementViews:s,incrementLikes:i}=Wx(),[o,l]=O.useState("all"),[c,d]=O.useState("all"),[u,f]=O.useState(""),[h,m]=O.useState([]),x=[{id:"all",name:e("resources.types.all"),icon:wt},{id:"article",name:e("resources.types.article"),icon:br},{id:"video",name:e("resources.types.video"),icon:jr},{id:"course",name:e("resources.types.course"),icon:pi},{id:"template",name:e("resources.types.template"),icon:Tr},{id:"podcast",name:e("resources.types.podcast"),icon:Ug},{id:"link",name:e("resources.types.link"),icon:ou}],p=[{id:"all",name:e("resources.categories.all")},{id:"project-management",name:e("resources.categories.projectManagement")},{id:"programming",name:e("resources.categories.programming")},{id:"design",name:e("resources.categories.design")},{id:"entrepreneurship",name:e("resources.categories.entrepreneurship")},{id:"stem",name:e("resources.categories.stem")},{id:"soft-skills",name:e("resources.categories.softSkills")}],g=t.filter(j=>{const N=o==="all"||j.type===o,k=c==="all"||j.category===c,S=j.title.toLowerCase().includes(u.toLowerCase())||j.description.toLowerCase().includes(u.toLowerCase())||j.tags.some(E=>E.toLowerCase().includes(u.toLowerCase()));return N&&k&&S}),y=j=>{h.includes(j)?m(N=>N.filter(k=>k!==j)):(m(N=>[...N,j]),i(j))},w=j=>{s(j)},v=j=>{const N=x.find(k=>k.id===j);return N?N.icon:br},_=j=>{switch(j){case"مبتدئ":case"beginner":return"bg-green-100 text-green-800";case"متوسط":case"intermediate":return"bg-yellow-100 text-yellow-800";case"متقدم":case"advanced":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},b=j=>{switch(j){case"مبتدئ":case"beginner":return e("resources.difficulties.beginner");case"متوسط":case"intermediate":return e("resources.difficulties.intermediate");case"متقدم":case"advanced":return e("resources.difficulties.advanced");default:return j}};return r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-emerald-500"})}):a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(oa,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:a})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-emerald-600 to-teal-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(wt,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("resources.title")}),n.jsx("p",{className:"opacity-90",children:e("resources.subtitle")})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.length}),n.jsx("div",{className:"text-sm opacity-80",children:e("resources.stats.learningResource")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:x.length-1}),n.jsx("div",{className:"text-sm opacity-80",children:e("resources.stats.contentType")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:p.length-1}),n.jsx("div",{className:"text-sm opacity-80",children:e("resources.stats.specialtyCategory")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"100%"}),n.jsx("div",{className:"text-sm opacity-80",children:e("resources.stats.free")})]})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsx("div",{className:"flex flex-col lg:flex-row gap-4 mb-6",children:n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ut,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("resources.searchPlaceholder"),value:u,onChange:j=>f(j.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]})}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("resources.filters.contentType")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:x.map(j=>n.jsxs("button",{onClick:()=>l(j.id),className:`flex items-center gap-2 px-4 py-2 rounded-xl transition-all ${o===j.id?"bg-emerald-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[n.jsx(j.icon,{className:"w-4 h-4"}),j.name]},j.id))})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("resources.filters.category")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:p.map(j=>n.jsx("button",{onClick:()=>d(j.id),className:`px-4 py-2 rounded-xl transition-all ${c===j.id?"bg-teal-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:j.name},j.id))})]})]}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:[e("resources.showing")," ",g.length," ",e("resources.of")," ",t.length," ",e("resources.resource")]})}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map((j,N)=>{var S;const k=v(j.type);return n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:N*.1},className:"bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 group",children:[n.jsxs("div",{className:"relative h-48 overflow-hidden",children:[n.jsx("img",{src:j.thumbnail||"https://images.pexels.com/photos/3184465/pexels-photo-3184465.jpeg?auto=compress&cs=tinysrgb&w=400",alt:j.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"}),j.featured&&n.jsx("div",{className:"absolute top-4 right-4 bg-yellow-500 text-white px-2 py-1 rounded-lg text-sm font-medium",children:e("resources.featured")}),n.jsx("div",{className:"absolute top-4 left-4",children:n.jsxs("div",{className:"bg-black bg-opacity-50 text-white px-2 py-1 rounded-lg text-xs flex items-center gap-1",children:[n.jsx(k,{className:"w-3 h-3"}),(S=x.find(E=>E.id===j.type))==null?void 0:S.name]})}),n.jsxs("div",{className:"absolute bottom-4 left-4 flex gap-2",children:[n.jsxs("div",{className:"bg-black bg-opacity-50 text-white px-2 py-1 rounded-lg text-xs flex items-center gap-1",children:[n.jsx(sr,{className:"w-3 h-3"}),j.views.toLocaleString()]}),n.jsxs("div",{className:"bg-black bg-opacity-50 text-white px-2 py-1 rounded-lg text-xs flex items-center gap-1",children:[n.jsx(fa,{className:"w-3 h-3"}),j.likes]})]})]}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"text-sm font-medium",children:j.rating})]}),n.jsx("span",{className:"text-gray-300",children:"•"}),n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${_(j.difficulty||"beginner")}`,children:b(j.difficulty||"beginner")})]}),n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2 group-hover:text-emerald-600 transition-colors line-clamp-2",children:j.title}),n.jsx("p",{className:"text-gray-600 mb-4 line-clamp-3 leading-relaxed",children:j.description}),n.jsxs("div",{className:"flex flex-wrap gap-1 mb-4",children:[j.tags.slice(0,3).map((E,P)=>n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["#",E]},P)),j.tags.length>3&&n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["+",j.tags.length-3," ",e("resources.more")]})]}),n.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-4",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(jt,{className:"w-4 h-4"}),j.duration||e("resources.defaultDuration")]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(lt,{className:"w-4 h-4"}),j.author]})]}),j.type==="course"&&j.lessons&&n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 mb-4",children:[n.jsxs("span",{children:[j.lessons," ",e("resources.lesson")]}),j.certificate&&n.jsx("span",{children:e("resources.certifiedCourse")})]}),j.type==="template"&&j.fileSize&&n.jsxs("div",{className:"text-sm text-gray-500 mb-4",children:[e("resources.fileSize"),": ",j.fileSize]}),j.type==="podcast"&&j.episodes&&n.jsxs("div",{className:"text-sm text-gray-500 mb-4",children:[j.episodes," ",e("resources.episode")]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>y(j.id),className:`p-2 rounded-lg transition-colors ${h.includes(j.id)?"bg-red-100 text-red-600":"bg-gray-100 text-gray-600 hover:bg-red-100 hover:text-red-600"}`,children:n.jsx(fa,{className:"w-4 h-4"})}),n.jsx("button",{className:"p-2 rounded-lg bg-gray-100 text-gray-600 hover:bg-blue-100 hover:text-blue-600 transition-colors",children:n.jsx(bs,{className:"w-4 h-4"})}),(j.type==="template"||j.downloadUrl)&&n.jsx("button",{className:"p-2 rounded-lg bg-gray-100 text-gray-600 hover:bg-green-100 hover:text-green-600 transition-colors",children:n.jsx(Tr,{className:"w-4 h-4"})})]}),j.type==="video"?n.jsxs("a",{href:j.watchUrl||j.contentUrl||"#",target:"_blank",rel:"noopener noreferrer",onClick:()=>w(j.id),className:"px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors text-sm font-medium flex items-center gap-2",children:[n.jsx(pi,{className:"w-4 h-4"}),e("resources.actions.watch")]}):n.jsxs("button",{onClick:()=>w(j.id),className:"px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors text-sm font-medium flex items-center gap-2",children:[j.type==="course"&&n.jsx(wt,{className:"w-4 h-4"}),j.type==="template"&&n.jsx(Tr,{className:"w-4 h-4"}),j.type==="podcast"&&n.jsx(Ug,{className:"w-4 h-4"}),j.type==="article"&&n.jsx(br,{className:"w-4 h-4"}),j.type==="link"&&n.jsx(ou,{className:"w-4 h-4"}),j.type==="course"&&e("resources.actions.startCourse"),j.type==="template"&&e("resources.actions.download"),j.type==="podcast"&&e("resources.actions.listen"),j.type==="article"&&e("resources.actions.read"),j.type==="link"&&e("resources.actions.visit")]})]})]})]},j.id)})}),g.length===0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(ut,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("resources.noResourcesFound")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("resources.tryChangingFilters")}),n.jsx("button",{onClick:()=>{l("all"),d("all"),f("")},className:"px-6 py-2 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors",children:e("common.resetFilters")})]})]})},QE=()=>{const[e,t]=O.useState([]),[r,a]=O.useState(!0),[s,i]=O.useState(null),{user:o}=vt(),l=async()=>{if(o)try{a(!0);const u=De(pe,"intellectual_property");let f;if(o.role==="student")f=et(u,Ue("student_id","==",o.id));else if(o.role==="teacher"){const x=De(pe,"users"),p=et(x,Ue("role","==","student"),Ue("school_id","==",o.school_id)),y=(await Je(p)).docs.map(w=>w.id);if(y.length>0)f=et(u,Ue("student_id","in",y));else{t([]),a(!1);return}}else f=u;const h=await Je(f),m=await Promise.all(h.docs.map(async x=>{const p=x.data();let g={id:p.student_id,name:"طالب غير معروف",avatar:"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",school:"مدرسة غير معروفة"};if(p.student_id){const w=Ie(pe,"users",p.student_id),v=await hr(w);if(v.exists()){const _=v.data();if(g.name=_.name,g.avatar=_.avatar_url||g.avatar,_.school_id){const b=Ie(pe,"schools",_.school_id),j=await hr(b);j.exists()&&(g.school=j.data().name)}}}let y=null;if(p.project_id){const w=Ie(pe,"projects",p.project_id),v=await hr(w);if(v.exists()){const _=v.data();y={id:v.id,title:_.title}}}return{id:x.id,title:p.title,description:p.description,type:p.type,status:p.status,student:g,project:y,submittedAt:p.submitted_at?new Date(p.submitted_at.toDate()).toISOString():new Date().toISOString(),reviewedAt:p.reviewed_at?new Date(p.reviewed_at.toDate()).toISOString():void 0,documents:p.documents||[],tags:p.tags||[],certificateNumber:p.certificate_number,rejectionReason:p.rejection_reason,estimatedReviewDate:p.estimated_review_date?new Date(p.estimated_review_date.toDate()).toISOString():void 0}}));t(m)}catch(u){console.error("Error fetching intellectual properties:",u),i(u instanceof Error?u.message:"حدث خطأ في تحميل طلبات الملكية الفكرية")}finally{a(!1)}},c=async u=>{var f;if(!o)throw new Error("يجب تسجيل الدخول أولاً");try{const h=De(pe,"intellectual_property"),m={student_id:o.id,project_id:(f=u.project)==null?void 0:f.id,title:u.title,description:u.description,type:u.type,status:"pending",documents:u.documents||[],tags:u.tags||[],submitted_at:Ge(),estimated_review_date:rn.fromDate(new Date(Date.now()+7*24*60*60*1e3))},x=await Aa(h,m);return await l(),{id:x.id,...m}}catch(h){throw console.error("Error creating intellectual property:",h),h}},d=async(u,f)=>{try{const h=Ie(pe,"intellectual_property",u),m={};f.status&&(m.status=f.status,f.status==="approved"?(m.reviewed_at=Ge(),f.certificateNumber&&(m.certificate_number=f.certificateNumber)):f.status==="rejected"&&(m.reviewed_at=Ge(),f.rejectionReason&&(m.rejection_reason=f.rejectionReason))),f.documents&&(m.documents=f.documents),f.tags&&(m.tags=f.tags),await Wt(h,m),await l()}catch(h){throw console.error("Error updating intellectual property:",h),h}};return O.useEffect(()=>{o&&l()},[o]),{intellectualProperties:e,loading:r,error:s,fetchIntellectualProperties:l,createIntellectualProperty:c,updateIntellectualProperty:d}},eA=()=>{const{t:e}=yt(),{intellectualProperties:t,loading:r,error:a}=QE(),[s,i]=O.useState("all"),[o,l]=O.useState("all"),[c,d]=O.useState(""),u=[{id:"all",name:e("intellectualProperty.types.all"),icon:wt,color:"from-gray-500 to-gray-600"},{id:"invention",name:e("intellectualProperty.types.invention"),icon:xa,color:"from-yellow-400 to-orange-500"},{id:"design",name:e("intellectualProperty.types.design"),icon:sc,color:"from-pink-500 to-rose-600"},{id:"software",name:e("intellectualProperty.types.software"),icon:Wg,color:"from-blue-500 to-purple-600"},{id:"research",name:e("intellectualProperty.types.research"),icon:wt,color:"from-green-500 to-teal-600"}],f=[{id:"all",name:e("intellectualProperty.statuses.all"),color:"bg-gray-100 text-gray-800",icon:wt},{id:"pending",name:e("intellectualProperty.statuses.pending"),color:"bg-yellow-100 text-yellow-800",icon:jt},{id:"approved",name:e("intellectualProperty.statuses.approved"),color:"bg-green-100 text-green-800",icon:ze},{id:"rejected",name:e("intellectualProperty.statuses.rejected"),color:"bg-red-100 text-red-800",icon:Mr}],h=t.filter(g=>{const y=s==="all"||g.type===s,w=o==="all"||g.status===o,v=g.title.toLowerCase().includes(c.toLowerCase())||g.description.toLowerCase().includes(c.toLowerCase())||g.tags.some(_=>_.toLowerCase().includes(c.toLowerCase()));return y&&w&&v}),m=g=>f.find(w=>w.id===g)||{name:g,color:"bg-gray-100 text-gray-800",icon:oa},x=g=>u.find(w=>w.id===g)||{name:g,icon:br,color:"from-gray-400 to-gray-500"},p=g=>g;return r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-purple-500"})}):a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(oa,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:a})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-purple-600 to-indigo-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(Ga,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("intellectualProperty.title")}),n.jsx("p",{className:"opacity-90",children:e("intellectualProperty.subtitle")})]})]}),n.jsxs("button",{className:"bg-white text-purple-600 px-6 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(gt,{className:"w-5 h-5"}),e("intellectualProperty.newRegistration")]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.length}),n.jsx("div",{className:"text-sm opacity-80",children:e("intellectualProperty.stats.totalRequests")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.filter(g=>g.status==="approved").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("intellectualProperty.stats.approved")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.filter(g=>g.status==="pending").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("intellectualProperty.stats.underReview")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:u.length-1}),n.jsx("div",{className:"text-sm opacity-80",children:e("intellectualProperty.stats.protectionTypes")})]})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsx("div",{className:"flex flex-col lg:flex-row gap-4 mb-6",children:n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ut,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("intellectualProperty.searchPlaceholder"),value:c,onChange:g=>d(g.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("intellectualProperty.filters.propertyType")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:u.map(g=>n.jsxs("button",{onClick:()=>i(g.id),className:`flex items-center gap-2 px-4 py-2 rounded-xl transition-all ${s===g.id?"bg-purple-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[g.icon&&n.jsx(g.icon,{className:"w-4 h-4"}),g.name]},g.id))})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("intellectualProperty.filters.requestStatus")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:f.map(g=>n.jsxs("button",{onClick:()=>l(g.id),className:`flex items-center gap-2 px-4 py-2 rounded-xl transition-all ${o===g.id?"bg-indigo-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[g.icon&&n.jsx(g.icon,{className:"w-4 h-4"}),g.name]},g.id))})]})]}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:[e("intellectualProperty.showing")," ",h.length," ",e("intellectualProperty.of")," ",t.length," ",e("intellectualProperty.request")]})}),n.jsx("div",{className:"space-y-4",children:h.map((g,y)=>{const w=m(g.status),v=x(g.type);return n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:y*.1},className:"bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition-all duration-300",children:[n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[n.jsx("div",{className:`w-16 h-16 bg-gradient-to-r ${v.color} rounded-2xl flex items-center justify-center flex-shrink-0`,children:n.jsx(v.icon,{className:"w-8 h-8 text-white"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:g.title}),n.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${w.color}`,children:w.name})]}),n.jsx("p",{className:"text-gray-600 mb-3 leading-relaxed",children:g.description}),n.jsx("div",{className:"flex flex-wrap gap-1 mb-3",children:g.tags.map((_,b)=>n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["#",_]},b))}),n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("img",{src:g.student.avatar,alt:g.student.name,className:"w-10 h-10 rounded-full object-cover"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:g.student.name}),n.jsx("p",{className:"text-sm text-gray-500",children:g.student.school})]})]}),g.project&&n.jsxs("div",{className:"text-sm text-gray-500 mb-3",children:[n.jsxs("span",{children:[e("intellectualProperty.relatedProject"),": "]}),n.jsx("span",{className:"text-purple-600 hover:text-purple-800 cursor-pointer",children:g.project.title})]}),n.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-500",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(tt,{className:"w-4 h-4"}),n.jsxs("span",{children:[e("intellectualProperty.submissionDate"),": ",Ze(g.submittedAt)]})]}),g.reviewedAt&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(ze,{className:"w-4 h-4"}),n.jsxs("span",{children:[e("intellectualProperty.reviewDate"),": ",Ze(g.reviewedAt)]})]}),g.estimatedReviewDate&&!g.reviewedAt&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(jt,{className:"w-4 h-4"}),n.jsxs("span",{children:[e("intellectualProperty.estimatedReview"),": ",Ze(g.estimatedReviewDate)]})]})]})]})]}),g.certificateNumber&&n.jsx("div",{className:"text-right",children:n.jsxs("div",{className:"bg-green-100 text-green-800 px-3 py-2 rounded-lg text-sm font-medium",children:[e("intellectualProperty.certificateNumber"),": ",g.certificateNumber]})})]}),n.jsxs("div",{className:"mb-4",children:[n.jsxs("h4",{className:"font-medium text-gray-800 mb-2",children:[e("intellectualProperty.attachedDocuments"),":"]}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-2",children:g.documents.map((_,b)=>n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[n.jsx(br,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-sm font-medium text-gray-800 truncate",children:_.name}),n.jsx("p",{className:"text-xs text-gray-500",children:p(_.size)})]}),n.jsx("button",{className:"p-1 rounded hover:bg-gray-200 transition-colors",children:n.jsx(Tr,{className:"w-4 h-4 text-gray-500"})})]},b))})]}),g.status==="rejected"&&g.rejectionReason&&n.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:[n.jsxs("h4",{className:"font-medium text-red-800 mb-2 flex items-center gap-2",children:[n.jsx(Mr,{className:"w-4 h-4"}),e("intellectualProperty.rejectionReason"),":"]}),n.jsx("p",{className:"text-red-700 text-sm",children:g.rejectionReason})]}),n.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 transition-colors text-sm",children:[n.jsx(sr,{className:"w-4 h-4"}),e("intellectualProperty.actions.viewDetails")]}),g.status==="approved"&&n.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors text-sm",children:[n.jsx(Tr,{className:"w-4 h-4"}),e("intellectualProperty.actions.downloadCertificate")]}),g.status==="rejected"&&n.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors text-sm",children:[n.jsx(xi,{className:"w-4 h-4"}),e("intellectualProperty.actions.resubmit")]})]}),n.jsxs("div",{className:"text-sm text-gray-500",children:[e("intellectualProperty.protectionType"),": ",v.name]})]})]},g.id)})}),h.length===0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(Ga,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("intellectualProperty.noRequests")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("intellectualProperty.noRequestsFound")}),n.jsxs("div",{className:"flex justify-center gap-4",children:[n.jsxs("button",{className:"px-6 py-2 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors flex items-center gap-2",children:[n.jsx(gt,{className:"w-4 h-4"}),e("intellectualProperty.newRegistration")]}),n.jsx("button",{onClick:()=>{i("all"),l("all"),d("")},className:"px-6 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("common.resetFilters")})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-6",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:e("intellectualProperty.importantInfo.title")}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsxs("h4",{className:"font-semibold text-gray-800 mb-2",children:[e("intellectualProperty.importantInfo.availableTypes"),":"]}),n.jsxs("ul",{className:"space-y-2 text-gray-600",children:[n.jsxs("li",{className:"flex items-center gap-2",children:[n.jsx(xa,{className:"w-4 h-4 text-yellow-500"}),e("intellectualProperty.importantInfo.inventions")]}),n.jsxs("li",{className:"flex items-center gap-2",children:[n.jsx(Wg,{className:"w-4 h-4 text-blue-500"}),e("intellectualProperty.importantInfo.software")]}),n.jsxs("li",{className:"flex items-center gap-2",children:[n.jsx(sc,{className:"w-4 h-4 text-pink-500"}),e("intellectualProperty.importantInfo.designs")]}),n.jsxs("li",{className:"flex items-center gap-2",children:[n.jsx(wt,{className:"w-4 h-4 text-green-500"}),e("intellectualProperty.importantInfo.research")]})]})]}),n.jsxs("div",{children:[n.jsxs("h4",{className:"font-semibold text-gray-800 mb-2",children:[e("intellectualProperty.importantInfo.registrationSteps"),":"]}),n.jsxs("ol",{className:"space-y-2 text-gray-600",children:[n.jsxs("li",{children:["1. ",e("intellectualProperty.importantInfo.step1")]}),n.jsxs("li",{children:["2. ",e("intellectualProperty.importantInfo.step2")]}),n.jsxs("li",{children:["3. ",e("intellectualProperty.importantInfo.step3")]}),n.jsxs("li",{children:["4. ",e("intellectualProperty.importantInfo.step4")]})]})]})]})]})]})},tA=()=>{const[e,t]=O.useState([]),[r,a]=O.useState(!0),[s,i]=O.useState(null),{user:o}=vt(),l=async()=>{if(o)try{a(!0);const c=De(pe,"users");let d;if(o.role==="admin")d=et(c,Pi("created_at","desc"),ys(50));else if(o.role==="school"&&o.id)d=et(c,Ue("school_id","==",o.id),ys(50));else if(o.role==="teacher"&&o.school_id)d=et(c,Ue("school_id","==",o.school_id),Ue("role","==","student"),ys(50));else{t([]),a(!1);return}const u=await Je(d),f=await Promise.all(u.docs.map(async h=>{const m=h.data();let x;if(m.school_id){const y=await hr(Ie(pe,"schools",m.school_id));y.exists()&&(x=y.data().name)}let p=0,g=0;if(m.role==="student"){const y=De(pe,"project_students"),w=et(y,Ue("student_id","==",h.id)),_=(await Je(w)).docs.map(b=>b.data().project_id);if(_.length>0){const b=De(pe,"projects"),j=et(b,Ue("__name__","in",_)),N=await Je(j);p=N.size,g=N.docs.filter(k=>k.data().status==="completed").length}}else if(m.role==="teacher"){const y=De(pe,"projects"),w=et(y,Ue("teacher_id","==",h.id));p=(await Je(w)).size;const _=De(pe,"users"),b=et(_,Ue("role","==","student"),Ue("school_id","==",m.school_id)),j=await Je(b);m.studentsCount=j.size}return{id:h.id,name:m.name||"",email:m.email||"",role:m.role||"student",avatar:m.avatar_url||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",school:x,school_id:m.school_id,grade:m.grade,subject:m.subject,experience:m.experience_years?`${m.experience_years} سنوات`:void 0,joinedAt:m.created_at?new Date(m.created_at.toDate()).toISOString():new Date().toISOString(),lastActive:m.last_active_at?new Date(m.last_active_at.toDate()).toISOString():new Date().toISOString(),projectsCount:p,completedProjects:g,studentsCount:m.studentsCount,teachersCount:m.teachersCount,status:m.status||"active",location:m.location||"غير محدد",department:m.department,permissions:m.permissions,type:m.type,establishedYear:m.established_year,certifications:m.certifications,phone:m.phone}}));t(f)}catch(c){console.error("Error fetching users:",c),i(c instanceof Error?c.message:"حدث خطأ في تحميل المستخدمين")}finally{a(!1)}};return O.useEffect(()=>{o&&l()},[o]),{users:e,loading:r,error:s,fetchUsers:l}},Zg=[{id:"all",name:"جميع المستخدمين"},{id:"student",name:"طلاب",icon:js,color:"bg-blue-500"},{id:"teacher",name:"معلمين",icon:wt,color:"bg-green-500"},{id:"school",name:"مدارس",icon:jn,color:"bg-purple-500"},{id:"admin",name:"مديرين",icon:Ga,color:"bg-red-500"}],Qg=()=>{const{users:e,loading:t,error:r}=tA(),[a,s]=O.useState("all"),[i,o]=O.useState(""),[l,c]=O.useState(!1),d=e.filter(x=>{const p=a==="all"||x.role===a,g=x.name.toLowerCase().includes(i.toLowerCase())||x.email.toLowerCase().includes(i.toLowerCase())||x.school&&x.school.toLowerCase().includes(i.toLowerCase());return p&&g}),u=x=>Zg.find(g=>g.id===x)||{name:x,icon:lt,color:"bg-gray-500"},f=x=>{switch(x){case"student":return"طالب";case"teacher":return"معلم";case"school":return"مدرسة";case"admin":return"مدير";default:return x}},h=x=>{switch(x){case"active":return"bg-green-100 text-green-800";case"inactive":return"bg-gray-100 text-gray-800";case"suspended":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},m=x=>{switch(x){case"active":return"نشط";case"inactive":return"غير نشط";case"suspended":return"موقوف";default:return x}};return t?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(oa,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:r})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(lt,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"إدارة المستخدمين"}),n.jsx("p",{className:"opacity-90",children:"إدارة ومتابعة جميع مستخدمي المنصة"})]})]}),n.jsxs("button",{className:"bg-white text-blue-600 px-6 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(gt,{className:"w-5 h-5"}),"إضافة مستخدم"]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.length}),n.jsx("div",{className:"text-sm opacity-80",children:"إجمالي المستخدمين"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.filter(x=>x.role==="student").length}),n.jsx("div",{className:"text-sm opacity-80",children:"طلاب"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.filter(x=>x.role==="teacher").length}),n.jsx("div",{className:"text-sm opacity-80",children:"معلمين"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.filter(x=>x.status==="active").length}),n.jsx("div",{className:"text-sm opacity-80",children:"نشط"})]})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ut,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"البحث في المستخدمين...",value:i,onChange:x=>o(x.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("button",{onClick:()=>c(!l),className:"lg:hidden flex items-center gap-2 px-4 py-3 bg-gray-100 rounded-xl hover:bg-gray-200 transition-colors",children:[n.jsx(Ko,{className:"w-5 h-5"}),"الفلاتر"]})]}),n.jsxs("div",{className:`mt-4 ${l?"block":"hidden lg:block"}`,children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:"نوع المستخدم"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:Zg.map(x=>n.jsxs("button",{onClick:()=>s(x.id),className:`flex items-center gap-2 px-4 py-2 rounded-xl transition-all ${a===x.id?"bg-blue-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[x.icon&&n.jsx(x.icon,{className:"w-4 h-4"}),x.name]},x.id))})]})]}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:["عرض ",d.length," من أصل ",e.length," مستخدم"]})}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map((x,p)=>{const g=u(x.role);return n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:p*.1},className:"bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition-all duration-300 group",children:[n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:x.avatar,alt:x.name,className:"w-16 h-16 rounded-full object-cover"}),n.jsx("div",{className:`absolute -bottom-1 -right-1 w-5 h-5 ${g.color} rounded-full flex items-center justify-center`,children:n.jsx(g.icon,{className:"w-3 h-3 text-white"})})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 group-hover:text-blue-600 transition-colors",children:x.name}),n.jsx("p",{className:"text-sm text-gray-600",children:f(x.role)}),n.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium mt-1 ${h(x.status)}`,children:m(x.status)})]})]}),n.jsxs("div",{className:"relative group/menu",children:[n.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Pf,{className:"w-5 h-5 text-gray-400"})}),n.jsx("div",{className:"absolute left-0 top-10 w-48 bg-white rounded-lg shadow-lg border border-gray-200 opacity-0 invisible group-hover/menu:opacity-100 group-hover/menu:visible transition-all duration-200 z-10",children:n.jsxs("div",{className:"p-2",children:[n.jsxs("button",{className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:[n.jsx(sr,{className:"w-4 h-4"}),"عرض الملف الشخصي"]}),n.jsxs("button",{className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:[n.jsx(Oa,{className:"w-4 h-4"}),"تعديل"]}),n.jsxs("button",{className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:[n.jsx(Ta,{className:"w-4 h-4"}),"إرسال رسالة"]}),n.jsx("hr",{className:"my-1"}),n.jsxs("button",{className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-red-600 hover:bg-red-50 rounded-md",children:[n.jsx(ir,{className:"w-4 h-4"}),"حذف"]})]})})]})]}),n.jsxs("div",{className:"space-y-2 mb-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(Ta,{className:"w-4 h-4"}),n.jsx("span",{className:"truncate",children:x.email})]}),x.phone&&n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(Pr,{className:"w-4 h-4"}),n.jsx("span",{children:x.phone})]}),x.location&&n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(Of,{className:"w-4 h-4"}),n.jsx("span",{children:x.location})]})]}),x.role==="student"&&n.jsxs("div",{className:"space-y-2 mb-4",children:[x.school&&n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(jn,{className:"w-4 h-4"}),n.jsx("span",{children:x.school})]}),x.grade&&n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(js,{className:"w-4 h-4"}),n.jsx("span",{children:x.grade})]})]}),x.role==="teacher"&&n.jsxs("div",{className:"space-y-2 mb-4",children:[x.school&&n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(jn,{className:"w-4 h-4"}),n.jsx("span",{children:x.school})]}),x.subject&&n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(wt,{className:"w-4 h-4"}),n.jsx("span",{children:x.subject})]}),x.experience&&n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(ar,{className:"w-4 h-4"}),n.jsx("span",{children:x.experience})]})]}),x.role==="school"&&n.jsxs("div",{className:"space-y-2 mb-4",children:[x.type&&n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(jn,{className:"w-4 h-4"}),n.jsx("span",{children:x.type})]}),x.establishedYear&&n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(tt,{className:"w-4 h-4"}),n.jsxs("span",{children:["تأسست عام ",x.establishedYear]})]})]}),x.role==="admin"&&x.department&&n.jsx("div",{className:"space-y-2 mb-4",children:n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(Ga,{className:"w-4 h-4"}),n.jsx("span",{children:x.department})]})}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[x.role==="student"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-lg font-bold text-gray-800",children:x.projectsCount||0}),n.jsx("div",{className:"text-xs text-gray-500",children:"مشاريع"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-lg font-bold text-gray-800",children:x.completedProjects||0}),n.jsx("div",{className:"text-xs text-gray-500",children:"مكتملة"})]})]}),x.role==="teacher"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-lg font-bold text-gray-800",children:x.projectsCount||0}),n.jsx("div",{className:"text-xs text-gray-500",children:"مشاريع"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-lg font-bold text-gray-800",children:x.studentsCount||0}),n.jsx("div",{className:"text-xs text-gray-500",children:"طلاب"})]})]}),x.role==="school"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-lg font-bold text-gray-800",children:x.studentsCount||0}),n.jsx("div",{className:"text-xs text-gray-500",children:"طلاب"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-lg font-bold text-gray-800",children:x.teachersCount||0}),n.jsx("div",{className:"text-xs text-gray-500",children:"معلمين"})]})]})]}),n.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[n.jsxs("div",{className:"text-xs text-gray-500",children:["انضم: ",Ze(x.joinedAt)]}),n.jsx("div",{className:"text-xs text-gray-500",children:bE(x.lastActive)})]})]},x.id)})}),d.length===0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(lt,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"لا يوجد مستخدمين"}),n.jsx("p",{className:"text-gray-600 mb-4",children:"لم يتم العثور على مستخدمين يطابقون معايير البحث"}),n.jsxs("div",{className:"flex justify-center gap-4",children:[n.jsxs("button",{className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2",children:[n.jsx(ic,{className:"w-4 h-4"}),"إضافة مستخدم جديد"]}),n.jsx("button",{onClick:()=>{s("all"),o("")},className:"px-6 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إعادة تعيين الفلاتر"})]})]})]})};function n2(e){var t,r,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=n2(e[t]))&&(a&&(a+=" "),a+=r)}else for(r in e)e[r]&&(a&&(a+=" "),a+=r);return a}function qe(){for(var e,t,r=0,a="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=n2(e))&&(a&&(a+=" "),a+=t);return a}var rA=Array.isArray,ga=rA,aA=typeof Mn=="object"&&Mn&&Mn.Object===Object&&Mn,s2=aA,nA=s2,sA=typeof self=="object"&&self&&self.Object===Object&&self,iA=nA||sA||Function("return this")(),Tn=iA,oA=Tn,lA=oA.Symbol,dd=lA,ev=dd,i2=Object.prototype,cA=i2.hasOwnProperty,dA=i2.toString,xl=ev?ev.toStringTag:void 0;function uA(e){var t=cA.call(e,xl),r=e[xl];try{e[xl]=void 0;var a=!0}catch{}var s=dA.call(e);return a&&(t?e[xl]=r:delete e[xl]),s}var fA=uA,hA=Object.prototype,mA=hA.toString;function xA(e){return mA.call(e)}var pA=xA,tv=dd,gA=fA,vA=pA,yA="[object Null]",bA="[object Undefined]",rv=tv?tv.toStringTag:void 0;function wA(e){return e==null?e===void 0?bA:yA:rv&&rv in Object(e)?gA(e):vA(e)}var as=wA;function jA(e){return e!=null&&typeof e=="object"}var ns=jA,NA=as,_A=ns,SA="[object Symbol]";function kA(e){return typeof e=="symbol"||_A(e)&&NA(e)==SA}var qo=kA,EA=ga,AA=qo,TA=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,OA=/^\w*$/;function PA(e,t){if(EA(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||AA(e)?!0:OA.test(e)||!TA.test(e)||t!=null&&e in Object(t)}var Hx=PA;function CA(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Ts=CA;const Xo=kt(Ts);var FA=as,IA=Ts,DA="[object AsyncFunction]",RA="[object Function]",MA="[object GeneratorFunction]",$A="[object Proxy]";function LA(e){if(!IA(e))return!1;var t=FA(e);return t==RA||t==MA||t==DA||t==$A}var zx=LA;const $e=kt(zx);var BA=Tn,UA=BA["__core-js_shared__"],WA=UA,z0=WA,av=function(){var e=/[^.]+$/.exec(z0&&z0.keys&&z0.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function HA(e){return!!av&&av in e}var zA=HA,VA=Function.prototype,GA=VA.toString;function KA(e){if(e!=null){try{return GA.call(e)}catch{}try{return e+""}catch{}}return""}var o2=KA,qA=zx,XA=zA,YA=Ts,JA=o2,ZA=/[\\^$.*+?()[\]{}|]/g,QA=/^\[object .+?Constructor\]$/,e5=Function.prototype,t5=Object.prototype,r5=e5.toString,a5=t5.hasOwnProperty,n5=RegExp("^"+r5.call(a5).replace(ZA,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function s5(e){if(!YA(e)||XA(e))return!1;var t=qA(e)?n5:QA;return t.test(JA(e))}var i5=s5;function o5(e,t){return e==null?void 0:e[t]}var l5=o5,c5=i5,d5=l5;function u5(e,t){var r=d5(e,t);return c5(r)?r:void 0}var Fi=u5,f5=Fi,h5=f5(Object,"create"),Rf=h5,nv=Rf;function m5(){this.__data__=nv?nv(null):{},this.size=0}var x5=m5;function p5(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var g5=p5,v5=Rf,y5="__lodash_hash_undefined__",b5=Object.prototype,w5=b5.hasOwnProperty;function j5(e){var t=this.__data__;if(v5){var r=t[e];return r===y5?void 0:r}return w5.call(t,e)?t[e]:void 0}var N5=j5,_5=Rf,S5=Object.prototype,k5=S5.hasOwnProperty;function E5(e){var t=this.__data__;return _5?t[e]!==void 0:k5.call(t,e)}var A5=E5,T5=Rf,O5="__lodash_hash_undefined__";function P5(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=T5&&t===void 0?O5:t,this}var C5=P5,F5=x5,I5=g5,D5=N5,R5=A5,M5=C5;function Yo(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var a=e[t];this.set(a[0],a[1])}}Yo.prototype.clear=F5;Yo.prototype.delete=I5;Yo.prototype.get=D5;Yo.prototype.has=R5;Yo.prototype.set=M5;var $5=Yo;function L5(){this.__data__=[],this.size=0}var B5=L5;function U5(e,t){return e===t||e!==e&&t!==t}var Vx=U5,W5=Vx;function H5(e,t){for(var r=e.length;r--;)if(W5(e[r][0],t))return r;return-1}var Mf=H5,z5=Mf,V5=Array.prototype,G5=V5.splice;function K5(e){var t=this.__data__,r=z5(t,e);if(r<0)return!1;var a=t.length-1;return r==a?t.pop():G5.call(t,r,1),--this.size,!0}var q5=K5,X5=Mf;function Y5(e){var t=this.__data__,r=X5(t,e);return r<0?void 0:t[r][1]}var J5=Y5,Z5=Mf;function Q5(e){return Z5(this.__data__,e)>-1}var eT=Q5,tT=Mf;function rT(e,t){var r=this.__data__,a=tT(r,e);return a<0?(++this.size,r.push([e,t])):r[a][1]=t,this}var aT=rT,nT=B5,sT=q5,iT=J5,oT=eT,lT=aT;function Jo(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var a=e[t];this.set(a[0],a[1])}}Jo.prototype.clear=nT;Jo.prototype.delete=sT;Jo.prototype.get=iT;Jo.prototype.has=oT;Jo.prototype.set=lT;var $f=Jo,cT=Fi,dT=Tn,uT=cT(dT,"Map"),Gx=uT,sv=$5,fT=$f,hT=Gx;function mT(){this.size=0,this.__data__={hash:new sv,map:new(hT||fT),string:new sv}}var xT=mT;function pT(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var gT=pT,vT=gT;function yT(e,t){var r=e.__data__;return vT(t)?r[typeof t=="string"?"string":"hash"]:r.map}var Lf=yT,bT=Lf;function wT(e){var t=bT(this,e).delete(e);return this.size-=t?1:0,t}var jT=wT,NT=Lf;function _T(e){return NT(this,e).get(e)}var ST=_T,kT=Lf;function ET(e){return kT(this,e).has(e)}var AT=ET,TT=Lf;function OT(e,t){var r=TT(this,e),a=r.size;return r.set(e,t),this.size+=r.size==a?0:1,this}var PT=OT,CT=xT,FT=jT,IT=ST,DT=AT,RT=PT;function Zo(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var a=e[t];this.set(a[0],a[1])}}Zo.prototype.clear=CT;Zo.prototype.delete=FT;Zo.prototype.get=IT;Zo.prototype.has=DT;Zo.prototype.set=RT;var Kx=Zo,l2=Kx,MT="Expected a function";function qx(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(MT);var r=function(){var a=arguments,s=t?t.apply(this,a):a[0],i=r.cache;if(i.has(s))return i.get(s);var o=e.apply(this,a);return r.cache=i.set(s,o)||i,o};return r.cache=new(qx.Cache||l2),r}qx.Cache=l2;var c2=qx;const $T=kt(c2);var LT=c2,BT=500;function UT(e){var t=LT(e,function(a){return r.size===BT&&r.clear(),a}),r=t.cache;return t}var WT=UT,HT=WT,zT=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,VT=/\\(\\)?/g,GT=HT(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(zT,function(r,a,s,i){t.push(s?i.replace(VT,"$1"):a||r)}),t}),KT=GT;function qT(e,t){for(var r=-1,a=e==null?0:e.length,s=Array(a);++r<a;)s[r]=t(e[r],r,e);return s}var Xx=qT,iv=dd,XT=Xx,YT=ga,JT=qo,ov=iv?iv.prototype:void 0,lv=ov?ov.toString:void 0;function d2(e){if(typeof e=="string")return e;if(YT(e))return XT(e,d2)+"";if(JT(e))return lv?lv.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var ZT=d2,QT=ZT;function eO(e){return e==null?"":QT(e)}var u2=eO,tO=ga,rO=Hx,aO=KT,nO=u2;function sO(e,t){return tO(e)?e:rO(e,t)?[e]:aO(nO(e))}var f2=sO,iO=qo;function oO(e){if(typeof e=="string"||iO(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var Bf=oO,lO=f2,cO=Bf;function dO(e,t){t=lO(t,e);for(var r=0,a=t.length;e!=null&&r<a;)e=e[cO(t[r++])];return r&&r==a?e:void 0}var Yx=dO,uO=Yx;function fO(e,t,r){var a=e==null?void 0:uO(e,t);return a===void 0?r:a}var h2=fO;const ka=kt(h2);function hO(e){return e==null}var mO=hO;const We=kt(mO);var xO=as,pO=ga,gO=ns,vO="[object String]";function yO(e){return typeof e=="string"||!pO(e)&&gO(e)&&xO(e)==vO}var bO=yO;const gi=kt(bO);var m2={exports:{}},Et={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jx=Symbol.for("react.element"),Zx=Symbol.for("react.portal"),Uf=Symbol.for("react.fragment"),Wf=Symbol.for("react.strict_mode"),Hf=Symbol.for("react.profiler"),zf=Symbol.for("react.provider"),Vf=Symbol.for("react.context"),wO=Symbol.for("react.server_context"),Gf=Symbol.for("react.forward_ref"),Kf=Symbol.for("react.suspense"),qf=Symbol.for("react.suspense_list"),Xf=Symbol.for("react.memo"),Yf=Symbol.for("react.lazy"),jO=Symbol.for("react.offscreen"),x2;x2=Symbol.for("react.module.reference");function Xa(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case Jx:switch(e=e.type,e){case Uf:case Hf:case Wf:case Kf:case qf:return e;default:switch(e=e&&e.$$typeof,e){case wO:case Vf:case Gf:case Yf:case Xf:case zf:return e;default:return t}}case Zx:return t}}}Et.ContextConsumer=Vf;Et.ContextProvider=zf;Et.Element=Jx;Et.ForwardRef=Gf;Et.Fragment=Uf;Et.Lazy=Yf;Et.Memo=Xf;Et.Portal=Zx;Et.Profiler=Hf;Et.StrictMode=Wf;Et.Suspense=Kf;Et.SuspenseList=qf;Et.isAsyncMode=function(){return!1};Et.isConcurrentMode=function(){return!1};Et.isContextConsumer=function(e){return Xa(e)===Vf};Et.isContextProvider=function(e){return Xa(e)===zf};Et.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===Jx};Et.isForwardRef=function(e){return Xa(e)===Gf};Et.isFragment=function(e){return Xa(e)===Uf};Et.isLazy=function(e){return Xa(e)===Yf};Et.isMemo=function(e){return Xa(e)===Xf};Et.isPortal=function(e){return Xa(e)===Zx};Et.isProfiler=function(e){return Xa(e)===Hf};Et.isStrictMode=function(e){return Xa(e)===Wf};Et.isSuspense=function(e){return Xa(e)===Kf};Et.isSuspenseList=function(e){return Xa(e)===qf};Et.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Uf||e===Hf||e===Wf||e===Kf||e===qf||e===jO||typeof e=="object"&&e!==null&&(e.$$typeof===Yf||e.$$typeof===Xf||e.$$typeof===zf||e.$$typeof===Vf||e.$$typeof===Gf||e.$$typeof===x2||e.getModuleId!==void 0)};Et.typeOf=Xa;m2.exports=Et;var NO=m2.exports,_O=as,SO=ns,kO="[object Number]";function EO(e){return typeof e=="number"||SO(e)&&_O(e)==kO}var p2=EO;const AO=kt(p2);var TO=p2;function OO(e){return TO(e)&&e!=+e}var PO=OO;const Qo=kt(PO);var aa=function(t){return t===0?0:t>0?1:-1},Js=function(t){return gi(t)&&t.indexOf("%")===t.length-1},be=function(t){return AO(t)&&!Qo(t)},CO=function(t){return We(t)},wr=function(t){return be(t)||gi(t)},FO=0,Ii=function(t){var r=++FO;return"".concat(t||"").concat(r)},na=function(t,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!be(t)&&!gi(t))return a;var i;if(Js(t)){var o=t.indexOf("%");i=r*parseFloat(t.slice(0,o))/100}else i=+t;return Qo(i)&&(i=a),s&&i>r&&(i=r),i},ms=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},IO=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,a={},s=0;s<r;s++)if(!a[t[s]])a[t[s]]=!0;else return!0;return!1},vr=function(t,r){return be(t)&&be(r)?function(a){return t+a*(r-t)}:function(){return r}};function cu(e,t,r){return!e||!e.length?null:e.find(function(a){return a&&(typeof t=="function"?t(a):ka(a,t))===r})}var DO=function(t,r){return be(t)&&be(r)?t-r:gi(t)&&gi(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function io(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var a in t)if({}.hasOwnProperty.call(t,a)&&!{}.hasOwnProperty.call(e,a))return!1;return!0}function zh(e){"@babel/helpers - typeof";return zh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zh(e)}var RO=["viewBox","children"],MO=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],cv=["points","pathLength"],V0={svg:RO,polygon:cv,polyline:cv},Qx=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],du=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(O.isValidElement(t)&&(a=t.props),!Xo(a))return null;var s={};return Object.keys(a).forEach(function(i){Qx.includes(i)&&(s[i]=r||function(o){return a[i](a,o)})}),s},$O=function(t,r,a){return function(s){return t(r,a,s),null}},vi=function(t,r,a){if(!Xo(t)||zh(t)!=="object")return null;var s=null;return Object.keys(t).forEach(function(i){var o=t[i];Qx.includes(i)&&typeof o=="function"&&(s||(s={}),s[i]=$O(o,r,a))}),s},LO=["children"],BO=["children"];function dv(e,t){if(e==null)return{};var r=UO(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function UO(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function Vh(e){"@babel/helpers - typeof";return Vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vh(e)}var uv={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},zn=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},fv=null,G0=null,ep=function e(t){if(t===fv&&Array.isArray(G0))return G0;var r=[];return O.Children.forEach(t,function(a){We(a)||(NO.isFragment(a)?r=r.concat(e(a.props.children)):r.push(a))}),G0=r,fv=t,r};function Ea(e,t){var r=[],a=[];return Array.isArray(t)?a=t.map(function(s){return zn(s)}):a=[zn(t)],ep(e).forEach(function(s){var i=ka(s,"type.displayName")||ka(s,"type.name");a.indexOf(i)!==-1&&r.push(s)}),r}function ba(e,t){var r=Ea(e,t);return r&&r[0]}var hv=function(t){if(!t||!t.props)return!1;var r=t.props,a=r.width,s=r.height;return!(!be(a)||a<=0||!be(s)||s<=0)},WO=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],HO=function(t){return t&&t.type&&gi(t.type)&&WO.indexOf(t.type)>=0},g2=function(t){return t&&Vh(t)==="object"&&"clipDot"in t},zO=function(t,r,a,s){var i,o=(i=V0==null?void 0:V0[s])!==null&&i!==void 0?i:[];return r.startsWith("data-")||!$e(t)&&(s&&o.includes(r)||MO.includes(r))||a&&Qx.includes(r)},Ce=function(t,r,a){if(!t||typeof t=="function"||typeof t=="boolean")return null;var s=t;if(O.isValidElement(t)&&(s=t.props),!Xo(s))return null;var i={};return Object.keys(s).forEach(function(o){var l;zO((l=s)===null||l===void 0?void 0:l[o],o,r,a)&&(i[o]=s[o])}),i},Gh=function e(t,r){if(t===r)return!0;var a=O.Children.count(t);if(a!==O.Children.count(r))return!1;if(a===0)return!0;if(a===1)return mv(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var s=0;s<a;s++){var i=t[s],o=r[s];if(Array.isArray(i)||Array.isArray(o)){if(!e(i,o))return!1}else if(!mv(i,o))return!1}return!0},mv=function(t,r){if(We(t)&&We(r))return!0;if(!We(t)&&!We(r)){var a=t.props||{},s=a.children,i=dv(a,LO),o=r.props||{},l=o.children,c=dv(o,BO);return s&&l?io(i,c)&&Gh(s,l):!s&&!l?io(i,c):!1}return!1},xv=function(t,r){var a=[],s={};return ep(t).forEach(function(i,o){if(HO(i))a.push(i);else if(i){var l=zn(i.type),c=r[l]||{},d=c.handler,u=c.once;if(d&&(!u||!s[l])){var f=d(i,l,o);a.push(f),s[l]=!0}}}),a},VO=function(t){var r=t&&t.type;return r&&uv[r]?uv[r]:null},GO=function(t,r){return ep(r).indexOf(t)},KO=["children","width","height","viewBox","className","style","title","desc"];function Kh(){return Kh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Kh.apply(this,arguments)}function qO(e,t){if(e==null)return{};var r=XO(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function XO(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function qh(e){var t=e.children,r=e.width,a=e.height,s=e.viewBox,i=e.className,o=e.style,l=e.title,c=e.desc,d=qO(e,KO),u=s||{width:r,height:a,x:0,y:0},f=qe("recharts-surface",i);return Z.createElement("svg",Kh({},Ce(d,!0,"svg"),{className:f,width:r,height:a,style:o,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height)}),Z.createElement("title",null,l),Z.createElement("desc",null,c),t)}var YO=["children","className"];function Xh(){return Xh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Xh.apply(this,arguments)}function JO(e,t){if(e==null)return{};var r=ZO(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function ZO(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}var it=Z.forwardRef(function(e,t){var r=e.children,a=e.className,s=JO(e,YO),i=qe("recharts-layer",a);return Z.createElement("g",Xh({className:i},Ce(s,!0),{ref:t}),r)}),on=function(t,r){for(var a=arguments.length,s=new Array(a>2?a-2:0),i=2;i<a;i++)s[i-2]=arguments[i]};function QO(e,t,r){var a=-1,s=e.length;t<0&&(t=-t>s?0:s+t),r=r>s?s:r,r<0&&(r+=s),s=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(s);++a<s;)i[a]=e[a+t];return i}var eP=QO,tP=eP;function rP(e,t,r){var a=e.length;return r=r===void 0?a:r,!t&&r>=a?e:tP(e,t,r)}var aP=rP,nP="\\ud800-\\udfff",sP="\\u0300-\\u036f",iP="\\ufe20-\\ufe2f",oP="\\u20d0-\\u20ff",lP=sP+iP+oP,cP="\\ufe0e\\ufe0f",dP="\\u200d",uP=RegExp("["+dP+nP+lP+cP+"]");function fP(e){return uP.test(e)}var v2=fP;function hP(e){return e.split("")}var mP=hP,y2="\\ud800-\\udfff",xP="\\u0300-\\u036f",pP="\\ufe20-\\ufe2f",gP="\\u20d0-\\u20ff",vP=xP+pP+gP,yP="\\ufe0e\\ufe0f",bP="["+y2+"]",Yh="["+vP+"]",Jh="\\ud83c[\\udffb-\\udfff]",wP="(?:"+Yh+"|"+Jh+")",b2="[^"+y2+"]",w2="(?:\\ud83c[\\udde6-\\uddff]){2}",j2="[\\ud800-\\udbff][\\udc00-\\udfff]",jP="\\u200d",N2=wP+"?",_2="["+yP+"]?",NP="(?:"+jP+"(?:"+[b2,w2,j2].join("|")+")"+_2+N2+")*",_P=_2+N2+NP,SP="(?:"+[b2+Yh+"?",Yh,w2,j2,bP].join("|")+")",kP=RegExp(Jh+"(?="+Jh+")|"+SP+_P,"g");function EP(e){return e.match(kP)||[]}var AP=EP,TP=mP,OP=v2,PP=AP;function CP(e){return OP(e)?PP(e):TP(e)}var FP=CP,IP=aP,DP=v2,RP=FP,MP=u2;function $P(e){return function(t){t=MP(t);var r=DP(t)?RP(t):void 0,a=r?r[0]:t.charAt(0),s=r?IP(r,1).join(""):t.slice(1);return a[e]()+s}}var LP=$P,BP=LP,UP=BP("toUpperCase"),WP=UP;const Jf=kt(WP);function It(e){return function(){return e}}const S2=Math.cos,uu=Math.sin,un=Math.sqrt,fu=Math.PI,Zf=2*fu,Zh=Math.PI,Qh=2*Zh,Ws=1e-6,HP=Qh-Ws;function k2(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function zP(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return k2;const r=10**t;return function(a){this._+=a[0];for(let s=1,i=a.length;s<i;++s)this._+=Math.round(arguments[s]*r)/r+a[s]}}class VP{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?k2:zP(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,a,s){this._append`Q${+t},${+r},${this._x1=+a},${this._y1=+s}`}bezierCurveTo(t,r,a,s,i,o){this._append`C${+t},${+r},${+a},${+s},${this._x1=+i},${this._y1=+o}`}arcTo(t,r,a,s,i){if(t=+t,r=+r,a=+a,s=+s,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,l=this._y1,c=a-t,d=s-r,u=o-t,f=l-r,h=u*u+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(h>Ws)if(!(Math.abs(f*c-d*u)>Ws)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let m=a-o,x=s-l,p=c*c+d*d,g=m*m+x*x,y=Math.sqrt(p),w=Math.sqrt(h),v=i*Math.tan((Zh-Math.acos((p+h-g)/(2*y*w)))/2),_=v/w,b=v/y;Math.abs(_-1)>Ws&&this._append`L${t+_*u},${r+_*f}`,this._append`A${i},${i},0,0,${+(f*m>u*x)},${this._x1=t+b*c},${this._y1=r+b*d}`}}arc(t,r,a,s,i,o){if(t=+t,r=+r,a=+a,o=!!o,a<0)throw new Error(`negative radius: ${a}`);let l=a*Math.cos(s),c=a*Math.sin(s),d=t+l,u=r+c,f=1^o,h=o?s-i:i-s;this._x1===null?this._append`M${d},${u}`:(Math.abs(this._x1-d)>Ws||Math.abs(this._y1-u)>Ws)&&this._append`L${d},${u}`,a&&(h<0&&(h=h%Qh+Qh),h>HP?this._append`A${a},${a},0,1,${f},${t-l},${r-c}A${a},${a},0,1,${f},${this._x1=d},${this._y1=u}`:h>Ws&&this._append`A${a},${a},0,${+(h>=Zh)},${f},${this._x1=t+a*Math.cos(i)},${this._y1=r+a*Math.sin(i)}`)}rect(t,r,a,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${a=+a}v${+s}h${-a}Z`}toString(){return this._}}function tp(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const a=Math.floor(r);if(!(a>=0))throw new RangeError(`invalid digits: ${r}`);t=a}return e},()=>new VP(t)}function rp(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function E2(e){this._context=e}E2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Qf(e){return new E2(e)}function A2(e){return e[0]}function T2(e){return e[1]}function O2(e,t){var r=It(!0),a=null,s=Qf,i=null,o=tp(l);e=typeof e=="function"?e:e===void 0?A2:It(e),t=typeof t=="function"?t:t===void 0?T2:It(t);function l(c){var d,u=(c=rp(c)).length,f,h=!1,m;for(a==null&&(i=s(m=o())),d=0;d<=u;++d)!(d<u&&r(f=c[d],d,c))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+e(f,d,c),+t(f,d,c));if(m)return i=null,m+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:It(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:It(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:It(!!c),l):r},l.curve=function(c){return arguments.length?(s=c,a!=null&&(i=s(a)),l):s},l.context=function(c){return arguments.length?(c==null?a=i=null:i=s(a=c),l):a},l}function Od(e,t,r){var a=null,s=It(!0),i=null,o=Qf,l=null,c=tp(d);e=typeof e=="function"?e:e===void 0?A2:It(+e),t=typeof t=="function"?t:It(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?T2:It(+r);function d(f){var h,m,x,p=(f=rp(f)).length,g,y=!1,w,v=new Array(p),_=new Array(p);for(i==null&&(l=o(w=c())),h=0;h<=p;++h){if(!(h<p&&s(g=f[h],h,f))===y)if(y=!y)m=h,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),x=h-1;x>=m;--x)l.point(v[x],_[x]);l.lineEnd(),l.areaEnd()}y&&(v[h]=+e(g,h,f),_[h]=+t(g,h,f),l.point(a?+a(g,h,f):v[h],r?+r(g,h,f):_[h]))}if(w)return l=null,w+""||null}function u(){return O2().defined(s).curve(o).context(i)}return d.x=function(f){return arguments.length?(e=typeof f=="function"?f:It(+f),a=null,d):e},d.x0=function(f){return arguments.length?(e=typeof f=="function"?f:It(+f),d):e},d.x1=function(f){return arguments.length?(a=f==null?null:typeof f=="function"?f:It(+f),d):a},d.y=function(f){return arguments.length?(t=typeof f=="function"?f:It(+f),r=null,d):t},d.y0=function(f){return arguments.length?(t=typeof f=="function"?f:It(+f),d):t},d.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:It(+f),d):r},d.lineX0=d.lineY0=function(){return u().x(e).y(t)},d.lineY1=function(){return u().x(e).y(r)},d.lineX1=function(){return u().x(a).y(t)},d.defined=function(f){return arguments.length?(s=typeof f=="function"?f:It(!!f),d):s},d.curve=function(f){return arguments.length?(o=f,i!=null&&(l=o(i)),d):o},d.context=function(f){return arguments.length?(f==null?i=l=null:l=o(i=f),d):i},d}class P2{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function GP(e){return new P2(e,!0)}function KP(e){return new P2(e,!1)}const ap={draw(e,t){const r=un(t/fu);e.moveTo(r,0),e.arc(0,0,r,0,Zf)}},qP={draw(e,t){const r=un(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},C2=un(1/3),XP=C2*2,YP={draw(e,t){const r=un(t/XP),a=r*C2;e.moveTo(0,-r),e.lineTo(a,0),e.lineTo(0,r),e.lineTo(-a,0),e.closePath()}},JP={draw(e,t){const r=un(t),a=-r/2;e.rect(a,a,r,r)}},ZP=.8908130915292852,F2=uu(fu/10)/uu(7*fu/10),QP=uu(Zf/10)*F2,eC=-S2(Zf/10)*F2,tC={draw(e,t){const r=un(t*ZP),a=QP*r,s=eC*r;e.moveTo(0,-r),e.lineTo(a,s);for(let i=1;i<5;++i){const o=Zf*i/5,l=S2(o),c=uu(o);e.lineTo(c*r,-l*r),e.lineTo(l*a-c*s,c*a+l*s)}e.closePath()}},K0=un(3),rC={draw(e,t){const r=-un(t/(K0*3));e.moveTo(0,r*2),e.lineTo(-K0*r,-r),e.lineTo(K0*r,-r),e.closePath()}},Fa=-.5,Ia=un(3)/2,em=1/un(12),aC=(em/2+1)*3,nC={draw(e,t){const r=un(t/aC),a=r/2,s=r*em,i=a,o=r*em+r,l=-i,c=o;e.moveTo(a,s),e.lineTo(i,o),e.lineTo(l,c),e.lineTo(Fa*a-Ia*s,Ia*a+Fa*s),e.lineTo(Fa*i-Ia*o,Ia*i+Fa*o),e.lineTo(Fa*l-Ia*c,Ia*l+Fa*c),e.lineTo(Fa*a+Ia*s,Fa*s-Ia*a),e.lineTo(Fa*i+Ia*o,Fa*o-Ia*i),e.lineTo(Fa*l+Ia*c,Fa*c-Ia*l),e.closePath()}};function sC(e,t){let r=null,a=tp(s);e=typeof e=="function"?e:It(e||ap),t=typeof t=="function"?t:It(t===void 0?64:+t);function s(){let i;if(r||(r=i=a()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return s.type=function(i){return arguments.length?(e=typeof i=="function"?i:It(i),s):e},s.size=function(i){return arguments.length?(t=typeof i=="function"?i:It(+i),s):t},s.context=function(i){return arguments.length?(r=i??null,s):r},s}function hu(){}function mu(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function I2(e){this._context=e}I2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:mu(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:mu(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function iC(e){return new I2(e)}function D2(e){this._context=e}D2.prototype={areaStart:hu,areaEnd:hu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:mu(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function oC(e){return new D2(e)}function R2(e){this._context=e}R2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,a=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,a):this._context.moveTo(r,a);break;case 3:this._point=4;default:mu(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function lC(e){return new R2(e)}function M2(e){this._context=e}M2.prototype={areaStart:hu,areaEnd:hu,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function cC(e){return new M2(e)}function pv(e){return e<0?-1:1}function gv(e,t,r){var a=e._x1-e._x0,s=t-e._x1,i=(e._y1-e._y0)/(a||s<0&&-0),o=(r-e._y1)/(s||a<0&&-0),l=(i*s+o*a)/(a+s);return(pv(i)+pv(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(l))||0}function vv(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function q0(e,t,r){var a=e._x0,s=e._y0,i=e._x1,o=e._y1,l=(i-a)/3;e._context.bezierCurveTo(a+l,s+l*t,i-l,o-l*r,i,o)}function xu(e){this._context=e}xu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:q0(this,this._t0,vv(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,q0(this,vv(this,r=gv(this,e,t)),r);break;default:q0(this,this._t0,r=gv(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function $2(e){this._context=new L2(e)}($2.prototype=Object.create(xu.prototype)).point=function(e,t){xu.prototype.point.call(this,t,e)};function L2(e){this._context=e}L2.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,a,s,i){this._context.bezierCurveTo(t,e,a,r,i,s)}};function dC(e){return new xu(e)}function uC(e){return new $2(e)}function B2(e){this._context=e}B2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var a=yv(e),s=yv(t),i=0,o=1;o<r;++i,++o)this._context.bezierCurveTo(a[0][i],s[0][i],a[1][i],s[1][i],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function yv(e){var t,r=e.length-1,a,s=new Array(r),i=new Array(r),o=new Array(r);for(s[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)s[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(s[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)a=s[t]/i[t-1],i[t]-=a,o[t]-=a*o[t-1];for(s[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)s[t]=(o[t]-s[t+1])/i[t];for(i[r-1]=(e[r]+s[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-s[t+1];return[s,i]}function fC(e){return new B2(e)}function e0(e,t){this._context=e,this._t=t}e0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function hC(e){return new e0(e,.5)}function mC(e){return new e0(e,0)}function xC(e){return new e0(e,1)}function po(e,t){if((o=e.length)>1)for(var r=1,a,s,i=e[t[0]],o,l=i.length;r<o;++r)for(s=i,i=e[t[r]],a=0;a<l;++a)i[a][1]+=i[a][0]=isNaN(s[a][1])?s[a][0]:s[a][1]}function tm(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function pC(e,t){return e[t]}function gC(e){const t=[];return t.key=e,t}function vC(){var e=It([]),t=tm,r=po,a=pC;function s(i){var o=Array.from(e.apply(this,arguments),gC),l,c=o.length,d=-1,u;for(const f of i)for(l=0,++d;l<c;++l)(o[l][d]=[0,+a(f,o[l].key,d,i)]).data=f;for(l=0,u=rp(t(o));l<c;++l)o[u[l]].index=l;return r(o,u),o}return s.keys=function(i){return arguments.length?(e=typeof i=="function"?i:It(Array.from(i)),s):e},s.value=function(i){return arguments.length?(a=typeof i=="function"?i:It(+i),s):a},s.order=function(i){return arguments.length?(t=i==null?tm:typeof i=="function"?i:It(Array.from(i)),s):t},s.offset=function(i){return arguments.length?(r=i??po,s):r},s}function yC(e,t){if((a=e.length)>0){for(var r,a,s=0,i=e[0].length,o;s<i;++s){for(o=r=0;r<a;++r)o+=e[r][s][1]||0;if(o)for(r=0;r<a;++r)e[r][s][1]/=o}po(e,t)}}function bC(e,t){if((s=e.length)>0){for(var r=0,a=e[t[0]],s,i=a.length;r<i;++r){for(var o=0,l=0;o<s;++o)l+=e[o][r][1]||0;a[r][1]+=a[r][0]=-l/2}po(e,t)}}function wC(e,t){if(!(!((o=e.length)>0)||!((i=(s=e[t[0]]).length)>0))){for(var r=0,a=1,s,i,o;a<i;++a){for(var l=0,c=0,d=0;l<o;++l){for(var u=e[t[l]],f=u[a][1]||0,h=u[a-1][1]||0,m=(f-h)/2,x=0;x<l;++x){var p=e[t[x]],g=p[a][1]||0,y=p[a-1][1]||0;m+=g-y}c+=f,d+=m*f}s[a-1][1]+=s[a-1][0]=r,c&&(r-=d/c)}s[a-1][1]+=s[a-1][0]=r,po(e,t)}}function cc(e){"@babel/helpers - typeof";return cc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cc(e)}var jC=["type","size","sizeType"];function rm(){return rm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},rm.apply(this,arguments)}function bv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function wv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bv(Object(r),!0).forEach(function(a){NC(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bv(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function NC(e,t,r){return t=_C(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _C(e){var t=SC(e,"string");return cc(t)=="symbol"?t:t+""}function SC(e,t){if(cc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(cc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kC(e,t){if(e==null)return{};var r=EC(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function EC(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}var U2={symbolCircle:ap,symbolCross:qP,symbolDiamond:YP,symbolSquare:JP,symbolStar:tC,symbolTriangle:rC,symbolWye:nC},AC=Math.PI/180,TC=function(t){var r="symbol".concat(Jf(t));return U2[r]||ap},OC=function(t,r,a){if(r==="area")return t;switch(a){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var s=18*AC;return 1.25*t*t*(Math.tan(s)-Math.tan(s*2)*Math.pow(Math.tan(s),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},PC=function(t,r){U2["symbol".concat(Jf(t))]=r},np=function(t){var r=t.type,a=r===void 0?"circle":r,s=t.size,i=s===void 0?64:s,o=t.sizeType,l=o===void 0?"area":o,c=kC(t,jC),d=wv(wv({},c),{},{type:a,size:i,sizeType:l}),u=function(){var g=TC(a),y=sC().type(g).size(OC(i,l,a));return y()},f=d.className,h=d.cx,m=d.cy,x=Ce(d,!0);return h===+h&&m===+m&&i===+i?Z.createElement("path",rm({},x,{className:qe("recharts-symbols",f),transform:"translate(".concat(h,", ").concat(m,")"),d:u()})):null};np.registerSymbol=PC;function go(e){"@babel/helpers - typeof";return go=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},go(e)}function am(){return am=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},am.apply(this,arguments)}function jv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function CC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jv(Object(r),!0).forEach(function(a){dc(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jv(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function FC(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IC(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,H2(a.key),a)}}function DC(e,t,r){return t&&IC(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function RC(e,t,r){return t=pu(t),MC(e,W2()?Reflect.construct(t,r||[],pu(e).constructor):t.apply(e,r))}function MC(e,t){if(t&&(go(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $C(e)}function $C(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function W2(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(W2=function(){return!!e})()}function pu(e){return pu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pu(e)}function LC(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nm(e,t)}function nm(e,t){return nm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},nm(e,t)}function dc(e,t,r){return t=H2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function H2(e){var t=BC(e,"string");return go(t)=="symbol"?t:t+""}function BC(e,t){if(go(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(go(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Da=32,sp=function(e){function t(){return FC(this,t),RC(this,t,arguments)}return LC(t,e),DC(t,[{key:"renderIcon",value:function(a){var s=this.props.inactiveColor,i=Da/2,o=Da/6,l=Da/3,c=a.inactive?s:a.color;if(a.type==="plainline")return Z.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:a.payload.strokeDasharray,x1:0,y1:i,x2:Da,y2:i,className:"recharts-legend-icon"});if(a.type==="line")return Z.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(i,"h").concat(l,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*l,",").concat(i,`
            H`).concat(Da,"M").concat(2*l,",").concat(i,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(l,",").concat(i),className:"recharts-legend-icon"});if(a.type==="rect")return Z.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(Da/8,"h").concat(Da,"v").concat(Da*3/4,"h").concat(-Da,"z"),className:"recharts-legend-icon"});if(Z.isValidElement(a.legendIcon)){var d=CC({},a);return delete d.legendIcon,Z.cloneElement(a.legendIcon,d)}return Z.createElement(np,{fill:c,cx:i,cy:i,size:Da,sizeType:"diameter",type:a.type})}},{key:"renderItems",value:function(){var a=this,s=this.props,i=s.payload,o=s.iconSize,l=s.layout,c=s.formatter,d=s.inactiveColor,u={x:0,y:0,width:Da,height:Da},f={display:l==="horizontal"?"inline-block":"block",marginRight:10},h={display:"inline-block",verticalAlign:"middle",marginRight:4};return i.map(function(m,x){var p=m.formatter||c,g=qe(dc(dc({"recharts-legend-item":!0},"legend-item-".concat(x),!0),"inactive",m.inactive));if(m.type==="none")return null;var y=$e(m.value)?null:m.value;on(!$e(m.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var w=m.inactive?d:m.color;return Z.createElement("li",am({className:g,style:f,key:"legend-item-".concat(x)},vi(a.props,m,x)),Z.createElement(qh,{width:o,height:o,viewBox:u,style:h},a.renderIcon(m)),Z.createElement("span",{className:"recharts-legend-item-text",style:{color:w}},p?p(y,m,x):y))})}},{key:"render",value:function(){var a=this.props,s=a.payload,i=a.layout,o=a.align;if(!s||!s.length)return null;var l={padding:0,margin:0,textAlign:i==="horizontal"?o:"left"};return Z.createElement("ul",{className:"recharts-default-legend",style:l},this.renderItems())}}])}(O.PureComponent);dc(sp,"displayName","Legend");dc(sp,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var UC=$f;function WC(){this.__data__=new UC,this.size=0}var HC=WC;function zC(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var VC=zC;function GC(e){return this.__data__.get(e)}var KC=GC;function qC(e){return this.__data__.has(e)}var XC=qC,YC=$f,JC=Gx,ZC=Kx,QC=200;function e8(e,t){var r=this.__data__;if(r instanceof YC){var a=r.__data__;if(!JC||a.length<QC-1)return a.push([e,t]),this.size=++r.size,this;r=this.__data__=new ZC(a)}return r.set(e,t),this.size=r.size,this}var t8=e8,r8=$f,a8=HC,n8=VC,s8=KC,i8=XC,o8=t8;function el(e){var t=this.__data__=new r8(e);this.size=t.size}el.prototype.clear=a8;el.prototype.delete=n8;el.prototype.get=s8;el.prototype.has=i8;el.prototype.set=o8;var z2=el,l8="__lodash_hash_undefined__";function c8(e){return this.__data__.set(e,l8),this}var d8=c8;function u8(e){return this.__data__.has(e)}var f8=u8,h8=Kx,m8=d8,x8=f8;function gu(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new h8;++t<r;)this.add(e[t])}gu.prototype.add=gu.prototype.push=m8;gu.prototype.has=x8;var V2=gu;function p8(e,t){for(var r=-1,a=e==null?0:e.length;++r<a;)if(t(e[r],r,e))return!0;return!1}var G2=p8;function g8(e,t){return e.has(t)}var K2=g8,v8=V2,y8=G2,b8=K2,w8=1,j8=2;function N8(e,t,r,a,s,i){var o=r&w8,l=e.length,c=t.length;if(l!=c&&!(o&&c>l))return!1;var d=i.get(e),u=i.get(t);if(d&&u)return d==t&&u==e;var f=-1,h=!0,m=r&j8?new v8:void 0;for(i.set(e,t),i.set(t,e);++f<l;){var x=e[f],p=t[f];if(a)var g=o?a(p,x,f,t,e,i):a(x,p,f,e,t,i);if(g!==void 0){if(g)continue;h=!1;break}if(m){if(!y8(t,function(y,w){if(!b8(m,w)&&(x===y||s(x,y,r,a,i)))return m.push(w)})){h=!1;break}}else if(!(x===p||s(x,p,r,a,i))){h=!1;break}}return i.delete(e),i.delete(t),h}var q2=N8,_8=Tn,S8=_8.Uint8Array,k8=S8;function E8(e){var t=-1,r=Array(e.size);return e.forEach(function(a,s){r[++t]=[s,a]}),r}var A8=E8;function T8(e){var t=-1,r=Array(e.size);return e.forEach(function(a){r[++t]=a}),r}var ip=T8,Nv=dd,_v=k8,O8=Vx,P8=q2,C8=A8,F8=ip,I8=1,D8=2,R8="[object Boolean]",M8="[object Date]",$8="[object Error]",L8="[object Map]",B8="[object Number]",U8="[object RegExp]",W8="[object Set]",H8="[object String]",z8="[object Symbol]",V8="[object ArrayBuffer]",G8="[object DataView]",Sv=Nv?Nv.prototype:void 0,X0=Sv?Sv.valueOf:void 0;function K8(e,t,r,a,s,i,o){switch(r){case G8:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case V8:return!(e.byteLength!=t.byteLength||!i(new _v(e),new _v(t)));case R8:case M8:case B8:return O8(+e,+t);case $8:return e.name==t.name&&e.message==t.message;case U8:case H8:return e==t+"";case L8:var l=C8;case W8:var c=a&I8;if(l||(l=F8),e.size!=t.size&&!c)return!1;var d=o.get(e);if(d)return d==t;a|=D8,o.set(e,t);var u=P8(l(e),l(t),a,s,i,o);return o.delete(e),u;case z8:if(X0)return X0.call(e)==X0.call(t)}return!1}var q8=K8;function X8(e,t){for(var r=-1,a=t.length,s=e.length;++r<a;)e[s+r]=t[r];return e}var X2=X8,Y8=X2,J8=ga;function Z8(e,t,r){var a=t(e);return J8(e)?a:Y8(a,r(e))}var Q8=Z8;function eF(e,t){for(var r=-1,a=e==null?0:e.length,s=0,i=[];++r<a;){var o=e[r];t(o,r,e)&&(i[s++]=o)}return i}var tF=eF;function rF(){return[]}var aF=rF,nF=tF,sF=aF,iF=Object.prototype,oF=iF.propertyIsEnumerable,kv=Object.getOwnPropertySymbols,lF=kv?function(e){return e==null?[]:(e=Object(e),nF(kv(e),function(t){return oF.call(e,t)}))}:sF,cF=lF;function dF(e,t){for(var r=-1,a=Array(e);++r<e;)a[r]=t(r);return a}var uF=dF,fF=as,hF=ns,mF="[object Arguments]";function xF(e){return hF(e)&&fF(e)==mF}var pF=xF,Ev=pF,gF=ns,Y2=Object.prototype,vF=Y2.hasOwnProperty,yF=Y2.propertyIsEnumerable,bF=Ev(function(){return arguments}())?Ev:function(e){return gF(e)&&vF.call(e,"callee")&&!yF.call(e,"callee")},op=bF,vu={exports:{}};function wF(){return!1}var jF=wF;vu.exports;(function(e,t){var r=Tn,a=jF,s=t&&!t.nodeType&&t,i=s&&!0&&e&&!e.nodeType&&e,o=i&&i.exports===s,l=o?r.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||a;e.exports=d})(vu,vu.exports);var J2=vu.exports,NF=9007199254740991,_F=/^(?:0|[1-9]\d*)$/;function SF(e,t){var r=typeof e;return t=t??NF,!!t&&(r=="number"||r!="symbol"&&_F.test(e))&&e>-1&&e%1==0&&e<t}var lp=SF,kF=9007199254740991;function EF(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=kF}var cp=EF,AF=as,TF=cp,OF=ns,PF="[object Arguments]",CF="[object Array]",FF="[object Boolean]",IF="[object Date]",DF="[object Error]",RF="[object Function]",MF="[object Map]",$F="[object Number]",LF="[object Object]",BF="[object RegExp]",UF="[object Set]",WF="[object String]",HF="[object WeakMap]",zF="[object ArrayBuffer]",VF="[object DataView]",GF="[object Float32Array]",KF="[object Float64Array]",qF="[object Int8Array]",XF="[object Int16Array]",YF="[object Int32Array]",JF="[object Uint8Array]",ZF="[object Uint8ClampedArray]",QF="[object Uint16Array]",eI="[object Uint32Array]",Rt={};Rt[GF]=Rt[KF]=Rt[qF]=Rt[XF]=Rt[YF]=Rt[JF]=Rt[ZF]=Rt[QF]=Rt[eI]=!0;Rt[PF]=Rt[CF]=Rt[zF]=Rt[FF]=Rt[VF]=Rt[IF]=Rt[DF]=Rt[RF]=Rt[MF]=Rt[$F]=Rt[LF]=Rt[BF]=Rt[UF]=Rt[WF]=Rt[HF]=!1;function tI(e){return OF(e)&&TF(e.length)&&!!Rt[AF(e)]}var rI=tI;function aI(e){return function(t){return e(t)}}var Z2=aI,yu={exports:{}};yu.exports;(function(e,t){var r=s2,a=t&&!t.nodeType&&t,s=a&&!0&&e&&!e.nodeType&&e,i=s&&s.exports===a,o=i&&r.process,l=function(){try{var c=s&&s.require&&s.require("util").types;return c||o&&o.binding&&o.binding("util")}catch{}}();e.exports=l})(yu,yu.exports);var nI=yu.exports,sI=rI,iI=Z2,Av=nI,Tv=Av&&Av.isTypedArray,oI=Tv?iI(Tv):sI,Q2=oI,lI=uF,cI=op,dI=ga,uI=J2,fI=lp,hI=Q2,mI=Object.prototype,xI=mI.hasOwnProperty;function pI(e,t){var r=dI(e),a=!r&&cI(e),s=!r&&!a&&uI(e),i=!r&&!a&&!s&&hI(e),o=r||a||s||i,l=o?lI(e.length,String):[],c=l.length;for(var d in e)(t||xI.call(e,d))&&!(o&&(d=="length"||s&&(d=="offset"||d=="parent")||i&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||fI(d,c)))&&l.push(d);return l}var gI=pI,vI=Object.prototype;function yI(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||vI;return e===r}var bI=yI;function wI(e,t){return function(r){return e(t(r))}}var eN=wI,jI=eN,NI=jI(Object.keys,Object),_I=NI,SI=bI,kI=_I,EI=Object.prototype,AI=EI.hasOwnProperty;function TI(e){if(!SI(e))return kI(e);var t=[];for(var r in Object(e))AI.call(e,r)&&r!="constructor"&&t.push(r);return t}var OI=TI,PI=zx,CI=cp;function FI(e){return e!=null&&CI(e.length)&&!PI(e)}var ud=FI,II=gI,DI=OI,RI=ud;function MI(e){return RI(e)?II(e):DI(e)}var t0=MI,$I=Q8,LI=cF,BI=t0;function UI(e){return $I(e,BI,LI)}var WI=UI,Ov=WI,HI=1,zI=Object.prototype,VI=zI.hasOwnProperty;function GI(e,t,r,a,s,i){var o=r&HI,l=Ov(e),c=l.length,d=Ov(t),u=d.length;if(c!=u&&!o)return!1;for(var f=c;f--;){var h=l[f];if(!(o?h in t:VI.call(t,h)))return!1}var m=i.get(e),x=i.get(t);if(m&&x)return m==t&&x==e;var p=!0;i.set(e,t),i.set(t,e);for(var g=o;++f<c;){h=l[f];var y=e[h],w=t[h];if(a)var v=o?a(w,y,h,t,e,i):a(y,w,h,e,t,i);if(!(v===void 0?y===w||s(y,w,r,a,i):v)){p=!1;break}g||(g=h=="constructor")}if(p&&!g){var _=e.constructor,b=t.constructor;_!=b&&"constructor"in e&&"constructor"in t&&!(typeof _=="function"&&_ instanceof _&&typeof b=="function"&&b instanceof b)&&(p=!1)}return i.delete(e),i.delete(t),p}var KI=GI,qI=Fi,XI=Tn,YI=qI(XI,"DataView"),JI=YI,ZI=Fi,QI=Tn,eD=ZI(QI,"Promise"),tD=eD,rD=Fi,aD=Tn,nD=rD(aD,"Set"),tN=nD,sD=Fi,iD=Tn,oD=sD(iD,"WeakMap"),lD=oD,sm=JI,im=Gx,om=tD,lm=tN,cm=lD,rN=as,tl=o2,Pv="[object Map]",cD="[object Object]",Cv="[object Promise]",Fv="[object Set]",Iv="[object WeakMap]",Dv="[object DataView]",dD=tl(sm),uD=tl(im),fD=tl(om),hD=tl(lm),mD=tl(cm),Hs=rN;(sm&&Hs(new sm(new ArrayBuffer(1)))!=Dv||im&&Hs(new im)!=Pv||om&&Hs(om.resolve())!=Cv||lm&&Hs(new lm)!=Fv||cm&&Hs(new cm)!=Iv)&&(Hs=function(e){var t=rN(e),r=t==cD?e.constructor:void 0,a=r?tl(r):"";if(a)switch(a){case dD:return Dv;case uD:return Pv;case fD:return Cv;case hD:return Fv;case mD:return Iv}return t});var xD=Hs,Y0=z2,pD=q2,gD=q8,vD=KI,Rv=xD,Mv=ga,$v=J2,yD=Q2,bD=1,Lv="[object Arguments]",Bv="[object Array]",Pd="[object Object]",wD=Object.prototype,Uv=wD.hasOwnProperty;function jD(e,t,r,a,s,i){var o=Mv(e),l=Mv(t),c=o?Bv:Rv(e),d=l?Bv:Rv(t);c=c==Lv?Pd:c,d=d==Lv?Pd:d;var u=c==Pd,f=d==Pd,h=c==d;if(h&&$v(e)){if(!$v(t))return!1;o=!0,u=!1}if(h&&!u)return i||(i=new Y0),o||yD(e)?pD(e,t,r,a,s,i):gD(e,t,c,r,a,s,i);if(!(r&bD)){var m=u&&Uv.call(e,"__wrapped__"),x=f&&Uv.call(t,"__wrapped__");if(m||x){var p=m?e.value():e,g=x?t.value():t;return i||(i=new Y0),s(p,g,r,a,i)}}return h?(i||(i=new Y0),vD(e,t,r,a,s,i)):!1}var ND=jD,_D=ND,Wv=ns;function aN(e,t,r,a,s){return e===t?!0:e==null||t==null||!Wv(e)&&!Wv(t)?e!==e&&t!==t:_D(e,t,r,a,aN,s)}var dp=aN,SD=z2,kD=dp,ED=1,AD=2;function TD(e,t,r,a){var s=r.length,i=s,o=!a;if(e==null)return!i;for(e=Object(e);s--;){var l=r[s];if(o&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++s<i;){l=r[s];var c=l[0],d=e[c],u=l[1];if(o&&l[2]){if(d===void 0&&!(c in e))return!1}else{var f=new SD;if(a)var h=a(d,u,c,e,t,f);if(!(h===void 0?kD(u,d,ED|AD,a,f):h))return!1}}return!0}var OD=TD,PD=Ts;function CD(e){return e===e&&!PD(e)}var nN=CD,FD=nN,ID=t0;function DD(e){for(var t=ID(e),r=t.length;r--;){var a=t[r],s=e[a];t[r]=[a,s,FD(s)]}return t}var RD=DD;function MD(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var sN=MD,$D=OD,LD=RD,BD=sN;function UD(e){var t=LD(e);return t.length==1&&t[0][2]?BD(t[0][0],t[0][1]):function(r){return r===e||$D(r,e,t)}}var WD=UD;function HD(e,t){return e!=null&&t in Object(e)}var zD=HD,VD=f2,GD=op,KD=ga,qD=lp,XD=cp,YD=Bf;function JD(e,t,r){t=VD(t,e);for(var a=-1,s=t.length,i=!1;++a<s;){var o=YD(t[a]);if(!(i=e!=null&&r(e,o)))break;e=e[o]}return i||++a!=s?i:(s=e==null?0:e.length,!!s&&XD(s)&&qD(o,s)&&(KD(e)||GD(e)))}var ZD=JD,QD=zD,eR=ZD;function tR(e,t){return e!=null&&eR(e,t,QD)}var rR=tR,aR=dp,nR=h2,sR=rR,iR=Hx,oR=nN,lR=sN,cR=Bf,dR=1,uR=2;function fR(e,t){return iR(e)&&oR(t)?lR(cR(e),t):function(r){var a=nR(r,e);return a===void 0&&a===t?sR(r,e):aR(t,a,dR|uR)}}var hR=fR;function mR(e){return e}var rl=mR;function xR(e){return function(t){return t==null?void 0:t[e]}}var pR=xR,gR=Yx;function vR(e){return function(t){return gR(t,e)}}var yR=vR,bR=pR,wR=yR,jR=Hx,NR=Bf;function _R(e){return jR(e)?bR(NR(e)):wR(e)}var SR=_R,kR=WD,ER=hR,AR=rl,TR=ga,OR=SR;function PR(e){return typeof e=="function"?e:e==null?AR:typeof e=="object"?TR(e)?ER(e[0],e[1]):kR(e):OR(e)}var On=PR;function CR(e,t,r,a){for(var s=e.length,i=r+(a?1:-1);a?i--:++i<s;)if(t(e[i],i,e))return i;return-1}var iN=CR;function FR(e){return e!==e}var IR=FR;function DR(e,t,r){for(var a=r-1,s=e.length;++a<s;)if(e[a]===t)return a;return-1}var RR=DR,MR=iN,$R=IR,LR=RR;function BR(e,t,r){return t===t?LR(e,t,r):MR(e,$R,r)}var UR=BR,WR=UR;function HR(e,t){var r=e==null?0:e.length;return!!r&&WR(e,t,0)>-1}var zR=HR;function VR(e,t,r){for(var a=-1,s=e==null?0:e.length;++a<s;)if(r(t,e[a]))return!0;return!1}var GR=VR;function KR(){}var qR=KR,J0=tN,XR=qR,YR=ip,JR=1/0,ZR=J0&&1/YR(new J0([,-0]))[1]==JR?function(e){return new J0(e)}:XR,QR=ZR,eM=V2,tM=zR,rM=GR,aM=K2,nM=QR,sM=ip,iM=200;function oM(e,t,r){var a=-1,s=tM,i=e.length,o=!0,l=[],c=l;if(r)o=!1,s=rM;else if(i>=iM){var d=t?null:nM(e);if(d)return sM(d);o=!1,s=aM,c=new eM}else c=t?[]:l;e:for(;++a<i;){var u=e[a],f=t?t(u):u;if(u=r||u!==0?u:0,o&&f===f){for(var h=c.length;h--;)if(c[h]===f)continue e;t&&c.push(f),l.push(u)}else s(c,f,r)||(c!==l&&c.push(f),l.push(u))}return l}var lM=oM,cM=On,dM=lM;function uM(e,t){return e&&e.length?dM(e,cM(t)):[]}var fM=uM;const Hv=kt(fM);function oN(e,t,r){return t===!0?Hv(e,r):$e(t)?Hv(e,t):e}function vo(e){"@babel/helpers - typeof";return vo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vo(e)}var hM=["ref"];function zv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Dn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zv(Object(r),!0).forEach(function(a){r0(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zv(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function mM(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vv(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,cN(a.key),a)}}function xM(e,t,r){return t&&Vv(e.prototype,t),r&&Vv(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pM(e,t,r){return t=bu(t),gM(e,lN()?Reflect.construct(t,r||[],bu(e).constructor):t.apply(e,r))}function gM(e,t){if(t&&(vo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vM(e)}function vM(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lN=function(){return!!e})()}function bu(e){return bu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bu(e)}function yM(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dm(e,t)}function dm(e,t){return dm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},dm(e,t)}function r0(e,t,r){return t=cN(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cN(e){var t=bM(e,"string");return vo(t)=="symbol"?t:t+""}function bM(e,t){if(vo(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(vo(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function wM(e,t){if(e==null)return{};var r=jM(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function jM(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function NM(e){return e.value}function _M(e,t){if(Z.isValidElement(e))return Z.cloneElement(e,t);if(typeof e=="function")return Z.createElement(e,t);t.ref;var r=wM(t,hM);return Z.createElement(sp,r)}var Gv=1,oo=function(e){function t(){var r;mM(this,t);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return r=pM(this,t,[].concat(s)),r0(r,"lastBoundingBox",{width:-1,height:-1}),r}return yM(t,e),xM(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var a=this.wrapperNode.getBoundingClientRect();return a.height=this.wrapperNode.offsetHeight,a.width=this.wrapperNode.offsetWidth,a}return null}},{key:"updateBBox",value:function(){var a=this.props.onBBoxUpdate,s=this.getBBox();s?(Math.abs(s.width-this.lastBoundingBox.width)>Gv||Math.abs(s.height-this.lastBoundingBox.height)>Gv)&&(this.lastBoundingBox.width=s.width,this.lastBoundingBox.height=s.height,a&&a(s)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,a&&a(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Dn({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(a){var s=this.props,i=s.layout,o=s.align,l=s.verticalAlign,c=s.margin,d=s.chartWidth,u=s.chartHeight,f,h;if(!a||(a.left===void 0||a.left===null)&&(a.right===void 0||a.right===null))if(o==="center"&&i==="vertical"){var m=this.getBBoxSnapshot();f={left:((d||0)-m.width)/2}}else f=o==="right"?{right:c&&c.right||0}:{left:c&&c.left||0};if(!a||(a.top===void 0||a.top===null)&&(a.bottom===void 0||a.bottom===null))if(l==="middle"){var x=this.getBBoxSnapshot();h={top:((u||0)-x.height)/2}}else h=l==="bottom"?{bottom:c&&c.bottom||0}:{top:c&&c.top||0};return Dn(Dn({},f),h)}},{key:"render",value:function(){var a=this,s=this.props,i=s.content,o=s.width,l=s.height,c=s.wrapperStyle,d=s.payloadUniqBy,u=s.payload,f=Dn(Dn({position:"absolute",width:o||"auto",height:l||"auto"},this.getDefaultPosition(c)),c);return Z.createElement("div",{className:"recharts-legend-wrapper",style:f,ref:function(m){a.wrapperNode=m}},_M(i,Dn(Dn({},this.props),{},{payload:oN(u,d,NM)})))}}],[{key:"getWithHeight",value:function(a,s){var i=Dn(Dn({},this.defaultProps),a.props),o=i.layout;return o==="vertical"&&be(a.props.height)?{height:a.props.height}:o==="horizontal"?{width:a.props.width||s}:null}}])}(O.PureComponent);r0(oo,"displayName","Legend");r0(oo,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var Kv=dd,SM=op,kM=ga,qv=Kv?Kv.isConcatSpreadable:void 0;function EM(e){return kM(e)||SM(e)||!!(qv&&e&&e[qv])}var AM=EM,TM=X2,OM=AM;function dN(e,t,r,a,s){var i=-1,o=e.length;for(r||(r=OM),s||(s=[]);++i<o;){var l=e[i];t>0&&r(l)?t>1?dN(l,t-1,r,a,s):TM(s,l):a||(s[s.length]=l)}return s}var uN=dN;function PM(e){return function(t,r,a){for(var s=-1,i=Object(t),o=a(t),l=o.length;l--;){var c=o[e?l:++s];if(r(i[c],c,i)===!1)break}return t}}var CM=PM,FM=CM,IM=FM(),DM=IM,RM=DM,MM=t0;function $M(e,t){return e&&RM(e,t,MM)}var fN=$M,LM=ud;function BM(e,t){return function(r,a){if(r==null)return r;if(!LM(r))return e(r,a);for(var s=r.length,i=t?s:-1,o=Object(r);(t?i--:++i<s)&&a(o[i],i,o)!==!1;);return r}}var UM=BM,WM=fN,HM=UM,zM=HM(WM),up=zM,VM=up,GM=ud;function KM(e,t){var r=-1,a=GM(e)?Array(e.length):[];return VM(e,function(s,i,o){a[++r]=t(s,i,o)}),a}var hN=KM;function qM(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var XM=qM,Xv=qo;function YM(e,t){if(e!==t){var r=e!==void 0,a=e===null,s=e===e,i=Xv(e),o=t!==void 0,l=t===null,c=t===t,d=Xv(t);if(!l&&!d&&!i&&e>t||i&&o&&c&&!l&&!d||a&&o&&c||!r&&c||!s)return 1;if(!a&&!i&&!d&&e<t||d&&r&&s&&!a&&!i||l&&r&&s||!o&&s||!c)return-1}return 0}var JM=YM,ZM=JM;function QM(e,t,r){for(var a=-1,s=e.criteria,i=t.criteria,o=s.length,l=r.length;++a<o;){var c=ZM(s[a],i[a]);if(c){if(a>=l)return c;var d=r[a];return c*(d=="desc"?-1:1)}}return e.index-t.index}var e$=QM,Z0=Xx,t$=Yx,r$=On,a$=hN,n$=XM,s$=Z2,i$=e$,o$=rl,l$=ga;function c$(e,t,r){t.length?t=Z0(t,function(i){return l$(i)?function(o){return t$(o,i.length===1?i[0]:i)}:i}):t=[o$];var a=-1;t=Z0(t,s$(r$));var s=a$(e,function(i,o,l){var c=Z0(t,function(d){return d(i)});return{criteria:c,index:++a,value:i}});return n$(s,function(i,o){return i$(i,o,r)})}var d$=c$;function u$(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var f$=u$,h$=f$,Yv=Math.max;function m$(e,t,r){return t=Yv(t===void 0?e.length-1:t,0),function(){for(var a=arguments,s=-1,i=Yv(a.length-t,0),o=Array(i);++s<i;)o[s]=a[t+s];s=-1;for(var l=Array(t+1);++s<t;)l[s]=a[s];return l[t]=r(o),h$(e,this,l)}}var x$=m$;function p$(e){return function(){return e}}var g$=p$,v$=Fi,y$=function(){try{var e=v$(Object,"defineProperty");return e({},"",{}),e}catch{}}(),mN=y$,b$=g$,Jv=mN,w$=rl,j$=Jv?function(e,t){return Jv(e,"toString",{configurable:!0,enumerable:!1,value:b$(t),writable:!0})}:w$,N$=j$,_$=800,S$=16,k$=Date.now;function E$(e){var t=0,r=0;return function(){var a=k$(),s=S$-(a-r);if(r=a,s>0){if(++t>=_$)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var A$=E$,T$=N$,O$=A$,P$=O$(T$),C$=P$,F$=rl,I$=x$,D$=C$;function R$(e,t){return D$(I$(e,t,F$),e+"")}var M$=R$,$$=Vx,L$=ud,B$=lp,U$=Ts;function W$(e,t,r){if(!U$(r))return!1;var a=typeof t;return(a=="number"?L$(r)&&B$(t,r.length):a=="string"&&t in r)?$$(r[t],e):!1}var a0=W$,H$=uN,z$=d$,V$=M$,Zv=a0,G$=V$(function(e,t){if(e==null)return[];var r=t.length;return r>1&&Zv(e,t[0],t[1])?t=[]:r>2&&Zv(t[0],t[1],t[2])&&(t=[t[0]]),z$(e,H$(t,1),[])}),K$=G$;const fp=kt(K$);function uc(e){"@babel/helpers - typeof";return uc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uc(e)}function um(){return um=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},um.apply(this,arguments)}function q$(e,t){return Z$(e)||J$(e,t)||Y$(e,t)||X$()}function X$(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Y$(e,t){if(e){if(typeof e=="string")return Qv(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Qv(e,t)}}function Qv(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function J$(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function Z$(e){if(Array.isArray(e))return e}function ey(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Q0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ey(Object(r),!0).forEach(function(a){Q$(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ey(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Q$(e,t,r){return t=eL(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eL(e){var t=tL(e,"string");return uc(t)=="symbol"?t:t+""}function tL(e,t){if(uc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(uc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rL(e){return Array.isArray(e)&&wr(e[0])&&wr(e[1])?e.join(" ~ "):e}var aL=function(t){var r=t.separator,a=r===void 0?" : ":r,s=t.contentStyle,i=s===void 0?{}:s,o=t.itemStyle,l=o===void 0?{}:o,c=t.labelStyle,d=c===void 0?{}:c,u=t.payload,f=t.formatter,h=t.itemSorter,m=t.wrapperClassName,x=t.labelClassName,p=t.label,g=t.labelFormatter,y=t.accessibilityLayer,w=y===void 0?!1:y,v=function(){if(u&&u.length){var C={padding:0,margin:0},T=(h?fp(u,h):u).map(function(M,A){if(M.type==="none")return null;var F=Q0({display:"block",paddingTop:4,paddingBottom:4,color:M.color||"#000"},l),H=M.formatter||f||rL,V=M.value,B=M.name,L=V,ee=B;if(H&&L!=null&&ee!=null){var I=H(V,B,M,A,u);if(Array.isArray(I)){var K=q$(I,2);L=K[0],ee=K[1]}else L=I}return Z.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(A),style:F},wr(ee)?Z.createElement("span",{className:"recharts-tooltip-item-name"},ee):null,wr(ee)?Z.createElement("span",{className:"recharts-tooltip-item-separator"},a):null,Z.createElement("span",{className:"recharts-tooltip-item-value"},L),Z.createElement("span",{className:"recharts-tooltip-item-unit"},M.unit||""))});return Z.createElement("ul",{className:"recharts-tooltip-item-list",style:C},T)}return null},_=Q0({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},i),b=Q0({margin:0},d),j=!We(p),N=j?p:"",k=qe("recharts-default-tooltip",m),S=qe("recharts-tooltip-label",x);j&&g&&u!==void 0&&u!==null&&(N=g(p,u));var E=w?{role:"status","aria-live":"assertive"}:{};return Z.createElement("div",um({className:k,style:_},E),Z.createElement("p",{className:S,style:b},Z.isValidElement(N)?N:"".concat(N)),v())};function fc(e){"@babel/helpers - typeof";return fc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fc(e)}function Cd(e,t,r){return t=nL(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nL(e){var t=sL(e,"string");return fc(t)=="symbol"?t:t+""}function sL(e,t){if(fc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(fc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pl="recharts-tooltip-wrapper",iL={visibility:"hidden"};function oL(e){var t=e.coordinate,r=e.translateX,a=e.translateY;return qe(pl,Cd(Cd(Cd(Cd({},"".concat(pl,"-right"),be(r)&&t&&be(t.x)&&r>=t.x),"".concat(pl,"-left"),be(r)&&t&&be(t.x)&&r<t.x),"".concat(pl,"-bottom"),be(a)&&t&&be(t.y)&&a>=t.y),"".concat(pl,"-top"),be(a)&&t&&be(t.y)&&a<t.y))}function ty(e){var t=e.allowEscapeViewBox,r=e.coordinate,a=e.key,s=e.offsetTopLeft,i=e.position,o=e.reverseDirection,l=e.tooltipDimension,c=e.viewBox,d=e.viewBoxDimension;if(i&&be(i[a]))return i[a];var u=r[a]-l-s,f=r[a]+s;if(t[a])return o[a]?u:f;if(o[a]){var h=u,m=c[a];return h<m?Math.max(f,c[a]):Math.max(u,c[a])}var x=f+l,p=c[a]+d;return x>p?Math.max(u,c[a]):Math.max(f,c[a])}function lL(e){var t=e.translateX,r=e.translateY,a=e.useTranslate3d;return{transform:a?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function cL(e){var t=e.allowEscapeViewBox,r=e.coordinate,a=e.offsetTopLeft,s=e.position,i=e.reverseDirection,o=e.tooltipBox,l=e.useTranslate3d,c=e.viewBox,d,u,f;return o.height>0&&o.width>0&&r?(u=ty({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:a,position:s,reverseDirection:i,tooltipDimension:o.width,viewBox:c,viewBoxDimension:c.width}),f=ty({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:a,position:s,reverseDirection:i,tooltipDimension:o.height,viewBox:c,viewBoxDimension:c.height}),d=lL({translateX:u,translateY:f,useTranslate3d:l})):d=iL,{cssProperties:d,cssClasses:oL({translateX:u,translateY:f,coordinate:r})}}function yo(e){"@babel/helpers - typeof";return yo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yo(e)}function ry(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function ay(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ry(Object(r),!0).forEach(function(a){hm(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ry(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function dL(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uL(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,pN(a.key),a)}}function fL(e,t,r){return t&&uL(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function hL(e,t,r){return t=wu(t),mL(e,xN()?Reflect.construct(t,r||[],wu(e).constructor):t.apply(e,r))}function mL(e,t){if(t&&(yo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xL(e)}function xL(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(xN=function(){return!!e})()}function wu(e){return wu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wu(e)}function pL(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fm(e,t)}function fm(e,t){return fm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},fm(e,t)}function hm(e,t,r){return t=pN(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pN(e){var t=gL(e,"string");return yo(t)=="symbol"?t:t+""}function gL(e,t){if(yo(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(yo(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var ny=1,vL=function(e){function t(){var r;dL(this,t);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return r=hL(this,t,[].concat(s)),hm(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),hm(r,"handleKeyDown",function(o){if(o.key==="Escape"){var l,c,d,u;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(l=(c=r.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&l!==void 0?l:0,y:(d=(u=r.props.coordinate)===null||u===void 0?void 0:u.y)!==null&&d!==void 0?d:0}})}}),r}return pL(t,e),fL(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var a=this.wrapperNode.getBoundingClientRect();(Math.abs(a.width-this.state.lastBoundingBox.width)>ny||Math.abs(a.height-this.state.lastBoundingBox.height)>ny)&&this.setState({lastBoundingBox:{width:a.width,height:a.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var a,s;this.props.active&&this.updateBBox(),this.state.dismissed&&(((a=this.props.coordinate)===null||a===void 0?void 0:a.x)!==this.state.dismissedAtCoordinate.x||((s=this.props.coordinate)===null||s===void 0?void 0:s.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var a=this,s=this.props,i=s.active,o=s.allowEscapeViewBox,l=s.animationDuration,c=s.animationEasing,d=s.children,u=s.coordinate,f=s.hasPayload,h=s.isAnimationActive,m=s.offset,x=s.position,p=s.reverseDirection,g=s.useTranslate3d,y=s.viewBox,w=s.wrapperStyle,v=cL({allowEscapeViewBox:o,coordinate:u,offsetTopLeft:m,position:x,reverseDirection:p,tooltipBox:this.state.lastBoundingBox,useTranslate3d:g,viewBox:y}),_=v.cssClasses,b=v.cssProperties,j=ay(ay({transition:h&&i?"transform ".concat(l,"ms ").concat(c):void 0},b),{},{pointerEvents:"none",visibility:!this.state.dismissed&&i&&f?"visible":"hidden",position:"absolute",top:0,left:0},w);return Z.createElement("div",{tabIndex:-1,className:_,style:j,ref:function(k){a.wrapperNode=k}},d)}}])}(O.PureComponent),yL=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Os={isSsr:yL()};function bo(e){"@babel/helpers - typeof";return bo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bo(e)}function sy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function iy(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sy(Object(r),!0).forEach(function(a){hp(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sy(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function bL(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wL(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,vN(a.key),a)}}function jL(e,t,r){return t&&wL(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function NL(e,t,r){return t=ju(t),_L(e,gN()?Reflect.construct(t,r||[],ju(e).constructor):t.apply(e,r))}function _L(e,t){if(t&&(bo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return SL(e)}function SL(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(gN=function(){return!!e})()}function ju(e){return ju=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ju(e)}function kL(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mm(e,t)}function mm(e,t){return mm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},mm(e,t)}function hp(e,t,r){return t=vN(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vN(e){var t=EL(e,"string");return bo(t)=="symbol"?t:t+""}function EL(e,t){if(bo(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(bo(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function AL(e){return e.dataKey}function TL(e,t){return Z.isValidElement(e)?Z.cloneElement(e,t):typeof e=="function"?Z.createElement(e,t):Z.createElement(aL,t)}var ua=function(e){function t(){return bL(this,t),NL(this,t,arguments)}return kL(t,e),jL(t,[{key:"render",value:function(){var a=this,s=this.props,i=s.active,o=s.allowEscapeViewBox,l=s.animationDuration,c=s.animationEasing,d=s.content,u=s.coordinate,f=s.filterNull,h=s.isAnimationActive,m=s.offset,x=s.payload,p=s.payloadUniqBy,g=s.position,y=s.reverseDirection,w=s.useTranslate3d,v=s.viewBox,_=s.wrapperStyle,b=x??[];f&&b.length&&(b=oN(x.filter(function(N){return N.value!=null&&(N.hide!==!0||a.props.includeHidden)}),p,AL));var j=b.length>0;return Z.createElement(vL,{allowEscapeViewBox:o,animationDuration:l,animationEasing:c,isAnimationActive:h,active:i,coordinate:u,hasPayload:j,offset:m,position:g,reverseDirection:y,useTranslate3d:w,viewBox:v,wrapperStyle:_},TL(d,iy(iy({},this.props),{},{payload:b})))}}])}(O.PureComponent);hp(ua,"displayName","Tooltip");hp(ua,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Os.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var OL=Tn,PL=function(){return OL.Date.now()},CL=PL,FL=/\s/;function IL(e){for(var t=e.length;t--&&FL.test(e.charAt(t)););return t}var DL=IL,RL=DL,ML=/^\s+/;function $L(e){return e&&e.slice(0,RL(e)+1).replace(ML,"")}var LL=$L,BL=LL,oy=Ts,UL=qo,ly=NaN,WL=/^[-+]0x[0-9a-f]+$/i,HL=/^0b[01]+$/i,zL=/^0o[0-7]+$/i,VL=parseInt;function GL(e){if(typeof e=="number")return e;if(UL(e))return ly;if(oy(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=oy(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=BL(e);var r=HL.test(e);return r||zL.test(e)?VL(e.slice(2),r?2:8):WL.test(e)?ly:+e}var yN=GL,KL=Ts,eh=CL,cy=yN,qL="Expected a function",XL=Math.max,YL=Math.min;function JL(e,t,r){var a,s,i,o,l,c,d=0,u=!1,f=!1,h=!0;if(typeof e!="function")throw new TypeError(qL);t=cy(t)||0,KL(r)&&(u=!!r.leading,f="maxWait"in r,i=f?XL(cy(r.maxWait)||0,t):i,h="trailing"in r?!!r.trailing:h);function m(j){var N=a,k=s;return a=s=void 0,d=j,o=e.apply(k,N),o}function x(j){return d=j,l=setTimeout(y,t),u?m(j):o}function p(j){var N=j-c,k=j-d,S=t-N;return f?YL(S,i-k):S}function g(j){var N=j-c,k=j-d;return c===void 0||N>=t||N<0||f&&k>=i}function y(){var j=eh();if(g(j))return w(j);l=setTimeout(y,p(j))}function w(j){return l=void 0,h&&a?m(j):(a=s=void 0,o)}function v(){l!==void 0&&clearTimeout(l),d=0,a=c=s=l=void 0}function _(){return l===void 0?o:w(eh())}function b(){var j=eh(),N=g(j);if(a=arguments,s=this,c=j,N){if(l===void 0)return x(c);if(f)return clearTimeout(l),l=setTimeout(y,t),m(c)}return l===void 0&&(l=setTimeout(y,t)),o}return b.cancel=v,b.flush=_,b}var ZL=JL,QL=ZL,e7=Ts,t7="Expected a function";function r7(e,t,r){var a=!0,s=!0;if(typeof e!="function")throw new TypeError(t7);return e7(r)&&(a="leading"in r?!!r.leading:a,s="trailing"in r?!!r.trailing:s),QL(e,t,{leading:a,maxWait:t,trailing:s})}var a7=r7;const bN=kt(a7);function hc(e){"@babel/helpers - typeof";return hc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hc(e)}function dy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Fd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dy(Object(r),!0).forEach(function(a){n7(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dy(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function n7(e,t,r){return t=s7(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s7(e){var t=i7(e,"string");return hc(t)=="symbol"?t:t+""}function i7(e,t){if(hc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(hc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function o7(e,t){return u7(e)||d7(e,t)||c7(e,t)||l7()}function l7(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function c7(e,t){if(e){if(typeof e=="string")return uy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uy(e,t)}}function uy(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function d7(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function u7(e){if(Array.isArray(e))return e}var gl=O.forwardRef(function(e,t){var r=e.aspect,a=e.initialDimension,s=a===void 0?{width:-1,height:-1}:a,i=e.width,o=i===void 0?"100%":i,l=e.height,c=l===void 0?"100%":l,d=e.minWidth,u=d===void 0?0:d,f=e.minHeight,h=e.maxHeight,m=e.children,x=e.debounce,p=x===void 0?0:x,g=e.id,y=e.className,w=e.onResize,v=e.style,_=v===void 0?{}:v,b=O.useRef(null),j=O.useRef();j.current=w,O.useImperativeHandle(t,function(){return Object.defineProperty(b.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),b.current},configurable:!0})});var N=O.useState({containerWidth:s.width,containerHeight:s.height}),k=o7(N,2),S=k[0],E=k[1],P=O.useCallback(function(T,M){E(function(A){var F=Math.round(T),H=Math.round(M);return A.containerWidth===F&&A.containerHeight===H?A:{containerWidth:F,containerHeight:H}})},[]);O.useEffect(function(){var T=function(B){var L,ee=B[0].contentRect,I=ee.width,K=ee.height;P(I,K),(L=j.current)===null||L===void 0||L.call(j,I,K)};p>0&&(T=bN(T,p,{trailing:!0,leading:!1}));var M=new ResizeObserver(T),A=b.current.getBoundingClientRect(),F=A.width,H=A.height;return P(F,H),M.observe(b.current),function(){M.disconnect()}},[P,p]);var C=O.useMemo(function(){var T=S.containerWidth,M=S.containerHeight;if(T<0||M<0)return null;on(Js(o)||Js(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,o,c),on(!r||r>0,"The aspect(%s) must be greater than zero.",r);var A=Js(o)?T:o,F=Js(c)?M:c;r&&r>0&&(A?F=A/r:F&&(A=F*r),h&&F>h&&(F=h)),on(A>0||F>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,A,F,o,c,u,f,r);var H=!Array.isArray(m)&&zn(m.type).endsWith("Chart");return Z.Children.map(m,function(V){return Z.isValidElement(V)?O.cloneElement(V,Fd({width:A,height:F},H?{style:Fd({height:"100%",width:"100%",maxHeight:F,maxWidth:A},V.props.style)}:{})):V})},[r,m,c,h,f,u,S,o]);return Z.createElement("div",{id:g?"".concat(g):void 0,className:qe("recharts-responsive-container",y),style:Fd(Fd({},_),{},{width:o,height:c,minWidth:u,minHeight:f,maxHeight:h}),ref:b},C)}),n0=function(t){return null};n0.displayName="Cell";function mc(e){"@babel/helpers - typeof";return mc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mc(e)}function fy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function xm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fy(Object(r),!0).forEach(function(a){f7(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fy(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function f7(e,t,r){return t=h7(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h7(e){var t=m7(e,"string");return mc(t)=="symbol"?t:t+""}function m7(e,t){if(mc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(mc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zi={widthCache:{},cacheCount:0},x7=2e3,p7={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},hy="recharts_measurement_span";function g7(e){var t=xm({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var Bl=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Os.isSsr)return{width:0,height:0};var a=g7(r),s=JSON.stringify({text:t,copyStyle:a});if(zi.widthCache[s])return zi.widthCache[s];try{var i=document.getElementById(hy);i||(i=document.createElement("span"),i.setAttribute("id",hy),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var o=xm(xm({},p7),a);Object.assign(i.style,o),i.textContent="".concat(t);var l=i.getBoundingClientRect(),c={width:l.width,height:l.height};return zi.widthCache[s]=c,++zi.cacheCount>x7&&(zi.cacheCount=0,zi.widthCache={}),c}catch{return{width:0,height:0}}},v7=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function xc(e){"@babel/helpers - typeof";return xc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xc(e)}function Nu(e,t){return j7(e)||w7(e,t)||b7(e,t)||y7()}function y7(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function b7(e,t){if(e){if(typeof e=="string")return my(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return my(e,t)}}function my(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function w7(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function j7(e){if(Array.isArray(e))return e}function N7(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xy(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,S7(a.key),a)}}function _7(e,t,r){return t&&xy(e.prototype,t),r&&xy(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function S7(e){var t=k7(e,"string");return xc(t)=="symbol"?t:t+""}function k7(e,t){if(xc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(xc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var py=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,gy=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,E7=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,A7=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,wN={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},T7=Object.keys(wN),eo="NaN";function O7(e,t){return e*wN[t]}var Id=function(){function e(t,r){N7(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!E7.test(r)&&(this.num=NaN,this.unit=""),T7.includes(r)&&(this.num=O7(t,r),this.unit="px")}return _7(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var a,s=(a=A7.exec(r))!==null&&a!==void 0?a:[],i=Nu(s,3),o=i[1],l=i[2];return new e(parseFloat(o),l??"")}}])}();function jN(e){if(e.includes(eo))return eo;for(var t=e;t.includes("*")||t.includes("/");){var r,a=(r=py.exec(t))!==null&&r!==void 0?r:[],s=Nu(a,4),i=s[1],o=s[2],l=s[3],c=Id.parse(i??""),d=Id.parse(l??""),u=o==="*"?c.multiply(d):c.divide(d);if(u.isNaN())return eo;t=t.replace(py,u.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var f,h=(f=gy.exec(t))!==null&&f!==void 0?f:[],m=Nu(h,4),x=m[1],p=m[2],g=m[3],y=Id.parse(x??""),w=Id.parse(g??""),v=p==="+"?y.add(w):y.subtract(w);if(v.isNaN())return eo;t=t.replace(gy,v.toString())}return t}var vy=/\(([^()]*)\)/;function P7(e){for(var t=e;t.includes("(");){var r=vy.exec(t),a=Nu(r,2),s=a[1];t=t.replace(vy,jN(s))}return t}function C7(e){var t=e.replace(/\s+/g,"");return t=P7(t),t=jN(t),t}function F7(e){try{return C7(e)}catch{return eo}}function th(e){var t=F7(e.slice(5,-1));return t===eo?"":t}var I7=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],D7=["dx","dy","angle","className","breakAll"];function pm(){return pm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},pm.apply(this,arguments)}function yy(e,t){if(e==null)return{};var r=R7(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function R7(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function by(e,t){return B7(e)||L7(e,t)||$7(e,t)||M7()}function M7(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $7(e,t){if(e){if(typeof e=="string")return wy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wy(e,t)}}function wy(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function L7(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function B7(e){if(Array.isArray(e))return e}var NN=/[ \f\n\r\t\v\u2028\u2029]+/,_N=function(t){var r=t.children,a=t.breakAll,s=t.style;try{var i=[];We(r)||(a?i=r.toString().split(""):i=r.toString().split(NN));var o=i.map(function(c){return{word:c,width:Bl(c,s).width}}),l=a?0:Bl(" ",s).width;return{wordsWithComputedWidth:o,spaceWidth:l}}catch{return null}},U7=function(t,r,a,s,i){var o=t.maxLines,l=t.children,c=t.style,d=t.breakAll,u=be(o),f=l,h=function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return A.reduce(function(F,H){var V=H.word,B=H.width,L=F[F.length-1];if(L&&(s==null||i||L.width+B+a<Number(s)))L.words.push(V),L.width+=B+a;else{var ee={words:[V],width:B};F.push(ee)}return F},[])},m=h(r),x=function(A){return A.reduce(function(F,H){return F.width>H.width?F:H})};if(!u)return m;for(var p="…",g=function(A){var F=f.slice(0,A),H=_N({breakAll:d,style:c,children:F+p}).wordsWithComputedWidth,V=h(H),B=V.length>o||x(V).width>Number(s);return[B,V]},y=0,w=f.length-1,v=0,_;y<=w&&v<=f.length-1;){var b=Math.floor((y+w)/2),j=b-1,N=g(j),k=by(N,2),S=k[0],E=k[1],P=g(b),C=by(P,1),T=C[0];if(!S&&!T&&(y=b+1),S&&T&&(w=b-1),!S&&T){_=E;break}v++}return _||m},jy=function(t){var r=We(t)?[]:t.toString().split(NN);return[{words:r}]},W7=function(t){var r=t.width,a=t.scaleToFit,s=t.children,i=t.style,o=t.breakAll,l=t.maxLines;if((r||a)&&!Os.isSsr){var c,d,u=_N({breakAll:o,children:s,style:i});if(u){var f=u.wordsWithComputedWidth,h=u.spaceWidth;c=f,d=h}else return jy(s);return U7({breakAll:o,children:s,maxLines:l,style:i},c,d,r,a)}return jy(s)},Ny="#808080",yi=function(t){var r=t.x,a=r===void 0?0:r,s=t.y,i=s===void 0?0:s,o=t.lineHeight,l=o===void 0?"1em":o,c=t.capHeight,d=c===void 0?"0.71em":c,u=t.scaleToFit,f=u===void 0?!1:u,h=t.textAnchor,m=h===void 0?"start":h,x=t.verticalAnchor,p=x===void 0?"end":x,g=t.fill,y=g===void 0?Ny:g,w=yy(t,I7),v=O.useMemo(function(){return W7({breakAll:w.breakAll,children:w.children,maxLines:w.maxLines,scaleToFit:f,style:w.style,width:w.width})},[w.breakAll,w.children,w.maxLines,f,w.style,w.width]),_=w.dx,b=w.dy,j=w.angle,N=w.className,k=w.breakAll,S=yy(w,D7);if(!wr(a)||!wr(i))return null;var E=a+(be(_)?_:0),P=i+(be(b)?b:0),C;switch(p){case"start":C=th("calc(".concat(d,")"));break;case"middle":C=th("calc(".concat((v.length-1)/2," * -").concat(l," + (").concat(d," / 2))"));break;default:C=th("calc(".concat(v.length-1," * -").concat(l,")"));break}var T=[];if(f){var M=v[0].width,A=w.width;T.push("scale(".concat((be(A)?A/M:1)/M,")"))}return j&&T.push("rotate(".concat(j,", ").concat(E,", ").concat(P,")")),T.length&&(S.transform=T.join(" ")),Z.createElement("text",pm({},Ce(S,!0),{x:E,y:P,className:qe("recharts-text",N),textAnchor:m,fill:y.includes("url")?Ny:y}),v.map(function(F,H){var V=F.words.join(k?"":" ");return Z.createElement("tspan",{x:E,dy:H===0?C:l,key:"".concat(V,"-").concat(H)},V)}))};function ws(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function H7(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function mp(e){let t,r,a;e.length!==2?(t=ws,r=(l,c)=>ws(e(l),c),a=(l,c)=>e(l)-c):(t=e===ws||e===H7?e:z7,r=e,a=e);function s(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const f=d+u>>>1;r(l[f],c)<0?d=f+1:u=f}while(d<u)}return d}function i(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const f=d+u>>>1;r(l[f],c)<=0?d=f+1:u=f}while(d<u)}return d}function o(l,c,d=0,u=l.length){const f=s(l,c,d,u-1);return f>d&&a(l[f-1],c)>-a(l[f],c)?f-1:f}return{left:s,center:o,right:i}}function z7(){return 0}function SN(e){return e===null?NaN:+e}function*V7(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const G7=mp(ws),fd=G7.right;mp(SN).center;class _y extends Map{constructor(t,r=X7){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[a,s]of t)this.set(a,s)}get(t){return super.get(Sy(this,t))}has(t){return super.has(Sy(this,t))}set(t,r){return super.set(K7(this,t),r)}delete(t){return super.delete(q7(this,t))}}function Sy({_intern:e,_key:t},r){const a=t(r);return e.has(a)?e.get(a):r}function K7({_intern:e,_key:t},r){const a=t(r);return e.has(a)?e.get(a):(e.set(a,r),r)}function q7({_intern:e,_key:t},r){const a=t(r);return e.has(a)&&(r=e.get(a),e.delete(a)),r}function X7(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Y7(e=ws){if(e===ws)return kN;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const a=e(t,r);return a||a===0?a:(e(r,r)===0)-(e(t,t)===0)}}function kN(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const J7=Math.sqrt(50),Z7=Math.sqrt(10),Q7=Math.sqrt(2);function _u(e,t,r){const a=(t-e)/Math.max(0,r),s=Math.floor(Math.log10(a)),i=a/Math.pow(10,s),o=i>=J7?10:i>=Z7?5:i>=Q7?2:1;let l,c,d;return s<0?(d=Math.pow(10,-s)/o,l=Math.round(e*d),c=Math.round(t*d),l/d<e&&++l,c/d>t&&--c,d=-d):(d=Math.pow(10,s)*o,l=Math.round(e/d),c=Math.round(t/d),l*d<e&&++l,c*d>t&&--c),c<l&&.5<=r&&r<2?_u(e,t,r*2):[l,c,d]}function gm(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const a=t<e,[s,i,o]=a?_u(t,e,r):_u(e,t,r);if(!(i>=s))return[];const l=i-s+1,c=new Array(l);if(a)if(o<0)for(let d=0;d<l;++d)c[d]=(i-d)/-o;else for(let d=0;d<l;++d)c[d]=(i-d)*o;else if(o<0)for(let d=0;d<l;++d)c[d]=(s+d)/-o;else for(let d=0;d<l;++d)c[d]=(s+d)*o;return c}function vm(e,t,r){return t=+t,e=+e,r=+r,_u(e,t,r)[2]}function ym(e,t,r){t=+t,e=+e,r=+r;const a=t<e,s=a?vm(t,e,r):vm(e,t,r);return(a?-1:1)*(s<0?1/-s:s)}function ky(e,t){let r;for(const a of e)a!=null&&(r<a||r===void 0&&a>=a)&&(r=a);return r}function Ey(e,t){let r;for(const a of e)a!=null&&(r>a||r===void 0&&a>=a)&&(r=a);return r}function EN(e,t,r=0,a=1/0,s){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),a=Math.floor(Math.min(e.length-1,a)),!(r<=t&&t<=a))return e;for(s=s===void 0?kN:Y7(s);a>r;){if(a-r>600){const c=a-r+1,d=t-r+1,u=Math.log(c),f=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*f*(c-f)/c)*(d-c/2<0?-1:1),m=Math.max(r,Math.floor(t-d*f/c+h)),x=Math.min(a,Math.floor(t+(c-d)*f/c+h));EN(e,t,m,x,s)}const i=e[t];let o=r,l=a;for(vl(e,r,t),s(e[a],i)>0&&vl(e,r,a);o<l;){for(vl(e,o,l),++o,--l;s(e[o],i)<0;)++o;for(;s(e[l],i)>0;)--l}s(e[r],i)===0?vl(e,r,l):(++l,vl(e,l,a)),l<=t&&(r=l+1),t<=l&&(a=l-1)}return e}function vl(e,t,r){const a=e[t];e[t]=e[r],e[r]=a}function eB(e,t,r){if(e=Float64Array.from(V7(e)),!(!(a=e.length)||isNaN(t=+t))){if(t<=0||a<2)return Ey(e);if(t>=1)return ky(e);var a,s=(a-1)*t,i=Math.floor(s),o=ky(EN(e,i).subarray(0,i+1)),l=Ey(e.subarray(i+1));return o+(l-o)*(s-i)}}function tB(e,t,r=SN){if(!(!(a=e.length)||isNaN(t=+t))){if(t<=0||a<2)return+r(e[0],0,e);if(t>=1)return+r(e[a-1],a-1,e);var a,s=(a-1)*t,i=Math.floor(s),o=+r(e[i],i,e),l=+r(e[i+1],i+1,e);return o+(l-o)*(s-i)}}function rB(e,t,r){e=+e,t=+t,r=(s=arguments.length)<2?(t=e,e=0,1):s<3?1:+r;for(var a=-1,s=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(s);++a<s;)i[a]=e+a*r;return i}function Ya(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function ss(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const bm=Symbol("implicit");function xp(){var e=new _y,t=[],r=[],a=bm;function s(i){let o=e.get(i);if(o===void 0){if(a!==bm)return a;e.set(i,o=t.push(i)-1)}return r[o%r.length]}return s.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new _y;for(const o of i)e.has(o)||e.set(o,t.push(o)-1);return s},s.range=function(i){return arguments.length?(r=Array.from(i),s):r.slice()},s.unknown=function(i){return arguments.length?(a=i,s):a},s.copy=function(){return xp(t,r).unknown(a)},Ya.apply(s,arguments),s}function pc(){var e=xp().unknown(void 0),t=e.domain,r=e.range,a=0,s=1,i,o,l=!1,c=0,d=0,u=.5;delete e.unknown;function f(){var h=t().length,m=s<a,x=m?s:a,p=m?a:s;i=(p-x)/Math.max(1,h-c+d*2),l&&(i=Math.floor(i)),x+=(p-x-i*(h-c))*u,o=i*(1-c),l&&(x=Math.round(x),o=Math.round(o));var g=rB(h).map(function(y){return x+i*y});return r(m?g.reverse():g)}return e.domain=function(h){return arguments.length?(t(h),f()):t()},e.range=function(h){return arguments.length?([a,s]=h,a=+a,s=+s,f()):[a,s]},e.rangeRound=function(h){return[a,s]=h,a=+a,s=+s,l=!0,f()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(h){return arguments.length?(l=!!h,f()):l},e.padding=function(h){return arguments.length?(c=Math.min(1,d=+h),f()):c},e.paddingInner=function(h){return arguments.length?(c=Math.min(1,h),f()):c},e.paddingOuter=function(h){return arguments.length?(d=+h,f()):d},e.align=function(h){return arguments.length?(u=Math.max(0,Math.min(1,h)),f()):u},e.copy=function(){return pc(t(),[a,s]).round(l).paddingInner(c).paddingOuter(d).align(u)},Ya.apply(f(),arguments)}function AN(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return AN(t())},e}function Ul(){return AN(pc.apply(null,arguments).paddingInner(1))}function pp(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function TN(e,t){var r=Object.create(e.prototype);for(var a in t)r[a]=t[a];return r}function hd(){}var gc=.7,Su=1/gc,lo="\\s*([+-]?\\d+)\\s*",vc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Nn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",aB=/^#([0-9a-f]{3,8})$/,nB=new RegExp(`^rgb\\(${lo},${lo},${lo}\\)$`),sB=new RegExp(`^rgb\\(${Nn},${Nn},${Nn}\\)$`),iB=new RegExp(`^rgba\\(${lo},${lo},${lo},${vc}\\)$`),oB=new RegExp(`^rgba\\(${Nn},${Nn},${Nn},${vc}\\)$`),lB=new RegExp(`^hsl\\(${vc},${Nn},${Nn}\\)$`),cB=new RegExp(`^hsla\\(${vc},${Nn},${Nn},${vc}\\)$`),Ay={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};pp(hd,yc,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Ty,formatHex:Ty,formatHex8:dB,formatHsl:uB,formatRgb:Oy,toString:Oy});function Ty(){return this.rgb().formatHex()}function dB(){return this.rgb().formatHex8()}function uB(){return ON(this).formatHsl()}function Oy(){return this.rgb().formatRgb()}function yc(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=aB.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?Py(t):r===3?new ha(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Dd(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Dd(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=nB.exec(e))?new ha(t[1],t[2],t[3],1):(t=sB.exec(e))?new ha(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=iB.exec(e))?Dd(t[1],t[2],t[3],t[4]):(t=oB.exec(e))?Dd(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=lB.exec(e))?Iy(t[1],t[2]/100,t[3]/100,1):(t=cB.exec(e))?Iy(t[1],t[2]/100,t[3]/100,t[4]):Ay.hasOwnProperty(e)?Py(Ay[e]):e==="transparent"?new ha(NaN,NaN,NaN,0):null}function Py(e){return new ha(e>>16&255,e>>8&255,e&255,1)}function Dd(e,t,r,a){return a<=0&&(e=t=r=NaN),new ha(e,t,r,a)}function fB(e){return e instanceof hd||(e=yc(e)),e?(e=e.rgb(),new ha(e.r,e.g,e.b,e.opacity)):new ha}function wm(e,t,r,a){return arguments.length===1?fB(e):new ha(e,t,r,a??1)}function ha(e,t,r,a){this.r=+e,this.g=+t,this.b=+r,this.opacity=+a}pp(ha,wm,TN(hd,{brighter(e){return e=e==null?Su:Math.pow(Su,e),new ha(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?gc:Math.pow(gc,e),new ha(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ha(si(this.r),si(this.g),si(this.b),ku(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Cy,formatHex:Cy,formatHex8:hB,formatRgb:Fy,toString:Fy}));function Cy(){return`#${Zs(this.r)}${Zs(this.g)}${Zs(this.b)}`}function hB(){return`#${Zs(this.r)}${Zs(this.g)}${Zs(this.b)}${Zs((isNaN(this.opacity)?1:this.opacity)*255)}`}function Fy(){const e=ku(this.opacity);return`${e===1?"rgb(":"rgba("}${si(this.r)}, ${si(this.g)}, ${si(this.b)}${e===1?")":`, ${e})`}`}function ku(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function si(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Zs(e){return e=si(e),(e<16?"0":"")+e.toString(16)}function Iy(e,t,r,a){return a<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new an(e,t,r,a)}function ON(e){if(e instanceof an)return new an(e.h,e.s,e.l,e.opacity);if(e instanceof hd||(e=yc(e)),!e)return new an;if(e instanceof an)return e;e=e.rgb();var t=e.r/255,r=e.g/255,a=e.b/255,s=Math.min(t,r,a),i=Math.max(t,r,a),o=NaN,l=i-s,c=(i+s)/2;return l?(t===i?o=(r-a)/l+(r<a)*6:r===i?o=(a-t)/l+2:o=(t-r)/l+4,l/=c<.5?i+s:2-i-s,o*=60):l=c>0&&c<1?0:o,new an(o,l,c,e.opacity)}function mB(e,t,r,a){return arguments.length===1?ON(e):new an(e,t,r,a??1)}function an(e,t,r,a){this.h=+e,this.s=+t,this.l=+r,this.opacity=+a}pp(an,mB,TN(hd,{brighter(e){return e=e==null?Su:Math.pow(Su,e),new an(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?gc:Math.pow(gc,e),new an(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,a=r+(r<.5?r:1-r)*t,s=2*r-a;return new ha(rh(e>=240?e-240:e+120,s,a),rh(e,s,a),rh(e<120?e+240:e-120,s,a),this.opacity)},clamp(){return new an(Dy(this.h),Rd(this.s),Rd(this.l),ku(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=ku(this.opacity);return`${e===1?"hsl(":"hsla("}${Dy(this.h)}, ${Rd(this.s)*100}%, ${Rd(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Dy(e){return e=(e||0)%360,e<0?e+360:e}function Rd(e){return Math.max(0,Math.min(1,e||0))}function rh(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const gp=e=>()=>e;function xB(e,t){return function(r){return e+r*t}}function pB(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(a){return Math.pow(e+a*t,r)}}function gB(e){return(e=+e)==1?PN:function(t,r){return r-t?pB(t,r,e):gp(isNaN(t)?r:t)}}function PN(e,t){var r=t-e;return r?xB(e,r):gp(isNaN(e)?t:e)}const Ry=function e(t){var r=gB(t);function a(s,i){var o=r((s=wm(s)).r,(i=wm(i)).r),l=r(s.g,i.g),c=r(s.b,i.b),d=PN(s.opacity,i.opacity);return function(u){return s.r=o(u),s.g=l(u),s.b=c(u),s.opacity=d(u),s+""}}return a.gamma=e,a}(1);function vB(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,a=t.slice(),s;return function(i){for(s=0;s<r;++s)a[s]=e[s]*(1-i)+t[s]*i;return a}}function yB(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function bB(e,t){var r=t?t.length:0,a=e?Math.min(r,e.length):0,s=new Array(a),i=new Array(r),o;for(o=0;o<a;++o)s[o]=al(e[o],t[o]);for(;o<r;++o)i[o]=t[o];return function(l){for(o=0;o<a;++o)i[o]=s[o](l);return i}}function wB(e,t){var r=new Date;return e=+e,t=+t,function(a){return r.setTime(e*(1-a)+t*a),r}}function Eu(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function jB(e,t){var r={},a={},s;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(s in t)s in e?r[s]=al(e[s],t[s]):a[s]=t[s];return function(i){for(s in r)a[s]=r[s](i);return a}}var jm=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ah=new RegExp(jm.source,"g");function NB(e){return function(){return e}}function _B(e){return function(t){return e(t)+""}}function SB(e,t){var r=jm.lastIndex=ah.lastIndex=0,a,s,i,o=-1,l=[],c=[];for(e=e+"",t=t+"";(a=jm.exec(e))&&(s=ah.exec(t));)(i=s.index)>r&&(i=t.slice(r,i),l[o]?l[o]+=i:l[++o]=i),(a=a[0])===(s=s[0])?l[o]?l[o]+=s:l[++o]=s:(l[++o]=null,c.push({i:o,x:Eu(a,s)})),r=ah.lastIndex;return r<t.length&&(i=t.slice(r),l[o]?l[o]+=i:l[++o]=i),l.length<2?c[0]?_B(c[0].x):NB(t):(t=c.length,function(d){for(var u=0,f;u<t;++u)l[(f=c[u]).i]=f.x(d);return l.join("")})}function al(e,t){var r=typeof t,a;return t==null||r==="boolean"?gp(t):(r==="number"?Eu:r==="string"?(a=yc(t))?(t=a,Ry):SB:t instanceof yc?Ry:t instanceof Date?wB:yB(t)?vB:Array.isArray(t)?bB:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?jB:Eu)(e,t)}function vp(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function kB(e,t){t===void 0&&(t=e,e=al);for(var r=0,a=t.length-1,s=t[0],i=new Array(a<0?0:a);r<a;)i[r]=e(s,s=t[++r]);return function(o){var l=Math.max(0,Math.min(a-1,Math.floor(o*=a)));return i[l](o-l)}}function EB(e){return function(){return e}}function Au(e){return+e}var My=[0,1];function sa(e){return e}function Nm(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:EB(isNaN(t)?NaN:.5)}function AB(e,t){var r;return e>t&&(r=e,e=t,t=r),function(a){return Math.max(e,Math.min(t,a))}}function TB(e,t,r){var a=e[0],s=e[1],i=t[0],o=t[1];return s<a?(a=Nm(s,a),i=r(o,i)):(a=Nm(a,s),i=r(i,o)),function(l){return i(a(l))}}function OB(e,t,r){var a=Math.min(e.length,t.length)-1,s=new Array(a),i=new Array(a),o=-1;for(e[a]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<a;)s[o]=Nm(e[o],e[o+1]),i[o]=r(t[o],t[o+1]);return function(l){var c=fd(e,l,1,a)-1;return i[c](s[c](l))}}function md(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function s0(){var e=My,t=My,r=al,a,s,i,o=sa,l,c,d;function u(){var h=Math.min(e.length,t.length);return o!==sa&&(o=AB(e[0],e[h-1])),l=h>2?OB:TB,c=d=null,f}function f(h){return h==null||isNaN(h=+h)?i:(c||(c=l(e.map(a),t,r)))(a(o(h)))}return f.invert=function(h){return o(s((d||(d=l(t,e.map(a),Eu)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,Au),u()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),u()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),r=vp,u()},f.clamp=function(h){return arguments.length?(o=h?!0:sa,u()):o!==sa},f.interpolate=function(h){return arguments.length?(r=h,u()):r},f.unknown=function(h){return arguments.length?(i=h,f):i},function(h,m){return a=h,s=m,u()}}function yp(){return s0()(sa,sa)}function PB(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Tu(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,a=e.slice(0,r);return[a.length>1?a[0]+a.slice(2):a,+e.slice(r+1)]}function wo(e){return e=Tu(Math.abs(e)),e?e[1]:NaN}function CB(e,t){return function(r,a){for(var s=r.length,i=[],o=0,l=e[0],c=0;s>0&&l>0&&(c+l+1>a&&(l=Math.max(1,a-c)),i.push(r.substring(s-=l,s+l)),!((c+=l+1)>a));)l=e[o=(o+1)%e.length];return i.reverse().join(t)}}function FB(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var IB=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function bc(e){if(!(t=IB.exec(e)))throw new Error("invalid format: "+e);var t;return new bp({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}bc.prototype=bp.prototype;function bp(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}bp.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function DB(e){e:for(var t=e.length,r=1,a=-1,s;r<t;++r)switch(e[r]){case".":a=s=r;break;case"0":a===0&&(a=r),s=r;break;default:if(!+e[r])break e;a>0&&(a=0);break}return a>0?e.slice(0,a)+e.slice(s+1):e}var CN;function RB(e,t){var r=Tu(e,t);if(!r)return e+"";var a=r[0],s=r[1],i=s-(CN=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,o=a.length;return i===o?a:i>o?a+new Array(i-o+1).join("0"):i>0?a.slice(0,i)+"."+a.slice(i):"0."+new Array(1-i).join("0")+Tu(e,Math.max(0,t+i-1))[0]}function $y(e,t){var r=Tu(e,t);if(!r)return e+"";var a=r[0],s=r[1];return s<0?"0."+new Array(-s).join("0")+a:a.length>s+1?a.slice(0,s+1)+"."+a.slice(s+1):a+new Array(s-a.length+2).join("0")}const Ly={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:PB,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>$y(e*100,t),r:$y,s:RB,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function By(e){return e}var Uy=Array.prototype.map,Wy=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function MB(e){var t=e.grouping===void 0||e.thousands===void 0?By:CB(Uy.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",a=e.currency===void 0?"":e.currency[1]+"",s=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?By:FB(Uy.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"−":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function d(f){f=bc(f);var h=f.fill,m=f.align,x=f.sign,p=f.symbol,g=f.zero,y=f.width,w=f.comma,v=f.precision,_=f.trim,b=f.type;b==="n"?(w=!0,b="g"):Ly[b]||(v===void 0&&(v=12),_=!0,b="g"),(g||h==="0"&&m==="=")&&(g=!0,h="0",m="=");var j=p==="$"?r:p==="#"&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",N=p==="$"?a:/[%p]/.test(b)?o:"",k=Ly[b],S=/[defgprs%]/.test(b);v=v===void 0?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v));function E(P){var C=j,T=N,M,A,F;if(b==="c")T=k(P)+T,P="";else{P=+P;var H=P<0||1/P<0;if(P=isNaN(P)?c:k(Math.abs(P),v),_&&(P=DB(P)),H&&+P==0&&x!=="+"&&(H=!1),C=(H?x==="("?x:l:x==="-"||x==="("?"":x)+C,T=(b==="s"?Wy[8+CN/3]:"")+T+(H&&x==="("?")":""),S){for(M=-1,A=P.length;++M<A;)if(F=P.charCodeAt(M),48>F||F>57){T=(F===46?s+P.slice(M+1):P.slice(M))+T,P=P.slice(0,M);break}}}w&&!g&&(P=t(P,1/0));var V=C.length+P.length+T.length,B=V<y?new Array(y-V+1).join(h):"";switch(w&&g&&(P=t(B+P,B.length?y-T.length:1/0),B=""),m){case"<":P=C+P+T+B;break;case"=":P=C+B+P+T;break;case"^":P=B.slice(0,V=B.length>>1)+C+P+T+B.slice(V);break;default:P=B+C+P+T;break}return i(P)}return E.toString=function(){return f+""},E}function u(f,h){var m=d((f=bc(f),f.type="f",f)),x=Math.max(-8,Math.min(8,Math.floor(wo(h)/3)))*3,p=Math.pow(10,-x),g=Wy[8+x/3];return function(y){return m(p*y)+g}}return{format:d,formatPrefix:u}}var Md,wp,FN;$B({thousands:",",grouping:[3],currency:["$",""]});function $B(e){return Md=MB(e),wp=Md.format,FN=Md.formatPrefix,Md}function LB(e){return Math.max(0,-wo(Math.abs(e)))}function BB(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(wo(t)/3)))*3-wo(Math.abs(e)))}function UB(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,wo(t)-wo(e))+1}function IN(e,t,r,a){var s=ym(e,t,r),i;switch(a=bc(a??",f"),a.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return a.precision==null&&!isNaN(i=BB(s,o))&&(a.precision=i),FN(a,o)}case"":case"e":case"g":case"p":case"r":{a.precision==null&&!isNaN(i=UB(s,Math.max(Math.abs(e),Math.abs(t))))&&(a.precision=i-(a.type==="e"));break}case"f":case"%":{a.precision==null&&!isNaN(i=LB(s))&&(a.precision=i-(a.type==="%")*2);break}}return wp(a)}function Ps(e){var t=e.domain;return e.ticks=function(r){var a=t();return gm(a[0],a[a.length-1],r??10)},e.tickFormat=function(r,a){var s=t();return IN(s[0],s[s.length-1],r??10,a)},e.nice=function(r){r==null&&(r=10);var a=t(),s=0,i=a.length-1,o=a[s],l=a[i],c,d,u=10;for(l<o&&(d=o,o=l,l=d,d=s,s=i,i=d);u-- >0;){if(d=vm(o,l,r),d===c)return a[s]=o,a[i]=l,t(a);if(d>0)o=Math.floor(o/d)*d,l=Math.ceil(l/d)*d;else if(d<0)o=Math.ceil(o*d)/d,l=Math.floor(l*d)/d;else break;c=d}return e},e}function Ou(){var e=yp();return e.copy=function(){return md(e,Ou())},Ya.apply(e,arguments),Ps(e)}function DN(e){var t;function r(a){return a==null||isNaN(a=+a)?t:a}return r.invert=r,r.domain=r.range=function(a){return arguments.length?(e=Array.from(a,Au),r):e.slice()},r.unknown=function(a){return arguments.length?(t=a,r):t},r.copy=function(){return DN(e).unknown(t)},e=arguments.length?Array.from(e,Au):[0,1],Ps(r)}function RN(e,t){e=e.slice();var r=0,a=e.length-1,s=e[r],i=e[a],o;return i<s&&(o=r,r=a,a=o,o=s,s=i,i=o),e[r]=t.floor(s),e[a]=t.ceil(i),e}function Hy(e){return Math.log(e)}function zy(e){return Math.exp(e)}function WB(e){return-Math.log(-e)}function HB(e){return-Math.exp(-e)}function zB(e){return isFinite(e)?+("1e"+e):e<0?0:e}function VB(e){return e===10?zB:e===Math.E?Math.exp:t=>Math.pow(e,t)}function GB(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Vy(e){return(t,r)=>-e(-t,r)}function jp(e){const t=e(Hy,zy),r=t.domain;let a=10,s,i;function o(){return s=GB(a),i=VB(a),r()[0]<0?(s=Vy(s),i=Vy(i),e(WB,HB)):e(Hy,zy),t}return t.base=function(l){return arguments.length?(a=+l,o()):a},t.domain=function(l){return arguments.length?(r(l),o()):r()},t.ticks=l=>{const c=r();let d=c[0],u=c[c.length-1];const f=u<d;f&&([d,u]=[u,d]);let h=s(d),m=s(u),x,p;const g=l==null?10:+l;let y=[];if(!(a%1)&&m-h<g){if(h=Math.floor(h),m=Math.ceil(m),d>0){for(;h<=m;++h)for(x=1;x<a;++x)if(p=h<0?x/i(-h):x*i(h),!(p<d)){if(p>u)break;y.push(p)}}else for(;h<=m;++h)for(x=a-1;x>=1;--x)if(p=h>0?x/i(-h):x*i(h),!(p<d)){if(p>u)break;y.push(p)}y.length*2<g&&(y=gm(d,u,g))}else y=gm(h,m,Math.min(m-h,g)).map(i);return f?y.reverse():y},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=a===10?"s":","),typeof c!="function"&&(!(a%1)&&(c=bc(c)).precision==null&&(c.trim=!0),c=wp(c)),l===1/0)return c;const d=Math.max(1,a*l/t.ticks().length);return u=>{let f=u/i(Math.round(s(u)));return f*a<a-.5&&(f*=a),f<=d?c(u):""}},t.nice=()=>r(RN(r(),{floor:l=>i(Math.floor(s(l))),ceil:l=>i(Math.ceil(s(l)))})),t}function MN(){const e=jp(s0()).domain([1,10]);return e.copy=()=>md(e,MN()).base(e.base()),Ya.apply(e,arguments),e}function Gy(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Ky(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Np(e){var t=1,r=e(Gy(t),Ky(t));return r.constant=function(a){return arguments.length?e(Gy(t=+a),Ky(t)):t},Ps(r)}function $N(){var e=Np(s0());return e.copy=function(){return md(e,$N()).constant(e.constant())},Ya.apply(e,arguments)}function qy(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function KB(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function qB(e){return e<0?-e*e:e*e}function _p(e){var t=e(sa,sa),r=1;function a(){return r===1?e(sa,sa):r===.5?e(KB,qB):e(qy(r),qy(1/r))}return t.exponent=function(s){return arguments.length?(r=+s,a()):r},Ps(t)}function Sp(){var e=_p(s0());return e.copy=function(){return md(e,Sp()).exponent(e.exponent())},Ya.apply(e,arguments),e}function XB(){return Sp.apply(null,arguments).exponent(.5)}function Xy(e){return Math.sign(e)*e*e}function YB(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function LN(){var e=yp(),t=[0,1],r=!1,a;function s(i){var o=YB(e(i));return isNaN(o)?a:r?Math.round(o):o}return s.invert=function(i){return e.invert(Xy(i))},s.domain=function(i){return arguments.length?(e.domain(i),s):e.domain()},s.range=function(i){return arguments.length?(e.range((t=Array.from(i,Au)).map(Xy)),s):t.slice()},s.rangeRound=function(i){return s.range(i).round(!0)},s.round=function(i){return arguments.length?(r=!!i,s):r},s.clamp=function(i){return arguments.length?(e.clamp(i),s):e.clamp()},s.unknown=function(i){return arguments.length?(a=i,s):a},s.copy=function(){return LN(e.domain(),t).round(r).clamp(e.clamp()).unknown(a)},Ya.apply(s,arguments),Ps(s)}function BN(){var e=[],t=[],r=[],a;function s(){var o=0,l=Math.max(1,t.length);for(r=new Array(l-1);++o<l;)r[o-1]=tB(e,o/l);return i}function i(o){return o==null||isNaN(o=+o)?a:t[fd(r,o)]}return i.invertExtent=function(o){var l=t.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},i.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let l of o)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(ws),s()},i.range=function(o){return arguments.length?(t=Array.from(o),s()):t.slice()},i.unknown=function(o){return arguments.length?(a=o,i):a},i.quantiles=function(){return r.slice()},i.copy=function(){return BN().domain(e).range(t).unknown(a)},Ya.apply(i,arguments)}function UN(){var e=0,t=1,r=1,a=[.5],s=[0,1],i;function o(c){return c!=null&&c<=c?s[fd(a,c,0,r)]:i}function l(){var c=-1;for(a=new Array(r);++c<r;)a[c]=((c+1)*t-(c-r)*e)/(r+1);return o}return o.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},o.range=function(c){return arguments.length?(r=(s=Array.from(c)).length-1,l()):s.slice()},o.invertExtent=function(c){var d=s.indexOf(c);return d<0?[NaN,NaN]:d<1?[e,a[0]]:d>=r?[a[r-1],t]:[a[d-1],a[d]]},o.unknown=function(c){return arguments.length&&(i=c),o},o.thresholds=function(){return a.slice()},o.copy=function(){return UN().domain([e,t]).range(s).unknown(i)},Ya.apply(Ps(o),arguments)}function WN(){var e=[.5],t=[0,1],r,a=1;function s(i){return i!=null&&i<=i?t[fd(e,i,0,a)]:r}return s.domain=function(i){return arguments.length?(e=Array.from(i),a=Math.min(e.length,t.length-1),s):e.slice()},s.range=function(i){return arguments.length?(t=Array.from(i),a=Math.min(e.length,t.length-1),s):t.slice()},s.invertExtent=function(i){var o=t.indexOf(i);return[e[o-1],e[o]]},s.unknown=function(i){return arguments.length?(r=i,s):r},s.copy=function(){return WN().domain(e).range(t).unknown(r)},Ya.apply(s,arguments)}const nh=new Date,sh=new Date;function _r(e,t,r,a){function s(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return s.floor=i=>(e(i=new Date(+i)),i),s.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),s.round=i=>{const o=s(i),l=s.ceil(i);return i-o<l-i?o:l},s.offset=(i,o)=>(t(i=new Date(+i),o==null?1:Math.floor(o)),i),s.range=(i,o,l)=>{const c=[];if(i=s.ceil(i),l=l==null?1:Math.floor(l),!(i<o)||!(l>0))return c;let d;do c.push(d=new Date(+i)),t(i,l),e(i);while(d<i&&i<o);return c},s.filter=i=>_r(o=>{if(o>=o)for(;e(o),!i(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;t(o,-1),!i(o););else for(;--l>=0;)for(;t(o,1),!i(o););}),r&&(s.count=(i,o)=>(nh.setTime(+i),sh.setTime(+o),e(nh),e(sh),Math.floor(r(nh,sh))),s.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?s.filter(a?o=>a(o)%i===0:o=>s.count(0,o)%i===0):s)),s}const Pu=_r(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Pu.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?_r(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Pu);Pu.range;const $n=1e3,Ha=$n*60,Ln=Ha*60,Qn=Ln*24,kp=Qn*7,Yy=Qn*30,ih=Qn*365,Qs=_r(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*$n)},(e,t)=>(t-e)/$n,e=>e.getUTCSeconds());Qs.range;const Ep=_r(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*$n)},(e,t)=>{e.setTime(+e+t*Ha)},(e,t)=>(t-e)/Ha,e=>e.getMinutes());Ep.range;const Ap=_r(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ha)},(e,t)=>(t-e)/Ha,e=>e.getUTCMinutes());Ap.range;const Tp=_r(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*$n-e.getMinutes()*Ha)},(e,t)=>{e.setTime(+e+t*Ln)},(e,t)=>(t-e)/Ln,e=>e.getHours());Tp.range;const Op=_r(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Ln)},(e,t)=>(t-e)/Ln,e=>e.getUTCHours());Op.range;const xd=_r(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ha)/Qn,e=>e.getDate()-1);xd.range;const i0=_r(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Qn,e=>e.getUTCDate()-1);i0.range;const HN=_r(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Qn,e=>Math.floor(e/Qn));HN.range;function Di(e){return _r(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Ha)/kp)}const o0=Di(0),Cu=Di(1),JB=Di(2),ZB=Di(3),jo=Di(4),QB=Di(5),e9=Di(6);o0.range;Cu.range;JB.range;ZB.range;jo.range;QB.range;e9.range;function Ri(e){return _r(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/kp)}const l0=Ri(0),Fu=Ri(1),t9=Ri(2),r9=Ri(3),No=Ri(4),a9=Ri(5),n9=Ri(6);l0.range;Fu.range;t9.range;r9.range;No.range;a9.range;n9.range;const Pp=_r(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Pp.range;const Cp=_r(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Cp.range;const es=_r(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());es.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:_r(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});es.range;const ts=_r(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());ts.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:_r(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});ts.range;function zN(e,t,r,a,s,i){const o=[[Qs,1,$n],[Qs,5,5*$n],[Qs,15,15*$n],[Qs,30,30*$n],[i,1,Ha],[i,5,5*Ha],[i,15,15*Ha],[i,30,30*Ha],[s,1,Ln],[s,3,3*Ln],[s,6,6*Ln],[s,12,12*Ln],[a,1,Qn],[a,2,2*Qn],[r,1,kp],[t,1,Yy],[t,3,3*Yy],[e,1,ih]];function l(d,u,f){const h=u<d;h&&([d,u]=[u,d]);const m=f&&typeof f.range=="function"?f:c(d,u,f),x=m?m.range(d,+u+1):[];return h?x.reverse():x}function c(d,u,f){const h=Math.abs(u-d)/f,m=mp(([,,g])=>g).right(o,h);if(m===o.length)return e.every(ym(d/ih,u/ih,f));if(m===0)return Pu.every(Math.max(ym(d,u,f),1));const[x,p]=o[h/o[m-1][2]<o[m][2]/h?m-1:m];return x.every(p)}return[l,c]}const[s9,i9]=zN(ts,Cp,l0,HN,Op,Ap),[o9,l9]=zN(es,Pp,o0,xd,Tp,Ep);function oh(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function lh(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function yl(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function c9(e){var t=e.dateTime,r=e.date,a=e.time,s=e.periods,i=e.days,o=e.shortDays,l=e.months,c=e.shortMonths,d=bl(s),u=wl(s),f=bl(i),h=wl(i),m=bl(o),x=wl(o),p=bl(l),g=wl(l),y=bl(c),w=wl(c),v={a:H,A:V,b:B,B:L,c:null,d:rb,e:rb,f:C9,g:W9,G:z9,H:T9,I:O9,j:P9,L:VN,m:F9,M:I9,p:ee,q:I,Q:sb,s:ib,S:D9,u:R9,U:M9,V:$9,w:L9,W:B9,x:null,X:null,y:U9,Y:H9,Z:V9,"%":nb},_={a:K,A:z,b:W,B:re,c:null,d:ab,e:ab,f:X9,g:sU,G:oU,H:G9,I:K9,j:q9,L:KN,m:Y9,M:J9,p:xe,q:me,Q:sb,s:ib,S:Z9,u:Q9,U:eU,V:tU,w:rU,W:aU,x:null,X:null,y:nU,Y:iU,Z:lU,"%":nb},b={a:E,A:P,b:C,B:T,c:M,d:eb,e:eb,f:S9,g:Qy,G:Zy,H:tb,I:tb,j:w9,L:_9,m:b9,M:j9,p:S,q:y9,Q:E9,s:A9,S:N9,u:m9,U:x9,V:p9,w:h9,W:g9,x:A,X:F,y:Qy,Y:Zy,Z:v9,"%":k9};v.x=j(r,v),v.X=j(a,v),v.c=j(t,v),_.x=j(r,_),_.X=j(a,_),_.c=j(t,_);function j(Q,q){return function(se){var D=[],ve=-1,we=0,Ae=Q.length,ce,he,oe;for(se instanceof Date||(se=new Date(+se));++ve<Ae;)Q.charCodeAt(ve)===37&&(D.push(Q.slice(we,ve)),(he=Jy[ce=Q.charAt(++ve)])!=null?ce=Q.charAt(++ve):he=ce==="e"?" ":"0",(oe=q[ce])&&(ce=oe(se,he)),D.push(ce),we=ve+1);return D.push(Q.slice(we,ve)),D.join("")}}function N(Q,q){return function(se){var D=yl(1900,void 0,1),ve=k(D,Q,se+="",0),we,Ae;if(ve!=se.length)return null;if("Q"in D)return new Date(D.Q);if("s"in D)return new Date(D.s*1e3+("L"in D?D.L:0));if(q&&!("Z"in D)&&(D.Z=0),"p"in D&&(D.H=D.H%12+D.p*12),D.m===void 0&&(D.m="q"in D?D.q:0),"V"in D){if(D.V<1||D.V>53)return null;"w"in D||(D.w=1),"Z"in D?(we=lh(yl(D.y,0,1)),Ae=we.getUTCDay(),we=Ae>4||Ae===0?Fu.ceil(we):Fu(we),we=i0.offset(we,(D.V-1)*7),D.y=we.getUTCFullYear(),D.m=we.getUTCMonth(),D.d=we.getUTCDate()+(D.w+6)%7):(we=oh(yl(D.y,0,1)),Ae=we.getDay(),we=Ae>4||Ae===0?Cu.ceil(we):Cu(we),we=xd.offset(we,(D.V-1)*7),D.y=we.getFullYear(),D.m=we.getMonth(),D.d=we.getDate()+(D.w+6)%7)}else("W"in D||"U"in D)&&("w"in D||(D.w="u"in D?D.u%7:"W"in D?1:0),Ae="Z"in D?lh(yl(D.y,0,1)).getUTCDay():oh(yl(D.y,0,1)).getDay(),D.m=0,D.d="W"in D?(D.w+6)%7+D.W*7-(Ae+5)%7:D.w+D.U*7-(Ae+6)%7);return"Z"in D?(D.H+=D.Z/100|0,D.M+=D.Z%100,lh(D)):oh(D)}}function k(Q,q,se,D){for(var ve=0,we=q.length,Ae=se.length,ce,he;ve<we;){if(D>=Ae)return-1;if(ce=q.charCodeAt(ve++),ce===37){if(ce=q.charAt(ve++),he=b[ce in Jy?q.charAt(ve++):ce],!he||(D=he(Q,se,D))<0)return-1}else if(ce!=se.charCodeAt(D++))return-1}return D}function S(Q,q,se){var D=d.exec(q.slice(se));return D?(Q.p=u.get(D[0].toLowerCase()),se+D[0].length):-1}function E(Q,q,se){var D=m.exec(q.slice(se));return D?(Q.w=x.get(D[0].toLowerCase()),se+D[0].length):-1}function P(Q,q,se){var D=f.exec(q.slice(se));return D?(Q.w=h.get(D[0].toLowerCase()),se+D[0].length):-1}function C(Q,q,se){var D=y.exec(q.slice(se));return D?(Q.m=w.get(D[0].toLowerCase()),se+D[0].length):-1}function T(Q,q,se){var D=p.exec(q.slice(se));return D?(Q.m=g.get(D[0].toLowerCase()),se+D[0].length):-1}function M(Q,q,se){return k(Q,t,q,se)}function A(Q,q,se){return k(Q,r,q,se)}function F(Q,q,se){return k(Q,a,q,se)}function H(Q){return o[Q.getDay()]}function V(Q){return i[Q.getDay()]}function B(Q){return c[Q.getMonth()]}function L(Q){return l[Q.getMonth()]}function ee(Q){return s[+(Q.getHours()>=12)]}function I(Q){return 1+~~(Q.getMonth()/3)}function K(Q){return o[Q.getUTCDay()]}function z(Q){return i[Q.getUTCDay()]}function W(Q){return c[Q.getUTCMonth()]}function re(Q){return l[Q.getUTCMonth()]}function xe(Q){return s[+(Q.getUTCHours()>=12)]}function me(Q){return 1+~~(Q.getUTCMonth()/3)}return{format:function(Q){var q=j(Q+="",v);return q.toString=function(){return Q},q},parse:function(Q){var q=N(Q+="",!1);return q.toString=function(){return Q},q},utcFormat:function(Q){var q=j(Q+="",_);return q.toString=function(){return Q},q},utcParse:function(Q){var q=N(Q+="",!0);return q.toString=function(){return Q},q}}}var Jy={"-":"",_:" ",0:"0"},Cr=/^\s*\d+/,d9=/^%/,u9=/[\\^$*+?|[\]().{}]/g;function xt(e,t,r){var a=e<0?"-":"",s=(a?-e:e)+"",i=s.length;return a+(i<r?new Array(r-i+1).join(t)+s:s)}function f9(e){return e.replace(u9,"\\$&")}function bl(e){return new RegExp("^(?:"+e.map(f9).join("|")+")","i")}function wl(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function h9(e,t,r){var a=Cr.exec(t.slice(r,r+1));return a?(e.w=+a[0],r+a[0].length):-1}function m9(e,t,r){var a=Cr.exec(t.slice(r,r+1));return a?(e.u=+a[0],r+a[0].length):-1}function x9(e,t,r){var a=Cr.exec(t.slice(r,r+2));return a?(e.U=+a[0],r+a[0].length):-1}function p9(e,t,r){var a=Cr.exec(t.slice(r,r+2));return a?(e.V=+a[0],r+a[0].length):-1}function g9(e,t,r){var a=Cr.exec(t.slice(r,r+2));return a?(e.W=+a[0],r+a[0].length):-1}function Zy(e,t,r){var a=Cr.exec(t.slice(r,r+4));return a?(e.y=+a[0],r+a[0].length):-1}function Qy(e,t,r){var a=Cr.exec(t.slice(r,r+2));return a?(e.y=+a[0]+(+a[0]>68?1900:2e3),r+a[0].length):-1}function v9(e,t,r){var a=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return a?(e.Z=a[1]?0:-(a[2]+(a[3]||"00")),r+a[0].length):-1}function y9(e,t,r){var a=Cr.exec(t.slice(r,r+1));return a?(e.q=a[0]*3-3,r+a[0].length):-1}function b9(e,t,r){var a=Cr.exec(t.slice(r,r+2));return a?(e.m=a[0]-1,r+a[0].length):-1}function eb(e,t,r){var a=Cr.exec(t.slice(r,r+2));return a?(e.d=+a[0],r+a[0].length):-1}function w9(e,t,r){var a=Cr.exec(t.slice(r,r+3));return a?(e.m=0,e.d=+a[0],r+a[0].length):-1}function tb(e,t,r){var a=Cr.exec(t.slice(r,r+2));return a?(e.H=+a[0],r+a[0].length):-1}function j9(e,t,r){var a=Cr.exec(t.slice(r,r+2));return a?(e.M=+a[0],r+a[0].length):-1}function N9(e,t,r){var a=Cr.exec(t.slice(r,r+2));return a?(e.S=+a[0],r+a[0].length):-1}function _9(e,t,r){var a=Cr.exec(t.slice(r,r+3));return a?(e.L=+a[0],r+a[0].length):-1}function S9(e,t,r){var a=Cr.exec(t.slice(r,r+6));return a?(e.L=Math.floor(a[0]/1e3),r+a[0].length):-1}function k9(e,t,r){var a=d9.exec(t.slice(r,r+1));return a?r+a[0].length:-1}function E9(e,t,r){var a=Cr.exec(t.slice(r));return a?(e.Q=+a[0],r+a[0].length):-1}function A9(e,t,r){var a=Cr.exec(t.slice(r));return a?(e.s=+a[0],r+a[0].length):-1}function rb(e,t){return xt(e.getDate(),t,2)}function T9(e,t){return xt(e.getHours(),t,2)}function O9(e,t){return xt(e.getHours()%12||12,t,2)}function P9(e,t){return xt(1+xd.count(es(e),e),t,3)}function VN(e,t){return xt(e.getMilliseconds(),t,3)}function C9(e,t){return VN(e,t)+"000"}function F9(e,t){return xt(e.getMonth()+1,t,2)}function I9(e,t){return xt(e.getMinutes(),t,2)}function D9(e,t){return xt(e.getSeconds(),t,2)}function R9(e){var t=e.getDay();return t===0?7:t}function M9(e,t){return xt(o0.count(es(e)-1,e),t,2)}function GN(e){var t=e.getDay();return t>=4||t===0?jo(e):jo.ceil(e)}function $9(e,t){return e=GN(e),xt(jo.count(es(e),e)+(es(e).getDay()===4),t,2)}function L9(e){return e.getDay()}function B9(e,t){return xt(Cu.count(es(e)-1,e),t,2)}function U9(e,t){return xt(e.getFullYear()%100,t,2)}function W9(e,t){return e=GN(e),xt(e.getFullYear()%100,t,2)}function H9(e,t){return xt(e.getFullYear()%1e4,t,4)}function z9(e,t){var r=e.getDay();return e=r>=4||r===0?jo(e):jo.ceil(e),xt(e.getFullYear()%1e4,t,4)}function V9(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+xt(t/60|0,"0",2)+xt(t%60,"0",2)}function ab(e,t){return xt(e.getUTCDate(),t,2)}function G9(e,t){return xt(e.getUTCHours(),t,2)}function K9(e,t){return xt(e.getUTCHours()%12||12,t,2)}function q9(e,t){return xt(1+i0.count(ts(e),e),t,3)}function KN(e,t){return xt(e.getUTCMilliseconds(),t,3)}function X9(e,t){return KN(e,t)+"000"}function Y9(e,t){return xt(e.getUTCMonth()+1,t,2)}function J9(e,t){return xt(e.getUTCMinutes(),t,2)}function Z9(e,t){return xt(e.getUTCSeconds(),t,2)}function Q9(e){var t=e.getUTCDay();return t===0?7:t}function eU(e,t){return xt(l0.count(ts(e)-1,e),t,2)}function qN(e){var t=e.getUTCDay();return t>=4||t===0?No(e):No.ceil(e)}function tU(e,t){return e=qN(e),xt(No.count(ts(e),e)+(ts(e).getUTCDay()===4),t,2)}function rU(e){return e.getUTCDay()}function aU(e,t){return xt(Fu.count(ts(e)-1,e),t,2)}function nU(e,t){return xt(e.getUTCFullYear()%100,t,2)}function sU(e,t){return e=qN(e),xt(e.getUTCFullYear()%100,t,2)}function iU(e,t){return xt(e.getUTCFullYear()%1e4,t,4)}function oU(e,t){var r=e.getUTCDay();return e=r>=4||r===0?No(e):No.ceil(e),xt(e.getUTCFullYear()%1e4,t,4)}function lU(){return"+0000"}function nb(){return"%"}function sb(e){return+e}function ib(e){return Math.floor(+e/1e3)}var Vi,XN,YN;cU({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function cU(e){return Vi=c9(e),XN=Vi.format,Vi.parse,YN=Vi.utcFormat,Vi.utcParse,Vi}function dU(e){return new Date(e)}function uU(e){return e instanceof Date?+e:+new Date(+e)}function Fp(e,t,r,a,s,i,o,l,c,d){var u=yp(),f=u.invert,h=u.domain,m=d(".%L"),x=d(":%S"),p=d("%I:%M"),g=d("%I %p"),y=d("%a %d"),w=d("%b %d"),v=d("%B"),_=d("%Y");function b(j){return(c(j)<j?m:l(j)<j?x:o(j)<j?p:i(j)<j?g:a(j)<j?s(j)<j?y:w:r(j)<j?v:_)(j)}return u.invert=function(j){return new Date(f(j))},u.domain=function(j){return arguments.length?h(Array.from(j,uU)):h().map(dU)},u.ticks=function(j){var N=h();return e(N[0],N[N.length-1],j??10)},u.tickFormat=function(j,N){return N==null?b:d(N)},u.nice=function(j){var N=h();return(!j||typeof j.range!="function")&&(j=t(N[0],N[N.length-1],j??10)),j?h(RN(N,j)):u},u.copy=function(){return md(u,Fp(e,t,r,a,s,i,o,l,c,d))},u}function fU(){return Ya.apply(Fp(o9,l9,es,Pp,o0,xd,Tp,Ep,Qs,XN).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function hU(){return Ya.apply(Fp(s9,i9,ts,Cp,l0,i0,Op,Ap,Qs,YN).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function c0(){var e=0,t=1,r,a,s,i,o=sa,l=!1,c;function d(f){return f==null||isNaN(f=+f)?c:o(s===0?.5:(f=(i(f)-r)*s,l?Math.max(0,Math.min(1,f)):f))}d.domain=function(f){return arguments.length?([e,t]=f,r=i(e=+e),a=i(t=+t),s=r===a?0:1/(a-r),d):[e,t]},d.clamp=function(f){return arguments.length?(l=!!f,d):l},d.interpolator=function(f){return arguments.length?(o=f,d):o};function u(f){return function(h){var m,x;return arguments.length?([m,x]=h,o=f(m,x),d):[o(0),o(1)]}}return d.range=u(al),d.rangeRound=u(vp),d.unknown=function(f){return arguments.length?(c=f,d):c},function(f){return i=f,r=f(e),a=f(t),s=r===a?0:1/(a-r),d}}function Cs(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function JN(){var e=Ps(c0()(sa));return e.copy=function(){return Cs(e,JN())},ss.apply(e,arguments)}function ZN(){var e=jp(c0()).domain([1,10]);return e.copy=function(){return Cs(e,ZN()).base(e.base())},ss.apply(e,arguments)}function QN(){var e=Np(c0());return e.copy=function(){return Cs(e,QN()).constant(e.constant())},ss.apply(e,arguments)}function Ip(){var e=_p(c0());return e.copy=function(){return Cs(e,Ip()).exponent(e.exponent())},ss.apply(e,arguments)}function mU(){return Ip.apply(null,arguments).exponent(.5)}function e_(){var e=[],t=sa;function r(a){if(a!=null&&!isNaN(a=+a))return t((fd(e,a,1)-1)/(e.length-1))}return r.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let s of a)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(ws),r},r.interpolator=function(a){return arguments.length?(t=a,r):t},r.range=function(){return e.map((a,s)=>t(s/(e.length-1)))},r.quantiles=function(a){return Array.from({length:a+1},(s,i)=>eB(e,i/a))},r.copy=function(){return e_(t).domain(e)},ss.apply(r,arguments)}function d0(){var e=0,t=.5,r=1,a=1,s,i,o,l,c,d=sa,u,f=!1,h;function m(p){return isNaN(p=+p)?h:(p=.5+((p=+u(p))-i)*(a*p<a*i?l:c),d(f?Math.max(0,Math.min(1,p)):p))}m.domain=function(p){return arguments.length?([e,t,r]=p,s=u(e=+e),i=u(t=+t),o=u(r=+r),l=s===i?0:.5/(i-s),c=i===o?0:.5/(o-i),a=i<s?-1:1,m):[e,t,r]},m.clamp=function(p){return arguments.length?(f=!!p,m):f},m.interpolator=function(p){return arguments.length?(d=p,m):d};function x(p){return function(g){var y,w,v;return arguments.length?([y,w,v]=g,d=kB(p,[y,w,v]),m):[d(0),d(.5),d(1)]}}return m.range=x(al),m.rangeRound=x(vp),m.unknown=function(p){return arguments.length?(h=p,m):h},function(p){return u=p,s=p(e),i=p(t),o=p(r),l=s===i?0:.5/(i-s),c=i===o?0:.5/(o-i),a=i<s?-1:1,m}}function t_(){var e=Ps(d0()(sa));return e.copy=function(){return Cs(e,t_())},ss.apply(e,arguments)}function r_(){var e=jp(d0()).domain([.1,1,10]);return e.copy=function(){return Cs(e,r_()).base(e.base())},ss.apply(e,arguments)}function a_(){var e=Np(d0());return e.copy=function(){return Cs(e,a_()).constant(e.constant())},ss.apply(e,arguments)}function Dp(){var e=_p(d0());return e.copy=function(){return Cs(e,Dp()).exponent(e.exponent())},ss.apply(e,arguments)}function xU(){return Dp.apply(null,arguments).exponent(.5)}const ob=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:pc,scaleDiverging:t_,scaleDivergingLog:r_,scaleDivergingPow:Dp,scaleDivergingSqrt:xU,scaleDivergingSymlog:a_,scaleIdentity:DN,scaleImplicit:bm,scaleLinear:Ou,scaleLog:MN,scaleOrdinal:xp,scalePoint:Ul,scalePow:Sp,scaleQuantile:BN,scaleQuantize:UN,scaleRadial:LN,scaleSequential:JN,scaleSequentialLog:ZN,scaleSequentialPow:Ip,scaleSequentialQuantile:e_,scaleSequentialSqrt:mU,scaleSequentialSymlog:QN,scaleSqrt:XB,scaleSymlog:$N,scaleThreshold:WN,scaleTime:fU,scaleUtc:hU,tickFormat:IN},Symbol.toStringTag,{value:"Module"}));var pU=qo;function gU(e,t,r){for(var a=-1,s=e.length;++a<s;){var i=e[a],o=t(i);if(o!=null&&(l===void 0?o===o&&!pU(o):r(o,l)))var l=o,c=i}return c}var u0=gU;function vU(e,t){return e>t}var n_=vU,yU=u0,bU=n_,wU=rl;function jU(e){return e&&e.length?yU(e,wU,bU):void 0}var NU=jU;const xs=kt(NU);function _U(e,t){return e<t}var s_=_U,SU=u0,kU=s_,EU=rl;function AU(e){return e&&e.length?SU(e,EU,kU):void 0}var TU=AU;const f0=kt(TU);var OU=Xx,PU=On,CU=hN,FU=ga;function IU(e,t){var r=FU(e)?OU:CU;return r(e,PU(t))}var DU=IU,RU=uN,MU=DU;function $U(e,t){return RU(MU(e,t),1)}var LU=$U;const BU=kt(LU);var UU=dp;function WU(e,t){return UU(e,t)}var HU=WU;const bi=kt(HU);var nl=1e9,zU={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Mp,Ut=!0,Ka="[DecimalError] ",ii=Ka+"Invalid argument: ",Rp=Ka+"Exponent out of range: ",sl=Math.floor,zs=Math.pow,VU=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Na,Sr=1e7,Mt=7,i_=9007199254740991,Iu=sl(i_/Mt),Pe={};Pe.absoluteValue=Pe.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Pe.comparedTo=Pe.cmp=function(e){var t,r,a,s,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(a=i.d.length,s=e.d.length,t=0,r=a<s?a:s;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return a===s?0:a>s^i.s<0?1:-1};Pe.decimalPlaces=Pe.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Mt;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Pe.dividedBy=Pe.div=function(e){return Vn(this,new this.constructor(e))};Pe.dividedToIntegerBy=Pe.idiv=function(e){var t=this,r=t.constructor;return Ct(Vn(t,new r(e),0,1),r.precision)};Pe.equals=Pe.eq=function(e){return!this.cmp(e)};Pe.exponent=function(){return mr(this)};Pe.greaterThan=Pe.gt=function(e){return this.cmp(e)>0};Pe.greaterThanOrEqualTo=Pe.gte=function(e){return this.cmp(e)>=0};Pe.isInteger=Pe.isint=function(){return this.e>this.d.length-2};Pe.isNegative=Pe.isneg=function(){return this.s<0};Pe.isPositive=Pe.ispos=function(){return this.s>0};Pe.isZero=function(){return this.s===0};Pe.lessThan=Pe.lt=function(e){return this.cmp(e)<0};Pe.lessThanOrEqualTo=Pe.lte=function(e){return this.cmp(e)<1};Pe.logarithm=Pe.log=function(e){var t,r=this,a=r.constructor,s=a.precision,i=s+5;if(e===void 0)e=new a(10);else if(e=new a(e),e.s<1||e.eq(Na))throw Error(Ka+"NaN");if(r.s<1)throw Error(Ka+(r.s?"NaN":"-Infinity"));return r.eq(Na)?new a(0):(Ut=!1,t=Vn(wc(r,i),wc(e,i),i),Ut=!0,Ct(t,s))};Pe.minus=Pe.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?c_(t,e):o_(t,(e.s=-e.s,e))};Pe.modulo=Pe.mod=function(e){var t,r=this,a=r.constructor,s=a.precision;if(e=new a(e),!e.s)throw Error(Ka+"NaN");return r.s?(Ut=!1,t=Vn(r,e,0,1).times(e),Ut=!0,r.minus(t)):Ct(new a(r),s)};Pe.naturalExponential=Pe.exp=function(){return l_(this)};Pe.naturalLogarithm=Pe.ln=function(){return wc(this)};Pe.negated=Pe.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Pe.plus=Pe.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?o_(t,e):c_(t,(e.s=-e.s,e))};Pe.precision=Pe.sd=function(e){var t,r,a,s=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(ii+e);if(t=mr(s)+1,a=s.d.length-1,r=a*Mt+1,a=s.d[a],a){for(;a%10==0;a/=10)r--;for(a=s.d[0];a>=10;a/=10)r++}return e&&t>r?t:r};Pe.squareRoot=Pe.sqrt=function(){var e,t,r,a,s,i,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(Ka+"NaN")}for(e=mr(l),Ut=!1,s=Math.sqrt(+l),s==0||s==1/0?(t=vn(l.d),(t.length+e)%2==0&&(t+="0"),s=Math.sqrt(t),e=sl((e+1)/2)-(e<0||e%2),s==1/0?t="5e"+e:(t=s.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),a=new c(t)):a=new c(s.toString()),r=c.precision,s=o=r+3;;)if(i=a,a=i.plus(Vn(l,i,o+2)).times(.5),vn(i.d).slice(0,o)===(t=vn(a.d)).slice(0,o)){if(t=t.slice(o-3,o+1),s==o&&t=="4999"){if(Ct(i,r+1,0),i.times(i).eq(l)){a=i;break}}else if(t!="9999")break;o+=4}return Ut=!0,Ct(a,r)};Pe.times=Pe.mul=function(e){var t,r,a,s,i,o,l,c,d,u=this,f=u.constructor,h=u.d,m=(e=new f(e)).d;if(!u.s||!e.s)return new f(0);for(e.s*=u.s,r=u.e+e.e,c=h.length,d=m.length,c<d&&(i=h,h=m,m=i,o=c,c=d,d=o),i=[],o=c+d,a=o;a--;)i.push(0);for(a=d;--a>=0;){for(t=0,s=c+a;s>a;)l=i[s]+m[a]*h[s-a-1]+t,i[s--]=l%Sr|0,t=l/Sr|0;i[s]=(i[s]+t)%Sr|0}for(;!i[--o];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,Ut?Ct(e,f.precision):e};Pe.toDecimalPlaces=Pe.todp=function(e,t){var r=this,a=r.constructor;return r=new a(r),e===void 0?r:(An(e,0,nl),t===void 0?t=a.rounding:An(t,0,8),Ct(r,e+mr(r)+1,t))};Pe.toExponential=function(e,t){var r,a=this,s=a.constructor;return e===void 0?r=wi(a,!0):(An(e,0,nl),t===void 0?t=s.rounding:An(t,0,8),a=Ct(new s(a),e+1,t),r=wi(a,!0,e+1)),r};Pe.toFixed=function(e,t){var r,a,s=this,i=s.constructor;return e===void 0?wi(s):(An(e,0,nl),t===void 0?t=i.rounding:An(t,0,8),a=Ct(new i(s),e+mr(s)+1,t),r=wi(a.abs(),!1,e+mr(a)+1),s.isneg()&&!s.isZero()?"-"+r:r)};Pe.toInteger=Pe.toint=function(){var e=this,t=e.constructor;return Ct(new t(e),mr(e)+1,t.rounding)};Pe.toNumber=function(){return+this};Pe.toPower=Pe.pow=function(e){var t,r,a,s,i,o,l=this,c=l.constructor,d=12,u=+(e=new c(e));if(!e.s)return new c(Na);if(l=new c(l),!l.s){if(e.s<1)throw Error(Ka+"Infinity");return l}if(l.eq(Na))return l;if(a=c.precision,e.eq(Na))return Ct(l,a);if(t=e.e,r=e.d.length-1,o=t>=r,i=l.s,o){if((r=u<0?-u:u)<=i_){for(s=new c(Na),t=Math.ceil(a/Mt+4),Ut=!1;r%2&&(s=s.times(l),cb(s.d,t)),r=sl(r/2),r!==0;)l=l.times(l),cb(l.d,t);return Ut=!0,e.s<0?new c(Na).div(s):Ct(s,a)}}else if(i<0)throw Error(Ka+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,Ut=!1,s=e.times(wc(l,a+d)),Ut=!0,s=l_(s),s.s=i,s};Pe.toPrecision=function(e,t){var r,a,s=this,i=s.constructor;return e===void 0?(r=mr(s),a=wi(s,r<=i.toExpNeg||r>=i.toExpPos)):(An(e,1,nl),t===void 0?t=i.rounding:An(t,0,8),s=Ct(new i(s),e,t),r=mr(s),a=wi(s,e<=r||r<=i.toExpNeg,e)),a};Pe.toSignificantDigits=Pe.tosd=function(e,t){var r=this,a=r.constructor;return e===void 0?(e=a.precision,t=a.rounding):(An(e,1,nl),t===void 0?t=a.rounding:An(t,0,8)),Ct(new a(r),e,t)};Pe.toString=Pe.valueOf=Pe.val=Pe.toJSON=Pe[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=mr(e),r=e.constructor;return wi(e,t<=r.toExpNeg||t>=r.toExpPos)};function o_(e,t){var r,a,s,i,o,l,c,d,u=e.constructor,f=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),Ut?Ct(t,f):t;if(c=e.d,d=t.d,o=e.e,s=t.e,c=c.slice(),i=o-s,i){for(i<0?(a=c,i=-i,l=d.length):(a=d,s=o,l=c.length),o=Math.ceil(f/Mt),l=o>l?o+1:l+1,i>l&&(i=l,a.length=1),a.reverse();i--;)a.push(0);a.reverse()}for(l=c.length,i=d.length,l-i<0&&(i=l,a=d,d=c,c=a),r=0;i;)r=(c[--i]=c[i]+d[i]+r)/Sr|0,c[i]%=Sr;for(r&&(c.unshift(r),++s),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=s,Ut?Ct(t,f):t}function An(e,t,r){if(e!==~~e||e<t||e>r)throw Error(ii+e)}function vn(e){var t,r,a,s=e.length-1,i="",o=e[0];if(s>0){for(i+=o,t=1;t<s;t++)a=e[t]+"",r=Mt-a.length,r&&(i+=hs(r)),i+=a;o=e[t],a=o+"",r=Mt-a.length,r&&(i+=hs(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var Vn=function(){function e(a,s){var i,o=0,l=a.length;for(a=a.slice();l--;)i=a[l]*s+o,a[l]=i%Sr|0,o=i/Sr|0;return o&&a.unshift(o),a}function t(a,s,i,o){var l,c;if(i!=o)c=i>o?1:-1;else for(l=c=0;l<i;l++)if(a[l]!=s[l]){c=a[l]>s[l]?1:-1;break}return c}function r(a,s,i){for(var o=0;i--;)a[i]-=o,o=a[i]<s[i]?1:0,a[i]=o*Sr+a[i]-s[i];for(;!a[0]&&a.length>1;)a.shift()}return function(a,s,i,o){var l,c,d,u,f,h,m,x,p,g,y,w,v,_,b,j,N,k,S=a.constructor,E=a.s==s.s?1:-1,P=a.d,C=s.d;if(!a.s)return new S(a);if(!s.s)throw Error(Ka+"Division by zero");for(c=a.e-s.e,N=C.length,b=P.length,m=new S(E),x=m.d=[],d=0;C[d]==(P[d]||0);)++d;if(C[d]>(P[d]||0)&&--c,i==null?w=i=S.precision:o?w=i+(mr(a)-mr(s))+1:w=i,w<0)return new S(0);if(w=w/Mt+2|0,d=0,N==1)for(u=0,C=C[0],w++;(d<b||u)&&w--;d++)v=u*Sr+(P[d]||0),x[d]=v/C|0,u=v%C|0;else{for(u=Sr/(C[0]+1)|0,u>1&&(C=e(C,u),P=e(P,u),N=C.length,b=P.length),_=N,p=P.slice(0,N),g=p.length;g<N;)p[g++]=0;k=C.slice(),k.unshift(0),j=C[0],C[1]>=Sr/2&&++j;do u=0,l=t(C,p,N,g),l<0?(y=p[0],N!=g&&(y=y*Sr+(p[1]||0)),u=y/j|0,u>1?(u>=Sr&&(u=Sr-1),f=e(C,u),h=f.length,g=p.length,l=t(f,p,h,g),l==1&&(u--,r(f,N<h?k:C,h))):(u==0&&(l=u=1),f=C.slice()),h=f.length,h<g&&f.unshift(0),r(p,f,g),l==-1&&(g=p.length,l=t(C,p,N,g),l<1&&(u++,r(p,N<g?k:C,g))),g=p.length):l===0&&(u++,p=[0]),x[d++]=u,l&&p[0]?p[g++]=P[_]||0:(p=[P[_]],g=1);while((_++<b||p[0]!==void 0)&&w--)}return x[0]||x.shift(),m.e=c,Ct(m,o?i+mr(m)+1:i)}}();function l_(e,t){var r,a,s,i,o,l,c=0,d=0,u=e.constructor,f=u.precision;if(mr(e)>16)throw Error(Rp+mr(e));if(!e.s)return new u(Na);for(Ut=!1,l=f,o=new u(.03125);e.abs().gte(.1);)e=e.times(o),d+=5;for(a=Math.log(zs(2,d))/Math.LN10*2+5|0,l+=a,r=s=i=new u(Na),u.precision=l;;){if(s=Ct(s.times(e),l),r=r.times(++c),o=i.plus(Vn(s,r,l)),vn(o.d).slice(0,l)===vn(i.d).slice(0,l)){for(;d--;)i=Ct(i.times(i),l);return u.precision=f,t==null?(Ut=!0,Ct(i,f)):i}i=o}}function mr(e){for(var t=e.e*Mt,r=e.d[0];r>=10;r/=10)t++;return t}function ch(e,t,r){if(t>e.LN10.sd())throw Ut=!0,r&&(e.precision=r),Error(Ka+"LN10 precision limit exceeded");return Ct(new e(e.LN10),t)}function hs(e){for(var t="";e--;)t+="0";return t}function wc(e,t){var r,a,s,i,o,l,c,d,u,f=1,h=10,m=e,x=m.d,p=m.constructor,g=p.precision;if(m.s<1)throw Error(Ka+(m.s?"NaN":"-Infinity"));if(m.eq(Na))return new p(0);if(t==null?(Ut=!1,d=g):d=t,m.eq(10))return t==null&&(Ut=!0),ch(p,d);if(d+=h,p.precision=d,r=vn(x),a=r.charAt(0),i=mr(m),Math.abs(i)<15e14){for(;a<7&&a!=1||a==1&&r.charAt(1)>3;)m=m.times(e),r=vn(m.d),a=r.charAt(0),f++;i=mr(m),a>1?(m=new p("0."+r),i++):m=new p(a+"."+r.slice(1))}else return c=ch(p,d+2,g).times(i+""),m=wc(new p(a+"."+r.slice(1)),d-h).plus(c),p.precision=g,t==null?(Ut=!0,Ct(m,g)):m;for(l=o=m=Vn(m.minus(Na),m.plus(Na),d),u=Ct(m.times(m),d),s=3;;){if(o=Ct(o.times(u),d),c=l.plus(Vn(o,new p(s),d)),vn(c.d).slice(0,d)===vn(l.d).slice(0,d))return l=l.times(2),i!==0&&(l=l.plus(ch(p,d+2,g).times(i+""))),l=Vn(l,new p(f),d),p.precision=g,t==null?(Ut=!0,Ct(l,g)):l;l=c,s+=2}}function lb(e,t){var r,a,s;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(a=t.search(/e/i))>0?(r<0&&(r=a),r+=+t.slice(a+1),t=t.substring(0,a)):r<0&&(r=t.length),a=0;t.charCodeAt(a)===48;)++a;for(s=t.length;t.charCodeAt(s-1)===48;)--s;if(t=t.slice(a,s),t){if(s-=a,r=r-a-1,e.e=sl(r/Mt),e.d=[],a=(r+1)%Mt,r<0&&(a+=Mt),a<s){for(a&&e.d.push(+t.slice(0,a)),s-=Mt;a<s;)e.d.push(+t.slice(a,a+=Mt));t=t.slice(a),a=Mt-t.length}else a-=s;for(;a--;)t+="0";if(e.d.push(+t),Ut&&(e.e>Iu||e.e<-Iu))throw Error(Rp+r)}else e.s=0,e.e=0,e.d=[0];return e}function Ct(e,t,r){var a,s,i,o,l,c,d,u,f=e.d;for(o=1,i=f[0];i>=10;i/=10)o++;if(a=t-o,a<0)a+=Mt,s=t,d=f[u=0];else{if(u=Math.ceil((a+1)/Mt),i=f.length,u>=i)return e;for(d=i=f[u],o=1;i>=10;i/=10)o++;a%=Mt,s=a-Mt+o}if(r!==void 0&&(i=zs(10,o-s-1),l=d/i%10|0,c=t<0||f[u+1]!==void 0||d%i,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(a>0?s>0?d/zs(10,o-s):0:f[u-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return c?(i=mr(e),f.length=1,t=t-i-1,f[0]=zs(10,(Mt-t%Mt)%Mt),e.e=sl(-t/Mt)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(a==0?(f.length=u,i=1,u--):(f.length=u+1,i=zs(10,Mt-a),f[u]=s>0?(d/zs(10,o-s)%zs(10,s)|0)*i:0),c)for(;;)if(u==0){(f[0]+=i)==Sr&&(f[0]=1,++e.e);break}else{if(f[u]+=i,f[u]!=Sr)break;f[u--]=0,i=1}for(a=f.length;f[--a]===0;)f.pop();if(Ut&&(e.e>Iu||e.e<-Iu))throw Error(Rp+mr(e));return e}function c_(e,t){var r,a,s,i,o,l,c,d,u,f,h=e.constructor,m=h.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new h(e),Ut?Ct(t,m):t;if(c=e.d,f=t.d,a=t.e,d=e.e,c=c.slice(),o=d-a,o){for(u=o<0,u?(r=c,o=-o,l=f.length):(r=f,a=d,l=c.length),s=Math.max(Math.ceil(m/Mt),l)+2,o>s&&(o=s,r.length=1),r.reverse(),s=o;s--;)r.push(0);r.reverse()}else{for(s=c.length,l=f.length,u=s<l,u&&(l=s),s=0;s<l;s++)if(c[s]!=f[s]){u=c[s]<f[s];break}o=0}for(u&&(r=c,c=f,f=r,t.s=-t.s),l=c.length,s=f.length-l;s>0;--s)c[l++]=0;for(s=f.length;s>o;){if(c[--s]<f[s]){for(i=s;i&&c[--i]===0;)c[i]=Sr-1;--c[i],c[s]+=Sr}c[s]-=f[s]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--a;return c[0]?(t.d=c,t.e=a,Ut?Ct(t,m):t):new h(0)}function wi(e,t,r){var a,s=mr(e),i=vn(e.d),o=i.length;return t?(r&&(a=r-o)>0?i=i.charAt(0)+"."+i.slice(1)+hs(a):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(s<0?"e":"e+")+s):s<0?(i="0."+hs(-s-1)+i,r&&(a=r-o)>0&&(i+=hs(a))):s>=o?(i+=hs(s+1-o),r&&(a=r-s-1)>0&&(i=i+"."+hs(a))):((a=s+1)<o&&(i=i.slice(0,a)+"."+i.slice(a)),r&&(a=r-o)>0&&(s+1===o&&(i+="."),i+=hs(a))),e.s<0?"-"+i:i}function cb(e,t){if(e.length>t)return e.length=t,!0}function d_(e){var t,r,a;function s(i){var o=this;if(!(o instanceof s))return new s(i);if(o.constructor=s,i instanceof s){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(ii+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return lb(o,i.toString())}else if(typeof i!="string")throw Error(ii+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,VU.test(i))lb(o,i);else throw Error(ii+i)}if(s.prototype=Pe,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.clone=d_,s.config=s.set=GU,e===void 0&&(e={}),e)for(a=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<a.length;)e.hasOwnProperty(r=a[t++])||(e[r]=this[r]);return s.config(e),s}function GU(e){if(!e||typeof e!="object")throw Error(Ka+"Object expected");var t,r,a,s=["precision",1,nl,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<s.length;t+=3)if((a=e[r=s[t]])!==void 0)if(sl(a)===a&&a>=s[t+1]&&a<=s[t+2])this[r]=a;else throw Error(ii+r+": "+a);if((a=e[r="LN10"])!==void 0)if(a==Math.LN10)this[r]=new this(a);else throw Error(ii+r+": "+a);return this}var Mp=d_(zU);Na=new Mp(1);const Tt=Mp;function KU(e){return JU(e)||YU(e)||XU(e)||qU()}function qU(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XU(e,t){if(e){if(typeof e=="string")return _m(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _m(e,t)}}function YU(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function JU(e){if(Array.isArray(e))return _m(e)}function _m(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var ZU=function(t){return t},u_={},f_=function(t){return t===u_},db=function(t){return function r(){return arguments.length===0||arguments.length===1&&f_(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},QU=function e(t,r){return t===1?r:db(function(){for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];var o=s.filter(function(l){return l!==u_}).length;return o>=t?r.apply(void 0,s):e(t-o,db(function(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];var u=s.map(function(f){return f_(f)?c.shift():f});return r.apply(void 0,KU(u).concat(c))}))})},h0=function(t){return QU(t.length,t)},Sm=function(t,r){for(var a=[],s=t;s<r;++s)a[s-t]=s;return a},eW=h0(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),tW=function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];if(!r.length)return ZU;var s=r.reverse(),i=s[0],o=s.slice(1);return function(){return o.reduce(function(l,c){return c(l)},i.apply(void 0,arguments))}},km=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},h_=function(t){var r=null,a=null;return function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r&&i.every(function(l,c){return l===r[c]})||(r=i,a=t.apply(void 0,i)),a}};function rW(e){var t;return e===0?t=1:t=Math.floor(new Tt(e).abs().log(10).toNumber())+1,t}function aW(e,t,r){for(var a=new Tt(e),s=0,i=[];a.lt(t)&&s<1e5;)i.push(a.toNumber()),a=a.add(r),s++;return i}var nW=h0(function(e,t,r){var a=+e,s=+t;return a+r*(s-a)}),sW=h0(function(e,t,r){var a=t-+e;return a=a||1/0,(r-e)/a}),iW=h0(function(e,t,r){var a=t-+e;return a=a||1/0,Math.max(0,Math.min(1,(r-e)/a))});const m0={rangeStep:aW,getDigitCount:rW,interpolateNumber:nW,uninterpolateNumber:sW,uninterpolateTruncation:iW};function Em(e){return cW(e)||lW(e)||m_(e)||oW()}function oW(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lW(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function cW(e){if(Array.isArray(e))return Am(e)}function jc(e,t){return fW(e)||uW(e,t)||m_(e,t)||dW()}function dW(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function m_(e,t){if(e){if(typeof e=="string")return Am(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Am(e,t)}}function Am(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function uW(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],a=!0,s=!1,i=void 0;try{for(var o=e[Symbol.iterator](),l;!(a=(l=o.next()).done)&&(r.push(l.value),!(t&&r.length===t));a=!0);}catch(c){s=!0,i=c}finally{try{!a&&o.return!=null&&o.return()}finally{if(s)throw i}}return r}}function fW(e){if(Array.isArray(e))return e}function x_(e){var t=jc(e,2),r=t[0],a=t[1],s=r,i=a;return r>a&&(s=a,i=r),[s,i]}function p_(e,t,r){if(e.lte(0))return new Tt(0);var a=m0.getDigitCount(e.toNumber()),s=new Tt(10).pow(a),i=e.div(s),o=a!==1?.05:.1,l=new Tt(Math.ceil(i.div(o).toNumber())).add(r).mul(o),c=l.mul(s);return t?c:new Tt(Math.ceil(c))}function hW(e,t,r){var a=1,s=new Tt(e);if(!s.isint()&&r){var i=Math.abs(e);i<1?(a=new Tt(10).pow(m0.getDigitCount(e)-1),s=new Tt(Math.floor(s.div(a).toNumber())).mul(a)):i>1&&(s=new Tt(Math.floor(e)))}else e===0?s=new Tt(Math.floor((t-1)/2)):r||(s=new Tt(Math.floor(e)));var o=Math.floor((t-1)/2),l=tW(eW(function(c){return s.add(new Tt(c-o).mul(a)).toNumber()}),Sm);return l(0,t)}function g_(e,t,r,a){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new Tt(0),tickMin:new Tt(0),tickMax:new Tt(0)};var i=p_(new Tt(t).sub(e).div(r-1),a,s),o;e<=0&&t>=0?o=new Tt(0):(o=new Tt(e).add(t).div(2),o=o.sub(new Tt(o).mod(i)));var l=Math.ceil(o.sub(e).div(i).toNumber()),c=Math.ceil(new Tt(t).sub(o).div(i).toNumber()),d=l+c+1;return d>r?g_(e,t,r,a,s+1):(d<r&&(c=t>0?c+(r-d):c,l=t>0?l:l+(r-d)),{step:i,tickMin:o.sub(new Tt(l).mul(i)),tickMax:o.add(new Tt(c).mul(i))})}function mW(e){var t=jc(e,2),r=t[0],a=t[1],s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(s,2),l=x_([r,a]),c=jc(l,2),d=c[0],u=c[1];if(d===-1/0||u===1/0){var f=u===1/0?[d].concat(Em(Sm(0,s-1).map(function(){return 1/0}))):[].concat(Em(Sm(0,s-1).map(function(){return-1/0})),[u]);return r>a?km(f):f}if(d===u)return hW(d,s,i);var h=g_(d,u,o,i),m=h.step,x=h.tickMin,p=h.tickMax,g=m0.rangeStep(x,p.add(new Tt(.1).mul(m)),m);return r>a?km(g):g}function xW(e,t){var r=jc(e,2),a=r[0],s=r[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=x_([a,s]),l=jc(o,2),c=l[0],d=l[1];if(c===-1/0||d===1/0)return[a,s];if(c===d)return[c];var u=Math.max(t,2),f=p_(new Tt(d).sub(c).div(u-1),i,0),h=[].concat(Em(m0.rangeStep(new Tt(c),new Tt(d).sub(new Tt(.99).mul(f)),f)),[d]);return a>s?km(h):h}var pW=h_(mW),gW=h_(xW),vW="Invariant failed";function ji(e,t){throw new Error(vW)}var yW=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function _o(e){"@babel/helpers - typeof";return _o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_o(e)}function Du(){return Du=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Du.apply(this,arguments)}function bW(e,t){return _W(e)||NW(e,t)||jW(e,t)||wW()}function wW(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jW(e,t){if(e){if(typeof e=="string")return ub(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ub(e,t)}}function ub(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function NW(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function _W(e){if(Array.isArray(e))return e}function SW(e,t){if(e==null)return{};var r=kW(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function kW(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function EW(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AW(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,b_(a.key),a)}}function TW(e,t,r){return t&&AW(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function OW(e,t,r){return t=Ru(t),PW(e,v_()?Reflect.construct(t,r||[],Ru(e).constructor):t.apply(e,r))}function PW(e,t){if(t&&(_o(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CW(e)}function CW(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v_(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v_=function(){return!!e})()}function Ru(e){return Ru=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ru(e)}function FW(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Tm(e,t)}function Tm(e,t){return Tm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Tm(e,t)}function y_(e,t,r){return t=b_(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b_(e){var t=IW(e,"string");return _o(t)=="symbol"?t:t+""}function IW(e,t){if(_o(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(_o(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var pd=function(e){function t(){return EW(this,t),OW(this,t,arguments)}return FW(t,e),TW(t,[{key:"render",value:function(){var a=this.props,s=a.offset,i=a.layout,o=a.width,l=a.dataKey,c=a.data,d=a.dataPointFormatter,u=a.xAxis,f=a.yAxis,h=SW(a,yW),m=Ce(h,!1);this.props.direction==="x"&&u.type!=="number"&&ji();var x=c.map(function(p){var g=d(p,l),y=g.x,w=g.y,v=g.value,_=g.errorVal;if(!_)return null;var b=[],j,N;if(Array.isArray(_)){var k=bW(_,2);j=k[0],N=k[1]}else j=N=_;if(i==="vertical"){var S=u.scale,E=w+s,P=E+o,C=E-o,T=S(v-j),M=S(v+N);b.push({x1:M,y1:P,x2:M,y2:C}),b.push({x1:T,y1:E,x2:M,y2:E}),b.push({x1:T,y1:P,x2:T,y2:C})}else if(i==="horizontal"){var A=f.scale,F=y+s,H=F-o,V=F+o,B=A(v-j),L=A(v+N);b.push({x1:H,y1:L,x2:V,y2:L}),b.push({x1:F,y1:B,x2:F,y2:L}),b.push({x1:H,y1:B,x2:V,y2:B})}return Z.createElement(it,Du({className:"recharts-errorBar",key:"bar-".concat(b.map(function(ee){return"".concat(ee.x1,"-").concat(ee.x2,"-").concat(ee.y1,"-").concat(ee.y2)}))},m),b.map(function(ee){return Z.createElement("line",Du({},ee,{key:"line-".concat(ee.x1,"-").concat(ee.x2,"-").concat(ee.y1,"-").concat(ee.y2)}))}))});return Z.createElement(it,{className:"recharts-errorBars"},x)}}])}(Z.Component);y_(pd,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});y_(pd,"displayName","ErrorBar");function Nc(e){"@babel/helpers - typeof";return Nc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nc(e)}function fb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Ls(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fb(Object(r),!0).forEach(function(a){DW(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fb(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function DW(e,t,r){return t=RW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RW(e){var t=MW(e,"string");return Nc(t)=="symbol"?t:t+""}function MW(e,t){if(Nc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Nc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var w_=function(t){var r=t.children,a=t.formattedGraphicalItems,s=t.legendWidth,i=t.legendContent,o=ba(r,oo);if(!o)return null;var l=oo.defaultProps,c=l!==void 0?Ls(Ls({},l),o.props):{},d;return o.props&&o.props.payload?d=o.props&&o.props.payload:i==="children"?d=(a||[]).reduce(function(u,f){var h=f.item,m=f.props,x=m.sectors||m.data||[];return u.concat(x.map(function(p){return{type:o.props.iconType||h.props.legendType,value:p.name,color:p.fill,payload:p}}))},[]):d=(a||[]).map(function(u){var f=u.item,h=f.type.defaultProps,m=h!==void 0?Ls(Ls({},h),f.props):{},x=m.dataKey,p=m.name,g=m.legendType,y=m.hide;return{inactive:y,dataKey:x,type:c.iconType||g||"square",color:$p(f),value:p||x,payload:m}}),Ls(Ls(Ls({},c),oo.getWithHeight(o,s)),{},{payload:d,item:o})};function _c(e){"@babel/helpers - typeof";return _c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_c(e)}function hb(e){return UW(e)||BW(e)||LW(e)||$W()}function $W(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LW(e,t){if(e){if(typeof e=="string")return Om(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Om(e,t)}}function BW(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function UW(e){if(Array.isArray(e))return Om(e)}function Om(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function mb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Yt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mb(Object(r),!0).forEach(function(a){co(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mb(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function co(e,t,r){return t=WW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WW(e){var t=HW(e,"string");return _c(t)=="symbol"?t:t+""}function HW(e,t){if(_c(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(_c(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nr(e,t,r){return We(e)||We(t)?r:wr(t)?ka(e,t,r):$e(t)?t(e):r}function Wl(e,t,r,a){var s=BU(e,function(l){return nr(l,t)});if(r==="number"){var i=s.filter(function(l){return be(l)||parseFloat(l)});return i.length?[f0(i),xs(i)]:[1/0,-1/0]}var o=a?s.filter(function(l){return!We(l)}):s;return o.map(function(l){return wr(l)||l instanceof Date?l:""})}var zW=function(t){var r,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=-1,l=(r=a==null?void 0:a.length)!==null&&r!==void 0?r:0;if(l<=1)return 0;if(i&&i.axisType==="angleAxis"&&Math.abs(Math.abs(i.range[1]-i.range[0])-360)<=1e-6)for(var c=i.range,d=0;d<l;d++){var u=d>0?s[d-1].coordinate:s[l-1].coordinate,f=s[d].coordinate,h=d>=l-1?s[0].coordinate:s[d+1].coordinate,m=void 0;if(aa(f-u)!==aa(h-f)){var x=[];if(aa(h-f)===aa(c[1]-c[0])){m=h;var p=f+c[1]-c[0];x[0]=Math.min(p,(p+u)/2),x[1]=Math.max(p,(p+u)/2)}else{m=u;var g=h+c[1]-c[0];x[0]=Math.min(f,(g+f)/2),x[1]=Math.max(f,(g+f)/2)}var y=[Math.min(f,(m+f)/2),Math.max(f,(m+f)/2)];if(t>y[0]&&t<=y[1]||t>=x[0]&&t<=x[1]){o=s[d].index;break}}else{var w=Math.min(u,h),v=Math.max(u,h);if(t>(w+f)/2&&t<=(v+f)/2){o=s[d].index;break}}}else for(var _=0;_<l;_++)if(_===0&&t<=(a[_].coordinate+a[_+1].coordinate)/2||_>0&&_<l-1&&t>(a[_].coordinate+a[_-1].coordinate)/2&&t<=(a[_].coordinate+a[_+1].coordinate)/2||_===l-1&&t>(a[_].coordinate+a[_-1].coordinate)/2){o=a[_].index;break}return o},$p=function(t){var r,a=t,s=a.type.displayName,i=(r=t.type)!==null&&r!==void 0&&r.defaultProps?Yt(Yt({},t.type.defaultProps),t.props):t.props,o=i.stroke,l=i.fill,c;switch(s){case"Line":c=o;break;case"Area":case"Radar":c=o&&o!=="none"?o:l;break;default:c=l;break}return c},VW=function(t){var r=t.barSize,a=t.totalSize,s=t.stackGroups,i=s===void 0?{}:s;if(!i)return{};for(var o={},l=Object.keys(i),c=0,d=l.length;c<d;c++)for(var u=i[l[c]].stackGroups,f=Object.keys(u),h=0,m=f.length;h<m;h++){var x=u[f[h]],p=x.items,g=x.cateAxisId,y=p.filter(function(N){return zn(N.type).indexOf("Bar")>=0});if(y&&y.length){var w=y[0].type.defaultProps,v=w!==void 0?Yt(Yt({},w),y[0].props):y[0].props,_=v.barSize,b=v[g];o[b]||(o[b]=[]);var j=We(_)?r:_;o[b].push({item:y[0],stackList:y.slice(1),barSize:We(j)?void 0:na(j,a,0)})}}return o},GW=function(t){var r=t.barGap,a=t.barCategoryGap,s=t.bandSize,i=t.sizeList,o=i===void 0?[]:i,l=t.maxBarSize,c=o.length;if(c<1)return null;var d=na(r,s,0,!0),u,f=[];if(o[0].barSize===+o[0].barSize){var h=!1,m=s/c,x=o.reduce(function(_,b){return _+b.barSize||0},0);x+=(c-1)*d,x>=s&&(x-=(c-1)*d,d=0),x>=s&&m>0&&(h=!0,m*=.9,x=c*m);var p=(s-x)/2>>0,g={offset:p-d,size:0};u=o.reduce(function(_,b){var j={item:b.item,position:{offset:g.offset+g.size+d,size:h?m:b.barSize}},N=[].concat(hb(_),[j]);return g=N[N.length-1].position,b.stackList&&b.stackList.length&&b.stackList.forEach(function(k){N.push({item:k,position:g})}),N},f)}else{var y=na(a,s,0,!0);s-2*y-(c-1)*d<=0&&(d=0);var w=(s-2*y-(c-1)*d)/c;w>1&&(w>>=0);var v=l===+l?Math.min(w,l):w;u=o.reduce(function(_,b,j){var N=[].concat(hb(_),[{item:b.item,position:{offset:y+(w+d)*j+(w-v)/2,size:v}}]);return b.stackList&&b.stackList.length&&b.stackList.forEach(function(k){N.push({item:k,position:N[N.length-1].position})}),N},f)}return u},KW=function(t,r,a,s){var i=a.children,o=a.width,l=a.margin,c=o-(l.left||0)-(l.right||0),d=w_({children:i,legendWidth:c});if(d){var u=s||{},f=u.width,h=u.height,m=d.align,x=d.verticalAlign,p=d.layout;if((p==="vertical"||p==="horizontal"&&x==="middle")&&m!=="center"&&be(t[m]))return Yt(Yt({},t),{},co({},m,t[m]+(f||0)));if((p==="horizontal"||p==="vertical"&&m==="center")&&x!=="middle"&&be(t[x]))return Yt(Yt({},t),{},co({},x,t[x]+(h||0)))}return t},qW=function(t,r,a){return We(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||a==="x"?r==="xAxis":a==="y"?r==="yAxis":!0},j_=function(t,r,a,s,i){var o=r.props.children,l=Ea(o,pd).filter(function(d){return qW(s,i,d.props.direction)});if(l&&l.length){var c=l.map(function(d){return d.props.dataKey});return t.reduce(function(d,u){var f=nr(u,a);if(We(f))return d;var h=Array.isArray(f)?[f0(f),xs(f)]:[f,f],m=c.reduce(function(x,p){var g=nr(u,p,0),y=h[0]-Math.abs(Array.isArray(g)?g[0]:g),w=h[1]+Math.abs(Array.isArray(g)?g[1]:g);return[Math.min(y,x[0]),Math.max(w,x[1])]},[1/0,-1/0]);return[Math.min(m[0],d[0]),Math.max(m[1],d[1])]},[1/0,-1/0])}return null},XW=function(t,r,a,s,i){var o=r.map(function(l){return j_(t,l,a,i,s)}).filter(function(l){return!We(l)});return o&&o.length?o.reduce(function(l,c){return[Math.min(l[0],c[0]),Math.max(l[1],c[1])]},[1/0,-1/0]):null},N_=function(t,r,a,s,i){var o=r.map(function(c){var d=c.props.dataKey;return a==="number"&&d&&j_(t,c,d,s)||Wl(t,d,a,i)});if(a==="number")return o.reduce(function(c,d){return[Math.min(c[0],d[0]),Math.max(c[1],d[1])]},[1/0,-1/0]);var l={};return o.reduce(function(c,d){for(var u=0,f=d.length;u<f;u++)l[d[u]]||(l[d[u]]=!0,c.push(d[u]));return c},[])},__=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},S_=function(t,r,a,s){if(s)return t.map(function(c){return c.coordinate});var i,o,l=t.map(function(c){return c.coordinate===r&&(i=!0),c.coordinate===a&&(o=!0),c.coordinate});return i||l.push(r),o||l.push(a),l},Bn=function(t,r,a){if(!t)return null;var s=t.scale,i=t.duplicateDomain,o=t.type,l=t.range,c=t.realScaleType==="scaleBand"?s.bandwidth()/2:2,d=(r||a)&&o==="category"&&s.bandwidth?s.bandwidth()/c:0;if(d=t.axisType==="angleAxis"&&(l==null?void 0:l.length)>=2?aa(l[0]-l[1])*2*d:d,r&&(t.ticks||t.niceTicks)){var u=(t.ticks||t.niceTicks).map(function(f){var h=i?i.indexOf(f):f;return{coordinate:s(h)+d,value:f,offset:d}});return u.filter(function(f){return!Qo(f.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(f,h){return{coordinate:s(f)+d,value:f,index:h,offset:d}}):s.ticks&&!a?s.ticks(t.tickCount).map(function(f){return{coordinate:s(f)+d,value:f,offset:d}}):s.domain().map(function(f,h){return{coordinate:s(f)+d,value:i?i[f]:f,index:h,offset:d}})},dh=new WeakMap,$d=function(t,r){if(typeof r!="function")return t;dh.has(t)||dh.set(t,new WeakMap);var a=dh.get(t);if(a.has(r))return a.get(r);var s=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return a.set(r,s),s},k_=function(t,r,a){var s=t.scale,i=t.type,o=t.layout,l=t.axisType;if(s==="auto")return o==="radial"&&l==="radiusAxis"?{scale:pc(),realScaleType:"band"}:o==="radial"&&l==="angleAxis"?{scale:Ou(),realScaleType:"linear"}:i==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!a)?{scale:Ul(),realScaleType:"point"}:i==="category"?{scale:pc(),realScaleType:"band"}:{scale:Ou(),realScaleType:"linear"};if(gi(s)){var c="scale".concat(Jf(s));return{scale:(ob[c]||Ul)(),realScaleType:ob[c]?c:"point"}}return $e(s)?{scale:s}:{scale:Ul(),realScaleType:"point"}},xb=1e-4,E_=function(t){var r=t.domain();if(!(!r||r.length<=2)){var a=r.length,s=t.range(),i=Math.min(s[0],s[1])-xb,o=Math.max(s[0],s[1])+xb,l=t(r[0]),c=t(r[a-1]);(l<i||l>o||c<i||c>o)&&t.domain([r[0],r[a-1]])}},YW=function(t,r){if(!t)return null;for(var a=0,s=t.length;a<s;a++)if(t[a].item===r)return t[a].position;return null},JW=function(t,r){if(!r||r.length!==2||!be(r[0])||!be(r[1]))return t;var a=Math.min(r[0],r[1]),s=Math.max(r[0],r[1]),i=[t[0],t[1]];return(!be(t[0])||t[0]<a)&&(i[0]=a),(!be(t[1])||t[1]>s)&&(i[1]=s),i[0]>s&&(i[0]=s),i[1]<a&&(i[1]=a),i},ZW=function(t){var r=t.length;if(!(r<=0))for(var a=0,s=t[0].length;a<s;++a)for(var i=0,o=0,l=0;l<r;++l){var c=Qo(t[l][a][1])?t[l][a][0]:t[l][a][1];c>=0?(t[l][a][0]=i,t[l][a][1]=i+c,i=t[l][a][1]):(t[l][a][0]=o,t[l][a][1]=o+c,o=t[l][a][1])}},QW=function(t){var r=t.length;if(!(r<=0))for(var a=0,s=t[0].length;a<s;++a)for(var i=0,o=0;o<r;++o){var l=Qo(t[o][a][1])?t[o][a][0]:t[o][a][1];l>=0?(t[o][a][0]=i,t[o][a][1]=i+l,i=t[o][a][1]):(t[o][a][0]=0,t[o][a][1]=0)}},eH={sign:ZW,expand:yC,none:po,silhouette:bC,wiggle:wC,positive:QW},tH=function(t,r,a){var s=r.map(function(l){return l.props.dataKey}),i=eH[a],o=vC().keys(s).value(function(l,c){return+nr(l,c,0)}).order(tm).offset(i);return o(t)},rH=function(t,r,a,s,i,o){if(!t)return null;var l=o?r.reverse():r,c={},d=l.reduce(function(f,h){var m,x=(m=h.type)!==null&&m!==void 0&&m.defaultProps?Yt(Yt({},h.type.defaultProps),h.props):h.props,p=x.stackId,g=x.hide;if(g)return f;var y=x[a],w=f[y]||{hasStack:!1,stackGroups:{}};if(wr(p)){var v=w.stackGroups[p]||{numericAxisId:a,cateAxisId:s,items:[]};v.items.push(h),w.hasStack=!0,w.stackGroups[p]=v}else w.stackGroups[Ii("_stackId_")]={numericAxisId:a,cateAxisId:s,items:[h]};return Yt(Yt({},f),{},co({},y,w))},c),u={};return Object.keys(d).reduce(function(f,h){var m=d[h];if(m.hasStack){var x={};m.stackGroups=Object.keys(m.stackGroups).reduce(function(p,g){var y=m.stackGroups[g];return Yt(Yt({},p),{},co({},g,{numericAxisId:a,cateAxisId:s,items:y.items,stackedData:tH(t,y.items,i)}))},x)}return Yt(Yt({},f),{},co({},h,m))},u)},A_=function(t,r){var a=r.realScaleType,s=r.type,i=r.tickCount,o=r.originalDomain,l=r.allowDecimals,c=a||r.scale;if(c!=="auto"&&c!=="linear")return null;if(i&&s==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var d=t.domain();if(!d.length)return null;var u=pW(d,i,l);return t.domain([f0(u),xs(u)]),{niceTicks:u}}if(i&&s==="number"){var f=t.domain(),h=gW(f,i,l);return{niceTicks:h}}return null};function Mu(e){var t=e.axis,r=e.ticks,a=e.bandSize,s=e.entry,i=e.index,o=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!We(s[t.dataKey])){var l=cu(r,"value",s[t.dataKey]);if(l)return l.coordinate+a/2}return r[i]?r[i].coordinate+a/2:null}var c=nr(s,We(o)?t.dataKey:o);return We(c)?null:t.scale(c)}var pb=function(t){var r=t.axis,a=t.ticks,s=t.offset,i=t.bandSize,o=t.entry,l=t.index;if(r.type==="category")return a[l]?a[l].coordinate+s:null;var c=nr(o,r.dataKey,r.domain[l]);return We(c)?null:r.scale(c)-i/2+s},aH=function(t){var r=t.numericAxis,a=r.scale.domain();if(r.type==="number"){var s=Math.min(a[0],a[1]),i=Math.max(a[0],a[1]);return s<=0&&i>=0?0:i<0?i:s}return a[0]},nH=function(t,r){var a,s=(a=t.type)!==null&&a!==void 0&&a.defaultProps?Yt(Yt({},t.type.defaultProps),t.props):t.props,i=s.stackId;if(wr(i)){var o=r[i];if(o){var l=o.items.indexOf(t);return l>=0?o.stackedData[l]:null}}return null},sH=function(t){return t.reduce(function(r,a){return[f0(a.concat([r[0]]).filter(be)),xs(a.concat([r[1]]).filter(be))]},[1/0,-1/0])},T_=function(t,r,a){return Object.keys(t).reduce(function(s,i){var o=t[i],l=o.stackedData,c=l.reduce(function(d,u){var f=sH(u.slice(r,a+1));return[Math.min(d[0],f[0]),Math.max(d[1],f[1])]},[1/0,-1/0]);return[Math.min(c[0],s[0]),Math.max(c[1],s[1])]},[1/0,-1/0]).map(function(s){return s===1/0||s===-1/0?0:s})},gb=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,vb=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Pm=function(t,r,a){if($e(t))return t(r,a);if(!Array.isArray(t))return r;var s=[];if(be(t[0]))s[0]=a?t[0]:Math.min(t[0],r[0]);else if(gb.test(t[0])){var i=+gb.exec(t[0])[1];s[0]=r[0]-i}else $e(t[0])?s[0]=t[0](r[0]):s[0]=r[0];if(be(t[1]))s[1]=a?t[1]:Math.max(t[1],r[1]);else if(vb.test(t[1])){var o=+vb.exec(t[1])[1];s[1]=r[1]+o}else $e(t[1])?s[1]=t[1](r[1]):s[1]=r[1];return s},$u=function(t,r,a){if(t&&t.scale&&t.scale.bandwidth){var s=t.scale.bandwidth();if(!a||s>0)return s}if(t&&r&&r.length>=2){for(var i=fp(r,function(f){return f.coordinate}),o=1/0,l=1,c=i.length;l<c;l++){var d=i[l],u=i[l-1];o=Math.min((d.coordinate||0)-(u.coordinate||0),o)}return o===1/0?0:o}return a?void 0:0},yb=function(t,r,a){return!t||!t.length||bi(t,ka(a,"type.defaultProps.domain"))?r:t},O_=function(t,r){var a=t.type.defaultProps?Yt(Yt({},t.type.defaultProps),t.props):t.props,s=a.dataKey,i=a.name,o=a.unit,l=a.formatter,c=a.tooltipType,d=a.chartType,u=a.hide;return Yt(Yt({},Ce(t,!1)),{},{dataKey:s,unit:o,formatter:l,name:i||s,color:$p(t),value:nr(r,s),type:c,payload:r,chartType:d,hide:u})};function Sc(e){"@babel/helpers - typeof";return Sc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sc(e)}function bb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Rn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bb(Object(r),!0).forEach(function(a){P_(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bb(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function P_(e,t,r){return t=iH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iH(e){var t=oH(e,"string");return Sc(t)=="symbol"?t:t+""}function oH(e,t){if(Sc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Sc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lH(e,t){return fH(e)||uH(e,t)||dH(e,t)||cH()}function cH(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dH(e,t){if(e){if(typeof e=="string")return wb(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wb(e,t)}}function wb(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function uH(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function fH(e){if(Array.isArray(e))return e}var Lu=Math.PI/180,hH=function(t){return t*180/Math.PI},Dt=function(t,r,a,s){return{x:t+Math.cos(-Lu*s)*a,y:r+Math.sin(-Lu*s)*a}},C_=function(t,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(a.left||0)-(a.right||0)),Math.abs(r-(a.top||0)-(a.bottom||0)))/2},mH=function(t,r,a,s,i){var o=t.width,l=t.height,c=t.startAngle,d=t.endAngle,u=na(t.cx,o,o/2),f=na(t.cy,l,l/2),h=C_(o,l,a),m=na(t.innerRadius,h,0),x=na(t.outerRadius,h,h*.8),p=Object.keys(r);return p.reduce(function(g,y){var w=r[y],v=w.domain,_=w.reversed,b;if(We(w.range))s==="angleAxis"?b=[c,d]:s==="radiusAxis"&&(b=[m,x]),_&&(b=[b[1],b[0]]);else{b=w.range;var j=b,N=lH(j,2);c=N[0],d=N[1]}var k=k_(w,i),S=k.realScaleType,E=k.scale;E.domain(v).range(b),E_(E);var P=A_(E,Rn(Rn({},w),{},{realScaleType:S})),C=Rn(Rn(Rn({},w),P),{},{range:b,radius:x,realScaleType:S,scale:E,cx:u,cy:f,innerRadius:m,outerRadius:x,startAngle:c,endAngle:d});return Rn(Rn({},g),{},P_({},y,C))},{})},xH=function(t,r){var a=t.x,s=t.y,i=r.x,o=r.y;return Math.sqrt(Math.pow(a-i,2)+Math.pow(s-o,2))},pH=function(t,r){var a=t.x,s=t.y,i=r.cx,o=r.cy,l=xH({x:a,y:s},{x:i,y:o});if(l<=0)return{radius:l};var c=(a-i)/l,d=Math.acos(c);return s>o&&(d=2*Math.PI-d),{radius:l,angle:hH(d),angleInRadian:d}},gH=function(t){var r=t.startAngle,a=t.endAngle,s=Math.floor(r/360),i=Math.floor(a/360),o=Math.min(s,i);return{startAngle:r-o*360,endAngle:a-o*360}},vH=function(t,r){var a=r.startAngle,s=r.endAngle,i=Math.floor(a/360),o=Math.floor(s/360),l=Math.min(i,o);return t+l*360},jb=function(t,r){var a=t.x,s=t.y,i=pH({x:a,y:s},r),o=i.radius,l=i.angle,c=r.innerRadius,d=r.outerRadius;if(o<c||o>d)return!1;if(o===0)return!0;var u=gH(r),f=u.startAngle,h=u.endAngle,m=l,x;if(f<=h){for(;m>h;)m-=360;for(;m<f;)m+=360;x=m>=f&&m<=h}else{for(;m>f;)m-=360;for(;m<h;)m+=360;x=m>=h&&m<=f}return x?Rn(Rn({},r),{},{radius:o,angle:vH(m,r)}):null},F_=function(t){return!O.isValidElement(t)&&!$e(t)&&typeof t!="boolean"?t.className:""};function kc(e){"@babel/helpers - typeof";return kc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kc(e)}var yH=["offset"];function bH(e){return _H(e)||NH(e)||jH(e)||wH()}function wH(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jH(e,t){if(e){if(typeof e=="string")return Cm(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Cm(e,t)}}function NH(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _H(e){if(Array.isArray(e))return Cm(e)}function Cm(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function SH(e,t){if(e==null)return{};var r=kH(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function kH(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function Nb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function gr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Nb(Object(r),!0).forEach(function(a){EH(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nb(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function EH(e,t,r){return t=AH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AH(e){var t=TH(e,"string");return kc(t)=="symbol"?t:t+""}function TH(e,t){if(kc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(kc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ec(){return Ec=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Ec.apply(this,arguments)}var OH=function(t){var r=t.value,a=t.formatter,s=We(t.children)?r:t.children;return $e(a)?a(s):s},PH=function(t,r){var a=aa(r-t),s=Math.min(Math.abs(r-t),360);return a*s},CH=function(t,r,a){var s=t.position,i=t.viewBox,o=t.offset,l=t.className,c=i,d=c.cx,u=c.cy,f=c.innerRadius,h=c.outerRadius,m=c.startAngle,x=c.endAngle,p=c.clockWise,g=(f+h)/2,y=PH(m,x),w=y>=0?1:-1,v,_;s==="insideStart"?(v=m+w*o,_=p):s==="insideEnd"?(v=x-w*o,_=!p):s==="end"&&(v=x+w*o,_=p),_=y<=0?_:!_;var b=Dt(d,u,g,v),j=Dt(d,u,g,v+(_?1:-1)*359),N="M".concat(b.x,",").concat(b.y,`
    A`).concat(g,",").concat(g,",0,1,").concat(_?0:1,`,
    `).concat(j.x,",").concat(j.y),k=We(t.id)?Ii("recharts-radial-line-"):t.id;return Z.createElement("text",Ec({},a,{dominantBaseline:"central",className:qe("recharts-radial-bar-label",l)}),Z.createElement("defs",null,Z.createElement("path",{id:k,d:N})),Z.createElement("textPath",{xlinkHref:"#".concat(k)},r))},FH=function(t){var r=t.viewBox,a=t.offset,s=t.position,i=r,o=i.cx,l=i.cy,c=i.innerRadius,d=i.outerRadius,u=i.startAngle,f=i.endAngle,h=(u+f)/2;if(s==="outside"){var m=Dt(o,l,d+a,h),x=m.x,p=m.y;return{x,y:p,textAnchor:x>=o?"start":"end",verticalAnchor:"middle"}}if(s==="center")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"middle"};if(s==="centerTop")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"start"};if(s==="centerBottom")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"end"};var g=(c+d)/2,y=Dt(o,l,g,h),w=y.x,v=y.y;return{x:w,y:v,textAnchor:"middle",verticalAnchor:"middle"}},IH=function(t){var r=t.viewBox,a=t.parentViewBox,s=t.offset,i=t.position,o=r,l=o.x,c=o.y,d=o.width,u=o.height,f=u>=0?1:-1,h=f*s,m=f>0?"end":"start",x=f>0?"start":"end",p=d>=0?1:-1,g=p*s,y=p>0?"end":"start",w=p>0?"start":"end";if(i==="top"){var v={x:l+d/2,y:c-f*s,textAnchor:"middle",verticalAnchor:m};return gr(gr({},v),a?{height:Math.max(c-a.y,0),width:d}:{})}if(i==="bottom"){var _={x:l+d/2,y:c+u+h,textAnchor:"middle",verticalAnchor:x};return gr(gr({},_),a?{height:Math.max(a.y+a.height-(c+u),0),width:d}:{})}if(i==="left"){var b={x:l-g,y:c+u/2,textAnchor:y,verticalAnchor:"middle"};return gr(gr({},b),a?{width:Math.max(b.x-a.x,0),height:u}:{})}if(i==="right"){var j={x:l+d+g,y:c+u/2,textAnchor:w,verticalAnchor:"middle"};return gr(gr({},j),a?{width:Math.max(a.x+a.width-j.x,0),height:u}:{})}var N=a?{width:d,height:u}:{};return i==="insideLeft"?gr({x:l+g,y:c+u/2,textAnchor:w,verticalAnchor:"middle"},N):i==="insideRight"?gr({x:l+d-g,y:c+u/2,textAnchor:y,verticalAnchor:"middle"},N):i==="insideTop"?gr({x:l+d/2,y:c+h,textAnchor:"middle",verticalAnchor:x},N):i==="insideBottom"?gr({x:l+d/2,y:c+u-h,textAnchor:"middle",verticalAnchor:m},N):i==="insideTopLeft"?gr({x:l+g,y:c+h,textAnchor:w,verticalAnchor:x},N):i==="insideTopRight"?gr({x:l+d-g,y:c+h,textAnchor:y,verticalAnchor:x},N):i==="insideBottomLeft"?gr({x:l+g,y:c+u-h,textAnchor:w,verticalAnchor:m},N):i==="insideBottomRight"?gr({x:l+d-g,y:c+u-h,textAnchor:y,verticalAnchor:m},N):Xo(i)&&(be(i.x)||Js(i.x))&&(be(i.y)||Js(i.y))?gr({x:l+na(i.x,d),y:c+na(i.y,u),textAnchor:"end",verticalAnchor:"end"},N):gr({x:l+d/2,y:c+u/2,textAnchor:"middle",verticalAnchor:"middle"},N)},DH=function(t){return"cx"in t&&be(t.cx)};function Er(e){var t=e.offset,r=t===void 0?5:t,a=SH(e,yH),s=gr({offset:r},a),i=s.viewBox,o=s.position,l=s.value,c=s.children,d=s.content,u=s.className,f=u===void 0?"":u,h=s.textBreakAll;if(!i||We(l)&&We(c)&&!O.isValidElement(d)&&!$e(d))return null;if(O.isValidElement(d))return O.cloneElement(d,s);var m;if($e(d)){if(m=O.createElement(d,s),O.isValidElement(m))return m}else m=OH(s);var x=DH(i),p=Ce(s,!0);if(x&&(o==="insideStart"||o==="insideEnd"||o==="end"))return CH(s,m,p);var g=x?FH(s):IH(s);return Z.createElement(yi,Ec({className:qe("recharts-label",f)},p,g,{breakAll:h}),m)}Er.displayName="Label";var I_=function(t){var r=t.cx,a=t.cy,s=t.angle,i=t.startAngle,o=t.endAngle,l=t.r,c=t.radius,d=t.innerRadius,u=t.outerRadius,f=t.x,h=t.y,m=t.top,x=t.left,p=t.width,g=t.height,y=t.clockWise,w=t.labelViewBox;if(w)return w;if(be(p)&&be(g)){if(be(f)&&be(h))return{x:f,y:h,width:p,height:g};if(be(m)&&be(x))return{x:m,y:x,width:p,height:g}}return be(f)&&be(h)?{x:f,y:h,width:0,height:0}:be(r)&&be(a)?{cx:r,cy:a,startAngle:i||s||0,endAngle:o||s||0,innerRadius:d||0,outerRadius:u||c||l||0,clockWise:y}:t.viewBox?t.viewBox:{}},RH=function(t,r){return t?t===!0?Z.createElement(Er,{key:"label-implicit",viewBox:r}):wr(t)?Z.createElement(Er,{key:"label-implicit",viewBox:r,value:t}):O.isValidElement(t)?t.type===Er?O.cloneElement(t,{key:"label-implicit",viewBox:r}):Z.createElement(Er,{key:"label-implicit",content:t,viewBox:r}):$e(t)?Z.createElement(Er,{key:"label-implicit",content:t,viewBox:r}):Xo(t)?Z.createElement(Er,Ec({viewBox:r},t,{key:"label-implicit"})):null:null},MH=function(t,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&a&&!t.label)return null;var s=t.children,i=I_(t),o=Ea(s,Er).map(function(c,d){return O.cloneElement(c,{viewBox:r||i,key:"label-".concat(d)})});if(!a)return o;var l=RH(t.label,r||i);return[l].concat(bH(o))};Er.parseViewBox=I_;Er.renderCallByParent=MH;function $H(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var LH=$H;const BH=kt(LH);function Ac(e){"@babel/helpers - typeof";return Ac=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ac(e)}var UH=["valueAccessor"],WH=["data","dataKey","clockWise","id","textBreakAll"];function HH(e){return KH(e)||GH(e)||VH(e)||zH()}function zH(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VH(e,t){if(e){if(typeof e=="string")return Fm(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Fm(e,t)}}function GH(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function KH(e){if(Array.isArray(e))return Fm(e)}function Fm(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Bu(){return Bu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Bu.apply(this,arguments)}function _b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Sb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_b(Object(r),!0).forEach(function(a){qH(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_b(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function qH(e,t,r){return t=XH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XH(e){var t=YH(e,"string");return Ac(t)=="symbol"?t:t+""}function YH(e,t){if(Ac(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Ac(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kb(e,t){if(e==null)return{};var r=JH(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function JH(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}var ZH=function(t){return Array.isArray(t.value)?BH(t.value):t.value};function _n(e){var t=e.valueAccessor,r=t===void 0?ZH:t,a=kb(e,UH),s=a.data,i=a.dataKey,o=a.clockWise,l=a.id,c=a.textBreakAll,d=kb(a,WH);return!s||!s.length?null:Z.createElement(it,{className:"recharts-label-list"},s.map(function(u,f){var h=We(i)?r(u,f):nr(u&&u.payload,i),m=We(l)?{}:{id:"".concat(l,"-").concat(f)};return Z.createElement(Er,Bu({},Ce(u,!0),d,m,{parentViewBox:u.parentViewBox,value:h,textBreakAll:c,viewBox:Er.parseViewBox(We(o)?u:Sb(Sb({},u),{},{clockWise:o})),key:"label-".concat(f),index:f}))}))}_n.displayName="LabelList";function QH(e,t){return e?e===!0?Z.createElement(_n,{key:"labelList-implicit",data:t}):Z.isValidElement(e)||$e(e)?Z.createElement(_n,{key:"labelList-implicit",data:t,content:e}):Xo(e)?Z.createElement(_n,Bu({data:t},e,{key:"labelList-implicit"})):null:null}function ez(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var a=e.children,s=Ea(a,_n).map(function(o,l){return O.cloneElement(o,{data:t,key:"labelList-".concat(l)})});if(!r)return s;var i=QH(e.label,t);return[i].concat(HH(s))}_n.renderCallByParent=ez;function Tc(e){"@babel/helpers - typeof";return Tc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tc(e)}function Im(){return Im=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Im.apply(this,arguments)}function Eb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Ab(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Eb(Object(r),!0).forEach(function(a){tz(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Eb(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function tz(e,t,r){return t=rz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rz(e){var t=az(e,"string");return Tc(t)=="symbol"?t:t+""}function az(e,t){if(Tc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Tc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nz=function(t,r){var a=aa(r-t),s=Math.min(Math.abs(r-t),359.999);return a*s},Ld=function(t){var r=t.cx,a=t.cy,s=t.radius,i=t.angle,o=t.sign,l=t.isExternal,c=t.cornerRadius,d=t.cornerIsExternal,u=c*(l?1:-1)+s,f=Math.asin(c/u)/Lu,h=d?i:i+o*f,m=Dt(r,a,u,h),x=Dt(r,a,s,h),p=d?i-o*f:i,g=Dt(r,a,u*Math.cos(f*Lu),p);return{center:m,circleTangency:x,lineTangency:g,theta:f}},D_=function(t){var r=t.cx,a=t.cy,s=t.innerRadius,i=t.outerRadius,o=t.startAngle,l=t.endAngle,c=nz(o,l),d=o+c,u=Dt(r,a,i,o),f=Dt(r,a,i,d),h="M ".concat(u.x,",").concat(u.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(o>d),`,
    `).concat(f.x,",").concat(f.y,`
  `);if(s>0){var m=Dt(r,a,s,o),x=Dt(r,a,s,d);h+="L ".concat(x.x,",").concat(x.y,`
            A `).concat(s,",").concat(s,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(o<=d),`,
            `).concat(m.x,",").concat(m.y," Z")}else h+="L ".concat(r,",").concat(a," Z");return h},sz=function(t){var r=t.cx,a=t.cy,s=t.innerRadius,i=t.outerRadius,o=t.cornerRadius,l=t.forceCornerRadius,c=t.cornerIsExternal,d=t.startAngle,u=t.endAngle,f=aa(u-d),h=Ld({cx:r,cy:a,radius:i,angle:d,sign:f,cornerRadius:o,cornerIsExternal:c}),m=h.circleTangency,x=h.lineTangency,p=h.theta,g=Ld({cx:r,cy:a,radius:i,angle:u,sign:-f,cornerRadius:o,cornerIsExternal:c}),y=g.circleTangency,w=g.lineTangency,v=g.theta,_=c?Math.abs(d-u):Math.abs(d-u)-p-v;if(_<0)return l?"M ".concat(x.x,",").concat(x.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):D_({cx:r,cy:a,innerRadius:s,outerRadius:i,startAngle:d,endAngle:u});var b="M ".concat(x.x,",").concat(x.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(_>180),",").concat(+(f<0),",").concat(y.x,",").concat(y.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(w.x,",").concat(w.y,`
  `);if(s>0){var j=Ld({cx:r,cy:a,radius:s,angle:d,sign:f,isExternal:!0,cornerRadius:o,cornerIsExternal:c}),N=j.circleTangency,k=j.lineTangency,S=j.theta,E=Ld({cx:r,cy:a,radius:s,angle:u,sign:-f,isExternal:!0,cornerRadius:o,cornerIsExternal:c}),P=E.circleTangency,C=E.lineTangency,T=E.theta,M=c?Math.abs(d-u):Math.abs(d-u)-S-T;if(M<0&&o===0)return"".concat(b,"L").concat(r,",").concat(a,"Z");b+="L".concat(C.x,",").concat(C.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(P.x,",").concat(P.y,`
      A`).concat(s,",").concat(s,",0,").concat(+(M>180),",").concat(+(f>0),",").concat(N.x,",").concat(N.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(k.x,",").concat(k.y,"Z")}else b+="L".concat(r,",").concat(a,"Z");return b},iz={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},R_=function(t){var r=Ab(Ab({},iz),t),a=r.cx,s=r.cy,i=r.innerRadius,o=r.outerRadius,l=r.cornerRadius,c=r.forceCornerRadius,d=r.cornerIsExternal,u=r.startAngle,f=r.endAngle,h=r.className;if(o<i||u===f)return null;var m=qe("recharts-sector",h),x=o-i,p=na(l,x,0,!0),g;return p>0&&Math.abs(u-f)<360?g=sz({cx:a,cy:s,innerRadius:i,outerRadius:o,cornerRadius:Math.min(p,x/2),forceCornerRadius:c,cornerIsExternal:d,startAngle:u,endAngle:f}):g=D_({cx:a,cy:s,innerRadius:i,outerRadius:o,startAngle:u,endAngle:f}),Z.createElement("path",Im({},Ce(r,!0),{className:m,d:g,role:"img"}))};function Oc(e){"@babel/helpers - typeof";return Oc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oc(e)}function Dm(){return Dm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Dm.apply(this,arguments)}function Tb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Ob(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Tb(Object(r),!0).forEach(function(a){oz(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tb(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function oz(e,t,r){return t=lz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lz(e){var t=cz(e,"string");return Oc(t)=="symbol"?t:t+""}function cz(e,t){if(Oc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Oc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pb={curveBasisClosed:oC,curveBasisOpen:lC,curveBasis:iC,curveBumpX:GP,curveBumpY:KP,curveLinearClosed:cC,curveLinear:Qf,curveMonotoneX:dC,curveMonotoneY:uC,curveNatural:fC,curveStep:hC,curveStepAfter:xC,curveStepBefore:mC},Bd=function(t){return t.x===+t.x&&t.y===+t.y},jl=function(t){return t.x},Nl=function(t){return t.y},dz=function(t,r){if($e(t))return t;var a="curve".concat(Jf(t));return(a==="curveMonotone"||a==="curveBump")&&r?Pb["".concat(a).concat(r==="vertical"?"Y":"X")]:Pb[a]||Qf},uz=function(t){var r=t.type,a=r===void 0?"linear":r,s=t.points,i=s===void 0?[]:s,o=t.baseLine,l=t.layout,c=t.connectNulls,d=c===void 0?!1:c,u=dz(a,l),f=d?i.filter(function(p){return Bd(p)}):i,h;if(Array.isArray(o)){var m=d?o.filter(function(p){return Bd(p)}):o,x=f.map(function(p,g){return Ob(Ob({},p),{},{base:m[g]})});return l==="vertical"?h=Od().y(Nl).x1(jl).x0(function(p){return p.base.x}):h=Od().x(jl).y1(Nl).y0(function(p){return p.base.y}),h.defined(Bd).curve(u),h(x)}return l==="vertical"&&be(o)?h=Od().y(Nl).x1(jl).x0(o):be(o)?h=Od().x(jl).y1(Nl).y0(o):h=O2().x(jl).y(Nl),h.defined(Bd).curve(u),h(f)},oi=function(t){var r=t.className,a=t.points,s=t.path,i=t.pathRef;if((!a||!a.length)&&!s)return null;var o=a&&a.length?uz(t):s;return O.createElement("path",Dm({},Ce(t,!1),du(t),{className:qe("recharts-curve",r),d:o,ref:i}))},M_={exports:{}},fz="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",hz=fz,mz=hz;function $_(){}function L_(){}L_.resetWarningCache=$_;var xz=function(){function e(a,s,i,o,l,c){if(c!==mz){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:L_,resetWarningCache:$_};return r.PropTypes=r,r};M_.exports=xz();var pz=M_.exports;const bt=kt(pz);var gz=Object.getOwnPropertyNames,vz=Object.getOwnPropertySymbols,yz=Object.prototype.hasOwnProperty;function Cb(e,t){return function(a,s,i){return e(a,s,i)&&t(a,s,i)}}function Ud(e){return function(r,a,s){if(!r||!a||typeof r!="object"||typeof a!="object")return e(r,a,s);var i=s.cache,o=i.get(r),l=i.get(a);if(o&&l)return o===a&&l===r;i.set(r,a),i.set(a,r);var c=e(r,a,s);return i.delete(r),i.delete(a),c}}function Fb(e){return gz(e).concat(vz(e))}var bz=Object.hasOwn||function(e,t){return yz.call(e,t)};function Mi(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var wz="__v",jz="__o",Nz="_owner",Ib=Object.getOwnPropertyDescriptor,Db=Object.keys;function _z(e,t,r){var a=e.length;if(t.length!==a)return!1;for(;a-- >0;)if(!r.equals(e[a],t[a],a,a,e,t,r))return!1;return!0}function Sz(e,t){return Mi(e.getTime(),t.getTime())}function kz(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function Ez(e,t){return e===t}function Rb(e,t,r){var a=e.size;if(a!==t.size)return!1;if(!a)return!0;for(var s=new Array(a),i=e.entries(),o,l,c=0;(o=i.next())&&!o.done;){for(var d=t.entries(),u=!1,f=0;(l=d.next())&&!l.done;){if(s[f]){f++;continue}var h=o.value,m=l.value;if(r.equals(h[0],m[0],c,f,e,t,r)&&r.equals(h[1],m[1],h[0],m[0],e,t,r)){u=s[f]=!0;break}f++}if(!u)return!1;c++}return!0}var Az=Mi;function Tz(e,t,r){var a=Db(e),s=a.length;if(Db(t).length!==s)return!1;for(;s-- >0;)if(!B_(e,t,r,a[s]))return!1;return!0}function _l(e,t,r){var a=Fb(e),s=a.length;if(Fb(t).length!==s)return!1;for(var i,o,l;s-- >0;)if(i=a[s],!B_(e,t,r,i)||(o=Ib(e,i),l=Ib(t,i),(o||l)&&(!o||!l||o.configurable!==l.configurable||o.enumerable!==l.enumerable||o.writable!==l.writable)))return!1;return!0}function Oz(e,t){return Mi(e.valueOf(),t.valueOf())}function Pz(e,t){return e.source===t.source&&e.flags===t.flags}function Mb(e,t,r){var a=e.size;if(a!==t.size)return!1;if(!a)return!0;for(var s=new Array(a),i=e.values(),o,l;(o=i.next())&&!o.done;){for(var c=t.values(),d=!1,u=0;(l=c.next())&&!l.done;){if(!s[u]&&r.equals(o.value,l.value,o.value,l.value,e,t,r)){d=s[u]=!0;break}u++}if(!d)return!1}return!0}function Cz(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function Fz(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function B_(e,t,r,a){return(a===Nz||a===jz||a===wz)&&(e.$$typeof||t.$$typeof)?!0:bz(t,a)&&r.equals(e[a],t[a],a,a,e,t,r)}var Iz="[object Arguments]",Dz="[object Boolean]",Rz="[object Date]",Mz="[object Error]",$z="[object Map]",Lz="[object Number]",Bz="[object Object]",Uz="[object RegExp]",Wz="[object Set]",Hz="[object String]",zz="[object URL]",Vz=Array.isArray,$b=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,Lb=Object.assign,Gz=Object.prototype.toString.call.bind(Object.prototype.toString);function Kz(e){var t=e.areArraysEqual,r=e.areDatesEqual,a=e.areErrorsEqual,s=e.areFunctionsEqual,i=e.areMapsEqual,o=e.areNumbersEqual,l=e.areObjectsEqual,c=e.arePrimitiveWrappersEqual,d=e.areRegExpsEqual,u=e.areSetsEqual,f=e.areTypedArraysEqual,h=e.areUrlsEqual;return function(x,p,g){if(x===p)return!0;if(x==null||p==null)return!1;var y=typeof x;if(y!==typeof p)return!1;if(y!=="object")return y==="number"?o(x,p,g):y==="function"?s(x,p,g):!1;var w=x.constructor;if(w!==p.constructor)return!1;if(w===Object)return l(x,p,g);if(Vz(x))return t(x,p,g);if($b!=null&&$b(x))return f(x,p,g);if(w===Date)return r(x,p,g);if(w===RegExp)return d(x,p,g);if(w===Map)return i(x,p,g);if(w===Set)return u(x,p,g);var v=Gz(x);return v===Rz?r(x,p,g):v===Uz?d(x,p,g):v===$z?i(x,p,g):v===Wz?u(x,p,g):v===Bz?typeof x.then!="function"&&typeof p.then!="function"&&l(x,p,g):v===zz?h(x,p,g):v===Mz?a(x,p,g):v===Iz?l(x,p,g):v===Dz||v===Lz||v===Hz?c(x,p,g):!1}}function qz(e){var t=e.circular,r=e.createCustomConfig,a=e.strict,s={areArraysEqual:a?_l:_z,areDatesEqual:Sz,areErrorsEqual:kz,areFunctionsEqual:Ez,areMapsEqual:a?Cb(Rb,_l):Rb,areNumbersEqual:Az,areObjectsEqual:a?_l:Tz,arePrimitiveWrappersEqual:Oz,areRegExpsEqual:Pz,areSetsEqual:a?Cb(Mb,_l):Mb,areTypedArraysEqual:a?_l:Cz,areUrlsEqual:Fz};if(r&&(s=Lb({},s,r(s))),t){var i=Ud(s.areArraysEqual),o=Ud(s.areMapsEqual),l=Ud(s.areObjectsEqual),c=Ud(s.areSetsEqual);s=Lb({},s,{areArraysEqual:i,areMapsEqual:o,areObjectsEqual:l,areSetsEqual:c})}return s}function Xz(e){return function(t,r,a,s,i,o,l){return e(t,r,l)}}function Yz(e){var t=e.circular,r=e.comparator,a=e.createState,s=e.equals,i=e.strict;if(a)return function(c,d){var u=a(),f=u.cache,h=f===void 0?t?new WeakMap:void 0:f,m=u.meta;return r(c,d,{cache:h,equals:s,meta:m,strict:i})};if(t)return function(c,d){return r(c,d,{cache:new WeakMap,equals:s,meta:void 0,strict:i})};var o={cache:void 0,equals:s,meta:void 0,strict:i};return function(c,d){return r(c,d,o)}}var Jz=Fs();Fs({strict:!0});Fs({circular:!0});Fs({circular:!0,strict:!0});Fs({createInternalComparator:function(){return Mi}});Fs({strict:!0,createInternalComparator:function(){return Mi}});Fs({circular:!0,createInternalComparator:function(){return Mi}});Fs({circular:!0,createInternalComparator:function(){return Mi},strict:!0});function Fs(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,a=e.createInternalComparator,s=e.createState,i=e.strict,o=i===void 0?!1:i,l=qz(e),c=Kz(l),d=a?a(c):Xz(c);return Yz({circular:r,comparator:c,createState:s,equals:d,strict:o})}function Zz(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function Bb(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,a=function s(i){r<0&&(r=i),i-r>t?(e(i),r=-1):Zz(s)};requestAnimationFrame(a)}function Rm(e){"@babel/helpers - typeof";return Rm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rm(e)}function Qz(e){return aV(e)||rV(e)||tV(e)||eV()}function eV(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tV(e,t){if(e){if(typeof e=="string")return Ub(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ub(e,t)}}function Ub(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function rV(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function aV(e){if(Array.isArray(e))return e}function nV(){var e={},t=function(){return null},r=!1,a=function s(i){if(!r){if(Array.isArray(i)){if(!i.length)return;var o=i,l=Qz(o),c=l[0],d=l.slice(1);if(typeof c=="number"){Bb(s.bind(null,d),c);return}s(c),Bb(s.bind(null,d));return}Rm(i)==="object"&&(e=i,t(e)),typeof i=="function"&&i()}};return{stop:function(){r=!0},start:function(i){r=!1,a(i)},subscribe:function(i){return t=i,function(){t=function(){return null}}}}}function Pc(e){"@babel/helpers - typeof";return Pc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pc(e)}function Wb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Hb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Wb(Object(r),!0).forEach(function(a){U_(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Wb(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function U_(e,t,r){return t=sV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sV(e){var t=iV(e,"string");return Pc(t)==="symbol"?t:String(t)}function iV(e,t){if(Pc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Pc(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oV=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(a,s){return a.filter(function(i){return s.includes(i)})})},lV=function(t){return t},cV=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},Hl=function(t,r){return Object.keys(r).reduce(function(a,s){return Hb(Hb({},a),{},U_({},s,t(s,r[s])))},{})},zb=function(t,r,a){return t.map(function(s){return"".concat(cV(s)," ").concat(r,"ms ").concat(a)}).join(",")};function dV(e,t){return hV(e)||fV(e,t)||W_(e,t)||uV()}function uV(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fV(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function hV(e){if(Array.isArray(e))return e}function mV(e){return gV(e)||pV(e)||W_(e)||xV()}function xV(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function W_(e,t){if(e){if(typeof e=="string")return Mm(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Mm(e,t)}}function pV(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function gV(e){if(Array.isArray(e))return Mm(e)}function Mm(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var Uu=1e-4,H_=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},z_=function(t,r){return t.map(function(a,s){return a*Math.pow(r,s)}).reduce(function(a,s){return a+s})},Vb=function(t,r){return function(a){var s=H_(t,r);return z_(s,a)}},vV=function(t,r){return function(a){var s=H_(t,r),i=[].concat(mV(s.map(function(o,l){return o*l}).slice(1)),[0]);return z_(i,a)}},Gb=function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];var s=r[0],i=r[1],o=r[2],l=r[3];if(r.length===1)switch(r[0]){case"linear":s=0,i=0,o=1,l=1;break;case"ease":s=.25,i=.1,o=.25,l=1;break;case"ease-in":s=.42,i=0,o=1,l=1;break;case"ease-out":s=.42,i=0,o=.58,l=1;break;case"ease-in-out":s=0,i=0,o=.58,l=1;break;default:{var c=r[0].split("(");if(c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4){var d=c[1].split(")")[0].split(",").map(function(g){return parseFloat(g)}),u=dV(d,4);s=u[0],i=u[1],o=u[2],l=u[3]}}}var f=Vb(s,o),h=Vb(i,l),m=vV(s,o),x=function(y){return y>1?1:y<0?0:y},p=function(y){for(var w=y>1?1:y,v=w,_=0;_<8;++_){var b=f(v)-w,j=m(v);if(Math.abs(b-w)<Uu||j<Uu)return h(v);v=x(v-b/j)}return h(v)};return p.isStepper=!1,p},yV=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,a=r===void 0?100:r,s=t.damping,i=s===void 0?8:s,o=t.dt,l=o===void 0?17:o,c=function(u,f,h){var m=-(u-f)*a,x=h*i,p=h+(m-x)*l/1e3,g=h*l/1e3+u;return Math.abs(g-f)<Uu&&Math.abs(p)<Uu?[f,0]:[g,p]};return c.isStepper=!0,c.dt=l,c},bV=function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];var s=r[0];if(typeof s=="string")switch(s){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Gb(s);case"spring":return yV();default:if(s.split("(")[0]==="cubic-bezier")return Gb(s)}return typeof s=="function"?s:null};function Cc(e){"@babel/helpers - typeof";return Cc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cc(e)}function Kb(e){return NV(e)||jV(e)||V_(e)||wV()}function wV(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jV(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function NV(e){if(Array.isArray(e))return Lm(e)}function qb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Dr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qb(Object(r),!0).forEach(function(a){$m(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qb(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function $m(e,t,r){return t=_V(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _V(e){var t=SV(e,"string");return Cc(t)==="symbol"?t:String(t)}function SV(e,t){if(Cc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Cc(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kV(e,t){return TV(e)||AV(e,t)||V_(e,t)||EV()}function EV(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function V_(e,t){if(e){if(typeof e=="string")return Lm(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Lm(e,t)}}function Lm(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function AV(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function TV(e){if(Array.isArray(e))return e}var Wu=function(t,r,a){return t+(r-t)*a},Bm=function(t){var r=t.from,a=t.to;return r!==a},OV=function e(t,r,a){var s=Hl(function(i,o){if(Bm(o)){var l=t(o.from,o.to,o.velocity),c=kV(l,2),d=c[0],u=c[1];return Dr(Dr({},o),{},{from:d,velocity:u})}return o},r);return a<1?Hl(function(i,o){return Bm(o)?Dr(Dr({},o),{},{velocity:Wu(o.velocity,s[i].velocity,a),from:Wu(o.from,s[i].from,a)}):o},r):e(t,s,a-1)};const PV=function(e,t,r,a,s){var i=oV(e,t),o=i.reduce(function(g,y){return Dr(Dr({},g),{},$m({},y,[e[y],t[y]]))},{}),l=i.reduce(function(g,y){return Dr(Dr({},g),{},$m({},y,{from:e[y],velocity:0,to:t[y]}))},{}),c=-1,d,u,f=function(){return null},h=function(){return Hl(function(y,w){return w.from},l)},m=function(){return!Object.values(l).filter(Bm).length},x=function(y){d||(d=y);var w=y-d,v=w/r.dt;l=OV(r,l,v),s(Dr(Dr(Dr({},e),t),h())),d=y,m()||(c=requestAnimationFrame(f))},p=function(y){u||(u=y);var w=(y-u)/a,v=Hl(function(b,j){return Wu.apply(void 0,Kb(j).concat([r(w)]))},o);if(s(Dr(Dr(Dr({},e),t),v)),w<1)c=requestAnimationFrame(f);else{var _=Hl(function(b,j){return Wu.apply(void 0,Kb(j).concat([r(1)]))},o);s(Dr(Dr(Dr({},e),t),_))}};return f=r.isStepper?x:p,function(){return requestAnimationFrame(f),function(){cancelAnimationFrame(c)}}};function So(e){"@babel/helpers - typeof";return So=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},So(e)}var CV=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function FV(e,t){if(e==null)return{};var r=IV(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function IV(e,t){if(e==null)return{};var r={},a=Object.keys(e),s,i;for(i=0;i<a.length;i++)s=a[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function uh(e){return $V(e)||MV(e)||RV(e)||DV()}function DV(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RV(e,t){if(e){if(typeof e=="string")return Um(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Um(e,t)}}function MV(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function $V(e){if(Array.isArray(e))return Um(e)}function Um(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Xb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Za(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Xb(Object(r),!0).forEach(function(a){Pl(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xb(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Pl(e,t,r){return t=G_(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LV(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BV(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,G_(a.key),a)}}function UV(e,t,r){return t&&BV(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function G_(e){var t=WV(e,"string");return So(t)==="symbol"?t:String(t)}function WV(e,t){if(So(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(So(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HV(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Wm(e,t)}function Wm(e,t){return Wm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Wm(e,t)}function zV(e){var t=VV();return function(){var a=Hu(e),s;if(t){var i=Hu(this).constructor;s=Reflect.construct(a,arguments,i)}else s=a.apply(this,arguments);return Hm(this,s)}}function Hm(e,t){if(t&&(So(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zm(e)}function zm(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hu(e){return Hu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hu(e)}var dn=function(e){HV(r,e);var t=zV(r);function r(a,s){var i;LV(this,r),i=t.call(this,a,s);var o=i.props,l=o.isActive,c=o.attributeName,d=o.from,u=o.to,f=o.steps,h=o.children,m=o.duration;if(i.handleStyleChange=i.handleStyleChange.bind(zm(i)),i.changeStyle=i.changeStyle.bind(zm(i)),!l||m<=0)return i.state={style:{}},typeof h=="function"&&(i.state={style:u}),Hm(i);if(f&&f.length)i.state={style:f[0].style};else if(d){if(typeof h=="function")return i.state={style:d},Hm(i);i.state={style:c?Pl({},c,d):d}}else i.state={style:{}};return i}return UV(r,[{key:"componentDidMount",value:function(){var s=this.props,i=s.isActive,o=s.canBegin;this.mounted=!0,!(!i||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(s){var i=this.props,o=i.isActive,l=i.canBegin,c=i.attributeName,d=i.shouldReAnimate,u=i.to,f=i.from,h=this.state.style;if(l){if(!o){var m={style:c?Pl({},c,u):u};this.state&&h&&(c&&h[c]!==u||!c&&h!==u)&&this.setState(m);return}if(!(Jz(s.to,u)&&s.canBegin&&s.isActive)){var x=!s.canBegin||!s.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var p=x||d?f:s.to;if(this.state&&h){var g={style:c?Pl({},c,p):p};(c&&h[c]!==p||!c&&h!==p)&&this.setState(g)}this.runAnimation(Za(Za({},this.props),{},{from:p,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var s=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),s&&s()}},{key:"handleStyleChange",value:function(s){this.changeStyle(s)}},{key:"changeStyle",value:function(s){this.mounted&&this.setState({style:s})}},{key:"runJSAnimation",value:function(s){var i=this,o=s.from,l=s.to,c=s.duration,d=s.easing,u=s.begin,f=s.onAnimationEnd,h=s.onAnimationStart,m=PV(o,l,bV(d),c,this.changeStyle),x=function(){i.stopJSAnimation=m()};this.manager.start([h,u,x,c,f])}},{key:"runStepAnimation",value:function(s){var i=this,o=s.steps,l=s.begin,c=s.onAnimationStart,d=o[0],u=d.style,f=d.duration,h=f===void 0?0:f,m=function(p,g,y){if(y===0)return p;var w=g.duration,v=g.easing,_=v===void 0?"ease":v,b=g.style,j=g.properties,N=g.onAnimationEnd,k=y>0?o[y-1]:g,S=j||Object.keys(b);if(typeof _=="function"||_==="spring")return[].concat(uh(p),[i.runJSAnimation.bind(i,{from:k.style,to:b,duration:w,easing:_}),w]);var E=zb(S,w,_),P=Za(Za(Za({},k.style),b),{},{transition:E});return[].concat(uh(p),[P,w,N]).filter(lV)};return this.manager.start([c].concat(uh(o.reduce(m,[u,Math.max(h,l)])),[s.onAnimationEnd]))}},{key:"runAnimation",value:function(s){this.manager||(this.manager=nV());var i=s.begin,o=s.duration,l=s.attributeName,c=s.to,d=s.easing,u=s.onAnimationStart,f=s.onAnimationEnd,h=s.steps,m=s.children,x=this.manager;if(this.unSubscribe=x.subscribe(this.handleStyleChange),typeof d=="function"||typeof m=="function"||d==="spring"){this.runJSAnimation(s);return}if(h.length>1){this.runStepAnimation(s);return}var p=l?Pl({},l,c):c,g=zb(Object.keys(p),o,d);x.start([u,i,Za(Za({},p),{},{transition:g}),o,f])}},{key:"render",value:function(){var s=this.props,i=s.children;s.begin;var o=s.duration;s.attributeName,s.easing;var l=s.isActive;s.steps,s.from,s.to,s.canBegin,s.onAnimationEnd,s.shouldReAnimate,s.onAnimationReStart;var c=FV(s,CV),d=O.Children.count(i),u=this.state.style;if(typeof i=="function")return i(u);if(!l||d===0||o<=0)return i;var f=function(m){var x=m.props,p=x.style,g=p===void 0?{}:p,y=x.className,w=O.cloneElement(m,Za(Za({},c),{},{style:Za(Za({},g),u),className:y}));return w};return d===1?f(O.Children.only(i)):Z.createElement("div",null,O.Children.map(i,function(h){return f(h)}))}}]),r}(O.PureComponent);dn.displayName="Animate";dn.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};dn.propTypes={from:bt.oneOfType([bt.object,bt.string]),to:bt.oneOfType([bt.object,bt.string]),attributeName:bt.string,duration:bt.number,begin:bt.number,easing:bt.oneOfType([bt.string,bt.func]),steps:bt.arrayOf(bt.shape({duration:bt.number.isRequired,style:bt.object.isRequired,easing:bt.oneOfType([bt.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),bt.func]),properties:bt.arrayOf("string"),onAnimationEnd:bt.func})),children:bt.oneOfType([bt.node,bt.func]),isActive:bt.bool,canBegin:bt.bool,onAnimationEnd:bt.func,shouldReAnimate:bt.bool,onAnimationStart:bt.func,onAnimationReStart:bt.func};function Fc(e){"@babel/helpers - typeof";return Fc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fc(e)}function zu(){return zu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},zu.apply(this,arguments)}function GV(e,t){return YV(e)||XV(e,t)||qV(e,t)||KV()}function KV(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qV(e,t){if(e){if(typeof e=="string")return Yb(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Yb(e,t)}}function Yb(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function XV(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function YV(e){if(Array.isArray(e))return e}function Jb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Zb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Jb(Object(r),!0).forEach(function(a){JV(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jb(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function JV(e,t,r){return t=ZV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZV(e){var t=QV(e,"string");return Fc(t)=="symbol"?t:t+""}function QV(e,t){if(Fc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Fc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qb=function(t,r,a,s,i){var o=Math.min(Math.abs(a)/2,Math.abs(s)/2),l=s>=0?1:-1,c=a>=0?1:-1,d=s>=0&&a>=0||s<0&&a<0?1:0,u;if(o>0&&i instanceof Array){for(var f=[0,0,0,0],h=0,m=4;h<m;h++)f[h]=i[h]>o?o:i[h];u="M".concat(t,",").concat(r+l*f[0]),f[0]>0&&(u+="A ".concat(f[0],",").concat(f[0],",0,0,").concat(d,",").concat(t+c*f[0],",").concat(r)),u+="L ".concat(t+a-c*f[1],",").concat(r),f[1]>0&&(u+="A ".concat(f[1],",").concat(f[1],",0,0,").concat(d,`,
        `).concat(t+a,",").concat(r+l*f[1])),u+="L ".concat(t+a,",").concat(r+s-l*f[2]),f[2]>0&&(u+="A ".concat(f[2],",").concat(f[2],",0,0,").concat(d,`,
        `).concat(t+a-c*f[2],",").concat(r+s)),u+="L ".concat(t+c*f[3],",").concat(r+s),f[3]>0&&(u+="A ".concat(f[3],",").concat(f[3],",0,0,").concat(d,`,
        `).concat(t,",").concat(r+s-l*f[3])),u+="Z"}else if(o>0&&i===+i&&i>0){var x=Math.min(o,i);u="M ".concat(t,",").concat(r+l*x,`
            A `).concat(x,",").concat(x,",0,0,").concat(d,",").concat(t+c*x,",").concat(r,`
            L `).concat(t+a-c*x,",").concat(r,`
            A `).concat(x,",").concat(x,",0,0,").concat(d,",").concat(t+a,",").concat(r+l*x,`
            L `).concat(t+a,",").concat(r+s-l*x,`
            A `).concat(x,",").concat(x,",0,0,").concat(d,",").concat(t+a-c*x,",").concat(r+s,`
            L `).concat(t+c*x,",").concat(r+s,`
            A `).concat(x,",").concat(x,",0,0,").concat(d,",").concat(t,",").concat(r+s-l*x," Z")}else u="M ".concat(t,",").concat(r," h ").concat(a," v ").concat(s," h ").concat(-a," Z");return u},eG=function(t,r){if(!t||!r)return!1;var a=t.x,s=t.y,i=r.x,o=r.y,l=r.width,c=r.height;if(Math.abs(l)>0&&Math.abs(c)>0){var d=Math.min(i,i+l),u=Math.max(i,i+l),f=Math.min(o,o+c),h=Math.max(o,o+c);return a>=d&&a<=u&&s>=f&&s<=h}return!1},tG={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Lp=function(t){var r=Zb(Zb({},tG),t),a=O.useRef(),s=O.useState(-1),i=GV(s,2),o=i[0],l=i[1];O.useEffect(function(){if(a.current&&a.current.getTotalLength)try{var _=a.current.getTotalLength();_&&l(_)}catch{}},[]);var c=r.x,d=r.y,u=r.width,f=r.height,h=r.radius,m=r.className,x=r.animationEasing,p=r.animationDuration,g=r.animationBegin,y=r.isAnimationActive,w=r.isUpdateAnimationActive;if(c!==+c||d!==+d||u!==+u||f!==+f||u===0||f===0)return null;var v=qe("recharts-rectangle",m);return w?Z.createElement(dn,{canBegin:o>0,from:{width:u,height:f,x:c,y:d},to:{width:u,height:f,x:c,y:d},duration:p,animationEasing:x,isActive:w},function(_){var b=_.width,j=_.height,N=_.x,k=_.y;return Z.createElement(dn,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:g,duration:p,isActive:y,easing:x},Z.createElement("path",zu({},Ce(r,!0),{className:v,d:Qb(N,k,b,j,h),ref:a})))}):Z.createElement("path",zu({},Ce(r,!0),{className:v,d:Qb(c,d,u,f,h)}))},rG=["points","className","baseLinePoints","connectNulls"];function to(){return to=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},to.apply(this,arguments)}function aG(e,t){if(e==null)return{};var r=nG(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function nG(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function e1(e){return lG(e)||oG(e)||iG(e)||sG()}function sG(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iG(e,t){if(e){if(typeof e=="string")return Vm(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Vm(e,t)}}function oG(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function lG(e){if(Array.isArray(e))return Vm(e)}function Vm(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var t1=function(t){return t&&t.x===+t.x&&t.y===+t.y},cG=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return t.forEach(function(a){t1(a)?r[r.length-1].push(a):r[r.length-1].length>0&&r.push([])}),t1(t[0])&&r[r.length-1].push(t[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},zl=function(t,r){var a=cG(t);r&&(a=[a.reduce(function(i,o){return[].concat(e1(i),e1(o))},[])]);var s=a.map(function(i){return i.reduce(function(o,l,c){return"".concat(o).concat(c===0?"M":"L").concat(l.x,",").concat(l.y)},"")}).join("");return a.length===1?"".concat(s,"Z"):s},dG=function(t,r,a){var s=zl(t,a);return"".concat(s.slice(-1)==="Z"?s.slice(0,-1):s,"L").concat(zl(r.reverse(),a).slice(1))},uG=function(t){var r=t.points,a=t.className,s=t.baseLinePoints,i=t.connectNulls,o=aG(t,rG);if(!r||!r.length)return null;var l=qe("recharts-polygon",a);if(s&&s.length){var c=o.stroke&&o.stroke!=="none",d=dG(r,s,i);return Z.createElement("g",{className:l},Z.createElement("path",to({},Ce(o,!0),{fill:d.slice(-1)==="Z"?o.fill:"none",stroke:"none",d})),c?Z.createElement("path",to({},Ce(o,!0),{fill:"none",d:zl(r,i)})):null,c?Z.createElement("path",to({},Ce(o,!0),{fill:"none",d:zl(s,i)})):null)}var u=zl(r,i);return Z.createElement("path",to({},Ce(o,!0),{fill:u.slice(-1)==="Z"?o.fill:"none",className:l,d:u}))};function Gm(){return Gm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Gm.apply(this,arguments)}var gd=function(t){var r=t.cx,a=t.cy,s=t.r,i=t.className,o=qe("recharts-dot",i);return r===+r&&a===+a&&s===+s?O.createElement("circle",Gm({},Ce(t,!1),du(t),{className:o,cx:r,cy:a,r:s})):null};function Ic(e){"@babel/helpers - typeof";return Ic=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ic(e)}var fG=["x","y","top","left","width","height","className"];function Km(){return Km=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Km.apply(this,arguments)}function r1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function hG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?r1(Object(r),!0).forEach(function(a){mG(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):r1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function mG(e,t,r){return t=xG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xG(e){var t=pG(e,"string");return Ic(t)=="symbol"?t:t+""}function pG(e,t){if(Ic(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Ic(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gG(e,t){if(e==null)return{};var r=vG(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function vG(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}var yG=function(t,r,a,s,i,o){return"M".concat(t,",").concat(i,"v").concat(s,"M").concat(o,",").concat(r,"h").concat(a)},bG=function(t){var r=t.x,a=r===void 0?0:r,s=t.y,i=s===void 0?0:s,o=t.top,l=o===void 0?0:o,c=t.left,d=c===void 0?0:c,u=t.width,f=u===void 0?0:u,h=t.height,m=h===void 0?0:h,x=t.className,p=gG(t,fG),g=hG({x:a,y:i,top:l,left:d,width:f,height:m},p);return!be(a)||!be(i)||!be(f)||!be(m)||!be(l)||!be(d)?null:Z.createElement("path",Km({},Ce(g,!0),{className:qe("recharts-cross",x),d:yG(a,i,f,m,l,d)}))},wG=u0,jG=n_,NG=On;function _G(e,t){return e&&e.length?wG(e,NG(t),jG):void 0}var SG=_G;const kG=kt(SG);var EG=u0,AG=On,TG=s_;function OG(e,t){return e&&e.length?EG(e,AG(t),TG):void 0}var PG=OG;const CG=kt(PG);var FG=["cx","cy","angle","ticks","axisLine"],IG=["ticks","tick","angle","tickFormatter","stroke"];function ko(e){"@babel/helpers - typeof";return ko=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ko(e)}function Vl(){return Vl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Vl.apply(this,arguments)}function a1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Bs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?a1(Object(r),!0).forEach(function(a){x0(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function n1(e,t){if(e==null)return{};var r=DG(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function DG(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function RG(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s1(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,q_(a.key),a)}}function MG(e,t,r){return t&&s1(e.prototype,t),r&&s1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $G(e,t,r){return t=Vu(t),LG(e,K_()?Reflect.construct(t,r||[],Vu(e).constructor):t.apply(e,r))}function LG(e,t){if(t&&(ko(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BG(e)}function BG(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function K_(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(K_=function(){return!!e})()}function Vu(e){return Vu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vu(e)}function UG(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qm(e,t)}function qm(e,t){return qm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},qm(e,t)}function x0(e,t,r){return t=q_(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function q_(e){var t=WG(e,"string");return ko(t)=="symbol"?t:t+""}function WG(e,t){if(ko(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(ko(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var p0=function(e){function t(){return RG(this,t),$G(this,t,arguments)}return UG(t,e),MG(t,[{key:"getTickValueCoord",value:function(a){var s=a.coordinate,i=this.props,o=i.angle,l=i.cx,c=i.cy;return Dt(l,c,s,o)}},{key:"getTickTextAnchor",value:function(){var a=this.props.orientation,s;switch(a){case"left":s="end";break;case"right":s="start";break;default:s="middle";break}return s}},{key:"getViewBox",value:function(){var a=this.props,s=a.cx,i=a.cy,o=a.angle,l=a.ticks,c=kG(l,function(u){return u.coordinate||0}),d=CG(l,function(u){return u.coordinate||0});return{cx:s,cy:i,startAngle:o,endAngle:o,innerRadius:d.coordinate||0,outerRadius:c.coordinate||0}}},{key:"renderAxisLine",value:function(){var a=this.props,s=a.cx,i=a.cy,o=a.angle,l=a.ticks,c=a.axisLine,d=n1(a,FG),u=l.reduce(function(x,p){return[Math.min(x[0],p.coordinate),Math.max(x[1],p.coordinate)]},[1/0,-1/0]),f=Dt(s,i,u[0],o),h=Dt(s,i,u[1],o),m=Bs(Bs(Bs({},Ce(d,!1)),{},{fill:"none"},Ce(c,!1)),{},{x1:f.x,y1:f.y,x2:h.x,y2:h.y});return Z.createElement("line",Vl({className:"recharts-polar-radius-axis-line"},m))}},{key:"renderTicks",value:function(){var a=this,s=this.props,i=s.ticks,o=s.tick,l=s.angle,c=s.tickFormatter,d=s.stroke,u=n1(s,IG),f=this.getTickTextAnchor(),h=Ce(u,!1),m=Ce(o,!1),x=i.map(function(p,g){var y=a.getTickValueCoord(p),w=Bs(Bs(Bs(Bs({textAnchor:f,transform:"rotate(".concat(90-l,", ").concat(y.x,", ").concat(y.y,")")},h),{},{stroke:"none",fill:d},m),{},{index:g},y),{},{payload:p});return Z.createElement(it,Vl({className:qe("recharts-polar-radius-axis-tick",F_(o)),key:"tick-".concat(p.coordinate)},vi(a.props,p,g)),t.renderTickItem(o,w,c?c(p.value,g):p.value))});return Z.createElement(it,{className:"recharts-polar-radius-axis-ticks"},x)}},{key:"render",value:function(){var a=this.props,s=a.ticks,i=a.axisLine,o=a.tick;return!s||!s.length?null:Z.createElement(it,{className:qe("recharts-polar-radius-axis",this.props.className)},i&&this.renderAxisLine(),o&&this.renderTicks(),Er.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(a,s,i){var o;return Z.isValidElement(a)?o=Z.cloneElement(a,s):$e(a)?o=a(s):o=Z.createElement(yi,Vl({},s,{className:"recharts-polar-radius-axis-tick-value"}),i),o}}])}(O.PureComponent);x0(p0,"displayName","PolarRadiusAxis");x0(p0,"axisType","radiusAxis");x0(p0,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function Eo(e){"@babel/helpers - typeof";return Eo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eo(e)}function Vs(){return Vs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Vs.apply(this,arguments)}function i1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Us(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i1(Object(r),!0).forEach(function(a){g0(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function HG(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o1(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,Y_(a.key),a)}}function zG(e,t,r){return t&&o1(e.prototype,t),r&&o1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VG(e,t,r){return t=Gu(t),GG(e,X_()?Reflect.construct(t,r||[],Gu(e).constructor):t.apply(e,r))}function GG(e,t){if(t&&(Eo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KG(e)}function KG(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function X_(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(X_=function(){return!!e})()}function Gu(e){return Gu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Gu(e)}function qG(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xm(e,t)}function Xm(e,t){return Xm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Xm(e,t)}function g0(e,t,r){return t=Y_(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Y_(e){var t=XG(e,"string");return Eo(t)=="symbol"?t:t+""}function XG(e,t){if(Eo(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Eo(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var YG=Math.PI/180,l1=1e-5,v0=function(e){function t(){return HG(this,t),VG(this,t,arguments)}return qG(t,e),zG(t,[{key:"getTickLineCoord",value:function(a){var s=this.props,i=s.cx,o=s.cy,l=s.radius,c=s.orientation,d=s.tickSize,u=d||8,f=Dt(i,o,l,a.coordinate),h=Dt(i,o,l+(c==="inner"?-1:1)*u,a.coordinate);return{x1:f.x,y1:f.y,x2:h.x,y2:h.y}}},{key:"getTickTextAnchor",value:function(a){var s=this.props.orientation,i=Math.cos(-a.coordinate*YG),o;return i>l1?o=s==="outer"?"start":"end":i<-l1?o=s==="outer"?"end":"start":o="middle",o}},{key:"renderAxisLine",value:function(){var a=this.props,s=a.cx,i=a.cy,o=a.radius,l=a.axisLine,c=a.axisLineType,d=Us(Us({},Ce(this.props,!1)),{},{fill:"none"},Ce(l,!1));if(c==="circle")return Z.createElement(gd,Vs({className:"recharts-polar-angle-axis-line"},d,{cx:s,cy:i,r:o}));var u=this.props.ticks,f=u.map(function(h){return Dt(s,i,o,h.coordinate)});return Z.createElement(uG,Vs({className:"recharts-polar-angle-axis-line"},d,{points:f}))}},{key:"renderTicks",value:function(){var a=this,s=this.props,i=s.ticks,o=s.tick,l=s.tickLine,c=s.tickFormatter,d=s.stroke,u=Ce(this.props,!1),f=Ce(o,!1),h=Us(Us({},u),{},{fill:"none"},Ce(l,!1)),m=i.map(function(x,p){var g=a.getTickLineCoord(x),y=a.getTickTextAnchor(x),w=Us(Us(Us({textAnchor:y},u),{},{stroke:"none",fill:d},f),{},{index:p,payload:x,x:g.x2,y:g.y2});return Z.createElement(it,Vs({className:qe("recharts-polar-angle-axis-tick",F_(o)),key:"tick-".concat(x.coordinate)},vi(a.props,x,p)),l&&Z.createElement("line",Vs({className:"recharts-polar-angle-axis-tick-line"},h,g)),o&&t.renderTickItem(o,w,c?c(x.value,p):x.value))});return Z.createElement(it,{className:"recharts-polar-angle-axis-ticks"},m)}},{key:"render",value:function(){var a=this.props,s=a.ticks,i=a.radius,o=a.axisLine;return i<=0||!s||!s.length?null:Z.createElement(it,{className:qe("recharts-polar-angle-axis",this.props.className)},o&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(a,s,i){var o;return Z.isValidElement(a)?o=Z.cloneElement(a,s):$e(a)?o=a(s):o=Z.createElement(yi,Vs({},s,{className:"recharts-polar-angle-axis-tick-value"}),i),o}}])}(O.PureComponent);g0(v0,"displayName","PolarAngleAxis");g0(v0,"axisType","angleAxis");g0(v0,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var JG=eN,ZG=JG(Object.getPrototypeOf,Object),QG=ZG,eK=as,tK=QG,rK=ns,aK="[object Object]",nK=Function.prototype,sK=Object.prototype,J_=nK.toString,iK=sK.hasOwnProperty,oK=J_.call(Object);function lK(e){if(!rK(e)||eK(e)!=aK)return!1;var t=tK(e);if(t===null)return!0;var r=iK.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&J_.call(r)==oK}var cK=lK;const dK=kt(cK);var uK=as,fK=ns,hK="[object Boolean]";function mK(e){return e===!0||e===!1||fK(e)&&uK(e)==hK}var xK=mK;const pK=kt(xK);function Dc(e){"@babel/helpers - typeof";return Dc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dc(e)}function Ku(){return Ku=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Ku.apply(this,arguments)}function gK(e,t){return wK(e)||bK(e,t)||yK(e,t)||vK()}function vK(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yK(e,t){if(e){if(typeof e=="string")return c1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c1(e,t)}}function c1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function bK(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function wK(e){if(Array.isArray(e))return e}function d1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function u1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?d1(Object(r),!0).forEach(function(a){jK(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function jK(e,t,r){return t=NK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NK(e){var t=_K(e,"string");return Dc(t)=="symbol"?t:t+""}function _K(e,t){if(Dc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Dc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var f1=function(t,r,a,s,i){var o=a-s,l;return l="M ".concat(t,",").concat(r),l+="L ".concat(t+a,",").concat(r),l+="L ".concat(t+a-o/2,",").concat(r+i),l+="L ".concat(t+a-o/2-s,",").concat(r+i),l+="L ".concat(t,",").concat(r," Z"),l},SK={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},kK=function(t){var r=u1(u1({},SK),t),a=O.useRef(),s=O.useState(-1),i=gK(s,2),o=i[0],l=i[1];O.useEffect(function(){if(a.current&&a.current.getTotalLength)try{var v=a.current.getTotalLength();v&&l(v)}catch{}},[]);var c=r.x,d=r.y,u=r.upperWidth,f=r.lowerWidth,h=r.height,m=r.className,x=r.animationEasing,p=r.animationDuration,g=r.animationBegin,y=r.isUpdateAnimationActive;if(c!==+c||d!==+d||u!==+u||f!==+f||h!==+h||u===0&&f===0||h===0)return null;var w=qe("recharts-trapezoid",m);return y?Z.createElement(dn,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:h,x:c,y:d},to:{upperWidth:u,lowerWidth:f,height:h,x:c,y:d},duration:p,animationEasing:x,isActive:y},function(v){var _=v.upperWidth,b=v.lowerWidth,j=v.height,N=v.x,k=v.y;return Z.createElement(dn,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:g,duration:p,easing:x},Z.createElement("path",Ku({},Ce(r,!0),{className:w,d:f1(N,k,_,b,j),ref:a})))}):Z.createElement("g",null,Z.createElement("path",Ku({},Ce(r,!0),{className:w,d:f1(c,d,u,f,h)})))},EK=["option","shapeType","propTransformer","activeClassName","isActive"];function Rc(e){"@babel/helpers - typeof";return Rc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rc(e)}function AK(e,t){if(e==null)return{};var r=TK(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function TK(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function h1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function qu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?h1(Object(r),!0).forEach(function(a){OK(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function OK(e,t,r){return t=PK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PK(e){var t=CK(e,"string");return Rc(t)=="symbol"?t:t+""}function CK(e,t){if(Rc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Rc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function FK(e,t){return qu(qu({},t),e)}function IK(e,t){return e==="symbols"}function m1(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return Z.createElement(Lp,r);case"trapezoid":return Z.createElement(kK,r);case"sector":return Z.createElement(R_,r);case"symbols":if(IK(t))return Z.createElement(np,r);break;default:return null}}function DK(e){return O.isValidElement(e)?e.props:e}function Z_(e){var t=e.option,r=e.shapeType,a=e.propTransformer,s=a===void 0?FK:a,i=e.activeClassName,o=i===void 0?"recharts-active-shape":i,l=e.isActive,c=AK(e,EK),d;if(O.isValidElement(t))d=O.cloneElement(t,qu(qu({},c),DK(t)));else if($e(t))d=t(c);else if(dK(t)&&!pK(t)){var u=s(t,c);d=Z.createElement(m1,{shapeType:r,elementProps:u})}else{var f=c;d=Z.createElement(m1,{shapeType:r,elementProps:f})}return l?Z.createElement(it,{className:o},d):d}function y0(e,t){return t!=null&&"trapezoids"in e.props}function b0(e,t){return t!=null&&"sectors"in e.props}function Mc(e,t){return t!=null&&"points"in e.props}function RK(e,t){var r,a,s=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,i=e.y===(t==null||(a=t.labelViewBox)===null||a===void 0?void 0:a.y)||e.y===t.y;return s&&i}function MK(e,t){var r=e.endAngle===t.endAngle,a=e.startAngle===t.startAngle;return r&&a}function $K(e,t){var r=e.x===t.x,a=e.y===t.y,s=e.z===t.z;return r&&a&&s}function LK(e,t){var r;return y0(e,t)?r=RK:b0(e,t)?r=MK:Mc(e,t)&&(r=$K),r}function BK(e,t){var r;return y0(e,t)?r="trapezoids":b0(e,t)?r="sectors":Mc(e,t)&&(r="points"),r}function UK(e,t){if(y0(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(b0(e,t)){var a;return(a=t.tooltipPayload)===null||a===void 0||(a=a[0])===null||a===void 0||(a=a.payload)===null||a===void 0?void 0:a.payload}return Mc(e,t)?t.payload:{}}function WK(e){var t=e.activeTooltipItem,r=e.graphicalItem,a=e.itemData,s=BK(r,t),i=UK(r,t),o=a.filter(function(c,d){var u=bi(i,c),f=r.props[s].filter(function(x){var p=LK(r,t);return p(x,t)}),h=r.props[s].indexOf(f[f.length-1]),m=d===h;return u&&m}),l=a.indexOf(o[o.length-1]);return l}var su;function Ao(e){"@babel/helpers - typeof";return Ao=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ao(e)}function ro(){return ro=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ro.apply(this,arguments)}function x1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Ft(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?x1(Object(r),!0).forEach(function(a){Wa(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function HK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p1(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,eS(a.key),a)}}function zK(e,t,r){return t&&p1(e.prototype,t),r&&p1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VK(e,t,r){return t=Xu(t),GK(e,Q_()?Reflect.construct(t,r||[],Xu(e).constructor):t.apply(e,r))}function GK(e,t){if(t&&(Ao(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KK(e)}function KK(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Q_(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Q_=function(){return!!e})()}function Xu(e){return Xu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xu(e)}function qK(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ym(e,t)}function Ym(e,t){return Ym=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Ym(e,t)}function Wa(e,t,r){return t=eS(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eS(e){var t=XK(e,"string");return Ao(t)=="symbol"?t:t+""}function XK(e,t){if(Ao(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Ao(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var is=function(e){function t(r){var a;return HK(this,t),a=VK(this,t,[r]),Wa(a,"pieRef",null),Wa(a,"sectorRefs",[]),Wa(a,"id",Ii("recharts-pie-")),Wa(a,"handleAnimationEnd",function(){var s=a.props.onAnimationEnd;a.setState({isAnimationFinished:!0}),$e(s)&&s()}),Wa(a,"handleAnimationStart",function(){var s=a.props.onAnimationStart;a.setState({isAnimationFinished:!1}),$e(s)&&s()}),a.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},a}return qK(t,e),zK(t,[{key:"isActiveIndex",value:function(a){var s=this.props.activeIndex;return Array.isArray(s)?s.indexOf(a)!==-1:a===s}},{key:"hasActiveIndex",value:function(){var a=this.props.activeIndex;return Array.isArray(a)?a.length!==0:a||a===0}},{key:"renderLabels",value:function(a){var s=this.props.isAnimationActive;if(s&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.label,l=i.labelLine,c=i.dataKey,d=i.valueKey,u=Ce(this.props,!1),f=Ce(o,!1),h=Ce(l,!1),m=o&&o.offsetRadius||20,x=a.map(function(p,g){var y=(p.startAngle+p.endAngle)/2,w=Dt(p.cx,p.cy,p.outerRadius+m,y),v=Ft(Ft(Ft(Ft({},u),p),{},{stroke:"none"},f),{},{index:g,textAnchor:t.getTextAnchor(w.x,p.cx)},w),_=Ft(Ft(Ft(Ft({},u),p),{},{fill:"none",stroke:p.fill},h),{},{index:g,points:[Dt(p.cx,p.cy,p.outerRadius,y),w]}),b=c;return We(c)&&We(d)?b="value":We(c)&&(b=d),Z.createElement(it,{key:"label-".concat(p.startAngle,"-").concat(p.endAngle,"-").concat(p.midAngle,"-").concat(g)},l&&t.renderLabelLineItem(l,_,"line"),t.renderLabelItem(o,v,nr(p,b)))});return Z.createElement(it,{className:"recharts-pie-labels"},x)}},{key:"renderSectorsStatically",value:function(a){var s=this,i=this.props,o=i.activeShape,l=i.blendStroke,c=i.inactiveShape;return a.map(function(d,u){if((d==null?void 0:d.startAngle)===0&&(d==null?void 0:d.endAngle)===0&&a.length!==1)return null;var f=s.isActiveIndex(u),h=c&&s.hasActiveIndex()?c:null,m=f?o:h,x=Ft(Ft({},d),{},{stroke:l?d.fill:d.stroke,tabIndex:-1});return Z.createElement(it,ro({ref:function(g){g&&!s.sectorRefs.includes(g)&&s.sectorRefs.push(g)},tabIndex:-1,className:"recharts-pie-sector"},vi(s.props,d,u),{key:"sector-".concat(d==null?void 0:d.startAngle,"-").concat(d==null?void 0:d.endAngle,"-").concat(d.midAngle,"-").concat(u)}),Z.createElement(Z_,ro({option:m,isActive:f,shapeType:"sector"},x)))})}},{key:"renderSectorsWithAnimation",value:function(){var a=this,s=this.props,i=s.sectors,o=s.isAnimationActive,l=s.animationBegin,c=s.animationDuration,d=s.animationEasing,u=s.animationId,f=this.state,h=f.prevSectors,m=f.prevIsAnimationActive;return Z.createElement(dn,{begin:l,duration:c,isActive:o,easing:d,from:{t:0},to:{t:1},key:"pie-".concat(u,"-").concat(m),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(x){var p=x.t,g=[],y=i&&i[0],w=y.startAngle;return i.forEach(function(v,_){var b=h&&h[_],j=_>0?ka(v,"paddingAngle",0):0;if(b){var N=vr(b.endAngle-b.startAngle,v.endAngle-v.startAngle),k=Ft(Ft({},v),{},{startAngle:w+j,endAngle:w+N(p)+j});g.push(k),w=k.endAngle}else{var S=v.endAngle,E=v.startAngle,P=vr(0,S-E),C=P(p),T=Ft(Ft({},v),{},{startAngle:w+j,endAngle:w+C+j});g.push(T),w=T.endAngle}}),Z.createElement(it,null,a.renderSectorsStatically(g))})}},{key:"attachKeyboardHandlers",value:function(a){var s=this;a.onkeydown=function(i){if(!i.altKey)switch(i.key){case"ArrowLeft":{var o=++s.state.sectorToFocus%s.sectorRefs.length;s.sectorRefs[o].focus(),s.setState({sectorToFocus:o});break}case"ArrowRight":{var l=--s.state.sectorToFocus<0?s.sectorRefs.length-1:s.state.sectorToFocus%s.sectorRefs.length;s.sectorRefs[l].focus(),s.setState({sectorToFocus:l});break}case"Escape":{s.sectorRefs[s.state.sectorToFocus].blur(),s.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var a=this.props,s=a.sectors,i=a.isAnimationActive,o=this.state.prevSectors;return i&&s&&s.length&&(!o||!bi(o,s))?this.renderSectorsWithAnimation():this.renderSectorsStatically(s)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var a=this,s=this.props,i=s.hide,o=s.sectors,l=s.className,c=s.label,d=s.cx,u=s.cy,f=s.innerRadius,h=s.outerRadius,m=s.isAnimationActive,x=this.state.isAnimationFinished;if(i||!o||!o.length||!be(d)||!be(u)||!be(f)||!be(h))return null;var p=qe("recharts-pie",l);return Z.createElement(it,{tabIndex:this.props.rootTabIndex,className:p,ref:function(y){a.pieRef=y}},this.renderSectors(),c&&this.renderLabels(o),Er.renderCallByParent(this.props,null,!1),(!m||x)&&_n.renderCallByParent(this.props,o,!1))}}],[{key:"getDerivedStateFromProps",value:function(a,s){return s.prevIsAnimationActive!==a.isAnimationActive?{prevIsAnimationActive:a.isAnimationActive,prevAnimationId:a.animationId,curSectors:a.sectors,prevSectors:[],isAnimationFinished:!0}:a.isAnimationActive&&a.animationId!==s.prevAnimationId?{prevAnimationId:a.animationId,curSectors:a.sectors,prevSectors:s.curSectors,isAnimationFinished:!0}:a.sectors!==s.curSectors?{curSectors:a.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(a,s){return a>s?"start":a<s?"end":"middle"}},{key:"renderLabelLineItem",value:function(a,s,i){if(Z.isValidElement(a))return Z.cloneElement(a,s);if($e(a))return a(s);var o=qe("recharts-pie-label-line",typeof a!="boolean"?a.className:"");return Z.createElement(oi,ro({},s,{key:i,type:"linear",className:o}))}},{key:"renderLabelItem",value:function(a,s,i){if(Z.isValidElement(a))return Z.cloneElement(a,s);var o=i;if($e(a)&&(o=a(s),Z.isValidElement(o)))return o;var l=qe("recharts-pie-label-text",typeof a!="boolean"&&!$e(a)?a.className:"");return Z.createElement(yi,ro({},s,{alignmentBaseline:"middle",className:l}),o)}}])}(O.PureComponent);su=is;Wa(is,"displayName","Pie");Wa(is,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!Os.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});Wa(is,"parseDeltaAngle",function(e,t){var r=aa(t-e),a=Math.min(Math.abs(t-e),360);return r*a});Wa(is,"getRealPieData",function(e){var t=e.data,r=e.children,a=Ce(e,!1),s=Ea(r,n0);return t&&t.length?t.map(function(i,o){return Ft(Ft(Ft({payload:i},a),i),s&&s[o]&&s[o].props)}):s&&s.length?s.map(function(i){return Ft(Ft({},a),i.props)}):[]});Wa(is,"parseCoordinateOfPie",function(e,t){var r=t.top,a=t.left,s=t.width,i=t.height,o=C_(s,i),l=a+na(e.cx,s,s/2),c=r+na(e.cy,i,i/2),d=na(e.innerRadius,o,0),u=na(e.outerRadius,o,o*.8),f=e.maxRadius||Math.sqrt(s*s+i*i)/2;return{cx:l,cy:c,innerRadius:d,outerRadius:u,maxRadius:f}});Wa(is,"getComposedData",function(e){var t=e.item,r=e.offset,a=t.type.defaultProps!==void 0?Ft(Ft({},t.type.defaultProps),t.props):t.props,s=su.getRealPieData(a);if(!s||!s.length)return null;var i=a.cornerRadius,o=a.startAngle,l=a.endAngle,c=a.paddingAngle,d=a.dataKey,u=a.nameKey,f=a.valueKey,h=a.tooltipType,m=Math.abs(a.minAngle),x=su.parseCoordinateOfPie(a,r),p=su.parseDeltaAngle(o,l),g=Math.abs(p),y=d;We(d)&&We(f)?(on(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),y="value"):We(d)&&(on(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),y=f);var w=s.filter(function(k){return nr(k,y,0)!==0}).length,v=(g>=360?w:w-1)*c,_=g-w*m-v,b=s.reduce(function(k,S){var E=nr(S,y,0);return k+(be(E)?E:0)},0),j;if(b>0){var N;j=s.map(function(k,S){var E=nr(k,y,0),P=nr(k,u,S),C=(be(E)?E:0)/b,T;S?T=N.endAngle+aa(p)*c*(E!==0?1:0):T=o;var M=T+aa(p)*((E!==0?m:0)+C*_),A=(T+M)/2,F=(x.innerRadius+x.outerRadius)/2,H=[{name:P,value:E,payload:k,dataKey:y,type:h}],V=Dt(x.cx,x.cy,F,A);return N=Ft(Ft(Ft({percent:C,cornerRadius:i,name:P,tooltipPayload:H,midAngle:A,middleRadius:F,tooltipPosition:V},k),x),{},{value:nr(k,y),startAngle:T,endAngle:M,payload:k,paddingAngle:aa(p)*c}),N})}return Ft(Ft({},x),{},{sectors:j,data:s})});var YK=Math.ceil,JK=Math.max;function ZK(e,t,r,a){for(var s=-1,i=JK(YK((t-e)/(r||1)),0),o=Array(i);i--;)o[a?i:++s]=e,e+=r;return o}var QK=ZK,eq=yN,g1=1/0,tq=17976931348623157e292;function rq(e){if(!e)return e===0?e:0;if(e=eq(e),e===g1||e===-g1){var t=e<0?-1:1;return t*tq}return e===e?e:0}var tS=rq,aq=QK,nq=a0,fh=tS;function sq(e){return function(t,r,a){return a&&typeof a!="number"&&nq(t,r,a)&&(r=a=void 0),t=fh(t),r===void 0?(r=t,t=0):r=fh(r),a=a===void 0?t<r?1:-1:fh(a),aq(t,r,a,e)}}var iq=sq,oq=iq,lq=oq(),cq=lq;const Yu=kt(cq);function $c(e){"@babel/helpers - typeof";return $c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$c(e)}function v1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function y1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?v1(Object(r),!0).forEach(function(a){rS(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function rS(e,t,r){return t=dq(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dq(e){var t=uq(e,"string");return $c(t)=="symbol"?t:t+""}function uq(e,t){if($c(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if($c(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fq=["Webkit","Moz","O","ms"],hq=function(t,r){var a=t.replace(/(\w)/,function(i){return i.toUpperCase()}),s=fq.reduce(function(i,o){return y1(y1({},i),{},rS({},o+a,r))},{});return s[t]=r,s};function To(e){"@babel/helpers - typeof";return To=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},To(e)}function Ju(){return Ju=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Ju.apply(this,arguments)}function b1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function hh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?b1(Object(r),!0).forEach(function(a){ya(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function mq(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w1(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,nS(a.key),a)}}function xq(e,t,r){return t&&w1(e.prototype,t),r&&w1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pq(e,t,r){return t=Zu(t),gq(e,aS()?Reflect.construct(t,r||[],Zu(e).constructor):t.apply(e,r))}function gq(e,t){if(t&&(To(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vq(e)}function vq(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aS(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(aS=function(){return!!e})()}function Zu(e){return Zu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zu(e)}function yq(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jm(e,t)}function Jm(e,t){return Jm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Jm(e,t)}function ya(e,t,r){return t=nS(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nS(e){var t=bq(e,"string");return To(t)=="symbol"?t:t+""}function bq(e,t){if(To(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(To(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var wq=function(t){var r=t.data,a=t.startIndex,s=t.endIndex,i=t.x,o=t.width,l=t.travellerWidth;if(!r||!r.length)return{};var c=r.length,d=Ul().domain(Yu(0,c)).range([i,i+o-l]),u=d.domain().map(function(f){return d(f)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:d(a),endX:d(s),scale:d,scaleValues:u}},j1=function(t){return t.changedTouches&&!!t.changedTouches.length},Oo=function(e){function t(r){var a;return mq(this,t),a=pq(this,t,[r]),ya(a,"handleDrag",function(s){a.leaveTimer&&(clearTimeout(a.leaveTimer),a.leaveTimer=null),a.state.isTravellerMoving?a.handleTravellerMove(s):a.state.isSlideMoving&&a.handleSlideDrag(s)}),ya(a,"handleTouchMove",function(s){s.changedTouches!=null&&s.changedTouches.length>0&&a.handleDrag(s.changedTouches[0])}),ya(a,"handleDragEnd",function(){a.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var s=a.props,i=s.endIndex,o=s.onDragEnd,l=s.startIndex;o==null||o({endIndex:i,startIndex:l})}),a.detachDragEndListener()}),ya(a,"handleLeaveWrapper",function(){(a.state.isTravellerMoving||a.state.isSlideMoving)&&(a.leaveTimer=window.setTimeout(a.handleDragEnd,a.props.leaveTimeOut))}),ya(a,"handleEnterSlideOrTraveller",function(){a.setState({isTextActive:!0})}),ya(a,"handleLeaveSlideOrTraveller",function(){a.setState({isTextActive:!1})}),ya(a,"handleSlideDragStart",function(s){var i=j1(s)?s.changedTouches[0]:s;a.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:i.pageX}),a.attachDragEndListener()}),a.travellerDragStartHandlers={startX:a.handleTravellerDragStart.bind(a,"startX"),endX:a.handleTravellerDragStart.bind(a,"endX")},a.state={},a}return yq(t,e),xq(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(a){var s=a.startX,i=a.endX,o=this.state.scaleValues,l=this.props,c=l.gap,d=l.data,u=d.length-1,f=Math.min(s,i),h=Math.max(s,i),m=t.getIndexInRange(o,f),x=t.getIndexInRange(o,h);return{startIndex:m-m%c,endIndex:x===u?u:x-x%c}}},{key:"getTextOfTick",value:function(a){var s=this.props,i=s.data,o=s.tickFormatter,l=s.dataKey,c=nr(i[a],l,a);return $e(o)?o(c,a):c}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(a){var s=this.state,i=s.slideMoveStartX,o=s.startX,l=s.endX,c=this.props,d=c.x,u=c.width,f=c.travellerWidth,h=c.startIndex,m=c.endIndex,x=c.onChange,p=a.pageX-i;p>0?p=Math.min(p,d+u-f-l,d+u-f-o):p<0&&(p=Math.max(p,d-o,d-l));var g=this.getIndex({startX:o+p,endX:l+p});(g.startIndex!==h||g.endIndex!==m)&&x&&x(g),this.setState({startX:o+p,endX:l+p,slideMoveStartX:a.pageX})}},{key:"handleTravellerDragStart",value:function(a,s){var i=j1(s)?s.changedTouches[0]:s;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:a,brushMoveStartX:i.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(a){var s=this.state,i=s.brushMoveStartX,o=s.movingTravellerId,l=s.endX,c=s.startX,d=this.state[o],u=this.props,f=u.x,h=u.width,m=u.travellerWidth,x=u.onChange,p=u.gap,g=u.data,y={startX:this.state.startX,endX:this.state.endX},w=a.pageX-i;w>0?w=Math.min(w,f+h-m-d):w<0&&(w=Math.max(w,f-d)),y[o]=d+w;var v=this.getIndex(y),_=v.startIndex,b=v.endIndex,j=function(){var k=g.length-1;return o==="startX"&&(l>c?_%p===0:b%p===0)||l<c&&b===k||o==="endX"&&(l>c?b%p===0:_%p===0)||l>c&&b===k};this.setState(ya(ya({},o,d+w),"brushMoveStartX",a.pageX),function(){x&&j()&&x(v)})}},{key:"handleTravellerMoveKeyboard",value:function(a,s){var i=this,o=this.state,l=o.scaleValues,c=o.startX,d=o.endX,u=this.state[s],f=l.indexOf(u);if(f!==-1){var h=f+a;if(!(h===-1||h>=l.length)){var m=l[h];s==="startX"&&m>=d||s==="endX"&&m<=c||this.setState(ya({},s,m),function(){i.props.onChange(i.getIndex({startX:i.state.startX,endX:i.state.endX}))})}}}},{key:"renderBackground",value:function(){var a=this.props,s=a.x,i=a.y,o=a.width,l=a.height,c=a.fill,d=a.stroke;return Z.createElement("rect",{stroke:d,fill:c,x:s,y:i,width:o,height:l})}},{key:"renderPanorama",value:function(){var a=this.props,s=a.x,i=a.y,o=a.width,l=a.height,c=a.data,d=a.children,u=a.padding,f=O.Children.only(d);return f?Z.cloneElement(f,{x:s,y:i,width:o,height:l,margin:u,compact:!0,data:c}):null}},{key:"renderTravellerLayer",value:function(a,s){var i,o,l=this,c=this.props,d=c.y,u=c.travellerWidth,f=c.height,h=c.traveller,m=c.ariaLabel,x=c.data,p=c.startIndex,g=c.endIndex,y=Math.max(a,this.props.x),w=hh(hh({},Ce(this.props,!1)),{},{x:y,y:d,width:u,height:f}),v=m||"Min value: ".concat((i=x[p])===null||i===void 0?void 0:i.name,", Max value: ").concat((o=x[g])===null||o===void 0?void 0:o.name);return Z.createElement(it,{tabIndex:0,role:"slider","aria-label":v,"aria-valuenow":a,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[s],onTouchStart:this.travellerDragStartHandlers[s],onKeyDown:function(b){["ArrowLeft","ArrowRight"].includes(b.key)&&(b.preventDefault(),b.stopPropagation(),l.handleTravellerMoveKeyboard(b.key==="ArrowRight"?1:-1,s))},onFocus:function(){l.setState({isTravellerFocused:!0})},onBlur:function(){l.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(h,w))}},{key:"renderSlide",value:function(a,s){var i=this.props,o=i.y,l=i.height,c=i.stroke,d=i.travellerWidth,u=Math.min(a,s)+d,f=Math.max(Math.abs(s-a)-d,0);return Z.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:c,fillOpacity:.2,x:u,y:o,width:f,height:l})}},{key:"renderText",value:function(){var a=this.props,s=a.startIndex,i=a.endIndex,o=a.y,l=a.height,c=a.travellerWidth,d=a.stroke,u=this.state,f=u.startX,h=u.endX,m=5,x={pointerEvents:"none",fill:d};return Z.createElement(it,{className:"recharts-brush-texts"},Z.createElement(yi,Ju({textAnchor:"end",verticalAnchor:"middle",x:Math.min(f,h)-m,y:o+l/2},x),this.getTextOfTick(s)),Z.createElement(yi,Ju({textAnchor:"start",verticalAnchor:"middle",x:Math.max(f,h)+c+m,y:o+l/2},x),this.getTextOfTick(i)))}},{key:"render",value:function(){var a=this.props,s=a.data,i=a.className,o=a.children,l=a.x,c=a.y,d=a.width,u=a.height,f=a.alwaysShowText,h=this.state,m=h.startX,x=h.endX,p=h.isTextActive,g=h.isSlideMoving,y=h.isTravellerMoving,w=h.isTravellerFocused;if(!s||!s.length||!be(l)||!be(c)||!be(d)||!be(u)||d<=0||u<=0)return null;var v=qe("recharts-brush",i),_=Z.Children.count(o)===1,b=hq("userSelect","none");return Z.createElement(it,{className:v,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:b},this.renderBackground(),_&&this.renderPanorama(),this.renderSlide(m,x),this.renderTravellerLayer(m,"startX"),this.renderTravellerLayer(x,"endX"),(p||g||y||w||f)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(a){var s=a.x,i=a.y,o=a.width,l=a.height,c=a.stroke,d=Math.floor(i+l/2)-1;return Z.createElement(Z.Fragment,null,Z.createElement("rect",{x:s,y:i,width:o,height:l,fill:c,stroke:"none"}),Z.createElement("line",{x1:s+1,y1:d,x2:s+o-1,y2:d,fill:"none",stroke:"#fff"}),Z.createElement("line",{x1:s+1,y1:d+2,x2:s+o-1,y2:d+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(a,s){var i;return Z.isValidElement(a)?i=Z.cloneElement(a,s):$e(a)?i=a(s):i=t.renderDefaultTraveller(s),i}},{key:"getDerivedStateFromProps",value:function(a,s){var i=a.data,o=a.width,l=a.x,c=a.travellerWidth,d=a.updateId,u=a.startIndex,f=a.endIndex;if(i!==s.prevData||d!==s.prevUpdateId)return hh({prevData:i,prevTravellerWidth:c,prevUpdateId:d,prevX:l,prevWidth:o},i&&i.length?wq({data:i,width:o,x:l,travellerWidth:c,startIndex:u,endIndex:f}):{scale:null,scaleValues:null});if(s.scale&&(o!==s.prevWidth||l!==s.prevX||c!==s.prevTravellerWidth)){s.scale.range([l,l+o-c]);var h=s.scale.domain().map(function(m){return s.scale(m)});return{prevData:i,prevTravellerWidth:c,prevUpdateId:d,prevX:l,prevWidth:o,startX:s.scale(a.startIndex),endX:s.scale(a.endIndex),scaleValues:h}}return null}},{key:"getIndexInRange",value:function(a,s){for(var i=a.length,o=0,l=i-1;l-o>1;){var c=Math.floor((o+l)/2);a[c]>s?l=c:o=c}return s>=a[l]?l:o}}])}(O.PureComponent);ya(Oo,"displayName","Brush");ya(Oo,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var jq=up;function Nq(e,t){var r;return jq(e,function(a,s,i){return r=t(a,s,i),!r}),!!r}var _q=Nq,Sq=G2,kq=On,Eq=_q,Aq=ga,Tq=a0;function Oq(e,t,r){var a=Aq(e)?Sq:Eq;return r&&Tq(e,t,r)&&(t=void 0),a(e,kq(t))}var Pq=Oq;const Cq=kt(Pq);var Sn=function(t,r){var a=t.alwaysShow,s=t.ifOverflow;return a&&(s="extendDomain"),s===r},N1=mN;function Fq(e,t,r){t=="__proto__"&&N1?N1(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var Iq=Fq,Dq=Iq,Rq=fN,Mq=On;function $q(e,t){var r={};return t=Mq(t),Rq(e,function(a,s,i){Dq(r,s,t(a,s,i))}),r}var Lq=$q;const Bq=kt(Lq);function Uq(e,t){for(var r=-1,a=e==null?0:e.length;++r<a;)if(!t(e[r],r,e))return!1;return!0}var Wq=Uq,Hq=up;function zq(e,t){var r=!0;return Hq(e,function(a,s,i){return r=!!t(a,s,i),r}),r}var Vq=zq,Gq=Wq,Kq=Vq,qq=On,Xq=ga,Yq=a0;function Jq(e,t,r){var a=Xq(e)?Gq:Kq;return r&&Yq(e,t,r)&&(t=void 0),a(e,qq(t))}var Zq=Jq;const sS=kt(Zq);var Qq=["x","y"];function Lc(e){"@babel/helpers - typeof";return Lc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lc(e)}function Zm(){return Zm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Zm.apply(this,arguments)}function _1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Sl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_1(Object(r),!0).forEach(function(a){eX(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function eX(e,t,r){return t=tX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tX(e){var t=rX(e,"string");return Lc(t)=="symbol"?t:t+""}function rX(e,t){if(Lc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Lc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aX(e,t){if(e==null)return{};var r=nX(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function nX(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function sX(e,t){var r=e.x,a=e.y,s=aX(e,Qq),i="".concat(r),o=parseInt(i,10),l="".concat(a),c=parseInt(l,10),d="".concat(t.height||s.height),u=parseInt(d,10),f="".concat(t.width||s.width),h=parseInt(f,10);return Sl(Sl(Sl(Sl(Sl({},t),s),o?{x:o}:{}),c?{y:c}:{}),{},{height:u,width:h,name:t.name,radius:t.radius})}function S1(e){return Z.createElement(Z_,Zm({shapeType:"rectangle",propTransformer:sX,activeClassName:"recharts-active-bar"},e))}var iX=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(a,s){if(typeof t=="number")return t;var i=be(a)||CO(a);return i?t(a,s):(i||ji(),r)}},oX=["value","background"],iS;function Po(e){"@babel/helpers - typeof";return Po=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Po(e)}function lX(e,t){if(e==null)return{};var r=cX(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function cX(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function Qu(){return Qu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Qu.apply(this,arguments)}function k1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function dr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?k1(Object(r),!0).forEach(function(a){ps(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function dX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E1(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,lS(a.key),a)}}function uX(e,t,r){return t&&E1(e.prototype,t),r&&E1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fX(e,t,r){return t=ef(t),hX(e,oS()?Reflect.construct(t,r||[],ef(e).constructor):t.apply(e,r))}function hX(e,t){if(t&&(Po(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mX(e)}function mX(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oS(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(oS=function(){return!!e})()}function ef(e){return ef=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ef(e)}function xX(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qm(e,t)}function Qm(e,t){return Qm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Qm(e,t)}function ps(e,t,r){return t=lS(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lS(e){var t=pX(e,"string");return Po(t)=="symbol"?t:t+""}function pX(e,t){if(Po(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Po(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Gn=function(e){function t(){var r;dX(this,t);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return r=fX(this,t,[].concat(s)),ps(r,"state",{isAnimationFinished:!1}),ps(r,"id",Ii("recharts-bar-")),ps(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),o&&o()}),ps(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),o&&o()}),r}return xX(t,e),uX(t,[{key:"renderRectanglesStatically",value:function(a){var s=this,i=this.props,o=i.shape,l=i.dataKey,c=i.activeIndex,d=i.activeBar,u=Ce(this.props,!1);return a&&a.map(function(f,h){var m=h===c,x=m?d:o,p=dr(dr(dr({},u),f),{},{isActive:m,option:x,index:h,dataKey:l,onAnimationStart:s.handleAnimationStart,onAnimationEnd:s.handleAnimationEnd});return Z.createElement(it,Qu({className:"recharts-bar-rectangle"},vi(s.props,f,h),{key:"rectangle-".concat(f==null?void 0:f.x,"-").concat(f==null?void 0:f.y,"-").concat(f==null?void 0:f.value,"-").concat(h)}),Z.createElement(S1,p))})}},{key:"renderRectanglesWithAnimation",value:function(){var a=this,s=this.props,i=s.data,o=s.layout,l=s.isAnimationActive,c=s.animationBegin,d=s.animationDuration,u=s.animationEasing,f=s.animationId,h=this.state.prevData;return Z.createElement(dn,{begin:c,duration:d,isActive:l,easing:u,from:{t:0},to:{t:1},key:"bar-".concat(f),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(m){var x=m.t,p=i.map(function(g,y){var w=h&&h[y];if(w){var v=vr(w.x,g.x),_=vr(w.y,g.y),b=vr(w.width,g.width),j=vr(w.height,g.height);return dr(dr({},g),{},{x:v(x),y:_(x),width:b(x),height:j(x)})}if(o==="horizontal"){var N=vr(0,g.height),k=N(x);return dr(dr({},g),{},{y:g.y+g.height-k,height:k})}var S=vr(0,g.width),E=S(x);return dr(dr({},g),{},{width:E})});return Z.createElement(it,null,a.renderRectanglesStatically(p))})}},{key:"renderRectangles",value:function(){var a=this.props,s=a.data,i=a.isAnimationActive,o=this.state.prevData;return i&&s&&s.length&&(!o||!bi(o,s))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(s)}},{key:"renderBackground",value:function(){var a=this,s=this.props,i=s.data,o=s.dataKey,l=s.activeIndex,c=Ce(this.props.background,!1);return i.map(function(d,u){d.value;var f=d.background,h=lX(d,oX);if(!f)return null;var m=dr(dr(dr(dr(dr({},h),{},{fill:"#eee"},f),c),vi(a.props,d,u)),{},{onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd,dataKey:o,index:u,className:"recharts-bar-background-rectangle"});return Z.createElement(S1,Qu({key:"background-bar-".concat(u),option:a.props.background,isActive:u===l},m))})}},{key:"renderErrorBar",value:function(a,s){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.data,l=i.xAxis,c=i.yAxis,d=i.layout,u=i.children,f=Ea(u,pd);if(!f)return null;var h=d==="vertical"?o[0].height/2:o[0].width/2,m=function(g,y){var w=Array.isArray(g.value)?g.value[1]:g.value;return{x:g.x,y:g.y,value:w,errorVal:nr(g,y)}},x={clipPath:a?"url(#clipPath-".concat(s,")"):null};return Z.createElement(it,x,f.map(function(p){return Z.cloneElement(p,{key:"error-bar-".concat(s,"-").concat(p.props.dataKey),data:o,xAxis:l,yAxis:c,layout:d,offset:h,dataPointFormatter:m})}))}},{key:"render",value:function(){var a=this.props,s=a.hide,i=a.data,o=a.className,l=a.xAxis,c=a.yAxis,d=a.left,u=a.top,f=a.width,h=a.height,m=a.isAnimationActive,x=a.background,p=a.id;if(s||!i||!i.length)return null;var g=this.state.isAnimationFinished,y=qe("recharts-bar",o),w=l&&l.allowDataOverflow,v=c&&c.allowDataOverflow,_=w||v,b=We(p)?this.id:p;return Z.createElement(it,{className:y},w||v?Z.createElement("defs",null,Z.createElement("clipPath",{id:"clipPath-".concat(b)},Z.createElement("rect",{x:w?d:d-f/2,y:v?u:u-h/2,width:w?f:f*2,height:v?h:h*2}))):null,Z.createElement(it,{className:"recharts-bar-rectangles",clipPath:_?"url(#clipPath-".concat(b,")"):null},x?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(_,b),(!m||g)&&_n.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(a,s){return a.animationId!==s.prevAnimationId?{prevAnimationId:a.animationId,curData:a.data,prevData:s.curData}:a.data!==s.curData?{curData:a.data}:null}}])}(O.PureComponent);iS=Gn;ps(Gn,"displayName","Bar");ps(Gn,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Os.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});ps(Gn,"getComposedData",function(e){var t=e.props,r=e.item,a=e.barPosition,s=e.bandSize,i=e.xAxis,o=e.yAxis,l=e.xAxisTicks,c=e.yAxisTicks,d=e.stackedData,u=e.dataStartIndex,f=e.displayedData,h=e.offset,m=YW(a,r);if(!m)return null;var x=t.layout,p=r.type.defaultProps,g=p!==void 0?dr(dr({},p),r.props):r.props,y=g.dataKey,w=g.children,v=g.minPointSize,_=x==="horizontal"?o:i,b=d?_.scale.domain():null,j=aH({numericAxis:_}),N=Ea(w,n0),k=f.map(function(S,E){var P,C,T,M,A,F;d?P=JW(d[u+E],b):(P=nr(S,y),Array.isArray(P)||(P=[j,P]));var H=iX(v,iS.defaultProps.minPointSize)(P[1],E);if(x==="horizontal"){var V,B=[o.scale(P[0]),o.scale(P[1])],L=B[0],ee=B[1];C=pb({axis:i,ticks:l,bandSize:s,offset:m.offset,entry:S,index:E}),T=(V=ee??L)!==null&&V!==void 0?V:void 0,M=m.size;var I=L-ee;if(A=Number.isNaN(I)?0:I,F={x:C,y:o.y,width:M,height:o.height},Math.abs(H)>0&&Math.abs(A)<Math.abs(H)){var K=aa(A||H)*(Math.abs(H)-Math.abs(A));T-=K,A+=K}}else{var z=[i.scale(P[0]),i.scale(P[1])],W=z[0],re=z[1];if(C=W,T=pb({axis:o,ticks:c,bandSize:s,offset:m.offset,entry:S,index:E}),M=re-W,A=m.size,F={x:i.x,y:T,width:i.width,height:A},Math.abs(H)>0&&Math.abs(M)<Math.abs(H)){var xe=aa(M||H)*(Math.abs(H)-Math.abs(M));M+=xe}}return dr(dr(dr({},S),{},{x:C,y:T,width:M,height:A,value:d?P:P[1],payload:S,background:F},N&&N[E]&&N[E].props),{},{tooltipPayload:[O_(r,S)],tooltipPosition:{x:C+M/2,y:T+A/2}})});return dr({data:k,layout:x},h)});function Bc(e){"@babel/helpers - typeof";return Bc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bc(e)}function gX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A1(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,cS(a.key),a)}}function vX(e,t,r){return t&&A1(e.prototype,t),r&&A1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function T1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function en(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?T1(Object(r),!0).forEach(function(a){w0(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function w0(e,t,r){return t=cS(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cS(e){var t=yX(e,"string");return Bc(t)=="symbol"?t:t+""}function yX(e,t){if(Bc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Bc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bp=function(t,r,a,s,i){var o=t.width,l=t.height,c=t.layout,d=t.children,u=Object.keys(r),f={left:a.left,leftMirror:a.left,right:o-a.right,rightMirror:o-a.right,top:a.top,topMirror:a.top,bottom:l-a.bottom,bottomMirror:l-a.bottom},h=!!ba(d,Gn);return u.reduce(function(m,x){var p=r[x],g=p.orientation,y=p.domain,w=p.padding,v=w===void 0?{}:w,_=p.mirror,b=p.reversed,j="".concat(g).concat(_?"Mirror":""),N,k,S,E,P;if(p.type==="number"&&(p.padding==="gap"||p.padding==="no-gap")){var C=y[1]-y[0],T=1/0,M=p.categoricalDomain.sort(DO);if(M.forEach(function(z,W){W>0&&(T=Math.min((z||0)-(M[W-1]||0),T))}),Number.isFinite(T)){var A=T/C,F=p.layout==="vertical"?a.height:a.width;if(p.padding==="gap"&&(N=A*F/2),p.padding==="no-gap"){var H=na(t.barCategoryGap,A*F),V=A*F/2;N=V-H-(V-H)/F*H}}}s==="xAxis"?k=[a.left+(v.left||0)+(N||0),a.left+a.width-(v.right||0)-(N||0)]:s==="yAxis"?k=c==="horizontal"?[a.top+a.height-(v.bottom||0),a.top+(v.top||0)]:[a.top+(v.top||0)+(N||0),a.top+a.height-(v.bottom||0)-(N||0)]:k=p.range,b&&(k=[k[1],k[0]]);var B=k_(p,i,h),L=B.scale,ee=B.realScaleType;L.domain(y).range(k),E_(L);var I=A_(L,en(en({},p),{},{realScaleType:ee}));s==="xAxis"?(P=g==="top"&&!_||g==="bottom"&&_,S=a.left,E=f[j]-P*p.height):s==="yAxis"&&(P=g==="left"&&!_||g==="right"&&_,S=f[j]-P*p.width,E=a.top);var K=en(en(en({},p),I),{},{realScaleType:ee,x:S,y:E,scale:L,width:s==="xAxis"?a.width:p.width,height:s==="yAxis"?a.height:p.height});return K.bandSize=$u(K,I),!p.hide&&s==="xAxis"?f[j]+=(P?-1:1)*K.height:p.hide||(f[j]+=(P?-1:1)*K.width),en(en({},m),{},w0({},x,K))},{})},dS=function(t,r){var a=t.x,s=t.y,i=r.x,o=r.y;return{x:Math.min(a,i),y:Math.min(s,o),width:Math.abs(i-a),height:Math.abs(o-s)}},bX=function(t){var r=t.x1,a=t.y1,s=t.x2,i=t.y2;return dS({x:r,y:a},{x:s,y:i})},uS=function(){function e(t){gX(this,e),this.scale=t}return vX(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=a.bandAware,i=a.position;if(r!==void 0){if(i)switch(i){case"start":return this.scale(r);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+o}case"end":{var l=this.bandwidth?this.bandwidth():0;return this.scale(r)+l}default:return this.scale(r)}if(s){var c=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+c}return this.scale(r)}}},{key:"isInRange",value:function(r){var a=this.range(),s=a[0],i=a[a.length-1];return s<=i?r>=s&&r<=i:r>=i&&r<=s}}],[{key:"create",value:function(r){return new e(r)}}])}();w0(uS,"EPS",1e-4);var Up=function(t){var r=Object.keys(t).reduce(function(a,s){return en(en({},a),{},w0({},s,uS.create(t[s])))},{});return en(en({},r),{},{apply:function(s){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=i.bandAware,l=i.position;return Bq(s,function(c,d){return r[d].apply(c,{bandAware:o,position:l})})},isInRange:function(s){return sS(s,function(i,o){return r[o].isInRange(i)})}})};function wX(e){return(e%180+180)%180}var jX=function(t){var r=t.width,a=t.height,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=wX(s),o=i*Math.PI/180,l=Math.atan(a/r),c=o>l&&o<Math.PI-l?a/Math.sin(o):r/Math.cos(o);return Math.abs(c)},NX=On,_X=ud,SX=t0;function kX(e){return function(t,r,a){var s=Object(t);if(!_X(t)){var i=NX(r);t=SX(t),r=function(l){return i(s[l],l,s)}}var o=e(t,r,a);return o>-1?s[i?t[o]:o]:void 0}}var EX=kX,AX=tS;function TX(e){var t=AX(e),r=t%1;return t===t?r?t-r:t:0}var OX=TX,PX=iN,CX=On,FX=OX,IX=Math.max;function DX(e,t,r){var a=e==null?0:e.length;if(!a)return-1;var s=r==null?0:FX(r);return s<0&&(s=IX(a+s,0)),PX(e,CX(t),s)}var RX=DX,MX=EX,$X=RX,LX=MX($X),BX=LX;const UX=kt(BX);var WX=$T(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),Wp=O.createContext(void 0),Hp=O.createContext(void 0),fS=O.createContext(void 0),hS=O.createContext({}),mS=O.createContext(void 0),xS=O.createContext(0),pS=O.createContext(0),O1=function(t){var r=t.state,a=r.xAxisMap,s=r.yAxisMap,i=r.offset,o=t.clipPathId,l=t.children,c=t.width,d=t.height,u=WX(i);return Z.createElement(Wp.Provider,{value:a},Z.createElement(Hp.Provider,{value:s},Z.createElement(hS.Provider,{value:i},Z.createElement(fS.Provider,{value:u},Z.createElement(mS.Provider,{value:o},Z.createElement(xS.Provider,{value:d},Z.createElement(pS.Provider,{value:c},l)))))))},HX=function(){return O.useContext(mS)},gS=function(t){var r=O.useContext(Wp);r==null&&ji();var a=r[t];return a==null&&ji(),a},zX=function(){var t=O.useContext(Wp);return ms(t)},VX=function(){var t=O.useContext(Hp),r=UX(t,function(a){return sS(a.domain,Number.isFinite)});return r||ms(t)},vS=function(t){var r=O.useContext(Hp);r==null&&ji();var a=r[t];return a==null&&ji(),a},GX=function(){var t=O.useContext(fS);return t},KX=function(){return O.useContext(hS)},zp=function(){return O.useContext(pS)},Vp=function(){return O.useContext(xS)};function Co(e){"@babel/helpers - typeof";return Co=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Co(e)}function qX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XX(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,bS(a.key),a)}}function YX(e,t,r){return t&&XX(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function JX(e,t,r){return t=tf(t),ZX(e,yS()?Reflect.construct(t,r||[],tf(e).constructor):t.apply(e,r))}function ZX(e,t){if(t&&(Co(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return QX(e)}function QX(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yS(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(yS=function(){return!!e})()}function tf(e){return tf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tf(e)}function eY(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ex(e,t)}function ex(e,t){return ex=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},ex(e,t)}function P1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function C1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?P1(Object(r),!0).forEach(function(a){Gp(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Gp(e,t,r){return t=bS(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bS(e){var t=tY(e,"string");return Co(t)=="symbol"?t:t+""}function tY(e,t){if(Co(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Co(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function rY(e,t){return iY(e)||sY(e,t)||nY(e,t)||aY()}function aY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nY(e,t){if(e){if(typeof e=="string")return F1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return F1(e,t)}}function F1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function sY(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function iY(e){if(Array.isArray(e))return e}function tx(){return tx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},tx.apply(this,arguments)}var oY=function(t,r){var a;return Z.isValidElement(t)?a=Z.cloneElement(t,r):$e(t)?a=t(r):a=Z.createElement("line",tx({},r,{className:"recharts-reference-line-line"})),a},lY=function(t,r,a,s,i,o,l,c,d){var u=i.x,f=i.y,h=i.width,m=i.height;if(a){var x=d.y,p=t.y.apply(x,{position:o});if(Sn(d,"discard")&&!t.y.isInRange(p))return null;var g=[{x:u+h,y:p},{x:u,y:p}];return c==="left"?g.reverse():g}if(r){var y=d.x,w=t.x.apply(y,{position:o});if(Sn(d,"discard")&&!t.x.isInRange(w))return null;var v=[{x:w,y:f+m},{x:w,y:f}];return l==="top"?v.reverse():v}if(s){var _=d.segment,b=_.map(function(j){return t.apply(j,{position:o})});return Sn(d,"discard")&&Cq(b,function(j){return!t.isInRange(j)})?null:b}return null};function cY(e){var t=e.x,r=e.y,a=e.segment,s=e.xAxisId,i=e.yAxisId,o=e.shape,l=e.className,c=e.alwaysShow,d=HX(),u=gS(s),f=vS(i),h=GX();if(!d||!h)return null;on(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var m=Up({x:u.scale,y:f.scale}),x=wr(t),p=wr(r),g=a&&a.length===2,y=lY(m,x,p,g,h,e.position,u.orientation,f.orientation,e);if(!y)return null;var w=rY(y,2),v=w[0],_=v.x,b=v.y,j=w[1],N=j.x,k=j.y,S=Sn(e,"hidden")?"url(#".concat(d,")"):void 0,E=C1(C1({clipPath:S},Ce(e,!0)),{},{x1:_,y1:b,x2:N,y2:k});return Z.createElement(it,{className:qe("recharts-reference-line",l)},oY(o,E),Er.renderCallByParent(e,bX({x1:_,y1:b,x2:N,y2:k})))}var Kp=function(e){function t(){return qX(this,t),JX(this,t,arguments)}return eY(t,e),YX(t,[{key:"render",value:function(){return Z.createElement(cY,this.props)}}])}(Z.Component);Gp(Kp,"displayName","ReferenceLine");Gp(Kp,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function rx(){return rx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},rx.apply(this,arguments)}function Fo(e){"@babel/helpers - typeof";return Fo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fo(e)}function I1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function D1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?I1(Object(r),!0).forEach(function(a){j0(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function dY(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uY(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,jS(a.key),a)}}function fY(e,t,r){return t&&uY(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function hY(e,t,r){return t=rf(t),mY(e,wS()?Reflect.construct(t,r||[],rf(e).constructor):t.apply(e,r))}function mY(e,t){if(t&&(Fo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xY(e)}function xY(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wS(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wS=function(){return!!e})()}function rf(e){return rf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rf(e)}function pY(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ax(e,t)}function ax(e,t){return ax=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},ax(e,t)}function j0(e,t,r){return t=jS(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jS(e){var t=gY(e,"string");return Fo(t)=="symbol"?t:t+""}function gY(e,t){if(Fo(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Fo(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var vY=function(t){var r=t.x,a=t.y,s=t.xAxis,i=t.yAxis,o=Up({x:s.scale,y:i.scale}),l=o.apply({x:r,y:a},{bandAware:!0});return Sn(t,"discard")&&!o.isInRange(l)?null:l},N0=function(e){function t(){return dY(this,t),hY(this,t,arguments)}return pY(t,e),fY(t,[{key:"render",value:function(){var a=this.props,s=a.x,i=a.y,o=a.r,l=a.alwaysShow,c=a.clipPathId,d=wr(s),u=wr(i);if(on(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!d||!u)return null;var f=vY(this.props);if(!f)return null;var h=f.x,m=f.y,x=this.props,p=x.shape,g=x.className,y=Sn(this.props,"hidden")?"url(#".concat(c,")"):void 0,w=D1(D1({clipPath:y},Ce(this.props,!0)),{},{cx:h,cy:m});return Z.createElement(it,{className:qe("recharts-reference-dot",g)},t.renderDot(p,w),Er.renderCallByParent(this.props,{x:h-o,y:m-o,width:2*o,height:2*o}))}}])}(Z.Component);j0(N0,"displayName","ReferenceDot");j0(N0,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});j0(N0,"renderDot",function(e,t){var r;return Z.isValidElement(e)?r=Z.cloneElement(e,t):$e(e)?r=e(t):r=Z.createElement(gd,rx({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function nx(){return nx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},nx.apply(this,arguments)}function Io(e){"@babel/helpers - typeof";return Io=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Io(e)}function R1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function M1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?R1(Object(r),!0).forEach(function(a){_0(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function yY(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bY(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,_S(a.key),a)}}function wY(e,t,r){return t&&bY(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function jY(e,t,r){return t=af(t),NY(e,NS()?Reflect.construct(t,r||[],af(e).constructor):t.apply(e,r))}function NY(e,t){if(t&&(Io(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _Y(e)}function _Y(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NS(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(NS=function(){return!!e})()}function af(e){return af=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},af(e)}function SY(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sx(e,t)}function sx(e,t){return sx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},sx(e,t)}function _0(e,t,r){return t=_S(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _S(e){var t=kY(e,"string");return Io(t)=="symbol"?t:t+""}function kY(e,t){if(Io(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Io(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var EY=function(t,r,a,s,i){var o=i.x1,l=i.x2,c=i.y1,d=i.y2,u=i.xAxis,f=i.yAxis;if(!u||!f)return null;var h=Up({x:u.scale,y:f.scale}),m={x:t?h.x.apply(o,{position:"start"}):h.x.rangeMin,y:a?h.y.apply(c,{position:"start"}):h.y.rangeMin},x={x:r?h.x.apply(l,{position:"end"}):h.x.rangeMax,y:s?h.y.apply(d,{position:"end"}):h.y.rangeMax};return Sn(i,"discard")&&(!h.isInRange(m)||!h.isInRange(x))?null:dS(m,x)},S0=function(e){function t(){return yY(this,t),jY(this,t,arguments)}return SY(t,e),wY(t,[{key:"render",value:function(){var a=this.props,s=a.x1,i=a.x2,o=a.y1,l=a.y2,c=a.className,d=a.alwaysShow,u=a.clipPathId;on(d===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=wr(s),h=wr(i),m=wr(o),x=wr(l),p=this.props.shape;if(!f&&!h&&!m&&!x&&!p)return null;var g=EY(f,h,m,x,this.props);if(!g&&!p)return null;var y=Sn(this.props,"hidden")?"url(#".concat(u,")"):void 0;return Z.createElement(it,{className:qe("recharts-reference-area",c)},t.renderRect(p,M1(M1({clipPath:y},Ce(this.props,!0)),g)),Er.renderCallByParent(this.props,g))}}])}(Z.Component);_0(S0,"displayName","ReferenceArea");_0(S0,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});_0(S0,"renderRect",function(e,t){var r;return Z.isValidElement(e)?r=Z.cloneElement(e,t):$e(e)?r=e(t):r=Z.createElement(Lp,nx({},t,{className:"recharts-reference-area-rect"})),r});function SS(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var a=[],s=0;s<e.length;s+=t)a.push(e[s]);return a}function AY(e,t,r){var a={width:e.width+t.width,height:e.height+t.height};return jX(a,r)}function TY(e,t,r){var a=r==="width",s=e.x,i=e.y,o=e.width,l=e.height;return t===1?{start:a?s:i,end:a?s+o:i+l}:{start:a?s+o:i+l,end:a?s:i}}function nf(e,t,r,a,s){if(e*t<e*a||e*t>e*s)return!1;var i=r();return e*(t-e*i/2-a)>=0&&e*(t+e*i/2-s)<=0}function OY(e,t){return SS(e,t+1)}function PY(e,t,r,a,s){for(var i=(a||[]).slice(),o=t.start,l=t.end,c=0,d=1,u=o,f=function(){var x=a==null?void 0:a[c];if(x===void 0)return{v:SS(a,d)};var p=c,g,y=function(){return g===void 0&&(g=r(x,p)),g},w=x.coordinate,v=c===0||nf(e,w,y,u,l);v||(c=0,u=o,d+=1),v&&(u=w+e*(y()/2+s),c+=d)},h;d<=i.length;)if(h=f(),h)return h.v;return[]}function Uc(e){"@babel/helpers - typeof";return Uc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uc(e)}function $1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Hr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$1(Object(r),!0).forEach(function(a){CY(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function CY(e,t,r){return t=FY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FY(e){var t=IY(e,"string");return Uc(t)=="symbol"?t:t+""}function IY(e,t){if(Uc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Uc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DY(e,t,r,a,s){for(var i=(a||[]).slice(),o=i.length,l=t.start,c=t.end,d=function(h){var m=i[h],x,p=function(){return x===void 0&&(x=r(m,h)),x};if(h===o-1){var g=e*(m.coordinate+e*p()/2-c);i[h]=m=Hr(Hr({},m),{},{tickCoord:g>0?m.coordinate-g*e:m.coordinate})}else i[h]=m=Hr(Hr({},m),{},{tickCoord:m.coordinate});var y=nf(e,m.tickCoord,p,l,c);y&&(c=m.tickCoord-e*(p()/2+s),i[h]=Hr(Hr({},m),{},{isShow:!0}))},u=o-1;u>=0;u--)d(u);return i}function RY(e,t,r,a,s,i){var o=(a||[]).slice(),l=o.length,c=t.start,d=t.end;if(i){var u=a[l-1],f=r(u,l-1),h=e*(u.coordinate+e*f/2-d);o[l-1]=u=Hr(Hr({},u),{},{tickCoord:h>0?u.coordinate-h*e:u.coordinate});var m=nf(e,u.tickCoord,function(){return f},c,d);m&&(d=u.tickCoord-e*(f/2+s),o[l-1]=Hr(Hr({},u),{},{isShow:!0}))}for(var x=i?l-1:l,p=function(w){var v=o[w],_,b=function(){return _===void 0&&(_=r(v,w)),_};if(w===0){var j=e*(v.coordinate-e*b()/2-c);o[w]=v=Hr(Hr({},v),{},{tickCoord:j<0?v.coordinate-j*e:v.coordinate})}else o[w]=v=Hr(Hr({},v),{},{tickCoord:v.coordinate});var N=nf(e,v.tickCoord,b,c,d);N&&(c=v.tickCoord+e*(b()/2+s),o[w]=Hr(Hr({},v),{},{isShow:!0}))},g=0;g<x;g++)p(g);return o}function qp(e,t,r){var a=e.tick,s=e.ticks,i=e.viewBox,o=e.minTickGap,l=e.orientation,c=e.interval,d=e.tickFormatter,u=e.unit,f=e.angle;if(!s||!s.length||!a)return[];if(be(c)||Os.isSsr)return OY(s,typeof c=="number"&&be(c)?c:0);var h=[],m=l==="top"||l==="bottom"?"width":"height",x=u&&m==="width"?Bl(u,{fontSize:t,letterSpacing:r}):{width:0,height:0},p=function(v,_){var b=$e(d)?d(v.value,_):v.value;return m==="width"?AY(Bl(b,{fontSize:t,letterSpacing:r}),x,f):Bl(b,{fontSize:t,letterSpacing:r})[m]},g=s.length>=2?aa(s[1].coordinate-s[0].coordinate):1,y=TY(i,g,m);return c==="equidistantPreserveStart"?PY(g,y,p,s,o):(c==="preserveStart"||c==="preserveStartEnd"?h=RY(g,y,p,s,o,c==="preserveStartEnd"):h=DY(g,y,p,s,o),h.filter(function(w){return w.isShow}))}var MY=["viewBox"],$Y=["viewBox"],LY=["ticks"];function Do(e){"@babel/helpers - typeof";return Do=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Do(e)}function ao(){return ao=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ao.apply(this,arguments)}function L1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function pr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?L1(Object(r),!0).forEach(function(a){Xp(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function mh(e,t){if(e==null)return{};var r=BY(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function BY(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function UY(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B1(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,ES(a.key),a)}}function WY(e,t,r){return t&&B1(e.prototype,t),r&&B1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function HY(e,t,r){return t=sf(t),zY(e,kS()?Reflect.construct(t,r||[],sf(e).constructor):t.apply(e,r))}function zY(e,t){if(t&&(Do(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VY(e)}function VY(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kS(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kS=function(){return!!e})()}function sf(e){return sf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sf(e)}function GY(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ix(e,t)}function ix(e,t){return ix=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},ix(e,t)}function Xp(e,t,r){return t=ES(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ES(e){var t=KY(e,"string");return Do(t)=="symbol"?t:t+""}function KY(e,t){if(Do(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Do(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var il=function(e){function t(r){var a;return UY(this,t),a=HY(this,t,[r]),a.state={fontSize:"",letterSpacing:""},a}return GY(t,e),WY(t,[{key:"shouldComponentUpdate",value:function(a,s){var i=a.viewBox,o=mh(a,MY),l=this.props,c=l.viewBox,d=mh(l,$Y);return!io(i,c)||!io(o,d)||!io(s,this.state)}},{key:"componentDidMount",value:function(){var a=this.layerReference;if(a){var s=a.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];s&&this.setState({fontSize:window.getComputedStyle(s).fontSize,letterSpacing:window.getComputedStyle(s).letterSpacing})}}},{key:"getTickLineCoord",value:function(a){var s=this.props,i=s.x,o=s.y,l=s.width,c=s.height,d=s.orientation,u=s.tickSize,f=s.mirror,h=s.tickMargin,m,x,p,g,y,w,v=f?-1:1,_=a.tickSize||u,b=be(a.tickCoord)?a.tickCoord:a.coordinate;switch(d){case"top":m=x=a.coordinate,g=o+ +!f*c,p=g-v*_,w=p-v*h,y=b;break;case"left":p=g=a.coordinate,x=i+ +!f*l,m=x-v*_,y=m-v*h,w=b;break;case"right":p=g=a.coordinate,x=i+ +f*l,m=x+v*_,y=m+v*h,w=b;break;default:m=x=a.coordinate,g=o+ +f*c,p=g+v*_,w=p+v*h,y=b;break}return{line:{x1:m,y1:p,x2:x,y2:g},tick:{x:y,y:w}}}},{key:"getTickTextAnchor",value:function(){var a=this.props,s=a.orientation,i=a.mirror,o;switch(s){case"left":o=i?"start":"end";break;case"right":o=i?"end":"start";break;default:o="middle";break}return o}},{key:"getTickVerticalAnchor",value:function(){var a=this.props,s=a.orientation,i=a.mirror,o="end";switch(s){case"left":case"right":o="middle";break;case"top":o=i?"start":"end";break;default:o=i?"end":"start";break}return o}},{key:"renderAxisLine",value:function(){var a=this.props,s=a.x,i=a.y,o=a.width,l=a.height,c=a.orientation,d=a.mirror,u=a.axisLine,f=pr(pr(pr({},Ce(this.props,!1)),Ce(u,!1)),{},{fill:"none"});if(c==="top"||c==="bottom"){var h=+(c==="top"&&!d||c==="bottom"&&d);f=pr(pr({},f),{},{x1:s,y1:i+h*l,x2:s+o,y2:i+h*l})}else{var m=+(c==="left"&&!d||c==="right"&&d);f=pr(pr({},f),{},{x1:s+m*o,y1:i,x2:s+m*o,y2:i+l})}return Z.createElement("line",ao({},f,{className:qe("recharts-cartesian-axis-line",ka(u,"className"))}))}},{key:"renderTicks",value:function(a,s,i){var o=this,l=this.props,c=l.tickLine,d=l.stroke,u=l.tick,f=l.tickFormatter,h=l.unit,m=qp(pr(pr({},this.props),{},{ticks:a}),s,i),x=this.getTickTextAnchor(),p=this.getTickVerticalAnchor(),g=Ce(this.props,!1),y=Ce(u,!1),w=pr(pr({},g),{},{fill:"none"},Ce(c,!1)),v=m.map(function(_,b){var j=o.getTickLineCoord(_),N=j.line,k=j.tick,S=pr(pr(pr(pr({textAnchor:x,verticalAnchor:p},g),{},{stroke:"none",fill:d},y),k),{},{index:b,payload:_,visibleTicksCount:m.length,tickFormatter:f});return Z.createElement(it,ao({className:"recharts-cartesian-axis-tick",key:"tick-".concat(_.value,"-").concat(_.coordinate,"-").concat(_.tickCoord)},vi(o.props,_,b)),c&&Z.createElement("line",ao({},w,N,{className:qe("recharts-cartesian-axis-tick-line",ka(c,"className"))})),u&&t.renderTickItem(u,S,"".concat($e(f)?f(_.value,b):_.value).concat(h||"")))});return Z.createElement("g",{className:"recharts-cartesian-axis-ticks"},v)}},{key:"render",value:function(){var a=this,s=this.props,i=s.axisLine,o=s.width,l=s.height,c=s.ticksGenerator,d=s.className,u=s.hide;if(u)return null;var f=this.props,h=f.ticks,m=mh(f,LY),x=h;return $e(c)&&(x=h&&h.length>0?c(this.props):c(m)),o<=0||l<=0||!x||!x.length?null:Z.createElement(it,{className:qe("recharts-cartesian-axis",d),ref:function(g){a.layerReference=g}},i&&this.renderAxisLine(),this.renderTicks(x,this.state.fontSize,this.state.letterSpacing),Er.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(a,s,i){var o,l=qe(s.className,"recharts-cartesian-axis-tick-value");return Z.isValidElement(a)?o=Z.cloneElement(a,pr(pr({},s),{},{className:l})):$e(a)?o=a(pr(pr({},s),{},{className:l})):o=Z.createElement(yi,ao({},s,{className:"recharts-cartesian-axis-tick-value"}),i),o}}])}(O.Component);Xp(il,"displayName","CartesianAxis");Xp(il,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var qY=["x1","y1","x2","y2","key"],XY=["offset"];function Ni(e){"@babel/helpers - typeof";return Ni=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ni(e)}function U1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Gr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?U1(Object(r),!0).forEach(function(a){YY(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function YY(e,t,r){return t=JY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JY(e){var t=ZY(e,"string");return Ni(t)=="symbol"?t:t+""}function ZY(e,t){if(Ni(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Ni(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ei(){return ei=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ei.apply(this,arguments)}function W1(e,t){if(e==null)return{};var r=QY(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function QY(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}var eJ=function(t){var r=t.fill;if(!r||r==="none")return null;var a=t.fillOpacity,s=t.x,i=t.y,o=t.width,l=t.height,c=t.ry;return Z.createElement("rect",{x:s,y:i,ry:c,width:o,height:l,stroke:"none",fill:r,fillOpacity:a,className:"recharts-cartesian-grid-bg"})};function AS(e,t){var r;if(Z.isValidElement(e))r=Z.cloneElement(e,t);else if($e(e))r=e(t);else{var a=t.x1,s=t.y1,i=t.x2,o=t.y2,l=t.key,c=W1(t,qY),d=Ce(c,!1);d.offset;var u=W1(d,XY);r=Z.createElement("line",ei({},u,{x1:a,y1:s,x2:i,y2:o,fill:"none",key:l}))}return r}function tJ(e){var t=e.x,r=e.width,a=e.horizontal,s=a===void 0?!0:a,i=e.horizontalPoints;if(!s||!i||!i.length)return null;var o=i.map(function(l,c){var d=Gr(Gr({},e),{},{x1:t,y1:l,x2:t+r,y2:l,key:"line-".concat(c),index:c});return AS(s,d)});return Z.createElement("g",{className:"recharts-cartesian-grid-horizontal"},o)}function rJ(e){var t=e.y,r=e.height,a=e.vertical,s=a===void 0?!0:a,i=e.verticalPoints;if(!s||!i||!i.length)return null;var o=i.map(function(l,c){var d=Gr(Gr({},e),{},{x1:l,y1:t,x2:l,y2:t+r,key:"line-".concat(c),index:c});return AS(s,d)});return Z.createElement("g",{className:"recharts-cartesian-grid-vertical"},o)}function aJ(e){var t=e.horizontalFill,r=e.fillOpacity,a=e.x,s=e.y,i=e.width,o=e.height,l=e.horizontalPoints,c=e.horizontal,d=c===void 0?!0:c;if(!d||!t||!t.length)return null;var u=l.map(function(h){return Math.round(h+s-s)}).sort(function(h,m){return h-m});s!==u[0]&&u.unshift(0);var f=u.map(function(h,m){var x=!u[m+1],p=x?s+o-h:u[m+1]-h;if(p<=0)return null;var g=m%t.length;return Z.createElement("rect",{key:"react-".concat(m),y:h,x:a,height:p,width:i,stroke:"none",fill:t[g],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return Z.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},f)}function nJ(e){var t=e.vertical,r=t===void 0?!0:t,a=e.verticalFill,s=e.fillOpacity,i=e.x,o=e.y,l=e.width,c=e.height,d=e.verticalPoints;if(!r||!a||!a.length)return null;var u=d.map(function(h){return Math.round(h+i-i)}).sort(function(h,m){return h-m});i!==u[0]&&u.unshift(0);var f=u.map(function(h,m){var x=!u[m+1],p=x?i+l-h:u[m+1]-h;if(p<=0)return null;var g=m%a.length;return Z.createElement("rect",{key:"react-".concat(m),x:h,y:o,width:p,height:c,stroke:"none",fill:a[g],fillOpacity:s,className:"recharts-cartesian-grid-bg"})});return Z.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},f)}var sJ=function(t,r){var a=t.xAxis,s=t.width,i=t.height,o=t.offset;return S_(qp(Gr(Gr(Gr({},il.defaultProps),a),{},{ticks:Bn(a,!0),viewBox:{x:0,y:0,width:s,height:i}})),o.left,o.left+o.width,r)},iJ=function(t,r){var a=t.yAxis,s=t.width,i=t.height,o=t.offset;return S_(qp(Gr(Gr(Gr({},il.defaultProps),a),{},{ticks:Bn(a,!0),viewBox:{x:0,y:0,width:s,height:i}})),o.top,o.top+o.height,r)},Gi={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function Cl(e){var t,r,a,s,i,o,l=zp(),c=Vp(),d=KX(),u=Gr(Gr({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Gi.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:Gi.fill,horizontal:(a=e.horizontal)!==null&&a!==void 0?a:Gi.horizontal,horizontalFill:(s=e.horizontalFill)!==null&&s!==void 0?s:Gi.horizontalFill,vertical:(i=e.vertical)!==null&&i!==void 0?i:Gi.vertical,verticalFill:(o=e.verticalFill)!==null&&o!==void 0?o:Gi.verticalFill,x:be(e.x)?e.x:d.left,y:be(e.y)?e.y:d.top,width:be(e.width)?e.width:d.width,height:be(e.height)?e.height:d.height}),f=u.x,h=u.y,m=u.width,x=u.height,p=u.syncWithTicks,g=u.horizontalValues,y=u.verticalValues,w=zX(),v=VX();if(!be(m)||m<=0||!be(x)||x<=0||!be(f)||f!==+f||!be(h)||h!==+h)return null;var _=u.verticalCoordinatesGenerator||sJ,b=u.horizontalCoordinatesGenerator||iJ,j=u.horizontalPoints,N=u.verticalPoints;if((!j||!j.length)&&$e(b)){var k=g&&g.length,S=b({yAxis:v?Gr(Gr({},v),{},{ticks:k?g:v.ticks}):void 0,width:l,height:c,offset:d},k?!0:p);on(Array.isArray(S),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(Ni(S),"]")),Array.isArray(S)&&(j=S)}if((!N||!N.length)&&$e(_)){var E=y&&y.length,P=_({xAxis:w?Gr(Gr({},w),{},{ticks:E?y:w.ticks}):void 0,width:l,height:c,offset:d},E?!0:p);on(Array.isArray(P),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(Ni(P),"]")),Array.isArray(P)&&(N=P)}return Z.createElement("g",{className:"recharts-cartesian-grid"},Z.createElement(eJ,{fill:u.fill,fillOpacity:u.fillOpacity,x:u.x,y:u.y,width:u.width,height:u.height,ry:u.ry}),Z.createElement(tJ,ei({},u,{offset:d,horizontalPoints:j,xAxis:w,yAxis:v})),Z.createElement(rJ,ei({},u,{offset:d,verticalPoints:N,xAxis:w,yAxis:v})),Z.createElement(aJ,ei({},u,{horizontalPoints:j})),Z.createElement(nJ,ei({},u,{verticalPoints:N})))}Cl.displayName="CartesianGrid";var oJ=["type","layout","connectNulls","ref"],lJ=["key"];function Ro(e){"@babel/helpers - typeof";return Ro=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ro(e)}function H1(e,t){if(e==null)return{};var r=cJ(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function cJ(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function Gl(){return Gl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Gl.apply(this,arguments)}function z1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function va(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?z1(Object(r),!0).forEach(function(a){tn(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Ki(e){return hJ(e)||fJ(e)||uJ(e)||dJ()}function dJ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uJ(e,t){if(e){if(typeof e=="string")return ox(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ox(e,t)}}function fJ(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function hJ(e){if(Array.isArray(e))return ox(e)}function ox(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function mJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function V1(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,OS(a.key),a)}}function xJ(e,t,r){return t&&V1(e.prototype,t),r&&V1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pJ(e,t,r){return t=of(t),gJ(e,TS()?Reflect.construct(t,r||[],of(e).constructor):t.apply(e,r))}function gJ(e,t){if(t&&(Ro(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vJ(e)}function vJ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TS(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(TS=function(){return!!e})()}function of(e){return of=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},of(e)}function yJ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lx(e,t)}function lx(e,t){return lx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},lx(e,t)}function tn(e,t,r){return t=OS(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OS(e){var t=bJ(e,"string");return Ro(t)=="symbol"?t:t+""}function bJ(e,t){if(Ro(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Ro(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var pn=function(e){function t(){var r;mJ(this,t);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return r=pJ(this,t,[].concat(s)),tn(r,"state",{isAnimationFinished:!0,totalLength:0}),tn(r,"generateSimpleStrokeDasharray",function(o,l){return"".concat(l,"px ").concat(o-l,"px")}),tn(r,"getStrokeDasharray",function(o,l,c){var d=c.reduce(function(y,w){return y+w});if(!d)return r.generateSimpleStrokeDasharray(l,o);for(var u=Math.floor(o/d),f=o%d,h=l-o,m=[],x=0,p=0;x<c.length;p+=c[x],++x)if(p+c[x]>f){m=[].concat(Ki(c.slice(0,x)),[f-p]);break}var g=m.length%2===0?[0,h]:[h];return[].concat(Ki(t.repeat(c,u)),Ki(m),g).map(function(y){return"".concat(y,"px")}).join(", ")}),tn(r,"id",Ii("recharts-line-")),tn(r,"pathRef",function(o){r.mainCurve=o}),tn(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),tn(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return yJ(t,e),xJ(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var a=this.getTotalLength();this.setState({totalLength:a})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var a=this.getTotalLength();a!==this.state.totalLength&&this.setState({totalLength:a})}}},{key:"getTotalLength",value:function(){var a=this.mainCurve;try{return a&&a.getTotalLength&&a.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(a,s){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.points,l=i.xAxis,c=i.yAxis,d=i.layout,u=i.children,f=Ea(u,pd);if(!f)return null;var h=function(p,g){return{x:p.x,y:p.y,value:p.value,errorVal:nr(p.payload,g)}},m={clipPath:a?"url(#clipPath-".concat(s,")"):null};return Z.createElement(it,m,f.map(function(x){return Z.cloneElement(x,{key:"bar-".concat(x.props.dataKey),data:o,xAxis:l,yAxis:c,layout:d,dataPointFormatter:h})}))}},{key:"renderDots",value:function(a,s,i){var o=this.props.isAnimationActive;if(o&&!this.state.isAnimationFinished)return null;var l=this.props,c=l.dot,d=l.points,u=l.dataKey,f=Ce(this.props,!1),h=Ce(c,!0),m=d.map(function(p,g){var y=va(va(va({key:"dot-".concat(g),r:3},f),h),{},{index:g,cx:p.x,cy:p.y,value:p.value,dataKey:u,payload:p.payload,points:d});return t.renderDotItem(c,y)}),x={clipPath:a?"url(#clipPath-".concat(s?"":"dots-").concat(i,")"):null};return Z.createElement(it,Gl({className:"recharts-line-dots",key:"dots"},x),m)}},{key:"renderCurveStatically",value:function(a,s,i,o){var l=this.props,c=l.type,d=l.layout,u=l.connectNulls;l.ref;var f=H1(l,oJ),h=va(va(va({},Ce(f,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:s?"url(#clipPath-".concat(i,")"):null,points:a},o),{},{type:c,layout:d,connectNulls:u});return Z.createElement(oi,Gl({},h,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(a,s){var i=this,o=this.props,l=o.points,c=o.strokeDasharray,d=o.isAnimationActive,u=o.animationBegin,f=o.animationDuration,h=o.animationEasing,m=o.animationId,x=o.animateNewValues,p=o.width,g=o.height,y=this.state,w=y.prevPoints,v=y.totalLength;return Z.createElement(dn,{begin:u,duration:f,isActive:d,easing:h,from:{t:0},to:{t:1},key:"line-".concat(m),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(_){var b=_.t;if(w){var j=w.length/l.length,N=l.map(function(C,T){var M=Math.floor(T*j);if(w[M]){var A=w[M],F=vr(A.x,C.x),H=vr(A.y,C.y);return va(va({},C),{},{x:F(b),y:H(b)})}if(x){var V=vr(p*2,C.x),B=vr(g/2,C.y);return va(va({},C),{},{x:V(b),y:B(b)})}return va(va({},C),{},{x:C.x,y:C.y})});return i.renderCurveStatically(N,a,s)}var k=vr(0,v),S=k(b),E;if(c){var P="".concat(c).split(/[,\s]+/gim).map(function(C){return parseFloat(C)});E=i.getStrokeDasharray(S,v,P)}else E=i.generateSimpleStrokeDasharray(v,S);return i.renderCurveStatically(l,a,s,{strokeDasharray:E})})}},{key:"renderCurve",value:function(a,s){var i=this.props,o=i.points,l=i.isAnimationActive,c=this.state,d=c.prevPoints,u=c.totalLength;return l&&o&&o.length&&(!d&&u>0||!bi(d,o))?this.renderCurveWithAnimation(a,s):this.renderCurveStatically(o,a,s)}},{key:"render",value:function(){var a,s=this.props,i=s.hide,o=s.dot,l=s.points,c=s.className,d=s.xAxis,u=s.yAxis,f=s.top,h=s.left,m=s.width,x=s.height,p=s.isAnimationActive,g=s.id;if(i||!l||!l.length)return null;var y=this.state.isAnimationFinished,w=l.length===1,v=qe("recharts-line",c),_=d&&d.allowDataOverflow,b=u&&u.allowDataOverflow,j=_||b,N=We(g)?this.id:g,k=(a=Ce(o,!1))!==null&&a!==void 0?a:{r:3,strokeWidth:2},S=k.r,E=S===void 0?3:S,P=k.strokeWidth,C=P===void 0?2:P,T=g2(o)?o:{},M=T.clipDot,A=M===void 0?!0:M,F=E*2+C;return Z.createElement(it,{className:v},_||b?Z.createElement("defs",null,Z.createElement("clipPath",{id:"clipPath-".concat(N)},Z.createElement("rect",{x:_?h:h-m/2,y:b?f:f-x/2,width:_?m:m*2,height:b?x:x*2})),!A&&Z.createElement("clipPath",{id:"clipPath-dots-".concat(N)},Z.createElement("rect",{x:h-F/2,y:f-F/2,width:m+F,height:x+F}))):null,!w&&this.renderCurve(j,N),this.renderErrorBar(j,N),(w||o)&&this.renderDots(j,A,N),(!p||y)&&_n.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(a,s){return a.animationId!==s.prevAnimationId?{prevAnimationId:a.animationId,curPoints:a.points,prevPoints:s.curPoints}:a.points!==s.curPoints?{curPoints:a.points}:null}},{key:"repeat",value:function(a,s){for(var i=a.length%2!==0?[].concat(Ki(a),[0]):a,o=[],l=0;l<s;++l)o=[].concat(Ki(o),Ki(i));return o}},{key:"renderDotItem",value:function(a,s){var i;if(Z.isValidElement(a))i=Z.cloneElement(a,s);else if($e(a))i=a(s);else{var o=s.key,l=H1(s,lJ),c=qe("recharts-line-dot",typeof a!="boolean"?a.className:"");i=Z.createElement(gd,Gl({key:o},l,{className:c}))}return i}}])}(O.PureComponent);tn(pn,"displayName","Line");tn(pn,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Os.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});tn(pn,"getComposedData",function(e){var t=e.props,r=e.xAxis,a=e.yAxis,s=e.xAxisTicks,i=e.yAxisTicks,o=e.dataKey,l=e.bandSize,c=e.displayedData,d=e.offset,u=t.layout,f=c.map(function(h,m){var x=nr(h,o);return u==="horizontal"?{x:Mu({axis:r,ticks:s,bandSize:l,entry:h,index:m}),y:We(x)?null:a.scale(x),value:x,payload:h}:{x:We(x)?null:r.scale(x),y:Mu({axis:a,ticks:i,bandSize:l,entry:h,index:m}),value:x,payload:h}});return va({points:f,layout:u},d)});var wJ=["layout","type","stroke","connectNulls","isRange","ref"],jJ=["key"],PS;function Mo(e){"@babel/helpers - typeof";return Mo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mo(e)}function CS(e,t){if(e==null)return{};var r=NJ(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function NJ(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function ti(){return ti=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ti.apply(this,arguments)}function G1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function fs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?G1(Object(r),!0).forEach(function(a){yn(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function _J(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function K1(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,IS(a.key),a)}}function SJ(e,t,r){return t&&K1(e.prototype,t),r&&K1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kJ(e,t,r){return t=lf(t),EJ(e,FS()?Reflect.construct(t,r||[],lf(e).constructor):t.apply(e,r))}function EJ(e,t){if(t&&(Mo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AJ(e)}function AJ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FS(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(FS=function(){return!!e})()}function lf(e){return lf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lf(e)}function TJ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cx(e,t)}function cx(e,t){return cx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},cx(e,t)}function yn(e,t,r){return t=IS(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IS(e){var t=OJ(e,"string");return Mo(t)=="symbol"?t:t+""}function OJ(e,t){if(Mo(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Mo(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var kn=function(e){function t(){var r;_J(this,t);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return r=kJ(this,t,[].concat(s)),yn(r,"state",{isAnimationFinished:!0}),yn(r,"id",Ii("recharts-area-")),yn(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),$e(o)&&o()}),yn(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),$e(o)&&o()}),r}return TJ(t,e),SJ(t,[{key:"renderDots",value:function(a,s,i){var o=this.props.isAnimationActive,l=this.state.isAnimationFinished;if(o&&!l)return null;var c=this.props,d=c.dot,u=c.points,f=c.dataKey,h=Ce(this.props,!1),m=Ce(d,!0),x=u.map(function(g,y){var w=fs(fs(fs({key:"dot-".concat(y),r:3},h),m),{},{index:y,cx:g.x,cy:g.y,dataKey:f,value:g.value,payload:g.payload,points:u});return t.renderDotItem(d,w)}),p={clipPath:a?"url(#clipPath-".concat(s?"":"dots-").concat(i,")"):null};return Z.createElement(it,ti({className:"recharts-area-dots"},p),x)}},{key:"renderHorizontalRect",value:function(a){var s=this.props,i=s.baseLine,o=s.points,l=s.strokeWidth,c=o[0].x,d=o[o.length-1].x,u=a*Math.abs(c-d),f=xs(o.map(function(h){return h.y||0}));return be(i)&&typeof i=="number"?f=Math.max(i,f):i&&Array.isArray(i)&&i.length&&(f=Math.max(xs(i.map(function(h){return h.y||0})),f)),be(f)?Z.createElement("rect",{x:c<d?c:c-u,y:0,width:u,height:Math.floor(f+(l?parseInt("".concat(l),10):1))}):null}},{key:"renderVerticalRect",value:function(a){var s=this.props,i=s.baseLine,o=s.points,l=s.strokeWidth,c=o[0].y,d=o[o.length-1].y,u=a*Math.abs(c-d),f=xs(o.map(function(h){return h.x||0}));return be(i)&&typeof i=="number"?f=Math.max(i,f):i&&Array.isArray(i)&&i.length&&(f=Math.max(xs(i.map(function(h){return h.x||0})),f)),be(f)?Z.createElement("rect",{x:0,y:c<d?c:c-u,width:f+(l?parseInt("".concat(l),10):1),height:Math.floor(u)}):null}},{key:"renderClipRect",value:function(a){var s=this.props.layout;return s==="vertical"?this.renderVerticalRect(a):this.renderHorizontalRect(a)}},{key:"renderAreaStatically",value:function(a,s,i,o){var l=this.props,c=l.layout,d=l.type,u=l.stroke,f=l.connectNulls,h=l.isRange;l.ref;var m=CS(l,wJ);return Z.createElement(it,{clipPath:i?"url(#clipPath-".concat(o,")"):null},Z.createElement(oi,ti({},Ce(m,!0),{points:a,connectNulls:f,type:d,baseLine:s,layout:c,stroke:"none",className:"recharts-area-area"})),u!=="none"&&Z.createElement(oi,ti({},Ce(this.props,!1),{className:"recharts-area-curve",layout:c,type:d,connectNulls:f,fill:"none",points:a})),u!=="none"&&h&&Z.createElement(oi,ti({},Ce(this.props,!1),{className:"recharts-area-curve",layout:c,type:d,connectNulls:f,fill:"none",points:s})))}},{key:"renderAreaWithAnimation",value:function(a,s){var i=this,o=this.props,l=o.points,c=o.baseLine,d=o.isAnimationActive,u=o.animationBegin,f=o.animationDuration,h=o.animationEasing,m=o.animationId,x=this.state,p=x.prevPoints,g=x.prevBaseLine;return Z.createElement(dn,{begin:u,duration:f,isActive:d,easing:h,from:{t:0},to:{t:1},key:"area-".concat(m),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(y){var w=y.t;if(p){var v=p.length/l.length,_=l.map(function(k,S){var E=Math.floor(S*v);if(p[E]){var P=p[E],C=vr(P.x,k.x),T=vr(P.y,k.y);return fs(fs({},k),{},{x:C(w),y:T(w)})}return k}),b;if(be(c)&&typeof c=="number"){var j=vr(g,c);b=j(w)}else if(We(c)||Qo(c)){var N=vr(g,0);b=N(w)}else b=c.map(function(k,S){var E=Math.floor(S*v);if(g[E]){var P=g[E],C=vr(P.x,k.x),T=vr(P.y,k.y);return fs(fs({},k),{},{x:C(w),y:T(w)})}return k});return i.renderAreaStatically(_,b,a,s)}return Z.createElement(it,null,Z.createElement("defs",null,Z.createElement("clipPath",{id:"animationClipPath-".concat(s)},i.renderClipRect(w))),Z.createElement(it,{clipPath:"url(#animationClipPath-".concat(s,")")},i.renderAreaStatically(l,c,a,s)))})}},{key:"renderArea",value:function(a,s){var i=this.props,o=i.points,l=i.baseLine,c=i.isAnimationActive,d=this.state,u=d.prevPoints,f=d.prevBaseLine,h=d.totalLength;return c&&o&&o.length&&(!u&&h>0||!bi(u,o)||!bi(f,l))?this.renderAreaWithAnimation(a,s):this.renderAreaStatically(o,l,a,s)}},{key:"render",value:function(){var a,s=this.props,i=s.hide,o=s.dot,l=s.points,c=s.className,d=s.top,u=s.left,f=s.xAxis,h=s.yAxis,m=s.width,x=s.height,p=s.isAnimationActive,g=s.id;if(i||!l||!l.length)return null;var y=this.state.isAnimationFinished,w=l.length===1,v=qe("recharts-area",c),_=f&&f.allowDataOverflow,b=h&&h.allowDataOverflow,j=_||b,N=We(g)?this.id:g,k=(a=Ce(o,!1))!==null&&a!==void 0?a:{r:3,strokeWidth:2},S=k.r,E=S===void 0?3:S,P=k.strokeWidth,C=P===void 0?2:P,T=g2(o)?o:{},M=T.clipDot,A=M===void 0?!0:M,F=E*2+C;return Z.createElement(it,{className:v},_||b?Z.createElement("defs",null,Z.createElement("clipPath",{id:"clipPath-".concat(N)},Z.createElement("rect",{x:_?u:u-m/2,y:b?d:d-x/2,width:_?m:m*2,height:b?x:x*2})),!A&&Z.createElement("clipPath",{id:"clipPath-dots-".concat(N)},Z.createElement("rect",{x:u-F/2,y:d-F/2,width:m+F,height:x+F}))):null,w?null:this.renderArea(j,N),(o||w)&&this.renderDots(j,A,N),(!p||y)&&_n.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(a,s){return a.animationId!==s.prevAnimationId?{prevAnimationId:a.animationId,curPoints:a.points,curBaseLine:a.baseLine,prevPoints:s.curPoints,prevBaseLine:s.curBaseLine}:a.points!==s.curPoints||a.baseLine!==s.curBaseLine?{curPoints:a.points,curBaseLine:a.baseLine}:null}}])}(O.PureComponent);PS=kn;yn(kn,"displayName","Area");yn(kn,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!Os.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});yn(kn,"getBaseValue",function(e,t,r,a){var s=e.layout,i=e.baseValue,o=t.props.baseValue,l=o??i;if(be(l)&&typeof l=="number")return l;var c=s==="horizontal"?a:r,d=c.scale.domain();if(c.type==="number"){var u=Math.max(d[0],d[1]),f=Math.min(d[0],d[1]);return l==="dataMin"?f:l==="dataMax"||u<0?u:Math.max(Math.min(d[0],d[1]),0)}return l==="dataMin"?d[0]:l==="dataMax"?d[1]:d[0]});yn(kn,"getComposedData",function(e){var t=e.props,r=e.item,a=e.xAxis,s=e.yAxis,i=e.xAxisTicks,o=e.yAxisTicks,l=e.bandSize,c=e.dataKey,d=e.stackedData,u=e.dataStartIndex,f=e.displayedData,h=e.offset,m=t.layout,x=d&&d.length,p=PS.getBaseValue(t,r,a,s),g=m==="horizontal",y=!1,w=f.map(function(_,b){var j;x?j=d[u+b]:(j=nr(_,c),Array.isArray(j)?y=!0:j=[p,j]);var N=j[1]==null||x&&nr(_,c)==null;return g?{x:Mu({axis:a,ticks:i,bandSize:l,entry:_,index:b}),y:N?null:s.scale(j[1]),value:j,payload:_}:{x:N?null:a.scale(j[1]),y:Mu({axis:s,ticks:o,bandSize:l,entry:_,index:b}),value:j,payload:_}}),v;return x||y?v=w.map(function(_){var b=Array.isArray(_.value)?_.value[0]:null;return g?{x:_.x,y:b!=null&&_.y!=null?s.scale(b):null}:{x:b!=null?a.scale(b):null,y:_.y}}):v=g?s.scale(p):a.scale(p),fs({points:w,baseLine:v,layout:m,isRange:y},h)});yn(kn,"renderDotItem",function(e,t){var r;if(Z.isValidElement(e))r=Z.cloneElement(e,t);else if($e(e))r=e(t);else{var a=qe("recharts-area-dot",typeof e!="boolean"?e.className:""),s=t.key,i=CS(t,jJ);r=Z.createElement(gd,ti({},i,{key:s,className:a}))}return r});function $o(e){"@babel/helpers - typeof";return $o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$o(e)}function PJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CJ(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,MS(a.key),a)}}function FJ(e,t,r){return t&&CJ(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function IJ(e,t,r){return t=cf(t),DJ(e,DS()?Reflect.construct(t,r||[],cf(e).constructor):t.apply(e,r))}function DJ(e,t){if(t&&($o(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RJ(e)}function RJ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DS(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(DS=function(){return!!e})()}function cf(e){return cf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cf(e)}function MJ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dx(e,t)}function dx(e,t){return dx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},dx(e,t)}function RS(e,t,r){return t=MS(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MS(e){var t=$J(e,"string");return $o(t)=="symbol"?t:t+""}function $J(e,t){if($o(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if($o(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function ux(){return ux=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ux.apply(this,arguments)}function LJ(e){var t=e.xAxisId,r=zp(),a=Vp(),s=gS(t);return s==null?null:O.createElement(il,ux({},s,{className:qe("recharts-".concat(s.axisType," ").concat(s.axisType),s.className),viewBox:{x:0,y:0,width:r,height:a},ticksGenerator:function(o){return Bn(o,!0)}}))}var Un=function(e){function t(){return PJ(this,t),IJ(this,t,arguments)}return MJ(t,e),FJ(t,[{key:"render",value:function(){return O.createElement(LJ,this.props)}}])}(O.Component);RS(Un,"displayName","XAxis");RS(Un,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Lo(e){"@babel/helpers - typeof";return Lo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lo(e)}function BJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UJ(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,BS(a.key),a)}}function WJ(e,t,r){return t&&UJ(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function HJ(e,t,r){return t=df(t),zJ(e,$S()?Reflect.construct(t,r||[],df(e).constructor):t.apply(e,r))}function zJ(e,t){if(t&&(Lo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VJ(e)}function VJ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $S(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return($S=function(){return!!e})()}function df(e){return df=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},df(e)}function GJ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fx(e,t)}function fx(e,t){return fx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},fx(e,t)}function LS(e,t,r){return t=BS(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BS(e){var t=KJ(e,"string");return Lo(t)=="symbol"?t:t+""}function KJ(e,t){if(Lo(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Lo(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function hx(){return hx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},hx.apply(this,arguments)}var qJ=function(t){var r=t.yAxisId,a=zp(),s=Vp(),i=vS(r);return i==null?null:O.createElement(il,hx({},i,{className:qe("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:a,height:s},ticksGenerator:function(l){return Bn(l,!0)}}))},Wn=function(e){function t(){return BJ(this,t),HJ(this,t,arguments)}return GJ(t,e),WJ(t,[{key:"render",value:function(){return O.createElement(qJ,this.props)}}])}(O.Component);LS(Wn,"displayName","YAxis");LS(Wn,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function q1(e){return ZJ(e)||JJ(e)||YJ(e)||XJ()}function XJ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YJ(e,t){if(e){if(typeof e=="string")return mx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mx(e,t)}}function JJ(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ZJ(e){if(Array.isArray(e))return mx(e)}function mx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var xx=function(t,r,a,s,i){var o=Ea(t,Kp),l=Ea(t,N0),c=[].concat(q1(o),q1(l)),d=Ea(t,S0),u="".concat(s,"Id"),f=s[0],h=r;if(c.length&&(h=c.reduce(function(p,g){if(g.props[u]===a&&Sn(g.props,"extendDomain")&&be(g.props[f])){var y=g.props[f];return[Math.min(p[0],y),Math.max(p[1],y)]}return p},h)),d.length){var m="".concat(f,"1"),x="".concat(f,"2");h=d.reduce(function(p,g){if(g.props[u]===a&&Sn(g.props,"extendDomain")&&be(g.props[m])&&be(g.props[x])){var y=g.props[m],w=g.props[x];return[Math.min(p[0],y,w),Math.max(p[1],y,w)]}return p},h)}return i&&i.length&&(h=i.reduce(function(p,g){return be(g)?[Math.min(p[0],g),Math.max(p[1],g)]:p},h)),h},US={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function a(){}Object.create&&(a.prototype=Object.create(null),new a().__proto__||(r=!1));function s(c,d,u){this.fn=c,this.context=d,this.once=u||!1}function i(c,d,u,f,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var m=new s(u,f||c,h),x=r?r+d:d;return c._events[x]?c._events[x].fn?c._events[x]=[c._events[x],m]:c._events[x].push(m):(c._events[x]=m,c._eventsCount++),c}function o(c,d){--c._eventsCount===0?c._events=new a:delete c._events[d]}function l(){this._events=new a,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],u,f;if(this._eventsCount===0)return d;for(f in u=this._events)t.call(u,f)&&d.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(u)):d},l.prototype.listeners=function(d){var u=r?r+d:d,f=this._events[u];if(!f)return[];if(f.fn)return[f.fn];for(var h=0,m=f.length,x=new Array(m);h<m;h++)x[h]=f[h].fn;return x},l.prototype.listenerCount=function(d){var u=r?r+d:d,f=this._events[u];return f?f.fn?1:f.length:0},l.prototype.emit=function(d,u,f,h,m,x){var p=r?r+d:d;if(!this._events[p])return!1;var g=this._events[p],y=arguments.length,w,v;if(g.fn){switch(g.once&&this.removeListener(d,g.fn,void 0,!0),y){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,f),!0;case 4:return g.fn.call(g.context,u,f,h),!0;case 5:return g.fn.call(g.context,u,f,h,m),!0;case 6:return g.fn.call(g.context,u,f,h,m,x),!0}for(v=1,w=new Array(y-1);v<y;v++)w[v-1]=arguments[v];g.fn.apply(g.context,w)}else{var _=g.length,b;for(v=0;v<_;v++)switch(g[v].once&&this.removeListener(d,g[v].fn,void 0,!0),y){case 1:g[v].fn.call(g[v].context);break;case 2:g[v].fn.call(g[v].context,u);break;case 3:g[v].fn.call(g[v].context,u,f);break;case 4:g[v].fn.call(g[v].context,u,f,h);break;default:if(!w)for(b=1,w=new Array(y-1);b<y;b++)w[b-1]=arguments[b];g[v].fn.apply(g[v].context,w)}}return!0},l.prototype.on=function(d,u,f){return i(this,d,u,f,!1)},l.prototype.once=function(d,u,f){return i(this,d,u,f,!0)},l.prototype.removeListener=function(d,u,f,h){var m=r?r+d:d;if(!this._events[m])return this;if(!u)return o(this,m),this;var x=this._events[m];if(x.fn)x.fn===u&&(!h||x.once)&&(!f||x.context===f)&&o(this,m);else{for(var p=0,g=[],y=x.length;p<y;p++)(x[p].fn!==u||h&&!x[p].once||f&&x[p].context!==f)&&g.push(x[p]);g.length?this._events[m]=g.length===1?g[0]:g:o(this,m)}return this},l.prototype.removeAllListeners=function(d){var u;return d?(u=r?r+d:d,this._events[u]&&o(this,u)):(this._events=new a,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(US);var QJ=US.exports;const eZ=kt(QJ);var xh=new eZ,ph="recharts.syncMouseEvents";function Wc(e){"@babel/helpers - typeof";return Wc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wc(e)}function tZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rZ(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,WS(a.key),a)}}function aZ(e,t,r){return t&&rZ(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function gh(e,t,r){return t=WS(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WS(e){var t=nZ(e,"string");return Wc(t)=="symbol"?t:t+""}function nZ(e,t){if(Wc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Wc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var sZ=function(){function e(){tZ(this,e),gh(this,"activeIndex",0),gh(this,"coordinateList",[]),gh(this,"layout","horizontal")}return aZ(e,[{key:"setDetails",value:function(r){var a,s=r.coordinateList,i=s===void 0?null:s,o=r.container,l=o===void 0?null:o,c=r.layout,d=c===void 0?null:c,u=r.offset,f=u===void 0?null:u,h=r.mouseHandlerCallback,m=h===void 0?null:h;this.coordinateList=(a=i??this.coordinateList)!==null&&a!==void 0?a:[],this.container=l??this.container,this.layout=d??this.layout,this.offset=f??this.offset,this.mouseHandlerCallback=m??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,a;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var s=this.container.getBoundingClientRect(),i=s.x,o=s.y,l=s.height,c=this.coordinateList[this.activeIndex].coordinate,d=((r=window)===null||r===void 0?void 0:r.scrollX)||0,u=((a=window)===null||a===void 0?void 0:a.scrollY)||0,f=i+c+d,h=o+this.offset.top+l/2+u;this.mouseHandlerCallback({pageX:f,pageY:h})}}}])}();function iZ(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var a=e==null?void 0:e[0],s=e==null?void 0:e[1];if(a&&s&&be(a)&&be(s))return!0}return!1}function oZ(e,t,r,a){var s=a/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-s:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-s,width:e==="horizontal"?a:r.width-1,height:e==="horizontal"?r.height-1:a}}function HS(e){var t=e.cx,r=e.cy,a=e.radius,s=e.startAngle,i=e.endAngle,o=Dt(t,r,a,s),l=Dt(t,r,a,i);return{points:[o,l],cx:t,cy:r,radius:a,startAngle:s,endAngle:i}}function lZ(e,t,r){var a,s,i,o;if(e==="horizontal")a=t.x,i=a,s=r.top,o=r.top+r.height;else if(e==="vertical")s=t.y,o=s,a=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var l=t.cx,c=t.cy,d=t.innerRadius,u=t.outerRadius,f=t.angle,h=Dt(l,c,d,f),m=Dt(l,c,u,f);a=h.x,s=h.y,i=m.x,o=m.y}else return HS(t);return[{x:a,y:s},{x:i,y:o}]}function Hc(e){"@babel/helpers - typeof";return Hc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hc(e)}function X1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Wd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?X1(Object(r),!0).forEach(function(a){cZ(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function cZ(e,t,r){return t=dZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dZ(e){var t=uZ(e,"string");return Hc(t)=="symbol"?t:t+""}function uZ(e,t){if(Hc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Hc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fZ(e){var t,r,a=e.element,s=e.tooltipEventType,i=e.isActive,o=e.activeCoordinate,l=e.activePayload,c=e.offset,d=e.activeTooltipIndex,u=e.tooltipAxisBandSize,f=e.layout,h=e.chartName,m=(t=a.props.cursor)!==null&&t!==void 0?t:(r=a.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!a||!m||!i||!o||h!=="ScatterChart"&&s!=="axis")return null;var x,p=oi;if(h==="ScatterChart")x=o,p=bG;else if(h==="BarChart")x=oZ(f,o,c,u),p=Lp;else if(f==="radial"){var g=HS(o),y=g.cx,w=g.cy,v=g.radius,_=g.startAngle,b=g.endAngle;x={cx:y,cy:w,startAngle:_,endAngle:b,innerRadius:v,outerRadius:v},p=R_}else x={points:lZ(f,o,c)},p=oi;var j=Wd(Wd(Wd(Wd({stroke:"#ccc",pointerEvents:"none"},c),x),Ce(m,!1)),{},{payload:l,payloadIndex:d,className:qe("recharts-tooltip-cursor",m.className)});return O.isValidElement(m)?O.cloneElement(m,j):O.createElement(p,j)}var hZ=["item"],mZ=["children","className","width","height","style","compact","title","desc"];function Bo(e){"@babel/helpers - typeof";return Bo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bo(e)}function no(){return no=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},no.apply(this,arguments)}function Y1(e,t){return gZ(e)||pZ(e,t)||VS(e,t)||xZ()}function xZ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pZ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function gZ(e){if(Array.isArray(e))return e}function J1(e,t){if(e==null)return{};var r=vZ(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function vZ(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function yZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bZ(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,GS(a.key),a)}}function wZ(e,t,r){return t&&bZ(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function jZ(e,t,r){return t=uf(t),NZ(e,zS()?Reflect.construct(t,r||[],uf(e).constructor):t.apply(e,r))}function NZ(e,t){if(t&&(Bo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _Z(e)}function _Z(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zS(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zS=function(){return!!e})()}function uf(e){return uf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},uf(e)}function SZ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&px(e,t)}function px(e,t){return px=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},px(e,t)}function Uo(e){return AZ(e)||EZ(e)||VS(e)||kZ()}function kZ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VS(e,t){if(e){if(typeof e=="string")return gx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gx(e,t)}}function EZ(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function AZ(e){if(Array.isArray(e))return gx(e)}function gx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Z1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function ue(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Z1(Object(r),!0).forEach(function(a){Re(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Re(e,t,r){return t=GS(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GS(e){var t=TZ(e,"string");return Bo(t)=="symbol"?t:t+""}function TZ(e,t){if(Bo(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Bo(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var OZ={xAxis:["bottom","top"],yAxis:["left","right"]},PZ={width:"100%",height:"100%"},KS={x:0,y:0};function Hd(e){return e}var CZ=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},FZ=function(t,r,a,s){var i=r.find(function(u){return u&&u.index===a});if(i){if(t==="horizontal")return{x:i.coordinate,y:s.y};if(t==="vertical")return{x:s.x,y:i.coordinate};if(t==="centric"){var o=i.coordinate,l=s.radius;return ue(ue(ue({},s),Dt(s.cx,s.cy,l,o)),{},{angle:o,radius:l})}var c=i.coordinate,d=s.angle;return ue(ue(ue({},s),Dt(s.cx,s.cy,c,d)),{},{angle:d,radius:c})}return KS},k0=function(t,r){var a=r.graphicalItems,s=r.dataStartIndex,i=r.dataEndIndex,o=(a??[]).reduce(function(l,c){var d=c.props.data;return d&&d.length?[].concat(Uo(l),Uo(d)):l},[]);return o.length>0?o:t&&t.length&&be(s)&&be(i)?t.slice(s,i+1):[]};function qS(e){return e==="number"?[0,"auto"]:void 0}var vx=function(t,r,a,s){var i=t.graphicalItems,o=t.tooltipAxis,l=k0(r,t);return a<0||!i||!i.length||a>=l.length?null:i.reduce(function(c,d){var u,f=(u=d.props.data)!==null&&u!==void 0?u:r;f&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=a&&(f=f.slice(t.dataStartIndex,t.dataEndIndex+1));var h;if(o.dataKey&&!o.allowDuplicatedCategory){var m=f===void 0?l:f;h=cu(m,o.dataKey,s)}else h=f&&f[a]||l[a];return h?[].concat(Uo(c),[O_(d,h)]):c},[])},Q1=function(t,r,a,s){var i=s||{x:t.chartX,y:t.chartY},o=CZ(i,a),l=t.orderedTooltipTicks,c=t.tooltipAxis,d=t.tooltipTicks,u=zW(o,l,d,c);if(u>=0&&d){var f=d[u]&&d[u].value,h=vx(t,r,u,f),m=FZ(a,l,u,i);return{activeTooltipIndex:u,activeLabel:f,activePayload:h,activeCoordinate:m}}return null},IZ=function(t,r){var a=r.axes,s=r.graphicalItems,i=r.axisType,o=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.layout,f=t.children,h=t.stackOffset,m=__(u,i);return a.reduce(function(x,p){var g,y=p.type.defaultProps!==void 0?ue(ue({},p.type.defaultProps),p.props):p.props,w=y.type,v=y.dataKey,_=y.allowDataOverflow,b=y.allowDuplicatedCategory,j=y.scale,N=y.ticks,k=y.includeHidden,S=y[o];if(x[S])return x;var E=k0(t.data,{graphicalItems:s.filter(function(I){var K,z=o in I.props?I.props[o]:(K=I.type.defaultProps)===null||K===void 0?void 0:K[o];return z===S}),dataStartIndex:c,dataEndIndex:d}),P=E.length,C,T,M;iZ(y.domain,_,w)&&(C=Pm(y.domain,null,_),m&&(w==="number"||j!=="auto")&&(M=Wl(E,v,"category")));var A=qS(w);if(!C||C.length===0){var F,H=(F=y.domain)!==null&&F!==void 0?F:A;if(v){if(C=Wl(E,v,w),w==="category"&&m){var V=IO(C);b&&V?(T=C,C=Yu(0,P)):b||(C=yb(H,C,p).reduce(function(I,K){return I.indexOf(K)>=0?I:[].concat(Uo(I),[K])},[]))}else if(w==="category")b?C=C.filter(function(I){return I!==""&&!We(I)}):C=yb(H,C,p).reduce(function(I,K){return I.indexOf(K)>=0||K===""||We(K)?I:[].concat(Uo(I),[K])},[]);else if(w==="number"){var B=XW(E,s.filter(function(I){var K,z,W=o in I.props?I.props[o]:(K=I.type.defaultProps)===null||K===void 0?void 0:K[o],re="hide"in I.props?I.props.hide:(z=I.type.defaultProps)===null||z===void 0?void 0:z.hide;return W===S&&(k||!re)}),v,i,u);B&&(C=B)}m&&(w==="number"||j!=="auto")&&(M=Wl(E,v,"category"))}else m?C=Yu(0,P):l&&l[S]&&l[S].hasStack&&w==="number"?C=h==="expand"?[0,1]:T_(l[S].stackGroups,c,d):C=N_(E,s.filter(function(I){var K=o in I.props?I.props[o]:I.type.defaultProps[o],z="hide"in I.props?I.props.hide:I.type.defaultProps.hide;return K===S&&(k||!z)}),w,u,!0);if(w==="number")C=xx(f,C,S,i,N),H&&(C=Pm(H,C,_));else if(w==="category"&&H){var L=H,ee=C.every(function(I){return L.indexOf(I)>=0});ee&&(C=L)}}return ue(ue({},x),{},Re({},S,ue(ue({},y),{},{axisType:i,domain:C,categoricalDomain:M,duplicateDomain:T,originalDomain:(g=y.domain)!==null&&g!==void 0?g:A,isCategorical:m,layout:u})))},{})},DZ=function(t,r){var a=r.graphicalItems,s=r.Axis,i=r.axisType,o=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.layout,f=t.children,h=k0(t.data,{graphicalItems:a,dataStartIndex:c,dataEndIndex:d}),m=h.length,x=__(u,i),p=-1;return a.reduce(function(g,y){var w=y.type.defaultProps!==void 0?ue(ue({},y.type.defaultProps),y.props):y.props,v=w[o],_=qS("number");if(!g[v]){p++;var b;return x?b=Yu(0,m):l&&l[v]&&l[v].hasStack?(b=T_(l[v].stackGroups,c,d),b=xx(f,b,v,i)):(b=Pm(_,N_(h,a.filter(function(j){var N,k,S=o in j.props?j.props[o]:(N=j.type.defaultProps)===null||N===void 0?void 0:N[o],E="hide"in j.props?j.props.hide:(k=j.type.defaultProps)===null||k===void 0?void 0:k.hide;return S===v&&!E}),"number",u),s.defaultProps.allowDataOverflow),b=xx(f,b,v,i)),ue(ue({},g),{},Re({},v,ue(ue({axisType:i},s.defaultProps),{},{hide:!0,orientation:ka(OZ,"".concat(i,".").concat(p%2),null),domain:b,originalDomain:_,isCategorical:x,layout:u})))}return g},{})},RZ=function(t,r){var a=r.axisType,s=a===void 0?"xAxis":a,i=r.AxisComp,o=r.graphicalItems,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.children,f="".concat(s,"Id"),h=Ea(u,i),m={};return h&&h.length?m=IZ(t,{axes:h,graphicalItems:o,axisType:s,axisIdKey:f,stackGroups:l,dataStartIndex:c,dataEndIndex:d}):o&&o.length&&(m=DZ(t,{Axis:i,graphicalItems:o,axisType:s,axisIdKey:f,stackGroups:l,dataStartIndex:c,dataEndIndex:d})),m},MZ=function(t){var r=ms(t),a=Bn(r,!1,!0);return{tooltipTicks:a,orderedTooltipTicks:fp(a,function(s){return s.coordinate}),tooltipAxis:r,tooltipAxisBandSize:$u(r,a)}},ew=function(t){var r=t.children,a=t.defaultShowTooltip,s=ba(r,Oo),i=0,o=0;return t.data&&t.data.length!==0&&(o=t.data.length-1),s&&s.props&&(s.props.startIndex>=0&&(i=s.props.startIndex),s.props.endIndex>=0&&(o=s.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:i,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!a}},$Z=function(t){return!t||!t.length?!1:t.some(function(r){var a=zn(r&&r.type);return a&&a.indexOf("Bar")>=0})},tw=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},LZ=function(t,r){var a=t.props,s=t.graphicalItems,i=t.xAxisMap,o=i===void 0?{}:i,l=t.yAxisMap,c=l===void 0?{}:l,d=a.width,u=a.height,f=a.children,h=a.margin||{},m=ba(f,Oo),x=ba(f,oo),p=Object.keys(c).reduce(function(b,j){var N=c[j],k=N.orientation;return!N.mirror&&!N.hide?ue(ue({},b),{},Re({},k,b[k]+N.width)):b},{left:h.left||0,right:h.right||0}),g=Object.keys(o).reduce(function(b,j){var N=o[j],k=N.orientation;return!N.mirror&&!N.hide?ue(ue({},b),{},Re({},k,ka(b,"".concat(k))+N.height)):b},{top:h.top||0,bottom:h.bottom||0}),y=ue(ue({},g),p),w=y.bottom;m&&(y.bottom+=m.props.height||Oo.defaultProps.height),x&&r&&(y=KW(y,s,a,r));var v=d-y.left-y.right,_=u-y.top-y.bottom;return ue(ue({brushBottom:w},y),{},{width:Math.max(v,0),height:Math.max(_,0)})},BZ=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},E0=function(t){var r=t.chartName,a=t.GraphicalChild,s=t.defaultTooltipEventType,i=s===void 0?"axis":s,o=t.validateTooltipEventTypes,l=o===void 0?["axis"]:o,c=t.axisComponents,d=t.legendContent,u=t.formatAxisMap,f=t.defaultProps,h=function(y,w){var v=w.graphicalItems,_=w.stackGroups,b=w.offset,j=w.updateId,N=w.dataStartIndex,k=w.dataEndIndex,S=y.barSize,E=y.layout,P=y.barGap,C=y.barCategoryGap,T=y.maxBarSize,M=tw(E),A=M.numericAxisName,F=M.cateAxisName,H=$Z(v),V=[];return v.forEach(function(B,L){var ee=k0(y.data,{graphicalItems:[B],dataStartIndex:N,dataEndIndex:k}),I=B.type.defaultProps!==void 0?ue(ue({},B.type.defaultProps),B.props):B.props,K=I.dataKey,z=I.maxBarSize,W=I["".concat(A,"Id")],re=I["".concat(F,"Id")],xe={},me=c.reduce(function(nt,At){var Xt=w["".concat(At.axisType,"Map")],er=I["".concat(At.axisType,"Id")];Xt&&Xt[er]||At.axisType==="zAxis"||ji();var ea=Xt[er];return ue(ue({},nt),{},Re(Re({},At.axisType,ea),"".concat(At.axisType,"Ticks"),Bn(ea)))},xe),Q=me[F],q=me["".concat(F,"Ticks")],se=_&&_[W]&&_[W].hasStack&&nH(B,_[W].stackGroups),D=zn(B.type).indexOf("Bar")>=0,ve=$u(Q,q),we=[],Ae=H&&VW({barSize:S,stackGroups:_,totalSize:BZ(me,F)});if(D){var ce,he,oe=We(z)?T:z,Ve=(ce=(he=$u(Q,q,!0))!==null&&he!==void 0?he:oe)!==null&&ce!==void 0?ce:0;we=GW({barGap:P,barCategoryGap:C,bandSize:Ve!==ve?Ve:ve,sizeList:Ae[re],maxBarSize:oe}),Ve!==ve&&(we=we.map(function(nt){return ue(ue({},nt),{},{position:ue(ue({},nt.position),{},{offset:nt.position.offset-Ve/2})})}))}var ct=B&&B.type&&B.type.getComposedData;ct&&V.push({props:ue(ue({},ct(ue(ue({},me),{},{displayedData:ee,props:y,dataKey:K,item:B,bandSize:ve,barPosition:we,offset:b,stackedData:se,layout:E,dataStartIndex:N,dataEndIndex:k}))),{},Re(Re(Re({key:B.key||"item-".concat(L)},A,me[A]),F,me[F]),"animationId",j)),childIndex:GO(B,y.children),item:B})}),V},m=function(y,w){var v=y.props,_=y.dataStartIndex,b=y.dataEndIndex,j=y.updateId;if(!hv({props:v}))return null;var N=v.children,k=v.layout,S=v.stackOffset,E=v.data,P=v.reverseStackOrder,C=tw(k),T=C.numericAxisName,M=C.cateAxisName,A=Ea(N,a),F=rH(E,A,"".concat(T,"Id"),"".concat(M,"Id"),S,P),H=c.reduce(function(I,K){var z="".concat(K.axisType,"Map");return ue(ue({},I),{},Re({},z,RZ(v,ue(ue({},K),{},{graphicalItems:A,stackGroups:K.axisType===T&&F,dataStartIndex:_,dataEndIndex:b}))))},{}),V=LZ(ue(ue({},H),{},{props:v,graphicalItems:A}),w==null?void 0:w.legendBBox);Object.keys(H).forEach(function(I){H[I]=u(v,H[I],V,I.replace("Map",""),r)});var B=H["".concat(M,"Map")],L=MZ(B),ee=h(v,ue(ue({},H),{},{dataStartIndex:_,dataEndIndex:b,updateId:j,graphicalItems:A,stackGroups:F,offset:V}));return ue(ue({formattedGraphicalItems:ee,graphicalItems:A,offset:V,stackGroups:F},L),H)},x=function(g){function y(w){var v,_,b;return yZ(this,y),b=jZ(this,y,[w]),Re(b,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Re(b,"accessibilityManager",new sZ),Re(b,"handleLegendBBoxUpdate",function(j){if(j){var N=b.state,k=N.dataStartIndex,S=N.dataEndIndex,E=N.updateId;b.setState(ue({legendBBox:j},m({props:b.props,dataStartIndex:k,dataEndIndex:S,updateId:E},ue(ue({},b.state),{},{legendBBox:j}))))}}),Re(b,"handleReceiveSyncEvent",function(j,N,k){if(b.props.syncId===j){if(k===b.eventEmitterSymbol&&typeof b.props.syncMethod!="function")return;b.applySyncEvent(N)}}),Re(b,"handleBrushChange",function(j){var N=j.startIndex,k=j.endIndex;if(N!==b.state.dataStartIndex||k!==b.state.dataEndIndex){var S=b.state.updateId;b.setState(function(){return ue({dataStartIndex:N,dataEndIndex:k},m({props:b.props,dataStartIndex:N,dataEndIndex:k,updateId:S},b.state))}),b.triggerSyncEvent({dataStartIndex:N,dataEndIndex:k})}}),Re(b,"handleMouseEnter",function(j){var N=b.getMouseInfo(j);if(N){var k=ue(ue({},N),{},{isTooltipActive:!0});b.setState(k),b.triggerSyncEvent(k);var S=b.props.onMouseEnter;$e(S)&&S(k,j)}}),Re(b,"triggeredAfterMouseMove",function(j){var N=b.getMouseInfo(j),k=N?ue(ue({},N),{},{isTooltipActive:!0}):{isTooltipActive:!1};b.setState(k),b.triggerSyncEvent(k);var S=b.props.onMouseMove;$e(S)&&S(k,j)}),Re(b,"handleItemMouseEnter",function(j){b.setState(function(){return{isTooltipActive:!0,activeItem:j,activePayload:j.tooltipPayload,activeCoordinate:j.tooltipPosition||{x:j.cx,y:j.cy}}})}),Re(b,"handleItemMouseLeave",function(){b.setState(function(){return{isTooltipActive:!1}})}),Re(b,"handleMouseMove",function(j){j.persist(),b.throttleTriggeredAfterMouseMove(j)}),Re(b,"handleMouseLeave",function(j){b.throttleTriggeredAfterMouseMove.cancel();var N={isTooltipActive:!1};b.setState(N),b.triggerSyncEvent(N);var k=b.props.onMouseLeave;$e(k)&&k(N,j)}),Re(b,"handleOuterEvent",function(j){var N=VO(j),k=ka(b.props,"".concat(N));if(N&&$e(k)){var S,E;/.*touch.*/i.test(N)?E=b.getMouseInfo(j.changedTouches[0]):E=b.getMouseInfo(j),k((S=E)!==null&&S!==void 0?S:{},j)}}),Re(b,"handleClick",function(j){var N=b.getMouseInfo(j);if(N){var k=ue(ue({},N),{},{isTooltipActive:!0});b.setState(k),b.triggerSyncEvent(k);var S=b.props.onClick;$e(S)&&S(k,j)}}),Re(b,"handleMouseDown",function(j){var N=b.props.onMouseDown;if($e(N)){var k=b.getMouseInfo(j);N(k,j)}}),Re(b,"handleMouseUp",function(j){var N=b.props.onMouseUp;if($e(N)){var k=b.getMouseInfo(j);N(k,j)}}),Re(b,"handleTouchMove",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&b.throttleTriggeredAfterMouseMove(j.changedTouches[0])}),Re(b,"handleTouchStart",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&b.handleMouseDown(j.changedTouches[0])}),Re(b,"handleTouchEnd",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&b.handleMouseUp(j.changedTouches[0])}),Re(b,"handleDoubleClick",function(j){var N=b.props.onDoubleClick;if($e(N)){var k=b.getMouseInfo(j);N(k,j)}}),Re(b,"handleContextMenu",function(j){var N=b.props.onContextMenu;if($e(N)){var k=b.getMouseInfo(j);N(k,j)}}),Re(b,"triggerSyncEvent",function(j){b.props.syncId!==void 0&&xh.emit(ph,b.props.syncId,j,b.eventEmitterSymbol)}),Re(b,"applySyncEvent",function(j){var N=b.props,k=N.layout,S=N.syncMethod,E=b.state.updateId,P=j.dataStartIndex,C=j.dataEndIndex;if(j.dataStartIndex!==void 0||j.dataEndIndex!==void 0)b.setState(ue({dataStartIndex:P,dataEndIndex:C},m({props:b.props,dataStartIndex:P,dataEndIndex:C,updateId:E},b.state)));else if(j.activeTooltipIndex!==void 0){var T=j.chartX,M=j.chartY,A=j.activeTooltipIndex,F=b.state,H=F.offset,V=F.tooltipTicks;if(!H)return;if(typeof S=="function")A=S(V,j);else if(S==="value"){A=-1;for(var B=0;B<V.length;B++)if(V[B].value===j.activeLabel){A=B;break}}var L=ue(ue({},H),{},{x:H.left,y:H.top}),ee=Math.min(T,L.x+L.width),I=Math.min(M,L.y+L.height),K=V[A]&&V[A].value,z=vx(b.state,b.props.data,A),W=V[A]?{x:k==="horizontal"?V[A].coordinate:ee,y:k==="horizontal"?I:V[A].coordinate}:KS;b.setState(ue(ue({},j),{},{activeLabel:K,activeCoordinate:W,activePayload:z,activeTooltipIndex:A}))}else b.setState(j)}),Re(b,"renderCursor",function(j){var N,k=b.state,S=k.isTooltipActive,E=k.activeCoordinate,P=k.activePayload,C=k.offset,T=k.activeTooltipIndex,M=k.tooltipAxisBandSize,A=b.getTooltipEventType(),F=(N=j.props.active)!==null&&N!==void 0?N:S,H=b.props.layout,V=j.key||"_recharts-cursor";return Z.createElement(fZ,{key:V,activeCoordinate:E,activePayload:P,activeTooltipIndex:T,chartName:r,element:j,isActive:F,layout:H,offset:C,tooltipAxisBandSize:M,tooltipEventType:A})}),Re(b,"renderPolarAxis",function(j,N,k){var S=ka(j,"type.axisType"),E=ka(b.state,"".concat(S,"Map")),P=j.type.defaultProps,C=P!==void 0?ue(ue({},P),j.props):j.props,T=E&&E[C["".concat(S,"Id")]];return O.cloneElement(j,ue(ue({},T),{},{className:qe(S,T.className),key:j.key||"".concat(N,"-").concat(k),ticks:Bn(T,!0)}))}),Re(b,"renderPolarGrid",function(j){var N=j.props,k=N.radialLines,S=N.polarAngles,E=N.polarRadius,P=b.state,C=P.radiusAxisMap,T=P.angleAxisMap,M=ms(C),A=ms(T),F=A.cx,H=A.cy,V=A.innerRadius,B=A.outerRadius;return O.cloneElement(j,{polarAngles:Array.isArray(S)?S:Bn(A,!0).map(function(L){return L.coordinate}),polarRadius:Array.isArray(E)?E:Bn(M,!0).map(function(L){return L.coordinate}),cx:F,cy:H,innerRadius:V,outerRadius:B,key:j.key||"polar-grid",radialLines:k})}),Re(b,"renderLegend",function(){var j=b.state.formattedGraphicalItems,N=b.props,k=N.children,S=N.width,E=N.height,P=b.props.margin||{},C=S-(P.left||0)-(P.right||0),T=w_({children:k,formattedGraphicalItems:j,legendWidth:C,legendContent:d});if(!T)return null;var M=T.item,A=J1(T,hZ);return O.cloneElement(M,ue(ue({},A),{},{chartWidth:S,chartHeight:E,margin:P,onBBoxUpdate:b.handleLegendBBoxUpdate}))}),Re(b,"renderTooltip",function(){var j,N=b.props,k=N.children,S=N.accessibilityLayer,E=ba(k,ua);if(!E)return null;var P=b.state,C=P.isTooltipActive,T=P.activeCoordinate,M=P.activePayload,A=P.activeLabel,F=P.offset,H=(j=E.props.active)!==null&&j!==void 0?j:C;return O.cloneElement(E,{viewBox:ue(ue({},F),{},{x:F.left,y:F.top}),active:H,label:A,payload:H?M:[],coordinate:T,accessibilityLayer:S})}),Re(b,"renderBrush",function(j){var N=b.props,k=N.margin,S=N.data,E=b.state,P=E.offset,C=E.dataStartIndex,T=E.dataEndIndex,M=E.updateId;return O.cloneElement(j,{key:j.key||"_recharts-brush",onChange:$d(b.handleBrushChange,j.props.onChange),data:S,x:be(j.props.x)?j.props.x:P.left,y:be(j.props.y)?j.props.y:P.top+P.height+P.brushBottom-(k.bottom||0),width:be(j.props.width)?j.props.width:P.width,startIndex:C,endIndex:T,updateId:"brush-".concat(M)})}),Re(b,"renderReferenceElement",function(j,N,k){if(!j)return null;var S=b,E=S.clipPathId,P=b.state,C=P.xAxisMap,T=P.yAxisMap,M=P.offset,A=j.type.defaultProps||{},F=j.props,H=F.xAxisId,V=H===void 0?A.xAxisId:H,B=F.yAxisId,L=B===void 0?A.yAxisId:B;return O.cloneElement(j,{key:j.key||"".concat(N,"-").concat(k),xAxis:C[V],yAxis:T[L],viewBox:{x:M.left,y:M.top,width:M.width,height:M.height},clipPathId:E})}),Re(b,"renderActivePoints",function(j){var N=j.item,k=j.activePoint,S=j.basePoint,E=j.childIndex,P=j.isRange,C=[],T=N.props.key,M=N.item.type.defaultProps!==void 0?ue(ue({},N.item.type.defaultProps),N.item.props):N.item.props,A=M.activeDot,F=M.dataKey,H=ue(ue({index:E,dataKey:F,cx:k.x,cy:k.y,r:4,fill:$p(N.item),strokeWidth:2,stroke:"#fff",payload:k.payload,value:k.value},Ce(A,!1)),du(A));return C.push(y.renderActiveDot(A,H,"".concat(T,"-activePoint-").concat(E))),S?C.push(y.renderActiveDot(A,ue(ue({},H),{},{cx:S.x,cy:S.y}),"".concat(T,"-basePoint-").concat(E))):P&&C.push(null),C}),Re(b,"renderGraphicChild",function(j,N,k){var S=b.filterFormatItem(j,N,k);if(!S)return null;var E=b.getTooltipEventType(),P=b.state,C=P.isTooltipActive,T=P.tooltipAxis,M=P.activeTooltipIndex,A=P.activeLabel,F=b.props.children,H=ba(F,ua),V=S.props,B=V.points,L=V.isRange,ee=V.baseLine,I=S.item.type.defaultProps!==void 0?ue(ue({},S.item.type.defaultProps),S.item.props):S.item.props,K=I.activeDot,z=I.hide,W=I.activeBar,re=I.activeShape,xe=!!(!z&&C&&H&&(K||W||re)),me={};E!=="axis"&&H&&H.props.trigger==="click"?me={onClick:$d(b.handleItemMouseEnter,j.props.onClick)}:E!=="axis"&&(me={onMouseLeave:$d(b.handleItemMouseLeave,j.props.onMouseLeave),onMouseEnter:$d(b.handleItemMouseEnter,j.props.onMouseEnter)});var Q=O.cloneElement(j,ue(ue({},S.props),me));function q(At){return typeof T.dataKey=="function"?T.dataKey(At.payload):null}if(xe)if(M>=0){var se,D;if(T.dataKey&&!T.allowDuplicatedCategory){var ve=typeof T.dataKey=="function"?q:"payload.".concat(T.dataKey.toString());se=cu(B,ve,A),D=L&&ee&&cu(ee,ve,A)}else se=B==null?void 0:B[M],D=L&&ee&&ee[M];if(re||W){var we=j.props.activeIndex!==void 0?j.props.activeIndex:M;return[O.cloneElement(j,ue(ue(ue({},S.props),me),{},{activeIndex:we})),null,null]}if(!We(se))return[Q].concat(Uo(b.renderActivePoints({item:S,activePoint:se,basePoint:D,childIndex:M,isRange:L})))}else{var Ae,ce=(Ae=b.getItemByXY(b.state.activeCoordinate))!==null&&Ae!==void 0?Ae:{graphicalItem:Q},he=ce.graphicalItem,oe=he.item,Ve=oe===void 0?j:oe,ct=he.childIndex,nt=ue(ue(ue({},S.props),me),{},{activeIndex:ct});return[O.cloneElement(Ve,nt),null,null]}return L?[Q,null,null]:[Q,null]}),Re(b,"renderCustomized",function(j,N,k){return O.cloneElement(j,ue(ue({key:"recharts-customized-".concat(k)},b.props),b.state))}),Re(b,"renderMap",{CartesianGrid:{handler:Hd,once:!0},ReferenceArea:{handler:b.renderReferenceElement},ReferenceLine:{handler:Hd},ReferenceDot:{handler:b.renderReferenceElement},XAxis:{handler:Hd},YAxis:{handler:Hd},Brush:{handler:b.renderBrush,once:!0},Bar:{handler:b.renderGraphicChild},Line:{handler:b.renderGraphicChild},Area:{handler:b.renderGraphicChild},Radar:{handler:b.renderGraphicChild},RadialBar:{handler:b.renderGraphicChild},Scatter:{handler:b.renderGraphicChild},Pie:{handler:b.renderGraphicChild},Funnel:{handler:b.renderGraphicChild},Tooltip:{handler:b.renderCursor,once:!0},PolarGrid:{handler:b.renderPolarGrid,once:!0},PolarAngleAxis:{handler:b.renderPolarAxis},PolarRadiusAxis:{handler:b.renderPolarAxis},Customized:{handler:b.renderCustomized}}),b.clipPathId="".concat((v=w.id)!==null&&v!==void 0?v:Ii("recharts"),"-clip"),b.throttleTriggeredAfterMouseMove=bN(b.triggeredAfterMouseMove,(_=w.throttleDelay)!==null&&_!==void 0?_:1e3/60),b.state={},b}return SZ(y,g),wZ(y,[{key:"componentDidMount",value:function(){var v,_;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(v=this.props.margin.left)!==null&&v!==void 0?v:0,top:(_=this.props.margin.top)!==null&&_!==void 0?_:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var v=this.props,_=v.children,b=v.data,j=v.height,N=v.layout,k=ba(_,ua);if(k){var S=k.props.defaultIndex;if(!(typeof S!="number"||S<0||S>this.state.tooltipTicks.length-1)){var E=this.state.tooltipTicks[S]&&this.state.tooltipTicks[S].value,P=vx(this.state,b,S,E),C=this.state.tooltipTicks[S].coordinate,T=(this.state.offset.top+j)/2,M=N==="horizontal",A=M?{x:C,y:T}:{y:C,x:T},F=this.state.formattedGraphicalItems.find(function(V){var B=V.item;return B.type.name==="Scatter"});F&&(A=ue(ue({},A),F.props.points[S].tooltipPosition),P=F.props.points[S].tooltipPayload);var H={activeTooltipIndex:S,isTooltipActive:!0,activeLabel:E,activePayload:P,activeCoordinate:A};this.setState(H),this.renderCursor(k),this.accessibilityManager.setIndex(S)}}}},{key:"getSnapshotBeforeUpdate",value:function(v,_){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==_.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==v.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==v.margin){var b,j;this.accessibilityManager.setDetails({offset:{left:(b=this.props.margin.left)!==null&&b!==void 0?b:0,top:(j=this.props.margin.top)!==null&&j!==void 0?j:0}})}return null}},{key:"componentDidUpdate",value:function(v){Gh([ba(v.children,ua)],[ba(this.props.children,ua)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var v=ba(this.props.children,ua);if(v&&typeof v.props.shared=="boolean"){var _=v.props.shared?"axis":"item";return l.indexOf(_)>=0?_:i}return i}},{key:"getMouseInfo",value:function(v){if(!this.container)return null;var _=this.container,b=_.getBoundingClientRect(),j=v7(b),N={chartX:Math.round(v.pageX-j.left),chartY:Math.round(v.pageY-j.top)},k=b.width/_.offsetWidth||1,S=this.inRange(N.chartX,N.chartY,k);if(!S)return null;var E=this.state,P=E.xAxisMap,C=E.yAxisMap,T=this.getTooltipEventType(),M=Q1(this.state,this.props.data,this.props.layout,S);if(T!=="axis"&&P&&C){var A=ms(P).scale,F=ms(C).scale,H=A&&A.invert?A.invert(N.chartX):null,V=F&&F.invert?F.invert(N.chartY):null;return ue(ue({},N),{},{xValue:H,yValue:V},M)}return M?ue(ue({},N),M):null}},{key:"inRange",value:function(v,_){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,j=this.props.layout,N=v/b,k=_/b;if(j==="horizontal"||j==="vertical"){var S=this.state.offset,E=N>=S.left&&N<=S.left+S.width&&k>=S.top&&k<=S.top+S.height;return E?{x:N,y:k}:null}var P=this.state,C=P.angleAxisMap,T=P.radiusAxisMap;if(C&&T){var M=ms(C);return jb({x:N,y:k},M)}return null}},{key:"parseEventsOfWrapper",value:function(){var v=this.props.children,_=this.getTooltipEventType(),b=ba(v,ua),j={};b&&_==="axis"&&(b.props.trigger==="click"?j={onClick:this.handleClick}:j={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var N=du(this.props,this.handleOuterEvent);return ue(ue({},N),j)}},{key:"addListener",value:function(){xh.on(ph,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){xh.removeListener(ph,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(v,_,b){for(var j=this.state.formattedGraphicalItems,N=0,k=j.length;N<k;N++){var S=j[N];if(S.item===v||S.props.key===v.key||_===zn(S.item.type)&&b===S.childIndex)return S}return null}},{key:"renderClipPath",value:function(){var v=this.clipPathId,_=this.state.offset,b=_.left,j=_.top,N=_.height,k=_.width;return Z.createElement("defs",null,Z.createElement("clipPath",{id:v},Z.createElement("rect",{x:b,y:j,height:N,width:k})))}},{key:"getXScales",value:function(){var v=this.state.xAxisMap;return v?Object.entries(v).reduce(function(_,b){var j=Y1(b,2),N=j[0],k=j[1];return ue(ue({},_),{},Re({},N,k.scale))},{}):null}},{key:"getYScales",value:function(){var v=this.state.yAxisMap;return v?Object.entries(v).reduce(function(_,b){var j=Y1(b,2),N=j[0],k=j[1];return ue(ue({},_),{},Re({},N,k.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(v){var _;return(_=this.state.xAxisMap)===null||_===void 0||(_=_[v])===null||_===void 0?void 0:_.scale}},{key:"getYScaleByAxisId",value:function(v){var _;return(_=this.state.yAxisMap)===null||_===void 0||(_=_[v])===null||_===void 0?void 0:_.scale}},{key:"getItemByXY",value:function(v){var _=this.state,b=_.formattedGraphicalItems,j=_.activeItem;if(b&&b.length)for(var N=0,k=b.length;N<k;N++){var S=b[N],E=S.props,P=S.item,C=P.type.defaultProps!==void 0?ue(ue({},P.type.defaultProps),P.props):P.props,T=zn(P.type);if(T==="Bar"){var M=(E.data||[]).find(function(V){return eG(v,V)});if(M)return{graphicalItem:S,payload:M}}else if(T==="RadialBar"){var A=(E.data||[]).find(function(V){return jb(v,V)});if(A)return{graphicalItem:S,payload:A}}else if(y0(S,j)||b0(S,j)||Mc(S,j)){var F=WK({graphicalItem:S,activeTooltipItem:j,itemData:C.data}),H=C.activeIndex===void 0?F:C.activeIndex;return{graphicalItem:ue(ue({},S),{},{childIndex:H}),payload:Mc(S,j)?C.data[F]:S.props.data[F]}}}return null}},{key:"render",value:function(){var v=this;if(!hv(this))return null;var _=this.props,b=_.children,j=_.className,N=_.width,k=_.height,S=_.style,E=_.compact,P=_.title,C=_.desc,T=J1(_,mZ),M=Ce(T,!1);if(E)return Z.createElement(O1,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Z.createElement(qh,no({},M,{width:N,height:k,title:P,desc:C}),this.renderClipPath(),xv(b,this.renderMap)));if(this.props.accessibilityLayer){var A,F;M.tabIndex=(A=this.props.tabIndex)!==null&&A!==void 0?A:0,M.role=(F=this.props.role)!==null&&F!==void 0?F:"application",M.onKeyDown=function(V){v.accessibilityManager.keyboardEvent(V)},M.onFocus=function(){v.accessibilityManager.focus()}}var H=this.parseEventsOfWrapper();return Z.createElement(O1,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Z.createElement("div",no({className:qe("recharts-wrapper",j),style:ue({position:"relative",cursor:"default",width:N,height:k},S)},H,{ref:function(B){v.container=B}}),Z.createElement(qh,no({},M,{width:N,height:k,title:P,desc:C,style:PZ}),this.renderClipPath(),xv(b,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(O.Component);Re(x,"displayName",r),Re(x,"defaultProps",ue({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},f)),Re(x,"getDerivedStateFromProps",function(g,y){var w=g.dataKey,v=g.data,_=g.children,b=g.width,j=g.height,N=g.layout,k=g.stackOffset,S=g.margin,E=y.dataStartIndex,P=y.dataEndIndex;if(y.updateId===void 0){var C=ew(g);return ue(ue(ue({},C),{},{updateId:0},m(ue(ue({props:g},C),{},{updateId:0}),y)),{},{prevDataKey:w,prevData:v,prevWidth:b,prevHeight:j,prevLayout:N,prevStackOffset:k,prevMargin:S,prevChildren:_})}if(w!==y.prevDataKey||v!==y.prevData||b!==y.prevWidth||j!==y.prevHeight||N!==y.prevLayout||k!==y.prevStackOffset||!io(S,y.prevMargin)){var T=ew(g),M={chartX:y.chartX,chartY:y.chartY,isTooltipActive:y.isTooltipActive},A=ue(ue({},Q1(y,v,N)),{},{updateId:y.updateId+1}),F=ue(ue(ue({},T),M),A);return ue(ue(ue({},F),m(ue({props:g},F),y)),{},{prevDataKey:w,prevData:v,prevWidth:b,prevHeight:j,prevLayout:N,prevStackOffset:k,prevMargin:S,prevChildren:_})}if(!Gh(_,y.prevChildren)){var H,V,B,L,ee=ba(_,Oo),I=ee&&(H=(V=ee.props)===null||V===void 0?void 0:V.startIndex)!==null&&H!==void 0?H:E,K=ee&&(B=(L=ee.props)===null||L===void 0?void 0:L.endIndex)!==null&&B!==void 0?B:P,z=I!==E||K!==P,W=!We(v),re=W&&!z?y.updateId:y.updateId+1;return ue(ue({updateId:re},m(ue(ue({props:g},y),{},{updateId:re,dataStartIndex:I,dataEndIndex:K}),y)),{},{prevChildren:_,dataStartIndex:I,dataEndIndex:K})}return null}),Re(x,"renderActiveDot",function(g,y,w){var v;return O.isValidElement(g)?v=O.cloneElement(g,y):$e(g)?v=g(y):v=Z.createElement(gd,y),Z.createElement(it,{className:"recharts-active-dot",key:w},v)});var p=O.forwardRef(function(y,w){return Z.createElement(x,no({},y,{ref:w}))});return p.displayName=x.displayName,p},rw=E0({chartName:"LineChart",GraphicalChild:pn,axisComponents:[{axisType:"xAxis",AxisComp:Un},{axisType:"yAxis",AxisComp:Wn}],formatAxisMap:Bp}),UZ=E0({chartName:"BarChart",GraphicalChild:Gn,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:Un},{axisType:"yAxis",AxisComp:Wn}],formatAxisMap:Bp}),WZ=E0({chartName:"PieChart",GraphicalChild:is,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:v0},{axisType:"radiusAxis",AxisComp:p0}],formatAxisMap:mH,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),HZ=E0({chartName:"AreaChart",GraphicalChild:kn,axisComponents:[{axisType:"xAxis",AxisComp:Un},{axisType:"yAxis",AxisComp:Wn}],formatAxisMap:Bp});const zZ=({defaultEmail:e=""})=>{const[t,r]=O.useState(e),[a,s]=O.useState(e),[i,o]=O.useState(null),[l,c]=O.useState(!1),[d,u]=O.useState(null),f=async()=>{if(!a.trim()){u("الرجاء إدخال البريد الإلكتروني للمدرسة");return}c(!0),u(null),o(null);try{const h=await N6(a);o(h),h.found||u(h.message)}catch(h){console.error("Error fetching school projects:",h),u(h instanceof Error?h.message:"حدث خطأ أثناء البحث عن المدرسة")}finally{c(!1)}};return O.useEffect(()=>{e&&f()},[e]),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[n.jsx(gn,{className:"w-6 h-6 text-indigo-600"}),"استعلام عن مشاريع المدرسة"]}),n.jsx("div",{className:"mb-6",children:n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(ut,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"email",value:t,onChange:h=>r(h.target.value),placeholder:"أدخل البريد الإلكتروني للمدرسة",className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),n.jsx("button",{onClick:()=>{s(t),f()},disabled:l,className:"px-6 py-3 bg-indigo-500 text-white rounded-xl hover:bg-indigo-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:l?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري البحث..."]}):n.jsxs(n.Fragment,{children:[n.jsx(ut,{className:"w-5 h-5"}),"بحث"]})})]})}),d&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-center gap-2",children:[n.jsx(Mr,{className:"w-5 h-5 flex-shrink-0"}),n.jsx("p",{children:d})]}),i&&i.found&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-6",children:[n.jsxs("div",{className:"bg-indigo-50 border border-indigo-200 rounded-xl p-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-16 h-16 bg-indigo-100 rounded-xl flex items-center justify-center",children:n.jsx(gn,{className:"w-8 h-8 text-indigo-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:i.school.name}),n.jsx("p",{className:"text-gray-600",children:i.school.email})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[n.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:i.count}),n.jsx("div",{className:"text-sm text-gray-600",children:"إجمالي المشاريع"})]}),n.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[n.jsx("div",{className:"text-2xl font-bold text-green-600",children:i.projects.filter(h=>h.status==="completed").length}),n.jsx("div",{className:"text-sm text-gray-600",children:"مشاريع مكتملة"})]}),n.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[n.jsx("div",{className:"text-2xl font-bold text-blue-600",children:i.projects.filter(h=>h.status==="active").length}),n.jsx("div",{className:"text-sm text-gray-600",children:"مشاريع نشطة"})]}),n.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[n.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:i.projects.filter(h=>h.status==="draft").length}),n.jsx("div",{className:"text-sm text-gray-600",children:"مشاريع في المسودة"})]})]})]}),i.projects.length>0?n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"قائمة المشاريع"}),n.jsx("div",{className:"space-y-4",children:i.projects.map(h=>n.jsx("div",{className:"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${h.status==="completed"?"bg-green-100 text-green-600":h.status==="active"?"bg-blue-100 text-blue-600":"bg-yellow-100 text-yellow-600"}`,children:n.jsx(Ll,{className:"w-5 h-5"})}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("h4",{className:"font-semibold text-gray-800",children:h.title}),n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${h.status==="completed"?"bg-green-100 text-green-800":h.status==="active"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:h.status==="completed"?"مكتمل":h.status==="active"?"نشط":"مسودة"})]}),n.jsx("p",{className:"text-gray-600 text-sm line-clamp-2",children:h.description}),n.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-500",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(tt,{className:"w-4 h-4"}),Ze(h.created_at)]}),h.due_date&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(jt,{className:"w-4 h-4"}),"تاريخ الاستحقاق: ",Ze(h.due_date)]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(lt,{className:"w-4 h-4"}),"الحد الأقصى: ",h.max_students," طلاب"]})]})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("div",{className:"text-sm font-medium text-gray-800",children:"درجة الإنجاز"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:n.jsx("div",{className:"h-2 rounded-full bg-indigo-600",style:{width:`${h.progress||0}%`}})}),n.jsx("span",{className:"text-sm",children:h.progress||0})]})]})]})},h.id))})]}):n.jsxs("div",{className:"text-center py-8",children:[n.jsx(ze,{className:"w-16 h-16 text-indigo-500 mx-auto mb-4"}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"تم العثور على المدرسة"}),n.jsx("p",{className:"text-gray-600",children:"لا توجد مشاريع مسجلة لهذه المدرسة حتى الآن"})]})]}),!l&&!i&&!d&&n.jsxs("div",{className:"text-center py-8",children:[n.jsx(oa,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"استعلام عن مشاريع المدرسة"}),n.jsx("p",{className:"text-gray-600",children:"أدخل البريد الإلكتروني للمدرسة للبحث عن المشاريع المرتبطة بها"})]})]})},VZ=[{id:"overview",name:"نظرة عامة",icon:Yn},{id:"projects",name:"تقارير المشاريع",icon:wt},{id:"users",name:"تقارير المستخدمين",icon:lt},{id:"performance",name:"تقارير الأداء",icon:mi},{id:"school-query",name:"استعلام المدارس",icon:gn}],GZ=[{id:"week",name:"الأسبوع الماضي"},{id:"month",name:"الشهر الماضي"},{id:"quarter",name:"الربع الماضي"},{id:"year",name:"السنة الماضية"}],aw=[{name:"يناير",مكتملة:12,نشطة:8,مسودة:3},{name:"فبراير",مكتملة:15,نشطة:12,مسودة:5},{name:"مارس",مكتملة:18,نشطة:15,مسودة:4},{name:"أبريل",مكتملة:22,نشطة:18,مسودة:6},{name:"مايو",مكتملة:25,نشطة:20,مسودة:7},{name:"يونيو",مكتملة:28,نشطة:22,مسودة:5}],nw=[{name:"العلوم والتقنية",value:45,color:"#3B82F6"},{name:"ريادة الأعمال",value:25,color:"#10B981"},{name:"التطوع",value:20,color:"#F59E0B"},{name:"الأخلاق",value:10,color:"#EF4444"}],KZ=[{name:"يناير",طلاب:120,معلمين:15,مدارس:3},{name:"فبراير",طلاب:145,معلمين:18,مدارس:4},{name:"مارس",طلاب:180,معلمين:22,مدارس:5},{name:"أبريل",طلاب:220,معلمين:28,مدارس:6},{name:"مايو",طلاب:265,معلمين:32,مدارس:7},{name:"يونيو",طلاب:310,معلمين:38,مدارس:8}],qZ=[{name:"الأسبوع 1",معدل_الإنجاز:85,رضا_المستخدمين:92,نشاط_المنصة:78},{name:"الأسبوع 2",معدل_الإنجاز:88,رضا_المستخدمين:94,نشاط_المنصة:82},{name:"الأسبوع 3",معدل_الإنجاز:92,رضا_المستخدمين:96,نشاط_المنصة:85},{name:"الأسبوع 4",معدل_الإنجاز:89,رضا_المستخدمين:93,نشاط_المنصة:88}],XZ=[{title:"إجمالي المشاريع",value:"156",change:"+12%",trend:"up",icon:wt,color:"from-blue-500 to-blue-600"},{title:"المستخدمون النشطون",value:"2,847",change:"+8%",trend:"up",icon:lt,color:"from-green-500 to-green-600"},{title:"معدل الإنجاز",value:"89%",change:"+5%",trend:"up",icon:ar,color:"from-purple-500 to-purple-600"},{title:"متوسط التقييم",value:"4.8",change:"+0.2",trend:"up",icon:mi,color:"from-orange-500 to-orange-600"}],YZ=()=>{const[e,t]=O.useState("school-query"),[r,a]=O.useState("month"),[s,i]=O.useState("muo4sa@gmail.com");return O.useEffect(()=>{t("school-query")},[]),n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-indigo-600 to-purple-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(Yn,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"التقارير والإحصائيات"}),n.jsx("p",{className:"opacity-90",children:"تحليل شامل لأداء المنصة والمشاريع"})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[e!=="school-query"&&n.jsx("select",{value:r,onChange:o=>a(o.target.value),className:"px-4 py-2 bg-white bg-opacity-20 text-white rounded-xl border border-white border-opacity-30 focus:outline-none focus:ring-2 focus:ring-white focus:ring-opacity-50",children:GZ.map(o=>n.jsx("option",{value:o.id,className:"text-gray-800",children:o.name},o.id))}),n.jsxs("button",{className:"bg-white text-indigo-600 px-6 py-2 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(Tr,{className:"w-5 h-5"}),"تصدير"]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"156"}),n.jsx("div",{className:"text-sm opacity-80",children:"مشروع نشط"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"2,847"}),n.jsx("div",{className:"text-sm opacity-80",children:"مستخدم"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"89%"}),n.jsx("div",{className:"text-sm opacity-80",children:"معدل النجاح"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"4.8"}),n.jsx("div",{className:"text-sm opacity-80",children:"متوسط التقييم"})]})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("div",{className:"border-b border-gray-200 mb-6",children:n.jsx("nav",{className:"flex space-x-8",children:VZ.map(o=>n.jsxs("button",{onClick:()=>t(o.id),className:`flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm transition-colors ${e===o.id?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[n.jsx(o.icon,{className:"w-4 h-4"}),o.name]},o.id))})}),e==="school-query"&&n.jsx("div",{className:"space-y-6",children:n.jsx(zZ,{defaultEmail:s})}),e==="overview"&&n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-6",children:XZ.map((o,l)=>n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:l*.1},className:"bg-white border border-gray-200 rounded-2xl p-6 hover:shadow-lg transition-all",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("div",{className:`w-12 h-12 bg-gradient-to-r ${o.color} rounded-xl flex items-center justify-center`,children:n.jsx(o.icon,{className:"w-6 h-6 text-white"})}),n.jsxs("div",{className:`flex items-center gap-1 text-sm font-medium ${o.trend==="up"?"text-green-600":"text-red-600"}`,children:[n.jsx(mi,{className:"w-4 h-4"}),o.change]})]}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-1",children:o.value}),n.jsx("p",{className:"text-gray-600 text-sm",children:o.title})]},o.title))}),n.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"تطور المشاريع"}),n.jsx(gl,{width:"100%",height:300,children:n.jsxs(UZ,{data:aw,children:[n.jsx(Cl,{strokeDasharray:"3 3"}),n.jsx(Un,{dataKey:"name"}),n.jsx(Wn,{}),n.jsx(ua,{}),n.jsx(Gn,{dataKey:"مكتملة",fill:"#10B981"}),n.jsx(Gn,{dataKey:"نشطة",fill:"#3B82F6"}),n.jsx(Gn,{dataKey:"مسودة",fill:"#F59E0B"})]})})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"توزيع المشاريع حسب الفئة"}),n.jsx(gl,{width:"100%",height:300,children:n.jsxs(WZ,{children:[n.jsx(is,{data:nw,cx:"50%",cy:"50%",outerRadius:80,dataKey:"value",label:({name:o,percent:l})=>`${o} ${(l*100).toFixed(0)}%`,children:nw.map((o,l)=>n.jsx(n0,{fill:o.color},`cell-${l}`))}),n.jsx(ua,{})]})})]})]})]}),e==="projects"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"إحصائيات المشاريع الشهرية"}),n.jsx(gl,{width:"100%",height:400,children:n.jsxs(HZ,{data:aw,children:[n.jsx(Cl,{strokeDasharray:"3 3"}),n.jsx(Un,{dataKey:"name"}),n.jsx(Wn,{}),n.jsx(ua,{}),n.jsx(kn,{type:"monotone",dataKey:"مكتملة",stackId:"1",stroke:"#10B981",fill:"#10B981"}),n.jsx(kn,{type:"monotone",dataKey:"نشطة",stackId:"1",stroke:"#3B82F6",fill:"#3B82F6"}),n.jsx(kn,{type:"monotone",dataKey:"مسودة",stackId:"1",stroke:"#F59E0B",fill:"#F59E0B"})]})})]}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(ar,{className:"w-8 h-8 text-green-600"})}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:"89"}),n.jsx("p",{className:"text-gray-600",children:"مشاريع مكتملة"}),n.jsx("p",{className:"text-green-600 text-sm mt-1",children:"+15% من الشهر الماضي"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(Hg,{className:"w-8 h-8 text-blue-600"})}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:"67"}),n.jsx("p",{className:"text-gray-600",children:"مشاريع نشطة"}),n.jsx("p",{className:"text-blue-600 text-sm mt-1",children:"+8% من الشهر الماضي"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-yellow-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(wt,{className:"w-8 h-8 text-yellow-600"})}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:"23"}),n.jsx("p",{className:"text-gray-600",children:"مشاريع في المسودة"}),n.jsx("p",{className:"text-yellow-600 text-sm mt-1",children:"-5% من الشهر الماضي"})]})]})]}),e==="users"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"نمو المستخدمين"}),n.jsx(gl,{width:"100%",height:400,children:n.jsxs(rw,{data:KZ,children:[n.jsx(Cl,{strokeDasharray:"3 3"}),n.jsx(Un,{dataKey:"name"}),n.jsx(Wn,{}),n.jsx(ua,{}),n.jsx(pn,{type:"monotone",dataKey:"طلاب",stroke:"#3B82F6",strokeWidth:3}),n.jsx(pn,{type:"monotone",dataKey:"معلمين",stroke:"#10B981",strokeWidth:3}),n.jsx(pn,{type:"monotone",dataKey:"مدارس",stroke:"#F59E0B",strokeWidth:3})]})})]}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(lt,{className:"w-8 h-8 text-blue-600"})}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:"2,456"}),n.jsx("p",{className:"text-gray-600",children:"إجمالي الطلاب"}),n.jsx("p",{className:"text-blue-600 text-sm mt-1",children:"+18% من الشهر الماضي"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(wt,{className:"w-8 h-8 text-green-600"})}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:"312"}),n.jsx("p",{className:"text-gray-600",children:"إجمالي المعلمين"}),n.jsx("p",{className:"text-green-600 text-sm mt-1",children:"+12% من الشهر الماضي"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-yellow-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(ar,{className:"w-8 h-8 text-yellow-600"})}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:"79"}),n.jsx("p",{className:"text-gray-600",children:"إجمالي المدارس"}),n.jsx("p",{className:"text-yellow-600 text-sm mt-1",children:"+25% من الشهر الماضي"})]})]})]}),e==="performance"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"مؤشرات الأداء الأسبوعية"}),n.jsx(gl,{width:"100%",height:400,children:n.jsxs(rw,{data:qZ,children:[n.jsx(Cl,{strokeDasharray:"3 3"}),n.jsx(Un,{dataKey:"name"}),n.jsx(Wn,{domain:[0,100]}),n.jsx(ua,{}),n.jsx(pn,{type:"monotone",dataKey:"معدل_الإنجاز",stroke:"#3B82F6",strokeWidth:3}),n.jsx(pn,{type:"monotone",dataKey:"رضا_المستخدمين",stroke:"#10B981",strokeWidth:3}),n.jsx(pn,{type:"monotone",dataKey:"نشاط_المنصة",stroke:"#F59E0B",strokeWidth:3})]})})]}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(mi,{className:"w-8 h-8 text-blue-600"})}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:"89%"}),n.jsx("p",{className:"text-gray-600",children:"معدل الإنجاز"}),n.jsx("p",{className:"text-blue-600 text-sm mt-1",children:"+3% من الأسبوع الماضي"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(ar,{className:"w-8 h-8 text-green-600"})}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:"94%"}),n.jsx("p",{className:"text-gray-600",children:"رضا المستخدمين"}),n.jsx("p",{className:"text-green-600 text-sm mt-1",children:"+1% من الأسبوع الماضي"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-yellow-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(Hg,{className:"w-8 h-8 text-yellow-600"})}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:"85%"}),n.jsx("p",{className:"text-gray-600",children:"نشاط المنصة"}),n.jsx("p",{className:"text-yellow-600 text-sm mt-1",children:"+7% من الأسبوع الماضي"})]})]})]})]}),e!=="school-query"&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"خيارات التصدير"}),n.jsxs("div",{className:"grid md:grid-cols-4 gap-4",children:[n.jsxs("button",{className:"flex items-center gap-3 p-4 border border-gray-200 rounded-xl hover:bg-gray-50 transition-colors",children:[n.jsx(Tr,{className:"w-5 h-5 text-blue-600"}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"font-medium text-gray-800",children:"تصدير PDF"}),n.jsx("p",{className:"text-sm text-gray-600",children:"تقرير شامل"})]})]}),n.jsxs("button",{className:"flex items-center gap-3 p-4 border border-gray-200 rounded-xl hover:bg-gray-50 transition-colors",children:[n.jsx(Tr,{className:"w-5 h-5 text-green-600"}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"font-medium text-gray-800",children:"تصدير Excel"}),n.jsx("p",{className:"text-sm text-gray-600",children:"بيانات خام"})]})]}),n.jsxs("button",{className:"flex items-center gap-3 p-4 border border-gray-200 rounded-xl hover:bg-gray-50 transition-colors",children:[n.jsx(sr,{className:"w-5 h-5 text-purple-600"}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"font-medium text-gray-800",children:"عرض مفصل"}),n.jsx("p",{className:"text-sm text-gray-600",children:"تحليل متقدم"})]})]}),n.jsxs("button",{className:"flex items-center gap-3 p-4 border border-gray-200 rounded-xl hover:bg-gray-50 transition-colors",children:[n.jsx(tt,{className:"w-5 h-5 text-orange-600"}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"font-medium text-gray-800",children:"تقرير مجدول"}),n.jsx("p",{className:"text-sm text-gray-600",children:"إرسال دوري"})]})]})]})]})]})},JZ=()=>{const{t:e}=yt(),{consultants:t,loading:r,error:a}=As(),[s,i]=O.useState(""),[o,l]=O.useState("all"),[c,d]=O.useState(0),[u,f]=O.useState(!1),[h,m]=O.useState(!1),[x,p]=O.useState(null),g=["all",...new Set(t.flatMap(w=>w.specialties))],y=t.filter(w=>{const v=w.name.toLowerCase().includes(s.toLowerCase())||w.title.toLowerCase().includes(s.toLowerCase())||w.specialties.some(j=>j.toLowerCase().includes(s.toLowerCase())),_=o==="all"||w.specialties.includes(o),b=w.rating>=c;return v&&_&&b});return r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-emerald-500"})}):a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(pt,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:a})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-emerald-600 to-teal-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(ut,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("search.title")}),n.jsx("p",{className:"opacity-90",children:e("search.subtitle")})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.length}),n.jsx("div",{className:"text-sm opacity-80",children:e("search.stats.availableConsultants")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:g.length-1}),n.jsx("div",{className:"text-sm opacity-80",children:e("search.stats.specialties")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"24/7"}),n.jsx("div",{className:"text-sm opacity-80",children:e("search.stats.support")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"100%"}),n.jsx("div",{className:"text-sm opacity-80",children:e("search.stats.satisfaction")})]})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ut,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("search.searchPlaceholder"),value:s,onChange:w=>i(w.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),n.jsxs("button",{onClick:()=>f(!u),className:"lg:hidden flex items-center gap-2 px-4 py-3 bg-gray-100 rounded-xl hover:bg-gray-200 transition-colors",children:[n.jsx(Ko,{className:"w-5 h-5"}),e("common.filter")]})]}),n.jsxs("div",{className:`mt-4 space-y-4 ${u?"block":"hidden lg:block"}`,children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("search.specialty")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:g.map(w=>n.jsx("button",{onClick:()=>l(w),className:`px-4 py-2 rounded-xl transition-all ${o===w?"bg-emerald-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:w==="all"?e("search.allSpecialties"):w},w))})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("search.rating")}),n.jsx("div",{className:"flex items-center gap-2",children:[0,3,3.5,4,4.5].map(w=>n.jsx("button",{onClick:()=>d(w),className:`flex items-center gap-1 px-4 py-2 rounded-xl transition-all ${c===w?"bg-emerald-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:w===0?e("common.all"):n.jsxs(n.Fragment,{children:[n.jsx(at,{className:"w-4 h-4"}),w,"+"]})},w))})]})]})]}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:[e("search.showing")," ",y.length," ",e("search.of")," ",t.length," ",e("search.consultant")]})}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:y.map((w,v)=>n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:v*.1},className:"bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition-all duration-300",children:[n.jsxs("div",{className:"text-center mb-4",children:[n.jsx("img",{src:w.avatar,alt:w.name,className:"w-24 h-24 rounded-full object-cover mx-auto mb-4"}),n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-1",children:w.name}),n.jsx("p",{className:"text-gray-600 mb-2",children:w.title}),n.jsxs("div",{className:"flex items-center justify-center gap-1 mb-2",children:[n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"font-medium",children:w.rating}),n.jsxs("span",{className:"text-gray-500 text-sm",children:["(",w.reviews," ",e("search.reviews"),")"]})]}),n.jsx("span",{className:"inline-block px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm",children:w.availability})]}),n.jsxs("div",{className:"space-y-3 mb-4",children:[n.jsxs("div",{children:[n.jsxs("h4",{className:"font-medium text-gray-800 mb-2",children:[e("search.specialties"),":"]}),n.jsx("div",{className:"flex flex-wrap gap-1",children:w.specialties.map((_,b)=>n.jsx("span",{className:"px-2 py-1 bg-emerald-100 text-emerald-800 text-xs rounded-lg",children:_},b))})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsxs("span",{className:"text-gray-600",children:[e("search.experience"),":"]}),n.jsx("span",{className:"font-medium",children:w.experience})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsxs("span",{className:"text-gray-600",children:[e("search.price"),":"]}),n.jsxs("span",{className:"font-medium text-emerald-600",children:[w.hourlyRate," ",e("search.pricePerHour")]})]}),n.jsxs("div",{children:[n.jsxs("span",{className:"text-gray-600 text-sm",children:[e("search.languages"),": "]}),n.jsx("span",{className:"text-sm",children:w.languages.join(", ")})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>{p(w.id),m(!0)},className:"flex-1 bg-emerald-500 text-white py-2 px-4 rounded-xl hover:bg-emerald-600 transition-colors font-medium",children:e("search.bookConsultation")}),n.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:n.jsx(Ht,{className:"w-4 h-4"})})]})]},w.id))}),y.length===0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(ut,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("search.noConsultantsFound")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("search.tryChangingFilters")}),n.jsx("button",{onClick:()=>{l("all"),d(0),i("")},className:"px-6 py-2 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors",children:e("common.resetFilters")})]}),h&&x&&n.jsx(Qj,{consultant:t.find(w=>w.id===x),onClose:()=>{m(!1),p(null)},onSubmit:w=>{console.log("Booking consultation:",w),m(!1),p(null)}})]})},ZZ=[{id:"1",name:"د. محمد العتيبي",title:"مستشار تقني",specialties:["الذكاء الاصطناعي","تعلم الآلة","الروبوتات"],rating:4.9,reviews:124,experience:"10+ سنوات",avatar:"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",hourlyRate:200,availability:"متاح",languages:["العربية","الإنجليزية"],location:"الرياض، السعودية"},{id:"2",name:"أ. سارة الشمري",title:"مستشارة أكاديمية",specialties:["التعليم","المناهج الدراسية","تطوير المهارات"],rating:4.8,reviews:98,experience:"8+ سنوات",avatar:"https://images.pexels.com/photos/774909/pexels-photo-774909.jpeg?auto=compress&cs=tinysrgb&w=150",hourlyRate:150,availability:"متاح",languages:["العربية","الإنجليزية","الفرنسية"],location:"جدة، السعودية"},{id:"3",name:"م. خالد الدوسري",title:"مستشار هندسي",specialties:["الهندسة الميكانيكية","الطاقة المتجددة","التصميم الهندسي"],rating:4.7,reviews:87,experience:"12+ سنوات",avatar:"https://images.pexels.com/photos/1043471/pexels-photo-1043471.jpeg?auto=compress&cs=tinysrgb&w=150",hourlyRate:250,availability:"متاح",languages:["العربية","الإنجليزية"],location:"الدمام، السعودية"},{id:"4",name:"د. نورة القحطاني",title:"مستشارة تعليمية",specialties:["التعليم الإلكتروني","تطوير المناهج","التقييم التربوي"],rating:4.9,reviews:112,experience:"15+ سنوات",avatar:"https://images.pexels.com/photos/415829/pexels-photo-415829.jpeg?auto=compress&cs=tinysrgb&w=150",hourlyRate:180,availability:"متاح",languages:["العربية","الإنجليزية"],location:"الرياض، السعودية"},{id:"5",name:"أ. فهد العنزي",title:"مستشار مالي",specialties:["التخطيط المالي","الاستثمار","إدارة الميزانية"],rating:4.6,reviews:76,experience:"7+ سنوات",avatar:"https://images.pexels.com/photos/1222271/pexels-photo-1222271.jpeg?auto=compress&cs=tinysrgb&w=150",hourlyRate:220,availability:"متاح",languages:["العربية","الإنجليزية"],location:"جدة، السعودية"}],QZ=()=>{const{t:e}=yt(),[t,r]=O.useState(ZZ),[a,s]=O.useState(""),[i,o]=O.useState("all"),l=["all",...new Set(t.flatMap(u=>u.specialties))],c=t.filter(u=>{const f=u.name.toLowerCase().includes(a.toLowerCase())||u.title.toLowerCase().includes(a.toLowerCase())||u.specialties.some(m=>m.toLowerCase().includes(a.toLowerCase())),h=i==="all"||u.specialties.includes(i);return f&&h}),d=u=>{r(f=>f.filter(h=>h.id!==u))};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-emerald-600 to-teal-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(at,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("favorites.title")}),n.jsx("p",{className:"opacity-90",children:e("favorites.subtitle")})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.length}),n.jsx("div",{className:"text-sm opacity-80",children:e("favorites.stats.favoriteConsultants")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:l.length-1}),n.jsx("div",{className:"text-sm opacity-80",children:e("favorites.stats.differentSpecialties")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:Math.round(t.reduce((u,f)=>u+f.rating,0)/t.length*10)/10}),n.jsx("div",{className:"text-sm opacity-80",children:e("favorites.stats.averageRating")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:Math.round(t.reduce((u,f)=>u+f.hourlyRate,0)/t.length)}),n.jsx("div",{className:"text-sm opacity-80",children:e("favorites.stats.averagePrice")})]})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsx("div",{className:"flex flex-col lg:flex-row gap-4 mb-6",children:n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ut,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("favorites.searchPlaceholder"),value:a,onChange:u=>s(u.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]})}),n.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("favorites.specialty")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:l.map(u=>n.jsx("button",{onClick:()=>o(u),className:`px-4 py-2 rounded-xl transition-all ${i===u?"bg-emerald-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:u==="all"?e("favorites.allSpecialties"):u},u))})]})})]}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:[e("favorites.showing")," ",c.length," ",e("favorites.of")," ",t.length," ",e("favorites.consultant")]})}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map((u,f)=>n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:f*.1},className:"bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition-all duration-300",children:[n.jsxs("div",{className:"text-center mb-4 relative",children:[n.jsx("button",{onClick:()=>d(u.id),className:"absolute top-0 left-0 p-2 bg-red-100 text-red-600 rounded-full hover:bg-red-200 transition-colors",children:n.jsx(fa,{className:"w-5 h-5 fill-current"})}),n.jsx("img",{src:u.avatar,alt:u.name,className:"w-24 h-24 rounded-full object-cover mx-auto mb-4"}),n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-1",children:u.name}),n.jsx("p",{className:"text-gray-600 mb-2",children:u.title}),n.jsxs("div",{className:"flex items-center justify-center gap-1 mb-2",children:[n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"font-medium",children:u.rating}),n.jsxs("span",{className:"text-gray-500 text-sm",children:["(",u.reviews," ",e("favorites.reviews"),")"]})]}),n.jsx("span",{className:"inline-block px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium flex items-center gap-1",children:u.availability})]}),n.jsxs("div",{className:"space-y-3 mb-4",children:[n.jsxs("div",{children:[n.jsxs("h4",{className:"font-medium text-gray-800 mb-2",children:[e("favorites.specialties"),":"]}),n.jsx("div",{className:"flex flex-wrap gap-1",children:u.specialties.map((h,m)=>n.jsx("span",{className:"px-2 py-1 bg-emerald-100 text-emerald-800 text-xs rounded-lg",children:h},m))})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsxs("span",{className:"text-gray-600",children:[e("favorites.experience"),":"]}),n.jsx("span",{className:"font-medium",children:u.experience})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsxs("span",{className:"text-gray-600",children:[e("favorites.price"),":"]}),n.jsxs("span",{className:"font-medium text-emerald-600",children:[u.hourlyRate," ",e("favorites.pricePerHour")]})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsxs("span",{className:"text-gray-600",children:[e("favorites.location"),":"]}),n.jsx("span",{className:"font-medium",children:u.location})]}),n.jsxs("div",{children:[n.jsxs("span",{className:"text-gray-600 text-sm",children:[e("favorites.languages"),": "]}),n.jsx("span",{className:"text-sm",children:u.languages.join(", ")})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(Ee,{to:`/consultations?consultant=${u.id}`,className:"flex-1 bg-emerald-500 text-white py-2 px-4 rounded-xl hover:bg-emerald-600 transition-colors font-medium",children:e("favorites.bookConsultation")}),n.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:n.jsx(Ht,{className:"w-4 h-4"})})]})]},u.id))}),c.length===0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(at,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("favorites.noFavorites")}),n.jsx("p",{className:"text-gray-600 mb-4",children:t.length===0?e("favorites.noFavoritesAdded"):e("favorites.noFavoritesMatch")}),n.jsxs("div",{className:"flex justify-center gap-4",children:[n.jsx(Ee,{to:"/search",className:"px-6 py-2 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors",children:e("favorites.searchConsultants")}),t.length>0&&n.jsx("button",{onClick:()=>{o("all"),s("")},className:"px-6 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("common.resetFilters")})]})]})]})},eQ=()=>{const{user:e}=vt(),{consultations:t,loading:r,error:a,acceptConsultation:s}=As(),[i,o]=O.useState("all"),[l,c]=O.useState(""),[d,u]=O.useState(!1),f=t.filter(v=>v.status==="pending"&&v.mentor_id===null),h=t.filter(v=>v.mentor_id===(e==null?void 0:e.id)),m=h.filter(v=>{const _=i==="all"||v.status===i,b=v.topic.toLowerCase().includes(l.toLowerCase())||v.description.toLowerCase().includes(l.toLowerCase());return _&&b}),x=async v=>{try{u(!0),await s(v)}catch(_){console.error("Error accepting consultation:",_)}finally{u(!1)}},p=v=>{switch(v){case"pending":return"bg-yellow-100 text-yellow-800";case"scheduled":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},g=v=>{switch(v){case"pending":return"في الانتظار";case"scheduled":return"مجدولة";case"completed":return"مكتملة";case"cancelled":return"ملغية";default:return v}},y=v=>{switch(v){case"video":return n.jsx(jr,{className:"w-4 h-4"});case"phone":return n.jsx(Pr,{className:"w-4 h-4"});case"chat":return n.jsx(Lr,{className:"w-4 h-4"});default:return n.jsx(Ht,{className:"w-4 h-4"})}},w=v=>{switch(v){case"video":return"مكالمة فيديو";case"phone":return"مكالمة صوتية";case"chat":return"محادثة نصية";default:return v}};return r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-emerald-500"})}):a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(oa,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:a})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-emerald-600 to-teal-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(hi,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"لوحة تحكم المستشار"}),n.jsxs("p",{className:"opacity-90",children:["مرحباً ",e==null?void 0:e.name,"، إدارة الاستشارات والمواعيد"]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:h.length}),n.jsx("div",{className:"text-sm opacity-80",children:"إجمالي الاستشارات"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:h.filter(v=>v.status==="scheduled").length}),n.jsx("div",{className:"text-sm opacity-80",children:"مجدولة"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:h.filter(v=>v.status==="completed").length}),n.jsx("div",{className:"text-sm opacity-80",children:"مكتملة"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:f.length}),n.jsx("div",{className:"text-sm opacity-80",children:"طلبات جديدة"})]})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[n.jsx(Ht,{className:"w-6 h-6 text-emerald-600"}),"طلبات الاستشارة الجديدة"]}),f.length>0?n.jsx("div",{className:"space-y-4",children:f.map(v=>n.jsx(te.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"border border-gray-200 rounded-xl p-6 hover:shadow-md transition-all",children:n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:v.topic}),n.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${p(v.status)}`,children:g(v.status)})]}),n.jsx("p",{className:"text-gray-600 mb-2",children:v.description}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[n.jsxs("span",{className:"flex items-center gap-1",children:[y(v.method),w(v.method)]}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(jt,{className:"w-4 h-4"}),v.duration," دقيقة"]}),v.preferredDate&&n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(tt,{className:"w-4 h-4"}),"التاريخ المفضل: ",Ze(v.preferredDate)]})]})]}),n.jsx("button",{onClick:()=>x(v.id),disabled:d,className:"px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:d?"جاري القبول...":"قبول الطلب"})]})},v.id))}):n.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-xl",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(Ht,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا توجد طلبات جديدة"}),n.jsx("p",{className:"text-gray-600",children:"ستظهر هنا طلبات الاستشارة الجديدة التي يمكنك قبولها"})]}),n.jsx("div",{className:"mt-4 text-center",children:n.jsxs(Ee,{to:"/consultation-requests",className:"inline-flex items-center gap-2 text-emerald-600 font-medium hover:text-emerald-800 transition-colors",children:["عرض جميع الطلبات",n.jsx(nc,{className:"w-4 h-4"})]})})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(tt,{className:"w-6 h-6 text-emerald-600"}),"استشاراتي"]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("div",{className:"relative",children:[n.jsx(ut,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"البحث في الاستشارات...",value:l,onChange:v=>c(v.target.value),className:"w-64 pr-12 pl-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),n.jsxs("select",{value:i,onChange:v=>o(v.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:"جميع الحالات"}),n.jsx("option",{value:"scheduled",children:"مجدولة"}),n.jsx("option",{value:"completed",children:"مكتملة"}),n.jsx("option",{value:"cancelled",children:"ملغية"})]})]})]}),m.length>0?n.jsx("div",{className:"space-y-4",children:m.map(v=>n.jsxs(te.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"border border-gray-200 rounded-xl p-6 hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:v.topic}),n.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${p(v.status)}`,children:g(v.status)})]}),n.jsx("p",{className:"text-gray-600 mb-2",children:v.description}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[n.jsxs("span",{className:"flex items-center gap-1",children:[y(v.method),w(v.method)]}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(jt,{className:"w-4 h-4"}),v.duration," دقيقة"]}),v.scheduledDate&&n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(tt,{className:"w-4 h-4"}),"موعد الاستشارة: ",Ze(v.scheduledDate)]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[v.status==="scheduled"&&n.jsx("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",onClick:()=>window.open("https://meet.google.com/new","_blank"),children:"بدء الاستشارة"}),n.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"عرض التفاصيل"})]})]}),v.status==="completed"&&v.rating&&n.jsxs("div",{className:"mt-2 flex items-center gap-1",children:[n.jsx("span",{className:"text-sm text-gray-600",children:"التقييم:"}),n.jsx("div",{className:"flex items-center",children:[1,2,3,4,5].map(_=>n.jsx(at,{className:`w-4 h-4 ${_<=v.rating?"text-yellow-400 fill-current":"text-gray-300"}`},_))}),v.feedback&&n.jsxs("span",{className:"text-sm text-gray-600 mr-2",children:['"',v.feedback,'"']})]})]},v.id))}):n.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-xl",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(tt,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا توجد استشارات"}),n.jsx("p",{className:"text-gray-600",children:"لم يتم العثور على استشارات تطابق معايير البحث"})]}),n.jsx("div",{className:"mt-4 text-center",children:n.jsxs(Ee,{to:"/consultant-schedule",className:"inline-flex items-center gap-2 text-emerald-600 font-medium hover:text-emerald-800 transition-colors",children:["عرض جدول المواعيد",n.jsx(nc,{className:"w-4 h-4"})]})})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-emerald-100 rounded-xl flex items-center justify-center",children:n.jsx(at,{className:"w-6 h-6 text-emerald-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"التقييمات"}),n.jsx("p",{className:"text-gray-600",children:"متوسط تقييم استشاراتك"})]})]}),n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("div",{className:"flex items-center",children:[1,2,3,4,5].map(v=>n.jsx(at,{className:`w-6 h-6 ${v<=4.5?"text-yellow-400 fill-current":"text-gray-300"}`},v))}),n.jsx("span",{className:"text-2xl font-bold text-gray-800",children:"4.5"})]}),n.jsxs("p",{className:"text-sm text-gray-600",children:["من ",h.filter(v=>v.rating).length," تقييم"]})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:n.jsx(lt,{className:"w-6 h-6 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"العملاء"}),n.jsx("p",{className:"text-gray-600",children:"عدد العملاء الذين قدمت لهم استشارات"})]})]}),n.jsx("div",{className:"text-2xl font-bold text-gray-800 mb-2",children:new Set(h.map(v=>v.student_id)).size}),n.jsx("p",{className:"text-sm text-gray-600",children:"عميل فريد"})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center",children:n.jsx(mi,{className:"w-6 h-6 text-purple-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"الإيرادات"}),n.jsx("p",{className:"text-gray-600",children:"إجمالي الإيرادات من الاستشارات"})]})]}),n.jsxs("div",{className:"text-2xl font-bold text-gray-800 mb-2",children:[h.filter(v=>v.status==="completed").reduce((v,_)=>v+_.duration/60*((e==null?void 0:e.hourly_rate)||150),0).toFixed(0)," ر.س"]}),n.jsxs("p",{className:"text-sm text-gray-600",children:["من ",h.filter(v=>v.status==="completed").length," استشارة مكتملة"]})]})]})]})},tQ=()=>{const{user:e}=vt(),{consultations:t,loading:r,error:a,acceptConsultation:s}=As(),[i,o]=O.useState(""),[l,c]=O.useState("all"),[d,u]=O.useState(!1),[f,h]=O.useState(1),m=5,x=t.filter(b=>b.status==="pending"&&b.mentor_id===null),p=x.filter(b=>{const j=l==="all"||b.type===l,N=b.topic.toLowerCase().includes(i.toLowerCase())||b.description.toLowerCase().includes(i.toLowerCase());return j&&N}),g=Math.ceil(p.length/m),y=p.slice((f-1)*m,f*m),w=async b=>{try{u(!0),await s(b)}catch(j){console.error("Error accepting consultation:",j)}finally{u(!1)}},v=b=>{switch(b){case"video":return n.jsx(jr,{className:"w-4 h-4"});case"phone":return n.jsx(Pr,{className:"w-4 h-4"});case"chat":return n.jsx(Lr,{className:"w-4 h-4"});default:return n.jsx(Ht,{className:"w-4 h-4"})}},_=b=>{switch(b){case"video":return"مكالمة فيديو";case"phone":return"مكالمة صوتية";case"chat":return"محادثة نصية";default:return b}};return r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-emerald-500"})}):a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(pt,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:a})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-emerald-600 to-teal-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(Ht,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"طلبات الاستشارة"}),n.jsx("p",{className:"opacity-90",children:"اختر الطلبات التي ترغب في قبولها"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:x.length}),n.jsx("div",{className:"text-sm opacity-80",children:"طلب استشارة متاح"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:x.filter(b=>b.type==="technical").length}),n.jsx("div",{className:"text-sm opacity-80",children:"استشارة تقنية"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:x.filter(b=>b.type==="academic").length}),n.jsx("div",{className:"text-sm opacity-80",children:"استشارة أكاديمية"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:x.filter(b=>b.type==="project").length}),n.jsx("div",{className:"text-sm opacity-80",children:"استشارة مشروع"})]})]})]}),n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ut,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"البحث في طلبات الاستشارة...",value:i,onChange:b=>o(b.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),n.jsxs("select",{value:l,onChange:b=>c(b.target.value),className:"px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:"جميع الأنواع"}),n.jsx("option",{value:"technical",children:"استشارة تقنية"}),n.jsx("option",{value:"academic",children:"استشارة أكاديمية"}),n.jsx("option",{value:"career",children:"استشارة مهنية"}),n.jsx("option",{value:"project",children:"استشارة مشروع"})]})]})}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:["عرض ",p.length," من أصل ",x.length," طلب استشارة"]})}),n.jsx("div",{className:"space-y-4",children:y.length>0?y.map(b=>n.jsxs(te.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition-all",children:[n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:b.topic}),n.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs font-medium",children:"في الانتظار"})]}),n.jsx("p",{className:"text-gray-600 mb-3",children:b.description}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[n.jsxs("span",{className:"flex items-center gap-1",children:[v(b.method),_(b.method)]}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(jt,{className:"w-4 h-4"}),b.duration," دقيقة"]}),b.preferredDate&&n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(tt,{className:"w-4 h-4"}),"التاريخ المفضل: ",Ze(b.preferredDate)]})]})]}),n.jsx("button",{onClick:()=>w(b.id),disabled:d,className:"px-6 py-3 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:d?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري القبول..."]}):n.jsxs(n.Fragment,{children:[n.jsx(ze,{className:"w-5 h-5"}),"قبول الطلب"]})})]}),n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-xl",children:[n.jsx(xr,{className:"w-5 h-5 text-gray-500"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-800",children:"الطالب"}),n.jsxs("p",{className:"text-xs text-gray-600",children:["معرف الطالب: ",b.student_id]})]})]})]},b.id)):n.jsxs("div",{className:"text-center py-12 bg-white rounded-2xl shadow-lg",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(Ht,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"لا توجد طلبات استشارة"}),n.jsx("p",{className:"text-gray-600 mb-4",children:"لم يتم العثور على طلبات استشارة تطابق معايير البحث"}),n.jsx("button",{onClick:()=>{c("all"),o("")},className:"px-6 py-2 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors",children:"إعادة تعيين الفلاتر"})]})}),g>1&&n.jsx("div",{className:"flex justify-center mt-6",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>h(b=>Math.max(b-1,1)),disabled:f===1,className:"p-2 rounded-lg border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:n.jsx(Jn,{className:"w-5 h-5"})}),n.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:g},(b,j)=>j+1).map(b=>n.jsx("button",{onClick:()=>h(b),className:`w-8 h-8 rounded-lg ${f===b?"bg-emerald-500 text-white":"border border-gray-300 hover:bg-gray-50"}`,children:b},b))}),n.jsx("button",{onClick:()=>h(b=>Math.min(b+1,g)),disabled:f===g,className:"p-2 rounded-lg border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:n.jsx(nc,{className:"w-5 h-5"})})]})}),n.jsx("div",{className:"text-center mt-6",children:n.jsxs(Ee,{to:"/consultant-dashboard",className:"inline-flex items-center gap-2 text-emerald-600 font-medium hover:text-emerald-800 transition-colors",children:[n.jsx(Jn,{className:"w-5 h-5"}),"العودة إلى لوحة التحكم"]})})]})},rQ=()=>{const{user:e}=vt(),{consultations:t,loading:r,error:a}=As(),[s,i]=O.useState(new Date),[o,l]=O.useState("week"),c=t.filter(y=>y.status==="scheduled"&&y.consultant_id===(e==null?void 0:e.id)),d=y=>{switch(y){case"video":return n.jsx(jr,{className:"w-4 h-4"});case"phone":return n.jsx(Pr,{className:"w-4 h-4"});case"chat":return n.jsx(Lr,{className:"w-4 h-4"});default:return n.jsx(Lr,{className:"w-4 h-4"})}},u=y=>{switch(y){case"video":return"مكالمة فيديو";case"phone":return"مكالمة صوتية";case"chat":return"محادثة نصية";default:return y}},h=(()=>{const y=[],w=new Date(s);w.setDate(s.getDate()-s.getDay());for(let v=0;v<7;v++){const _=new Date(w);_.setDate(w.getDate()+v),y.push(_)}return y})(),m=y=>c.filter(w=>{if(!w.scheduledDate)return!1;const v=new Date(w.scheduledDate);return v.getDate()===y.getDate()&&v.getMonth()===y.getMonth()&&v.getFullYear()===y.getFullYear()}),x=()=>{const y=new Date(s);y.setDate(s.getDate()-7),i(y)},p=()=>{const y=new Date(s);y.setDate(s.getDate()+7),i(y)},g=()=>{i(new Date)};return r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-emerald-500"})}):a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(pt,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:a})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-emerald-600 to-teal-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(tt,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"جدول المواعيد"}),n.jsx("p",{className:"opacity-90",children:"إدارة مواعيد الاستشارات الخاصة بك"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:c.length}),n.jsx("div",{className:"text-sm opacity-80",children:"استشارة مجدولة"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:c.filter(y=>{if(!y.scheduledDate)return!1;const w=new Date;w.setHours(0,0,0,0);const v=new Date(y.scheduledDate);return v.setHours(0,0,0,0),v.getTime()===w.getTime()}).length}),n.jsx("div",{className:"text-sm opacity-80",children:"اليوم"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:c.filter(y=>{if(!y.scheduledDate)return!1;const w=new Date;w.setHours(0,0,0,0);const v=new Date(w);v.setDate(w.getDate()+1);const _=new Date(y.scheduledDate);return _.setHours(0,0,0,0),_.getTime()===v.getTime()}).length}),n.jsx("div",{className:"text-sm opacity-80",children:"غداً"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:c.filter(y=>{if(!y.scheduledDate)return!1;const w=new Date;w.setHours(0,0,0,0);const v=new Date(w);v.setDate(w.getDate()+7);const _=new Date(y.scheduledDate);return _.setHours(0,0,0,0),_.getTime()>w.getTime()&&_.getTime()<=v.getTime()}).length}),n.jsx("div",{className:"text-sm opacity-80",children:"هذا الأسبوع"})]})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:x,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Ml,{className:"w-5 h-5 text-gray-600"})}),n.jsx("button",{onClick:g,className:"px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors",children:"اليوم"}),n.jsx("button",{onClick:p,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx($l,{className:"w-5 h-5 text-gray-600"})})]}),n.jsxs("div",{className:"text-lg font-bold text-gray-800",children:[Ze(h[0])," - ",Ze(h[6])]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>l("day"),className:`px-4 py-2 rounded-lg ${o==="day"?"bg-emerald-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"} transition-colors`,children:"يوم"}),n.jsx("button",{onClick:()=>l("week"),className:`px-4 py-2 rounded-lg ${o==="week"?"bg-emerald-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"} transition-colors`,children:"أسبوع"}),n.jsx("button",{onClick:()=>l("month"),className:`px-4 py-2 rounded-lg ${o==="month"?"bg-emerald-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"} transition-colors`,children:"شهر"})]})]}),o==="week"&&n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("div",{className:"grid grid-cols-7 gap-4 min-w-[800px]",children:[h.map((y,w)=>n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:`mb-2 font-medium ${y.getDate()===new Date().getDate()&&y.getMonth()===new Date().getMonth()&&y.getFullYear()===new Date().getFullYear()?"text-emerald-600":"text-gray-800"}`,children:y.toLocaleDateString("ar-SA",{weekday:"long"})}),n.jsx("div",{className:`w-10 h-10 rounded-full mx-auto flex items-center justify-center ${y.getDate()===new Date().getDate()&&y.getMonth()===new Date().getMonth()&&y.getFullYear()===new Date().getFullYear()?"bg-emerald-500 text-white":"bg-gray-100 text-gray-800"}`,children:y.getDate()})]},w)),h.map((y,w)=>n.jsx("div",{className:"mt-4 space-y-2",children:m(y).length>0?m(y).map(v=>n.jsxs("div",{className:"bg-emerald-50 border border-emerald-200 rounded-lg p-3 hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"text-sm font-medium text-emerald-800",children:v.scheduledDate&&H0(v.scheduledDate)}),n.jsxs("span",{className:"flex items-center gap-1 text-xs text-gray-600",children:[d(v.method),u(v.method)]})]}),n.jsx("h4",{className:"font-medium text-gray-800 mb-1 line-clamp-1",children:v.topic}),n.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:v.description}),n.jsx("div",{className:"mt-2 flex justify-end",children:n.jsx("button",{onClick:()=>window.open("https://meet.google.com/new","_blank"),className:"px-3 py-1 bg-emerald-500 text-white text-xs rounded-lg hover:bg-emerald-600 transition-colors",children:"بدء الاستشارة"})})]},v.id)):n.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3 text-center text-gray-500 text-sm",children:"لا توجد مواعيد"})},`consultations-${w}`))]})}),o==="day"&&n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"text-center mb-4",children:n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:Ze(s)})}),m(s).length>0?m(s).map(y=>n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h4",{className:"font-semibold text-gray-800",children:y.topic}),n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:"مجدولة"})]}),n.jsx("p",{className:"text-gray-600 text-sm mb-2",children:y.description}),n.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(jt,{className:"w-4 h-4"}),y.scheduledDate&&H0(y.scheduledDate)]}),n.jsxs("span",{className:"flex items-center gap-1",children:[d(y.method),u(y.method)]}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(jt,{className:"w-4 h-4"}),y.duration," دقيقة"]})]})]}),n.jsx("button",{onClick:()=>window.open("https://meet.google.com/new","_blank"),className:"px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors",children:"بدء الاستشارة"})]}),n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-xl",children:[n.jsx(xr,{className:"w-5 h-5 text-gray-500"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-800",children:"الطالب"}),n.jsxs("p",{className:"text-xs text-gray-600",children:["معرف الطالب: ",y.student_id]})]})]})]},y.id)):n.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-xl",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(tt,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا توجد مواعيد لهذا اليوم"}),n.jsx("p",{className:"text-gray-600",children:"يمكنك قبول طلبات استشارة جديدة من صفحة طلبات الاستشارة"})]})]}),o==="month"&&n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(tt,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"عرض الشهر قيد التطوير"}),n.jsx("p",{className:"text-gray-600",children:"يرجى استخدام عرض اليوم أو الأسبوع في الوقت الحالي"})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[n.jsx(jt,{className:"w-6 h-6 text-emerald-600"}),"الاستشارات القادمة"]}),c.length>0?n.jsx("div",{className:"space-y-4",children:c.filter(y=>{if(!y.scheduledDate)return!1;const w=new Date;return new Date(y.scheduledDate)>w}).sort((y,w)=>!y.scheduledDate||!w.scheduledDate?0:new Date(y.scheduledDate).getTime()-new Date(w.scheduledDate).getTime()).slice(0,3).map(y=>n.jsx("div",{className:"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h4",{className:"font-semibold text-gray-800",children:y.topic}),n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:"مجدولة"})]}),n.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(tt,{className:"w-4 h-4"}),y.scheduledDate&&Ze(y.scheduledDate)]}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(jt,{className:"w-4 h-4"}),y.scheduledDate&&H0(y.scheduledDate)]})]})]}),n.jsx("button",{onClick:()=>window.open("https://meet.google.com/new","_blank"),className:"px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors",children:"بدء الاستشارة"})]})},y.id))}):n.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-xl",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(tt,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا توجد استشارات قادمة"}),n.jsx("p",{className:"text-gray-600",children:"يمكنك قبول طلبات استشارة جديدة من صفحة طلبات الاستشارة"})]}),n.jsx("div",{className:"mt-4 text-center",children:n.jsxs(Ee,{to:"/consultation-requests",className:"inline-flex items-center gap-2 text-emerald-600 font-medium hover:text-emerald-800 transition-colors",children:["عرض طلبات الاستشارة",n.jsx(nc,{className:"w-4 h-4"})]})})]}),n.jsx("div",{className:"text-center mt-6",children:n.jsxs(Ee,{to:"/consultant-dashboard",className:"inline-flex items-center gap-2 text-emerald-600 font-medium hover:text-emerald-800 transition-colors",children:[n.jsx(Jn,{className:"w-5 h-5"}),"العودة إلى لوحة التحكم"]})})]})},aQ=()=>{const{user:e}=vt(),[t,r]=O.useState(!1),[a,s]=O.useState({name:(e==null?void 0:e.name)||"",bio:(e==null?void 0:e.bio)||"",phone:(e==null?void 0:e.phone)||"",specializations:(e==null?void 0:e.specializations)||[],experience:(e==null?void 0:e.experience)||"",hourlyRate:(e==null?void 0:e.hourlyRate)||0,languages:(e==null?void 0:e.languages)||[]}),[i,o]=O.useState(!1),l=["الاستشارات الهندسية","الاستشارات القانونية","الاستشارات الإدارية","الاستشارات التقنية","الاستشارات المالية","الاستشارات التسويقية","الاستشارات الطبية","الاستشارات التعليمية","الاستشارات البيئية","الاستشارات الأمنية"],c=["العربية","الإنجليزية","الفرنسية","الإسبانية","الألمانية","الصينية","اليابانية","الروسية","الهندية","البرتغالية"],d=(m,x)=>{s(p=>({...p,[m]:x}))},u=m=>{s(x=>({...x,specializations:x.specializations.includes(m)?x.specializations.filter(p=>p!==m):[...x.specializations,m]}))},f=m=>{s(x=>({...x,languages:x.languages.includes(m)?x.languages.filter(p=>p!==m):[...x.languages,m]}))},h=async()=>{o(!0),setTimeout(()=>{o(!1),r(!1)},1e3)};return n.jsxs("div",{className:"space-y-6",children:[n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-emerald-600 to-teal-600 rounded-2xl p-6 text-white",children:n.jsxs("div",{className:"flex items-center gap-6",children:[n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:(e==null?void 0:e.avatar)||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",alt:e==null?void 0:e.name,className:"w-24 h-24 rounded-full object-cover border-4 border-white"}),n.jsx("button",{className:"absolute bottom-0 right-0 w-8 h-8 bg-white text-emerald-600 rounded-full flex items-center justify-center hover:bg-gray-100 transition-colors",children:n.jsx(xi,{className:"w-4 h-4"})})]}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold mb-2",children:e==null?void 0:e.name}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(hi,{className:"w-4 h-4"}),n.jsx("span",{children:(e==null?void 0:e.role)==="consultant"?"مستشار":e==null?void 0:e.role})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(at,{className:"w-4 h-4"}),n.jsxs("span",{children:[(e==null?void 0:e.rating)||5," (",(e==null?void 0:e.reviewsCount)||0," تقييم)"]})]})]})]})]})}),n.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"lg:col-span-2",children:n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(xr,{className:"w-6 h-6 text-emerald-600"}),"المعلومات الشخصية"]}),n.jsx("button",{onClick:()=>r(!t),className:"px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors flex items-center gap-2",children:t?n.jsxs(n.Fragment,{children:[n.jsx(Zn,{className:"w-4 h-4"}),"حفظ"]}):n.jsxs(n.Fragment,{children:[n.jsx(Oa,{className:"w-4 h-4"}),"تعديل"]})})]}),t?n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الاسم الكامل"}),n.jsx("input",{type:"text",value:a.name,onChange:m=>d("name",m.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نبذة مهنية"}),n.jsx("textarea",{value:a.bio,onChange:m=>d("bio",m.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"اكتب نبذة مختصرة عن خبرتك المهنية..."})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم الهاتف"}),n.jsx("input",{type:"tel",value:a.phone,onChange:m=>d("phone",m.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"05xxxxxxxx"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"التخصصات"}),n.jsx("div",{className:"grid grid-cols-2 gap-2",children:l.map(m=>n.jsxs("label",{className:`flex items-center gap-2 p-3 border rounded-lg cursor-pointer transition-colors ${a.specializations.includes(m)?"bg-emerald-50 border-emerald-500 text-emerald-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"checkbox",checked:a.specializations.includes(m),onChange:()=>u(m),className:"sr-only"}),n.jsx("span",{className:"text-sm",children:m})]},m))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"اللغات"}),n.jsx("div",{className:"grid grid-cols-2 gap-2",children:c.map(m=>n.jsxs("label",{className:`flex items-center gap-2 p-3 border rounded-lg cursor-pointer transition-colors ${a.languages.includes(m)?"bg-emerald-50 border-emerald-500 text-emerald-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"checkbox",checked:a.languages.includes(m),onChange:()=>f(m),className:"sr-only"}),n.jsx("span",{className:"text-sm",children:m})]},m))})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"سنوات الخبرة"}),n.jsx("input",{type:"text",value:a.experience,onChange:m=>d("experience",m.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"مثال: 5 سنوات"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"السعر بالساعة (ريال سعودي)"}),n.jsx("input",{type:"number",value:a.hourlyRate,onChange:m=>d("hourlyRate",parseInt(m.target.value)||0),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"200",min:"0"})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[n.jsx("button",{type:"button",onClick:()=>r(!1),className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{type:"button",onClick:h,disabled:i,className:"px-6 py-3 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:i?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الحفظ..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Zn,{className:"w-5 h-5"}),"حفظ التغييرات"]})})]})]}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"البريد الإلكتروني"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Ta,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:e==null?void 0:e.email})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"رقم الهاتف"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Pr,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:(e==null?void 0:e.phone)||"غير محدد"})]})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"نبذة مهنية"}),n.jsx("p",{className:"text-gray-800 leading-relaxed",children:(e==null?void 0:e.bio)||"لا توجد نبذة مهنية. قم بتعديل ملفك الشخصي لإضافة نبذة عن خبرتك المهنية."})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"التخصصات"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:e!=null&&e.specializations&&e.specializations.length>0?e.specializations.map((m,x)=>n.jsx("span",{className:"px-3 py-1 bg-emerald-100 text-emerald-800 rounded-full text-sm",children:m},x)):n.jsx("span",{className:"text-gray-500",children:"لم يتم تحديد تخصصات"})})]}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"سنوات الخبرة"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(jt,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:(e==null?void 0:e.experience)||"غير محدد"})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"السعر بالساعة"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(iu,{className:"w-5 h-5 text-gray-400"}),n.jsxs("span",{className:"text-gray-800",children:[(e==null?void 0:e.hourlyRate)||0," ر.س"]})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"اللغات"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(l6,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:e!=null&&e.languages&&e.languages.length>0?e.languages.join("، "):"غير محدد"})]})]})]})]})]})}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"space-y-6",children:[n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[n.jsx(ar,{className:"w-5 h-5 text-emerald-600"}),"الإحصائيات"]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"التقييم"}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("div",{className:"flex",children:[1,2,3,4,5].map(m=>n.jsx(at,{className:`w-4 h-4 ${m<=((e==null?void 0:e.rating)||5)?"text-yellow-400 fill-current":"text-gray-300"}`},m))}),n.jsx("span",{className:"font-medium",children:(e==null?void 0:e.rating)||5})]})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"عدد التقييمات"}),n.jsx("span",{className:"font-medium",children:(e==null?void 0:e.reviewsCount)||0})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"الاستشارات المكتملة"}),n.jsx("span",{className:"font-medium",children:"0"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"معدل الاستجابة"}),n.jsx("span",{className:"font-medium",children:"100%"})]})]})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[n.jsx(tt,{className:"w-5 h-5 text-emerald-600"}),"أوقات الدوام"]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"الأحد"}),n.jsx("span",{className:"font-medium",children:"9:00 ص - 5:00 م"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"الإثنين"}),n.jsx("span",{className:"font-medium",children:"9:00 ص - 5:00 م"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"الثلاثاء"}),n.jsx("span",{className:"font-medium",children:"9:00 ص - 5:00 م"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"الأربعاء"}),n.jsx("span",{className:"font-medium",children:"9:00 ص - 5:00 م"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"الخميس"}),n.jsx("span",{className:"font-medium",children:"9:00 ص - 5:00 م"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"الجمعة"}),n.jsx("span",{className:"text-gray-400",children:"مغلق"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"السبت"}),n.jsx("span",{className:"text-gray-400",children:"مغلق"})]})]}),n.jsx("button",{className:"w-full mt-4 px-4 py-2 border border-emerald-500 text-emerald-600 rounded-lg hover:bg-emerald-50 transition-colors",children:"تعديل أوقات الدوام"})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h2",{className:"text-lg font-bold text-gray-800 mb-4",children:"روابط سريعة"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("a",{href:"/consultant-dashboard",className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded-lg transition-colors",children:[n.jsx(hi,{className:"w-5 h-5 text-emerald-600"}),n.jsx("span",{className:"text-gray-700",children:"لوحة التحكم"})]}),n.jsxs("a",{href:"/consultation-requests",className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded-lg transition-colors",children:[n.jsx(Ht,{className:"w-5 h-5 text-emerald-600"}),n.jsx("span",{className:"text-gray-700",children:"طلبات الاستشارة"})]}),n.jsxs("a",{href:"/consultant-schedule",className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded-lg transition-colors",children:[n.jsx(tt,{className:"w-5 h-5 text-emerald-600"}),n.jsx("span",{className:"text-gray-700",children:"جدول المواعيد"})]}),n.jsxs("a",{href:"/reviews",className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded-lg transition-colors",children:[n.jsx(at,{className:"w-5 h-5 text-emerald-600"}),n.jsx("span",{className:"text-gray-700",children:"التقييمات"})]}),n.jsxs("a",{href:"/settings",className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded-lg transition-colors",children:[n.jsx(br,{className:"w-5 h-5 text-emerald-600"}),n.jsx("span",{className:"text-gray-700",children:"الإعدادات"})]})]})]})]})]})]})},nQ=()=>{const{user:e}=vt(),[t,r]=O.useState([]),[a,s]=O.useState(!0),[i,o]=O.useState(null),[l,c]=O.useState(null),[d,u]=O.useState(""),[f,h]=O.useState("latest");O.useEffect(()=>{(async()=>{if(e)try{s(!0),o(null);const w=De(pe,"reviews"),v=et(w,Ue("consultant_id","==",e.id),Pi("created_at","desc"),ys(50)),_=await Je(v);if(_.empty){r([]),s(!1);return}const b=await Promise.all(_.docs.map(async j=>{const N=j.data();let k={name:"طالب غير معروف",avatar:"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150"};if(N.student_id){const E=Ie(pe,"users",N.student_id),P=await hr(E);if(P.exists()){const C=P.data();k={name:C.name||"طالب غير معروف",avatar:C.avatar_url||k.avatar}}}let S={topic:"استشارة",type:"عامة",date:new Date().toISOString()};if(N.consultation_id){const E=Ie(pe,"consultations",N.consultation_id),P=await hr(E);if(P.exists()){const C=P.data();S={topic:C.topic||"استشارة",type:C.type||"عامة",date:C.completed_at?new Date(C.completed_at.toDate()).toISOString():new Date().toISOString()}}}return{id:j.id,consultation_id:N.consultation_id,student_id:N.student_id,consultant_id:N.consultant_id,rating:N.rating||5,feedback:N.feedback||"",created_at:N.created_at?new Date(N.created_at.toDate()).toISOString():new Date().toISOString(),student:k,consultation:S}}));r(b)}catch(w){console.error("Error fetching reviews:",w),o(w instanceof Error?w.message:"حدث خطأ في تحميل التقييمات")}finally{s(!1)}})()},[e]);const m=t.filter(y=>{var _,b;const w=l===null||y.rating===l,v=y.feedback.toLowerCase().includes(d.toLowerCase())||((_=y.student)==null?void 0:_.name.toLowerCase().includes(d.toLowerCase()))||((b=y.consultation)==null?void 0:b.topic.toLowerCase().includes(d.toLowerCase()));return w&&v}).sort((y,w)=>f==="latest"?new Date(w.created_at).getTime()-new Date(y.created_at).getTime():f==="oldest"?new Date(y.created_at).getTime()-new Date(w.created_at).getTime():f==="highest"?w.rating-y.rating:f==="lowest"?y.rating-w.rating:0),x=t.length,p=x>0?t.reduce((y,w)=>y+w.rating,0)/x:0,g=[5,4,3,2,1].map(y=>({rating:y,count:t.filter(w=>w.rating===y).length,percentage:x>0?t.filter(w=>w.rating===y).length/x*100:0}));return a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-emerald-500"})}):i?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(oa,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:i})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-yellow-500 to-amber-500 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(at,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"التقييمات"}),n.jsx("p",{className:"opacity-90",children:"تقييمات الطلاب لاستشاراتك"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:x}),n.jsx("div",{className:"text-sm opacity-80",children:"إجمالي التقييمات"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:p.toFixed(1)}),n.jsx("div",{className:"text-sm opacity-80",children:"متوسط التقييم"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:g[0].count}),n.jsx("div",{className:"text-sm opacity-80",children:"تقييم 5 نجوم"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.filter(y=>y.rating>=4).length}),n.jsx("div",{className:"text-sm opacity-80",children:"تقييمات إيجابية"})]})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"grid lg:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"lg:col-span-2 bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[n.jsx(Yn,{className:"w-6 h-6 text-yellow-500"}),"توزيع التقييمات"]}),n.jsx("div",{className:"space-y-4",children:g.map(y=>n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-1 w-24",children:[n.jsx("span",{className:"font-medium",children:y.rating}),n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"})]}),n.jsx("div",{className:"flex-1",children:n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:n.jsx("div",{className:"bg-yellow-400 h-2.5 rounded-full",style:{width:`${y.percentage}%`}})})}),n.jsx("div",{className:"w-16 text-right",children:n.jsx("span",{className:"text-sm text-gray-600",children:y.count})}),n.jsx("div",{className:"w-16 text-right",children:n.jsxs("span",{className:"text-sm text-gray-600",children:[y.percentage.toFixed(0),"%"]})})]},y.rating))})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[n.jsx(mi,{className:"w-6 h-6 text-yellow-500"}),"إحصائيات التقييم"]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-5xl font-bold text-gray-800 mb-2",children:p.toFixed(1)}),n.jsx("div",{className:"flex items-center justify-center gap-1 mb-2",children:[1,2,3,4,5].map(y=>n.jsx(at,{className:`w-6 h-6 ${y<=Math.round(p)?"text-yellow-400 fill-current":"text-gray-300"}`},y))}),n.jsxs("p",{className:"text-gray-600",children:["من ",x," تقييم"]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-gray-600",children:"نسبة الرضا"}),n.jsxs("span",{className:"font-medium text-green-600",children:[x>0?(t.filter(y=>y.rating>=4).length/x*100).toFixed(0):0,"%"]})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-gray-600",children:"متوسط التقييم الشهري"}),n.jsx("span",{className:"font-medium text-blue-600",children:t.filter(y=>{const w=new Date(y.created_at),v=new Date;return w.getMonth()===v.getMonth()&&w.getFullYear()===v.getFullYear()}).length})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-gray-600",children:"أعلى تقييم"}),n.jsx("span",{className:"font-medium text-yellow-600",children:"5.0"})]})]})]})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(Lr,{className:"w-6 h-6 text-yellow-500"}),"التقييمات والمراجعات"]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:"relative",children:[n.jsx(ut,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"البحث في التقييمات...",value:d,onChange:y=>u(y.target.value),className:"w-64 pr-12 pl-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent"})]}),n.jsxs("select",{value:f,onChange:y=>h(y.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent",children:[n.jsx("option",{value:"latest",children:"الأحدث"}),n.jsx("option",{value:"oldest",children:"الأقدم"}),n.jsx("option",{value:"highest",children:"الأعلى تقييماً"}),n.jsx("option",{value:"lowest",children:"الأقل تقييماً"})]})]})]}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx(Ko,{className:"w-5 h-5 text-gray-500"}),n.jsx("span",{className:"font-medium text-gray-700",children:"تصفية حسب التقييم:"})]}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsx("button",{onClick:()=>c(null),className:`px-4 py-2 rounded-lg transition-colors ${l===null?"bg-yellow-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"الكل"}),[5,4,3,2,1].map(y=>n.jsxs("button",{onClick:()=>c(y),className:`flex items-center gap-1 px-4 py-2 rounded-lg transition-colors ${l===y?"bg-yellow-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[n.jsx("span",{children:y}),n.jsx(at,{className:"w-4 h-4"})]},y))]})]}),n.jsx("div",{className:"space-y-6",children:m.length>0?m.map(y=>{var w,v,_,b,j,N,k,S,E,P;return n.jsxs(te.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"border border-gray-200 rounded-xl p-6 hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[n.jsx("img",{src:(w=y.student)==null?void 0:w.avatar,alt:(v=y.student)==null?void 0:v.name,className:"w-12 h-12 rounded-full object-cover"}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold text-gray-800",children:(_=y.student)==null?void 0:_.name}),n.jsx("p",{className:"text-sm text-gray-500",children:(b=y.consultation)==null?void 0:b.topic})]}),n.jsxs("div",{className:"flex flex-col items-end",children:[n.jsx("div",{className:"flex items-center gap-1 mb-1",children:[1,2,3,4,5].map(C=>n.jsx(at,{className:`w-4 h-4 ${C<=y.rating?"text-yellow-400 fill-current":"text-gray-300"}`},C))}),n.jsx("span",{className:"text-xs text-gray-500",children:Ze(y.created_at)})]})]}),n.jsx("p",{className:"text-gray-700 leading-relaxed",children:y.feedback}),n.jsxs("div",{className:"flex items-center gap-4 mt-4 text-sm text-gray-500",children:[n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(tt,{className:"w-4 h-4"}),"تاريخ الاستشارة: ",Ze(((j=y.consultation)==null?void 0:j.date)||"")]}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(Lr,{className:"w-4 h-4"}),"نوع الاستشارة: ",((N=y.consultation)==null?void 0:N.type)==="technical"?"تقنية":((k=y.consultation)==null?void 0:k.type)==="academic"?"أكاديمية":((S=y.consultation)==null?void 0:S.type)==="career"?"مهنية":((E=y.consultation)==null?void 0:E.type)==="project"?"مشروع":(P=y.consultation)==null?void 0:P.type]})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t border-gray-200",children:[n.jsxs("button",{className:"flex items-center gap-1 px-3 py-1 text-sm text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:[n.jsx(c6,{className:"w-4 h-4"}),"مفيد"]}),n.jsxs("button",{className:"flex items-center gap-1 px-3 py-1 text-sm text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:[n.jsx(Lr,{className:"w-4 h-4"}),"رد"]})]})]},y.id)}):n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(Lr,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا توجد تقييمات"}),n.jsx("p",{className:"text-gray-600",children:t.length===0?"لم تتلق أي تقييمات بعد":"لم يتم العثور على تقييمات تطابق معايير البحث"}),t.length>0&&n.jsx("button",{onClick:()=>{c(null),u(""),h("latest")},className:"mt-4 px-6 py-2 bg-yellow-500 text-white rounded-xl hover:bg-yellow-600 transition-colors",children:"إعادة تعيين الفلاتر"})]})})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"bg-gradient-to-r from-yellow-50 to-amber-50 rounded-2xl p-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[n.jsx(ar,{className:"w-6 h-6 text-yellow-500"}),"نصائح لتحسين تقييماتك"]}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"الاستماع الجيد"}),n.jsx("p",{className:"text-gray-600 text-sm",children:"استمع جيداً لاحتياجات الطالب وافهم مشكلته قبل تقديم الحلول"})]}),n.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"التواصل الفعال"}),n.jsx("p",{className:"text-gray-600 text-sm",children:"حافظ على تواصل واضح ومباشر، واستخدم لغة مفهومة للطالب"})]}),n.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"المتابعة بعد الاستشارة"}),n.jsx("p",{className:"text-gray-600 text-sm",children:"تواصل مع الطالب بعد الاستشارة للتأكد من استفادته وتقديم دعم إضافي"})]})]})]})]})},sQ=()=>{const{user:e}=vt(),[t,r]=O.useState("overview"),[a,s]=O.useState([]),[i,o]=O.useState([]),[l,c]=O.useState(""),[d,u]=O.useState("all"),[f,h]=O.useState("all"),[m,x]=O.useState(!0),[p,g]=O.useState(null),[y,w]=O.useState(!1),[v,_]=O.useState({total:0,pending:0,approved:0,rejected:0});O.useEffect(()=>{b(),j()},[]);const b=async()=>{try{x(!0),g(null),console.log("Fetching users from Firestore...");const T=De(pe,"users"),M=et(T,Pi("createdAt","desc"),ys(100)),A=await Je(M);console.log(`Found ${A.docs.length} users in Firestore`);const F=A.docs.map(V=>{var L,ee;const B=V.data();return{id:V.id,...B,createdAt:((ee=(L=B.createdAt)==null?void 0:L.toDate)==null?void 0:ee.call(L))||new Date,name:B.name||"مستخدم بدون اسم",email:B.email||"بدون بريد إلكتروني",role:B.role||"student",status:B.status||"active",avatar_url:B.avatar_url||B.avatar}});console.log("Processed user data:",F),o(F);const H=F.filter(V=>(V.role==="school"||V.role==="consultant")&&V.status==="pending");console.log(`Found ${H.length} pending users`),s(H)}catch(T){console.error("Error fetching users:",T),g(T instanceof Error?T.message:"حدث خطأ في تحميل بيانات المستخدمين")}finally{x(!1)}},j=async()=>{try{const T=De(pe,"summer_program_registrations"),M=await Je(T),A=M.size,F=M.docs.filter(B=>B.data().status==="pending").length,H=M.docs.filter(B=>B.data().status==="approved").length,V=M.docs.filter(B=>B.data().status==="rejected").length;_({total:A,pending:F,approved:H,rejected:V})}catch(T){console.error("Error fetching summer program stats:",T)}},N=async T=>{try{w(!0);const M=Ie(pe,"users",T);await Wt(M,{status:"active",approved_at:Ge(),approved_by:e==null?void 0:e.id}),console.log(`User ${T} approved successfully`),await b(),alert("تم تفعيل الحساب بنجاح")}catch(M){console.error("Error approving user:",M),alert("حدث خطأ أثناء تفعيل الحساب")}finally{w(!1)}},k=async T=>{try{w(!0);const M=Ie(pe,"users",T);await Wt(M,{status:"rejected",rejected_at:Ge(),rejected_by:e==null?void 0:e.id}),console.log(`User ${T} rejected successfully`),await b(),alert("تم رفض الحساب بنجاح")}catch(M){console.error("Error rejecting user:",M),alert("حدث خطأ أثناء رفض الحساب")}finally{w(!1)}},S=async T=>{if(confirm("هل أنت متأكد من حذف هذا المستخدم؟ هذا الإجراء لا يمكن التراجع عنه."))try{w(!0);const M=Ie(pe,"users",T);await Va(M),console.log(`User ${T} deleted successfully`),await b(),alert("تم حذف المستخدم بنجاح")}catch(M){console.error("Error deleting user:",M),alert("حدث خطأ أثناء حذف المستخدم")}finally{w(!1)}},E=i.filter(T=>{var H,V;const M=(((H=T.name)==null?void 0:H.toLowerCase())||"").includes(l.toLowerCase())||(((V=T.email)==null?void 0:V.toLowerCase())||"").includes(l.toLowerCase()),A=d==="all"||T.role===d,F=f==="all"||T.status===f;return M&&A&&F}),P=T=>{switch(T){case"student":return"طالب";case"teacher":return"معلم";case"school":return"مدرسة";case"consultant":return"مستشار";case"admin":return"مدير";default:return T}},C=T=>{switch(T){case"active":return{text:"نشط",color:"bg-green-100 text-green-800",icon:ze};case"pending":return{text:"في انتظار التفعيل",color:"bg-yellow-100 text-yellow-800",icon:qs};case"rejected":return{text:"مرفوض",color:"bg-red-100 text-red-800",icon:Mr};case"suspended":return{text:"موقوف",color:"bg-gray-100 text-gray-800",icon:Mr};default:return{text:T,color:"bg-gray-100 text-gray-800",icon:pt}}};return m?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-red-600 to-purple-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(Mh,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"لوحة تحكم المدير"}),n.jsxs("p",{className:"opacity-90",children:["مرحباً ",e==null?void 0:e.name,"، إدارة المنصة والمستخدمين"]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:i.length}),n.jsx("div",{className:"text-sm opacity-80",children:"إجمالي المستخدمين"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:a.length}),n.jsx("div",{className:"text-sm opacity-80",children:"في انتظار التفعيل"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:i.filter(T=>T.role==="school").length}),n.jsx("div",{className:"text-sm opacity-80",children:"مدرسة"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:i.filter(T=>T.role==="consultant").length}),n.jsx("div",{className:"text-sm opacity-80",children:"مستشار"})]})]})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[n.jsx("div",{className:"border-b border-gray-200",children:n.jsxs("nav",{className:"flex overflow-x-auto",children:[n.jsx("button",{onClick:()=>r("overview"),className:`px-4 py-4 font-medium text-sm border-b-2 whitespace-nowrap ${t==="overview"?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Mh,{className:"w-4 h-4"}),"نظرة عامة"]})}),n.jsx("button",{onClick:()=>r("pending-approvals"),className:`px-4 py-4 font-medium text-sm border-b-2 whitespace-nowrap ${t==="pending-approvals"?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(qs,{className:"w-4 h-4"}),"طلبات التفعيل",a.length>0&&n.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:a.length})]})}),n.jsx("button",{onClick:()=>r("users-management"),className:`px-4 py-4 font-medium text-sm border-b-2 whitespace-nowrap ${t==="users-management"?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(lt,{className:"w-4 h-4"}),"إدارة المستخدمين"]})}),n.jsx("button",{onClick:()=>r("schools-management"),className:`px-4 py-4 font-medium text-sm border-b-2 whitespace-nowrap ${t==="schools-management"?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(gn,{className:"w-4 h-4"}),"إدارة المدارس"]})}),n.jsx("button",{onClick:()=>r("content-management"),className:`px-4 py-4 font-medium text-sm border-b-2 whitespace-nowrap ${t==="content-management"?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(br,{className:"w-4 h-4"}),"إدارة المحتوى"]})}),n.jsx("button",{onClick:()=>r("summer-program"),className:`px-4 py-4 font-medium text-sm border-b-2 whitespace-nowrap ${t==="summer-program"?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(tt,{className:"w-4 h-4"}),"البرنامج الصيفي",v.pending>0&&n.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:v.pending})]})}),n.jsx("button",{onClick:()=>r("system-settings"),className:`px-4 py-4 font-medium text-sm border-b-2 whitespace-nowrap ${t==="system-settings"?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(xo,{className:"w-4 h-4"}),"إعدادات النظام"]})})]})}),n.jsxs("div",{className:"p-6",children:[t==="overview"&&n.jsxs("div",{className:"space-y-6",children:[n.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"نظرة عامة على المنصة"}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:n.jsx(lt,{className:"w-5 h-5 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"المستخدمين"}),n.jsx("p",{className:"text-xl font-bold text-gray-800",children:i.length})]})]}),n.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[n.jsxs("span",{children:["نشط: ",i.filter(T=>T.status==="active").length]}),n.jsxs("span",{children:["جديد: +",i.filter(T=>{const M=new Date(T.createdAt),F=Math.abs(new Date().getTime()-M.getTime());return Math.ceil(F/(1e3*60*60*24))<=7}).length," هذا الأسبوع"]})]})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:n.jsx(gn,{className:"w-5 h-5 text-green-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"المدارس"}),n.jsx("p",{className:"text-xl font-bold text-gray-800",children:i.filter(T=>T.role==="school").length})]})]}),n.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[n.jsxs("span",{children:["نشط: ",i.filter(T=>T.role==="school"&&T.status==="active").length]}),n.jsxs("span",{children:["في الانتظار: ",i.filter(T=>T.role==="school"&&T.status==="pending").length]})]})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:n.jsx(Ht,{className:"w-5 h-5 text-purple-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"المستشارين"}),n.jsx("p",{className:"text-xl font-bold text-gray-800",children:i.filter(T=>T.role==="consultant").length})]})]}),n.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[n.jsxs("span",{children:["نشط: ",i.filter(T=>T.role==="consultant"&&T.status==="active").length]}),n.jsxs("span",{children:["في الانتظار: ",i.filter(T=>T.role==="consultant"&&T.status==="pending").length]})]})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("div",{className:"w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center",children:n.jsx(tt,{className:"w-5 h-5 text-yellow-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"البرنامج الصيفي"}),n.jsx("p",{className:"text-xl font-bold text-gray-800",children:v.total})]})]}),n.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[n.jsxs("span",{children:["مقبول: ",v.approved]}),n.jsxs("span",{children:["في الانتظار: ",v.pending]})]})]})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"النشاط الأخير"}),n.jsxs("div",{className:"space-y-4",children:[a.slice(0,5).map(T=>n.jsxs("div",{className:"flex items-start gap-3 p-3 border border-gray-100 rounded-lg hover:bg-gray-50 transition-colors",children:[n.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${T.role==="school"?"bg-green-100":"bg-purple-100"}`,children:T.role==="school"?n.jsx(gn,{className:`w-5 h-5 ${T.role==="school"?"text-green-600":"text-purple-600"}`}):n.jsx(hi,{className:"w-5 h-5 text-purple-600"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:T.name}),n.jsx("p",{className:"text-sm text-gray-500",children:T.email})]}),n.jsx("span",{className:"text-xs text-gray-500",children:Ze(T.createdAt)})]}),n.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[n.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full",children:"في انتظار التفعيل"}),n.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 text-xs rounded-full",children:P(T.role)})]})]}),n.jsxs("div",{className:"flex gap-1",children:[n.jsx("button",{onClick:()=>N(T.id),disabled:y,className:"p-2 bg-green-100 text-green-600 rounded-lg hover:bg-green-200 transition-colors",children:n.jsx(ze,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>k(T.id),disabled:y,className:"p-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition-colors",children:n.jsx(Mr,{className:"w-4 h-4"})})]})]},T.id)),a.length===0&&n.jsx("div",{className:"text-center py-6",children:n.jsx("p",{className:"text-gray-500",children:"لا توجد طلبات تفعيل جديدة"})})]}),a.length>5&&n.jsx("div",{className:"mt-4 text-center",children:n.jsxs("button",{onClick:()=>r("pending-approvals"),className:"text-red-600 hover:text-red-800 font-medium text-sm",children:["عرض كل الطلبات (",a.length,")"]})})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(tt,{className:"w-5 h-5 text-yellow-600"}),'البرنامج الصيفي "صيفي تك"']}),n.jsxs(Ee,{to:"/admin/summer-program-registrations",className:"text-blue-600 hover:text-blue-800 font-medium text-sm flex items-center gap-1",children:["إدارة التسجيلات",n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-arrow-left",children:[n.jsx("path",{d:"m12 19-7-7 7-7"}),n.jsx("path",{d:"M19 12H5"})]})]})]}),n.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-4",children:[n.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3 text-center",children:[n.jsx("div",{className:"text-xl font-bold text-gray-800",children:v.total}),n.jsx("div",{className:"text-xs text-gray-500",children:"إجمالي التسجيلات"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3 text-center",children:[n.jsx("div",{className:"text-xl font-bold text-yellow-600",children:v.pending}),n.jsx("div",{className:"text-xs text-gray-500",children:"قيد المراجعة"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3 text-center",children:[n.jsx("div",{className:"text-xl font-bold text-green-600",children:v.approved}),n.jsx("div",{className:"text-xs text-gray-500",children:"تمت الموافقة"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3 text-center",children:[n.jsx("div",{className:"text-xl font-bold text-red-600",children:v.rejected}),n.jsx("div",{className:"text-xs text-gray-500",children:"مرفوض"})]})]}),v.pending>0?n.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 flex items-start gap-3",children:[n.jsx(qs,{className:"w-5 h-5 text-yellow-600 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsxs("p",{className:"font-medium text-yellow-800",children:["يوجد ",v.pending," طلب تسجيل في انتظار المراجعة"]}),n.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:"يرجى مراجعة طلبات التسجيل في البرنامج الصيفي واتخاذ الإجراء المناسب."}),n.jsxs(Ee,{to:"/admin/summer-program-registrations",className:"mt-2 inline-flex items-center gap-1 text-sm font-medium text-yellow-800 hover:text-yellow-900",children:["عرض الطلبات",n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-arrow-left",children:[n.jsx("path",{d:"m12 19-7-7 7-7"}),n.jsx("path",{d:"M19 12H5"})]})]})]})]}):n.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-start gap-3",children:[n.jsx(ze,{className:"w-5 h-5 text-green-600 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-green-800",children:"لا توجد طلبات تسجيل في انتظار المراجعة"}),n.jsx("p",{className:"text-sm text-green-700 mt-1",children:"جميع طلبات التسجيل في البرنامج الصيفي تمت مراجعتها."})]})]})]}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:n.jsx(ic,{className:"w-6 h-6 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-gray-800",children:"إضافة مستخدم"}),n.jsx("p",{className:"text-sm text-gray-500",children:"إنشاء حساب جديد"})]})]}),n.jsx("button",{className:"w-full px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"إضافة مستخدم"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:n.jsx(Yn,{className:"w-6 h-6 text-green-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-gray-800",children:"التقارير"}),n.jsx("p",{className:"text-sm text-gray-500",children:"إحصائيات وتحليلات"})]})]}),n.jsx(Ee,{to:"/reports",className:"block w-full px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-center",children:"عرض التقارير"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center",children:n.jsx(au,{className:"w-6 h-6 text-purple-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-gray-800",children:"النسخ الاحتياطي"}),n.jsx("p",{className:"text-sm text-gray-500",children:"حماية بيانات المنصة"})]})]}),n.jsx("button",{className:"w-full px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors",children:"إنشاء نسخة احتياطية"})]})]})]}),t==="pending-approvals"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"طلبات التفعيل"}),n.jsx("div",{className:"flex items-center gap-2",children:n.jsxs("select",{value:d,onChange:T=>u(T.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:"جميع الأنواع"}),n.jsx("option",{value:"school",children:"المدارس"}),n.jsx("option",{value:"consultant",children:"المستشارين"})]})})]}),a.length>0?n.jsx("div",{className:"space-y-4",children:a.filter(T=>d==="all"||T.role===d).map(T=>n.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-6 hover:shadow-md transition-all",children:n.jsxs("div",{className:"flex items-start gap-4",children:[n.jsx("img",{src:T.avatar_url||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",alt:T.name,className:"w-16 h-16 rounded-full object-cover"}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:T.name}),n.jsx("p",{className:"text-gray-600",children:T.email})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs font-medium",children:"في انتظار التفعيل"}),n.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-800 rounded-full text-xs font-medium",children:P(T.role)})]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-4",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"تاريخ التسجيل:"}),n.jsx("p",{className:"text-sm font-medium",children:Ze(T.createdAt)})]}),T.phone&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"رقم الهاتف:"}),n.jsx("p",{className:"text-sm font-medium",children:T.phone})]}),T.role==="school"&&n.jsxs(n.Fragment,{children:[T.type&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"نوع المدرسة:"}),n.jsx("p",{className:"text-sm font-medium",children:T.type})]}),T.location&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"الموقع:"}),n.jsx("p",{className:"text-sm font-medium",children:T.location})]})]}),T.role==="consultant"&&n.jsxs(n.Fragment,{children:[T.subject&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"التخصص:"}),n.jsx("p",{className:"text-sm font-medium",children:T.subject})]}),T.experience_years&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"سنوات الخبرة:"}),n.jsxs("p",{className:"text-sm font-medium",children:[T.experience_years," سنوات"]})]})]})]}),T.bio&&n.jsxs("div",{className:"mb-4",children:[n.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"نبذة:"}),n.jsx("p",{className:"text-sm text-gray-700",children:T.bio})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("button",{onClick:()=>N(T.id),disabled:y,className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(ze,{className:"w-4 h-4"}),"تفعيل الحساب"]}),n.jsxs("button",{onClick:()=>k(T.id),disabled:y,className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(Mr,{className:"w-4 h-4"}),"رفض"]}),n.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"عرض التفاصيل"})]})]})]})},T.id))}):n.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-xl",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(qs,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا توجد طلبات تفعيل"}),n.jsx("p",{className:"text-gray-600",children:"جميع طلبات التفعيل تمت معالجتها"})]})]}),t==="users-management"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"إدارة المستخدمين"}),n.jsxs("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2",children:[n.jsx(ic,{className:"w-4 h-4"}),"إضافة مستخدم"]})]}),n.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ut,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"البحث في المستخدمين...",value:l,onChange:T=>c(T.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent"})]}),n.jsxs("select",{value:d,onChange:T=>u(T.target.value),className:"px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:"جميع الأنواع"}),n.jsx("option",{value:"student",children:"طلاب"}),n.jsx("option",{value:"teacher",children:"معلمين"}),n.jsx("option",{value:"school",children:"مدارس"}),n.jsx("option",{value:"consultant",children:"مستشارين"}),n.jsx("option",{value:"admin",children:"مديرين"})]}),n.jsxs("select",{value:f,onChange:T=>h(T.target.value),className:"px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:"جميع الحالات"}),n.jsx("option",{value:"active",children:"نشط"}),n.jsx("option",{value:"pending",children:"في الانتظار"}),n.jsx("option",{value:"rejected",children:"مرفوض"}),n.jsx("option",{value:"suspended",children:"موقوف"})]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المستخدم"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"النوع"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الحالة"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"تاريخ التسجيل"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الإجراءات"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:E.map(T=>{const M=C(T.status);return n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("img",{src:T.avatar_url||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",alt:T.name,className:"w-10 h-10 rounded-full object-cover"}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium text-gray-800",children:T.name}),n.jsx("div",{className:"text-sm text-gray-500",children:T.email})]})]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-800 rounded-full text-xs font-medium",children:P(T.role)})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("span",{className:`px-3 py-1 ${M.color} rounded-full text-xs font-medium flex items-center gap-1 w-fit`,children:[n.jsx(M.icon,{className:"w-3 h-3"}),M.text]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Ze(T.createdAt)}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{className:"p-1 text-blue-600 hover:text-blue-800 transition-colors",children:n.jsx(sr,{className:"w-4 h-4"})}),n.jsx("button",{className:"p-1 text-green-600 hover:text-green-800 transition-colors",children:n.jsx(Oa,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>S(T.id),className:"p-1 text-red-600 hover:text-red-800 transition-colors",children:n.jsx(ir,{className:"w-4 h-4"})})]})})]},T.id)})})]})}),E.length===0&&n.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-xl",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(lt,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا يوجد مستخدمين"}),n.jsx("p",{className:"text-gray-600",children:"لم يتم العثور على مستخدمين يطابقون معايير البحث"})]})]}),t==="summer-program"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(tt,{className:"w-6 h-6 text-yellow-600"}),'إدارة البرنامج الصيفي "صيفي تك"']}),n.jsxs(Ee,{to:"/admin/summer-program-registrations",className:"px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 transition-colors flex items-center gap-2",children:[n.jsx(sr,{className:"w-4 h-4"}),"عرض جميع التسجيلات"]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm",children:n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:n.jsx(lt,{className:"w-5 h-5 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"إجمالي التسجيلات"}),n.jsx("p",{className:"text-xl font-bold text-gray-800",children:v.total})]})]})}),n.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm",children:n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("div",{className:"w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center",children:n.jsx(jt,{className:"w-5 h-5 text-yellow-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"قيد المراجعة"}),n.jsx("p",{className:"text-xl font-bold text-gray-800",children:v.pending})]})]})}),n.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm",children:n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:n.jsx(ze,{className:"w-5 h-5 text-green-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"تمت الموافقة"}),n.jsx("p",{className:"text-xl font-bold text-gray-800",children:v.approved})]})]})}),n.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm",children:n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:n.jsx(Mr,{className:"w-5 h-5 text-red-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"مرفوض"}),n.jsx("p",{className:"text-xl font-bold text-gray-800",children:v.rejected})]})]})})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"معلومات البرنامج الصيفي"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-start gap-3 p-3 bg-blue-50 rounded-lg",children:[n.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:n.jsx(En,{className:"w-5 h-5 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-blue-800",children:'البرنامج الصيفي "صيفي تك"'}),n.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"برنامج تدريبي صيفي للطلاب في مجالات التكنولوجيا والابتكار"}),n.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"الفترة: 15 يونيو - 15 أغسطس 2025"})]})]}),n.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg",children:[n.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:n.jsx(ze,{className:"w-5 h-5 text-green-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-green-800",children:"رابط التسجيل في البرنامج"}),n.jsx("p",{className:"text-sm text-green-700 mt-1",children:"يمكن للطلاب التسجيل في البرنامج من خلال الرابط التالي:"}),n.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[n.jsx("code",{className:"px-3 py-1 bg-green-100 rounded-lg text-green-800 text-sm",children:"/summer-program-enrollment"}),n.jsx("button",{className:"p-1 bg-green-200 text-green-700 rounded-lg hover:bg-green-300 transition-colors",children:n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-copy",children:[n.jsx("rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}),n.jsx("path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"})]})})]})]})]}),n.jsxs("div",{className:"flex items-start gap-3 p-3 bg-purple-50 rounded-lg",children:[n.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:n.jsx(xo,{className:"w-5 h-5 text-purple-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-purple-800",children:"إدارة التسجيلات"}),n.jsx("p",{className:"text-sm text-purple-700 mt-1",children:"يمكنك إدارة جميع طلبات التسجيل في البرنامج الصيفي من خلال لوحة التحكم الخاصة بالبرنامج."}),n.jsxs(Ee,{to:"/admin/summer-program-registrations",className:"mt-2 inline-flex items-center gap-1 px-3 py-1 bg-purple-200 text-purple-800 rounded-lg hover:bg-purple-300 transition-colors text-sm",children:["الانتقال إلى لوحة التحكم",n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-arrow-left",children:[n.jsx("path",{d:"m12 19-7-7 7-7"}),n.jsx("path",{d:"M19 12H5"})]})]})]})]})]})]})]}),t==="schools-management"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"إدارة المدارس"}),n.jsxs("button",{className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors flex items-center gap-2",children:[n.jsx(gn,{className:"w-4 h-4"}),"إضافة مدرسة"]})]}),n.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:n.jsx("p",{className:"text-center text-gray-600",children:"قريباً - سيتم إضافة واجهة إدارة المدارس"})})]}),t==="content-management"&&n.jsxs("div",{className:"space-y-6",children:[n.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"إدارة المحتوى"}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:n.jsx(xa,{className:"w-6 h-6 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-gray-800",children:"أفكار المشاريع"}),n.jsx("p",{className:"text-sm text-gray-500",children:"إدارة مكتبة أفكار المشاريع"})]})]}),n.jsx(Ee,{to:"/admin/manage-project-ideas",className:"block w-full px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-center",children:"إدارة الأفكار"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center",children:n.jsx(wt,{className:"w-6 h-6 text-purple-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-gray-800",children:"المصادر التعليمية"}),n.jsx("p",{className:"text-sm text-gray-500",children:"إدارة المصادر والمواد التعليمية"})]})]}),n.jsx(Ee,{to:"/resources",className:"block w-full px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors text-center",children:"إدارة المصادر"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-emerald-100 rounded-xl flex items-center justify-center",children:n.jsx(jr,{className:"w-6 h-6 text-emerald-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-gray-800",children:"الفيديوهات التعليمية"}),n.jsx("p",{className:"text-sm text-gray-500",children:"إدارة الفيديوهات التعليمية"})]})]}),n.jsx(Ee,{to:"/admin/manage-videos",className:"block w-full px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors text-center",children:"إدارة الفيديوهات"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-pink-100 rounded-xl flex items-center justify-center",children:n.jsx(Br,{className:"w-6 h-6 text-pink-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-gray-800",children:"المتجر"}),n.jsx("p",{className:"text-sm text-gray-500",children:"إدارة منتجات المتجر"})]})]}),n.jsx(Ee,{to:"/store",className:"block w-full px-4 py-2 bg-pink-500 text-white rounded-lg hover:bg-pink-600 transition-colors text-center",children:"إدارة المتجر"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-xl flex items-center justify-center",children:n.jsx(tt,{className:"w-6 h-6 text-yellow-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-gray-800",children:"البرنامج الصيفي"}),n.jsx("p",{className:"text-sm text-gray-500",children:"إدارة تسجيلات البرنامج الصيفي"})]})]}),n.jsx(Ee,{to:"/admin/summer-program-registrations",className:"block w-full px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 transition-colors text-center",children:"إدارة التسجيلات"})]})]})]}),t==="system-settings"&&n.jsxs("div",{className:"space-y-6",children:[n.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"إعدادات النظام"}),n.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:n.jsx("p",{className:"text-center text-gray-600",children:"قريباً - سيتم إضافة واجهة إعدادات النظام"})})]})]})]})]})},iQ=({isOpen:e,onClose:t,onConfirm:r,title:a,isDeleting:s})=>e?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(pt,{className:"w-6 h-6 text-red-600"}),"تأكيد الحذف"]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Pt,{className:"w-5 h-5 text-gray-600"})})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("p",{className:"text-gray-700",children:"هل أنت متأكد من حذف فكرة المشروع التالية؟"}),n.jsxs("p",{className:"font-semibold text-gray-800 mt-2",children:['"',a,'"']}),n.jsx("p",{className:"text-red-600 text-sm mt-4",children:"هذا الإجراء لا يمكن التراجع عنه."})]}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{onClick:r,disabled:s,className:"px-6 py-3 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:s?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الحذف..."]}):n.jsxs(n.Fragment,{children:[n.jsx(ir,{className:"w-5 h-5"}),"تأكيد الحذف"]})})]})]})}):null;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var ff={};ff.version="0.18.5";var XS=1252,oQ=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Yp={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Jp=function(e){oQ.indexOf(e)!=-1&&(XS=Yp[0]=e)};function lQ(){Jp(1252)}var nn=function(e){Jp(e)};function Zp(){nn(1200),lQ()}function sw(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function cQ(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function YS(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Fl=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?cQ(e.slice(2)):t==254&&r==255?YS(e.slice(2)):t==65279?e.slice(1):e},zd=function(t){return String.fromCharCode(t)},iw=function(t){return String.fromCharCode(t)},zc,gs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Vc(e){for(var t="",r=0,a=0,s=0,i=0,o=0,l=0,c=0,d=0;d<e.length;)r=e.charCodeAt(d++),i=r>>2,a=e.charCodeAt(d++),o=(r&3)<<4|a>>4,s=e.charCodeAt(d++),l=(a&15)<<2|s>>6,c=s&63,isNaN(a)?l=c=64:isNaN(s)&&(c=64),t+=gs.charAt(i)+gs.charAt(o)+gs.charAt(l)+gs.charAt(c);return t}function Pa(e){var t="",r=0,a=0,s=0,i=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)i=gs.indexOf(e.charAt(d++)),o=gs.indexOf(e.charAt(d++)),r=i<<2|o>>4,t+=String.fromCharCode(r),l=gs.indexOf(e.charAt(d++)),a=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(a)),c=gs.indexOf(e.charAt(d++)),s=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var rt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),os=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Ns(e){return rt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function ow(e){return rt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var _a=function(t){return rt?os(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function A0(e){if(typeof ArrayBuffer>"u")return _a(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function Is(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function dQ(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Qp(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Qp(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Ar=rt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:os(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function uQ(e){for(var t=[],r=0,a=e.length+250,s=Ns(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++i)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|l>>6&15|(o&3)<<4,s[r++]=128|l&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>a&&(t.push(s.slice(0,r)),r=0,s=Ns(65535),a=65530)}return t.push(s.slice(0,r)),Ar(t)}var ia=/\u0000/g,Il=/[\u0001-\u0006]/g;function uo(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function sn(e,t){var r=""+e;return r.length>=t?r:Jt("0",t-r.length)+r}function eg(e,t){var r=""+e;return r.length>=t?r:Jt(" ",t-r.length)+r}function hf(e,t){var r=""+e;return r.length>=t?r:r+Jt(" ",t-r.length)}function fQ(e,t){var r=""+Math.round(e);return r.length>=t?r:Jt("0",t-r.length)+r}function hQ(e,t){var r=""+e;return r.length>=t?r:Jt("0",t-r.length)+r}var lw=Math.pow(2,32);function qi(e,t){if(e>lw||e<-lw)return fQ(e,t);var r=Math.round(e);return hQ(r,t)}function mf(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var cw=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],vh=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function mQ(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Me={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},dw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},xQ={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function xf(e,t,r){for(var a=e<0?-1:1,s=e*a,i=0,o=1,l=0,c=1,d=0,u=0,f=Math.floor(s);d<t&&(f=Math.floor(s),l=f*o+i,u=f*d+c,!(s-f<5e-8));)s=1/(s-f),i=o,o=l,c=d,d=u;if(u>t&&(d>t?(u=c,l=i):(u=d,l=o)),!r)return[0,a*l,u];var h=Math.floor(a*l/u);return[h,a*l-h*u,u]}function ri(e,t,r){if(e>2958465||e<0)return null;var a=e|0,s=Math.floor(86400*(e-a)),i=0,o=[],l={D:a,T:s,u:86400*(e-a)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(a+=1462),l.u>.9999&&(l.u=0,++s==86400&&(l.T=s=0,++a,++l.D)),a===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(a===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{a>60&&--a;var c=new Date(1900,0,1);c.setDate(c.getDate()+a-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),a<60&&(i=(i+6)%7),r&&(i=wQ(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=s%60,s=Math.floor(s/60),l.M=s%60,s=Math.floor(s/60),l.H=s,l.q=i,l}var JS=new Date(1899,11,31,0,0,0),pQ=JS.getTime(),gQ=new Date(1900,2,1,0,0,0);function ZS(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=gQ&&(r+=24*60*60*1e3),(r-(pQ+(e.getTimezoneOffset()-JS.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function tg(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function vQ(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function yQ(e){var t=e<0?12:11,r=tg(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function bQ(e){var t=tg(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Gc(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=yQ(e):t===10?r=e.toFixed(10).substr(0,12):r=bQ(e),tg(vQ(r.toUpperCase()))}function _i(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Gc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return qa(14,ZS(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function wQ(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function jQ(e,t,r,a){var s="",i=0,o=0,l=r.y,c,d=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,d=2;break;default:c=l%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,d=t.length;break;case 3:return vh[r.m-1][1];case 5:return vh[r.m-1][0];default:return vh[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,d=t.length;break;case 3:return cw[r.q][0];default:return cw[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?sn(r.S,t.length):(a>=2?o=a===3?1e3:100:o=a===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),t==="s"?i===0?"0":""+i/o:(s=sn(i,2+a),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:c=l,d=1;break}var u=d>0?sn(c,d):"";return u}function vs(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var QS=/%/g;function NQ(e,t,r){var a=t.replace(QS,""),s=t.length-a.length;return Kn(e,a,r*Math.pow(10,2*s))+Jt("%",s)}function _Q(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Kn(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function e4(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+e4(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(a+1+(s+i)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,u){return c+d+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var t4=/# (\?+)( ?)\/( ?)(\d+)/;function SQ(e,t,r){var a=parseInt(e[4],10),s=Math.round(t*a),i=Math.floor(s/a),o=s-i*a,l=a;return r+(i===0?"":""+i)+" "+(o===0?Jt(" ",e[1].length+1+e[4].length):eg(o,e[1].length)+e[2]+"/"+e[3]+sn(l,e[4].length))}function kQ(e,t,r){return r+(t===0?"":""+t)+Jt(" ",e[1].length+2+e[4].length)}var r4=/^#*0*\.([0#]+)/,a4=/\).*[0#]/,n4=/\(###\) ###\\?-####/;function ta(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function uw(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function fw(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function EQ(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function AQ(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ma(e,t,r){if(e.charCodeAt(0)===40&&!t.match(a4)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ma("n",a,r):"("+Ma("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return _Q(e,t,r);if(t.indexOf("%")!==-1)return NQ(e,t,r);if(t.indexOf("E")!==-1)return e4(t,r);if(t.charCodeAt(0)===36)return"$"+Ma(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,o,l,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+qi(c,t.length);if(t.match(/^[#?]+$/))return s=qi(r,0),s==="0"&&(s=""),s.length>t.length?s:ta(t.substr(0,t.length-s.length))+s;if(i=t.match(t4))return SQ(i,c,d);if(t.match(/^#+0+$/))return d+qi(c,t.length-t.indexOf("0"));if(i=t.match(r4))return s=uw(r,i[1].length).replace(/^([^\.]+)$/,"$1."+ta(i[1])).replace(/\.$/,"."+ta(i[1])).replace(/\.(\d*)$/,function(x,p){return"."+p+Jt("0",ta(i[1]).length-p.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+uw(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+vs(qi(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ma(e,t,-r):vs(""+(Math.floor(r)+EQ(r,i[1].length)))+"."+sn(fw(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Ma(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=uo(Ma(e,t.replace(/[\\-]/g,""),r)),o=0,uo(uo(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<s.length?s.charAt(o++):x==="0"?"0":""}));if(t.match(n4))return s=Ma(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=xf(c,Math.pow(10,o)-1,!1),s=""+d,u=Kn("n",i[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=hf(l[2],o),u.length<i[4].length&&(u=ta(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=xf(c,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?eg(l[1],o)+i[2]+"/"+i[3]+hf(l[2],o):Jt(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=qi(r,0),t.length<=s.length?s:ta(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=t.indexOf(".")-o,h=t.length-s.length-f;return ta(t.substr(0,f)+s+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=fw(r,i[1].length),r<0?"-"+Ma(e,t,-r):vs(AQ(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?sn(0,3-x.length):"")+x})+"."+sn(o,i[1].length);switch(t){case"###,##0.00":return Ma(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=vs(qi(c,0));return m!=="0"?d+m:"";case"###,###.00":return Ma(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ma(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function TQ(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Kn(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function OQ(e,t,r){var a=t.replace(QS,""),s=t.length-a.length;return Kn(e,a,r*Math.pow(10,2*s))+Jt("%",s)}function s4(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+s4(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(a+1+(s+i)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,u){return c+d+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function mn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(a4)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?mn("n",a,r):"("+mn("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return TQ(e,t,r);if(t.indexOf("%")!==-1)return OQ(e,t,r);if(t.indexOf("E")!==-1)return s4(t,r);if(t.charCodeAt(0)===36)return"$"+mn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,o,l,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+sn(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:ta(t.substr(0,t.length-s.length))+s;if(i=t.match(t4))return kQ(i,c,d);if(t.match(/^#+0+$/))return d+sn(c,t.length-t.indexOf("0"));if(i=t.match(r4))return s=(""+r).replace(/^([^\.]+)$/,"$1."+ta(i[1])).replace(/\.$/,"."+ta(i[1])),s=s.replace(/\.(\d*)$/,function(x,p){return"."+p+Jt("0",ta(i[1]).length-p.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+vs(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+mn(e,t,-r):vs(""+r)+"."+Jt("0",i[1].length);if(i=t.match(/^#,#*,#0/))return mn(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=uo(mn(e,t.replace(/[\\-]/g,""),r)),o=0,uo(uo(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<s.length?s.charAt(o++):x==="0"?"0":""}));if(t.match(n4))return s=mn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=xf(c,Math.pow(10,o)-1,!1),s=""+d,u=Kn("n",i[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=hf(l[2],o),u.length<i[4].length&&(u=ta(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=xf(c,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?eg(l[1],o)+i[2]+"/"+i[3]+hf(l[2],o):Jt(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:ta(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=t.indexOf(".")-o,h=t.length-s.length-f;return ta(t.substr(0,f)+s+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+mn(e,t,-r):vs(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?sn(0,3-x.length):"")+x})+"."+sn(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=vs(""+c);return m!=="0"?d+m:"";default:if(t.match(/\.[0#?]*$/))return mn(e,t.slice(0,t.lastIndexOf(".")),r)+ta(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Kn(e,t,r){return(r|0)===r?mn(e,t,r):Ma(e,t,r)}function PQ(e){for(var t=[],r=!1,a=0,s=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(s,a-s),s=a+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var i4=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ol(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":mf(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(i4))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function CQ(e,t,r,a){for(var s=[],i="",o=0,l="",c="t",d,u,f,h="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!mf(e,o))throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(f=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(f);s[s.length]={t:"t",v:i},++o;break;case"\\":var m=e.charAt(++o),x=m==="("||m===")"?m:"t";s[s.length]={t:x,v:m},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(d==null&&(d=ri(t,r,e.charAt(o+1)==="2"),d==null))return"";s[s.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=ri(t,r),d==null))return"";for(i=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)i+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=h),s[s.length]={t:l,v:i},c=l;break;case"A":case"a":case"上":var p={t:l,v:l};if(d==null&&(d=ri(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(p.v=d.H>=12?"P":"A"),p.t="T",h="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(p.v=d.H>=12?"PM":"AM"),p.t="T",o+=5,h="h"):e.substr(o,5).toUpperCase()==="上午/下午"?(d!=null&&(p.v=d.H>=12?"下午":"上午"),p.t="T",o+=5,h="h"):(p.t="t",++o),d==null&&p.t==="T")return"";s[s.length]=p,c=l;break;case"[":for(i=l;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(i4)){if(d==null&&(d=ri(t,r),d==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",ol(e)||(s[s.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=l;++o<e.length&&(l=e.charAt(o))==="0";)i+=l;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)i+=l;s[s.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++o)===l;)i+=l;s[s.length]={t:l,v:i},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:a===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:l,v:l},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"t",v:l},++o;break}var g=0,y=0,w;for(o=s.length-1,c="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=h,c="h",g<1&&(g=1);break;case"s":(w=s[o].v.match(/\.0+$/))&&(y=Math.max(y,w[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=s[o].t;break;case"m":c==="s"&&(s[o].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&s[o].v.match(/[Hh]/)&&(g=1),g<2&&s[o].v.match(/[Mm]/)&&(g=2),g<3&&s[o].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var v="",_;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=jQ(s[o].t.charCodeAt(0),s[o].v,d,y),s[o].t="t";break;case"n":case"?":for(_=o+1;s[_]!=null&&((l=s[_].t)==="?"||l==="D"||(l===" "||l==="t")&&s[_+1]!=null&&(s[_+1].t==="?"||s[_+1].t==="t"&&s[_+1].v==="/")||s[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(s[_].v==="/"||s[_].v===" "&&s[_+1]!=null&&s[_+1].t=="?"));)s[o].v+=s[_].v,s[_]={v:"",t:";"},++_;v+=s[o].v,o=_-1;break;case"G":s[o].t="t",s[o].v=_i(t,r);break}var b="",j,N;if(v.length>0){v.charCodeAt(0)==40?(j=t<0&&v.charCodeAt(0)===45?-t:t,N=Kn("n",v,j)):(j=t<0&&a>1?-t:t,N=Kn("n",v,j),j<0&&s[0]&&s[0].t=="t"&&(N=N.substr(1),s[0].v="-"+s[0].v)),_=N.length-1;var k=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){k=o;break}var S=s.length;if(k===s.length&&N.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(_>=s[o].v.length-1?(_-=s[o].v.length,s[o].v=N.substr(_+1,s[o].v.length)):_<0?s[o].v="":(s[o].v=N.substr(0,_+1),_=-1),s[o].t="t",S=o);_>=0&&S<s.length&&(s[S].v=N.substr(0,_+1)+s[S].v)}else if(k!==s.length&&N.indexOf("E")===-1){for(_=N.indexOf(".")-1,o=k;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(u=s[o].v.indexOf(".")>-1&&o===k?s[o].v.indexOf(".")-1:s[o].v.length-1,b=s[o].v.substr(u+1);u>=0;--u)_>=0&&(s[o].v.charAt(u)==="0"||s[o].v.charAt(u)==="#")&&(b=N.charAt(_--)+b);s[o].v=b,s[o].t="t",S=o}for(_>=0&&S<s.length&&(s[S].v=N.substr(0,_+1)+s[S].v),_=N.indexOf(".")+1,o=k;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==k)){for(u=s[o].v.indexOf(".")>-1&&o===k?s[o].v.indexOf(".")+1:0,b=s[o].v.substr(0,u);u<s[o].v.length;++u)_<N.length&&(b+=N.charAt(_++));s[o].v=b,s[o].t="t",S=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(j=a>1&&t<0&&o>0&&s[o-1].v==="-"?-t:t,s[o].v=Kn(s[o].t,s[o].v,j),s[o].t="t");var E="";for(o=0;o!==s.length;++o)s[o]!=null&&(E+=s[o].v);return E}var hw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function mw(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function FQ(e,t){var r=PQ(e),a=r.length,s=r[a-1].indexOf("@");if(a<4&&s>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(hw),l=r[1].match(hw);return mw(t,o)?[a,r[0]]:mw(t,l)?[a,r[1]]:[a,r[o!=null&&l!=null?2:1]]}return[a,i]}function qa(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:Me)[e],a==null&&(a=r.table&&r.table[dw[e]]||Me[dw[e]]),a==null&&(a=xQ[e]||"General");break}if(mf(a,0))return _i(t,r);t instanceof Date&&(t=ZS(t,r.date1904));var s=FQ(a,t);if(mf(s[1]))return _i(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return CQ(s[1],t,r,s[0])}function qn(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Me[r]==null){t<0&&(t=r);continue}if(Me[r]==e){t=r;break}}t<0&&(t=391)}return Me[t]=e,t}function T0(e){for(var t=0;t!=392;++t)e[t]!==void 0&&qn(e[t],t)}function ll(){Me=mQ()}var IQ={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},o4=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function DQ(e){var t=typeof e=="number"?Me[e]:e;return t=t.replace(o4,"(\\d+)"),new RegExp("^"+t+"$")}function RQ(e,t,r){var a=-1,s=-1,i=-1,o=-1,l=-1,c=-1;(t.match(o4)||[]).forEach(function(f,h){var m=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":a=m;break;case"d":i=m;break;case"h":o=m;break;case"s":c=m;break;case"m":o>=0?l=m:s=m;break}}),c>=0&&l==-1&&s>=0&&(l=s,s=-1);var d=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?d:a==-1&&s==-1&&i==-1?u:d+"T"+u}var MQ=function(){var e={};e.version="1.2.0";function t(){for(var N=0,k=new Array(256),S=0;S!=256;++S)N=S,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,k[S]=N;return typeof Int32Array<"u"?new Int32Array(k):k}var r=t();function a(N){var k=0,S=0,E=0,P=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(E=0;E!=256;++E)P[E]=N[E];for(E=0;E!=256;++E)for(S=N[E],k=256+E;k<4096;k+=256)S=P[k]=S>>>8^N[S&255];var C=[];for(E=1;E!=16;++E)C[E-1]=typeof Int32Array<"u"?P.subarray(E*256,E*256+256):P.slice(E*256,E*256+256);return C}var s=a(r),i=s[0],o=s[1],l=s[2],c=s[3],d=s[4],u=s[5],f=s[6],h=s[7],m=s[8],x=s[9],p=s[10],g=s[11],y=s[12],w=s[13],v=s[14];function _(N,k){for(var S=k^-1,E=0,P=N.length;E<P;)S=S>>>8^r[(S^N.charCodeAt(E++))&255];return~S}function b(N,k){for(var S=k^-1,E=N.length-15,P=0;P<E;)S=v[N[P++]^S&255]^w[N[P++]^S>>8&255]^y[N[P++]^S>>16&255]^g[N[P++]^S>>>24]^p[N[P++]]^x[N[P++]]^m[N[P++]]^h[N[P++]]^f[N[P++]]^u[N[P++]]^d[N[P++]]^c[N[P++]]^l[N[P++]]^o[N[P++]]^i[N[P++]]^r[N[P++]];for(E+=15;P<E;)S=S>>>8^r[(S^N[P++])&255];return~S}function j(N,k){for(var S=k^-1,E=0,P=N.length,C=0,T=0;E<P;)C=N.charCodeAt(E++),C<128?S=S>>>8^r[(S^C)&255]:C<2048?(S=S>>>8^r[(S^(192|C>>6&31))&255],S=S>>>8^r[(S^(128|C&63))&255]):C>=55296&&C<57344?(C=(C&1023)+64,T=N.charCodeAt(E++)&1023,S=S>>>8^r[(S^(240|C>>8&7))&255],S=S>>>8^r[(S^(128|C>>2&63))&255],S=S>>>8^r[(S^(128|T>>6&15|(C&3)<<4))&255],S=S>>>8^r[(S^(128|T&63))&255]):(S=S>>>8^r[(S^(224|C>>12&15))&255],S=S>>>8^r[(S^(128|C>>6&63))&255],S=S>>>8^r[(S^(128|C&63))&255]);return~S}return e.table=r,e.bstr=_,e.buf=b,e.str=j,e}(),Fe=function(){var t={};t.version="1.2.1";function r(R,X){for(var U=R.split("/"),G=X.split("/"),Y=0,J=0,ne=Math.min(U.length,G.length);Y<ne;++Y){if(J=U[Y].length-G[Y].length)return J;if(U[Y]!=G[Y])return U[Y]<G[Y]?-1:1}return U.length-G.length}function a(R){if(R.charAt(R.length-1)=="/")return R.slice(0,-1).indexOf("/")===-1?R:a(R.slice(0,-1));var X=R.lastIndexOf("/");return X===-1?R:R.slice(0,X+1)}function s(R){if(R.charAt(R.length-1)=="/")return s(R.slice(0,-1));var X=R.lastIndexOf("/");return X===-1?R:R.slice(X+1)}function i(R,X){typeof X=="string"&&(X=new Date(X));var U=X.getHours();U=U<<6|X.getMinutes(),U=U<<5|X.getSeconds()>>>1,R.write_shift(2,U);var G=X.getFullYear()-1980;G=G<<4|X.getMonth()+1,G=G<<5|X.getDate(),R.write_shift(2,G)}function o(R){var X=R.read_shift(2)&65535,U=R.read_shift(2)&65535,G=new Date,Y=U&31;U>>>=5;var J=U&15;U>>>=4,G.setMilliseconds(0),G.setFullYear(U+1980),G.setMonth(J-1),G.setDate(Y);var ne=X&31;X>>>=5;var fe=X&63;return X>>>=6,G.setHours(X),G.setMinutes(fe),G.setSeconds(ne<<1),G}function l(R){Rr(R,0);for(var X={},U=0;R.l<=R.length-4;){var G=R.read_shift(2),Y=R.read_shift(2),J=R.l+Y,ne={};switch(G){case 21589:U=R.read_shift(1),U&1&&(ne.mtime=R.read_shift(4)),Y>5&&(U&2&&(ne.atime=R.read_shift(4)),U&4&&(ne.ctime=R.read_shift(4))),ne.mtime&&(ne.mt=new Date(ne.mtime*1e3));break}R.l=J,X[G]=ne}return X}var c;function d(){return c||(c={})}function u(R,X){if(R[0]==80&&R[1]==75)return Ad(R,X);if((R[0]|32)==109&&(R[1]|32)==105)return _3(R,X);if(R.length<512)throw new Error("CFB file size "+R.length+" < 512");var U=3,G=512,Y=0,J=0,ne=0,fe=0,ae=0,ie=[],le=R.slice(0,512);Rr(le,0);var ye=f(le);switch(U=ye[0],U){case 3:G=512;break;case 4:G=4096;break;case 0:if(ye[1]==0)return Ad(R,X);default:throw new Error("Major Version: Expected 3 or 4 saw "+U)}G!==512&&(le=R.slice(0,G),Rr(le,28));var ke=R.slice(0,G);h(le,U);var Oe=le.read_shift(4,"i");if(U===3&&Oe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Oe);le.l+=4,ne=le.read_shift(4,"i"),le.l+=4,le.chk("00100000","Mini Stream Cutoff Size: "),fe=le.read_shift(4,"i"),Y=le.read_shift(4,"i"),ae=le.read_shift(4,"i"),J=le.read_shift(4,"i");for(var Ne=-1,Te=0;Te<109&&(Ne=le.read_shift(4,"i"),!(Ne<0));++Te)ie[Te]=Ne;var Ke=m(R,G);g(ae,J,Ke,G,ie);var Vt=w(Ke,ne,ie,G);Vt[ne].name="!Directory",Y>0&&fe!==T&&(Vt[fe].name="!MiniFAT"),Vt[ie[0]].name="!FAT",Vt.fat_addrs=ie,Vt.ssz=G;var Gt={},Ur=[],ul=[],fl=[];v(ne,Vt,Ke,Ur,Y,Gt,ul,fe),x(ul,fl,Ur),Ur.shift();var hl={FileIndex:ul,FullPaths:fl};return X&&X.raw&&(hl.raw={header:ke,sectors:Ke}),hl}function f(R){if(R[R.l]==80&&R[R.l+1]==75)return[0,0];R.chk(M,"Header Signature: "),R.l+=16;var X=R.read_shift(2,"u");return[R.read_shift(2,"u"),X]}function h(R,X){var U=9;switch(R.l+=2,U=R.read_shift(2)){case 9:if(X!=3)throw new Error("Sector Shift: Expected 9 saw "+U);break;case 12:if(X!=4)throw new Error("Sector Shift: Expected 12 saw "+U);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+U)}R.chk("0600","Mini Sector Shift: "),R.chk("000000000000","Reserved: ")}function m(R,X){for(var U=Math.ceil(R.length/X)-1,G=[],Y=1;Y<U;++Y)G[Y-1]=R.slice(Y*X,(Y+1)*X);return G[U-1]=R.slice(U*X),G}function x(R,X,U){for(var G=0,Y=0,J=0,ne=0,fe=0,ae=U.length,ie=[],le=[];G<ae;++G)ie[G]=le[G]=G,X[G]=U[G];for(;fe<le.length;++fe)G=le[fe],Y=R[G].L,J=R[G].R,ne=R[G].C,ie[G]===G&&(Y!==-1&&ie[Y]!==Y&&(ie[G]=ie[Y]),J!==-1&&ie[J]!==J&&(ie[G]=ie[J])),ne!==-1&&(ie[ne]=G),Y!==-1&&G!=ie[G]&&(ie[Y]=ie[G],le.lastIndexOf(Y)<fe&&le.push(Y)),J!==-1&&G!=ie[G]&&(ie[J]=ie[G],le.lastIndexOf(J)<fe&&le.push(J));for(G=1;G<ae;++G)ie[G]===G&&(J!==-1&&ie[J]!==J?ie[G]=ie[J]:Y!==-1&&ie[Y]!==Y&&(ie[G]=ie[Y]));for(G=1;G<ae;++G)if(R[G].type!==0){if(fe=G,fe!=ie[fe])do fe=ie[fe],X[G]=X[fe]+"/"+X[G];while(fe!==0&&ie[fe]!==-1&&fe!=ie[fe]);ie[G]=-1}for(X[0]+="/",G=1;G<ae;++G)R[G].type!==2&&(X[G]+="/")}function p(R,X,U){for(var G=R.start,Y=R.size,J=[],ne=G;U&&Y>0&&ne>=0;)J.push(X.slice(ne*C,ne*C+C)),Y-=C,ne=Gs(U,ne*4);return J.length===0?de(0):Ar(J).slice(0,R.size)}function g(R,X,U,G,Y){var J=T;if(R===T){if(X!==0)throw new Error("DIFAT chain shorter than expected")}else if(R!==-1){var ne=U[R],fe=(G>>>2)-1;if(!ne)return;for(var ae=0;ae<fe&&(J=Gs(ne,ae*4))!==T;++ae)Y.push(J);g(Gs(ne,G-4),X-1,U,G,Y)}}function y(R,X,U,G,Y){var J=[],ne=[];Y||(Y=[]);var fe=G-1,ae=0,ie=0;for(ae=X;ae>=0;){Y[ae]=!0,J[J.length]=ae,ne.push(R[ae]);var le=U[Math.floor(ae*4/G)];if(ie=ae*4&fe,G<4+ie)throw new Error("FAT boundary crossed: "+ae+" 4 "+G);if(!R[le])break;ae=Gs(R[le],ie)}return{nodes:J,data:kw([ne])}}function w(R,X,U,G){var Y=R.length,J=[],ne=[],fe=[],ae=[],ie=G-1,le=0,ye=0,ke=0,Oe=0;for(le=0;le<Y;++le)if(fe=[],ke=le+X,ke>=Y&&(ke-=Y),!ne[ke]){ae=[];var Ne=[];for(ye=ke;ye>=0;){Ne[ye]=!0,ne[ye]=!0,fe[fe.length]=ye,ae.push(R[ye]);var Te=U[Math.floor(ye*4/G)];if(Oe=ye*4&ie,G<4+Oe)throw new Error("FAT boundary crossed: "+ye+" 4 "+G);if(!R[Te]||(ye=Gs(R[Te],Oe),Ne[ye]))break}J[ke]={nodes:fe,data:kw([ae])}}return J}function v(R,X,U,G,Y,J,ne,fe){for(var ae=0,ie=G.length?2:0,le=X[R].data,ye=0,ke=0,Oe;ye<le.length;ye+=128){var Ne=le.slice(ye,ye+128);Rr(Ne,64),ke=Ne.read_shift(2),Oe=lg(Ne,0,ke-ie),G.push(Oe);var Te={name:Oe,type:Ne.read_shift(1),color:Ne.read_shift(1),L:Ne.read_shift(4,"i"),R:Ne.read_shift(4,"i"),C:Ne.read_shift(4,"i"),clsid:Ne.read_shift(16),state:Ne.read_shift(4,"i"),start:0,size:0},Ke=Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2);Ke!==0&&(Te.ct=_(Ne,Ne.l-8));var Vt=Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2);Vt!==0&&(Te.mt=_(Ne,Ne.l-8)),Te.start=Ne.read_shift(4,"i"),Te.size=Ne.read_shift(4,"i"),Te.size<0&&Te.start<0&&(Te.size=Te.type=0,Te.start=T,Te.name=""),Te.type===5?(ae=Te.start,Y>0&&ae!==T&&(X[ae].name="!StreamData")):Te.size>=4096?(Te.storage="fat",X[Te.start]===void 0&&(X[Te.start]=y(U,Te.start,X.fat_addrs,X.ssz)),X[Te.start].name=Te.name,Te.content=X[Te.start].data.slice(0,Te.size)):(Te.storage="minifat",Te.size<0?Te.size=0:ae!==T&&Te.start!==T&&X[ae]&&(Te.content=p(Te,X[ae].data,(X[fe]||{}).data))),Te.content&&Rr(Te.content,0),J[Oe]=Te,ne.push(Te)}}function _(R,X){return new Date((ja(R,X+4)/1e7*Math.pow(2,32)+ja(R,X)/1e7-11644473600)*1e3)}function b(R,X){return d(),u(c.readFileSync(R),X)}function j(R,X){var U=X&&X.type;switch(U||rt&&Buffer.isBuffer(R)&&(U="buffer"),U||"base64"){case"file":return b(R,X);case"base64":return u(_a(Pa(R)),X);case"binary":return u(_a(R),X)}return u(R,X)}function N(R,X){var U=X||{},G=U.root||"Root Entry";if(R.FullPaths||(R.FullPaths=[]),R.FileIndex||(R.FileIndex=[]),R.FullPaths.length!==R.FileIndex.length)throw new Error("inconsistent CFB structure");R.FullPaths.length===0&&(R.FullPaths[0]=G+"/",R.FileIndex[0]={name:G,type:5}),U.CLSID&&(R.FileIndex[0].clsid=U.CLSID),k(R)}function k(R){var X="Sh33tJ5";if(!Fe.find(R,"/"+X)){var U=de(4);U[0]=55,U[1]=U[3]=50,U[2]=54,R.FileIndex.push({name:X,type:2,content:U,size:4,L:69,R:69,C:69}),R.FullPaths.push(R.FullPaths[0]+X),S(R)}}function S(R,X){N(R);for(var U=!1,G=!1,Y=R.FullPaths.length-1;Y>=0;--Y){var J=R.FileIndex[Y];switch(J.type){case 0:G?U=!0:(R.FileIndex.pop(),R.FullPaths.pop());break;case 1:case 2:case 5:G=!0,isNaN(J.R*J.L*J.C)&&(U=!0),J.R>-1&&J.L>-1&&J.R==J.L&&(U=!0);break;default:U=!0;break}}if(!(!U&&!X)){var ne=new Date(1987,1,19),fe=0,ae=Object.create?Object.create(null):{},ie=[];for(Y=0;Y<R.FullPaths.length;++Y)ae[R.FullPaths[Y]]=!0,R.FileIndex[Y].type!==0&&ie.push([R.FullPaths[Y],R.FileIndex[Y]]);for(Y=0;Y<ie.length;++Y){var le=a(ie[Y][0]);G=ae[le],G||(ie.push([le,{name:s(le).replace("/",""),type:1,clsid:F,ct:ne,mt:ne,content:null}]),ae[le]=!0)}for(ie.sort(function(Oe,Ne){return r(Oe[0],Ne[0])}),R.FullPaths=[],R.FileIndex=[],Y=0;Y<ie.length;++Y)R.FullPaths[Y]=ie[Y][0],R.FileIndex[Y]=ie[Y][1];for(Y=0;Y<ie.length;++Y){var ye=R.FileIndex[Y],ke=R.FullPaths[Y];if(ye.name=s(ke).replace("/",""),ye.L=ye.R=ye.C=-(ye.color=1),ye.size=ye.content?ye.content.length:0,ye.start=0,ye.clsid=ye.clsid||F,Y===0)ye.C=ie.length>1?1:-1,ye.size=0,ye.type=5;else if(ke.slice(-1)=="/"){for(fe=Y+1;fe<ie.length&&a(R.FullPaths[fe])!=ke;++fe);for(ye.C=fe>=ie.length?-1:fe,fe=Y+1;fe<ie.length&&a(R.FullPaths[fe])!=a(ke);++fe);ye.R=fe>=ie.length?-1:fe,ye.type=1}else a(R.FullPaths[Y+1]||"")==a(ke)&&(ye.R=Y+1),ye.type=2}}}function E(R,X){var U=X||{};if(U.fileType=="mad")return S3(R,U);switch(S(R),U.fileType){case"zip":return v3(R,U)}var G=function(Oe){for(var Ne=0,Te=0,Ke=0;Ke<Oe.FileIndex.length;++Ke){var Vt=Oe.FileIndex[Ke];if(Vt.content){var Gt=Vt.content.length;Gt>0&&(Gt<4096?Ne+=Gt+63>>6:Te+=Gt+511>>9)}}for(var Ur=Oe.FullPaths.length+3>>2,ul=Ne+7>>3,fl=Ne+127>>7,hl=ul+Te+Ur+fl,$s=hl+127>>7,L0=$s<=109?0:Math.ceil(($s-109)/127);hl+$s+L0+127>>7>$s;)L0=++$s<=109?0:Math.ceil(($s-109)/127);var In=[1,L0,$s,fl,Ur,Te,Ne,0];return Oe.FileIndex[0].size=Ne<<6,In[7]=(Oe.FileIndex[0].start=In[0]+In[1]+In[2]+In[3]+In[4]+In[5])+(In[6]+7>>3),In}(R),Y=de(G[7]<<9),J=0,ne=0;{for(J=0;J<8;++J)Y.write_shift(1,A[J]);for(J=0;J<8;++J)Y.write_shift(2,0);for(Y.write_shift(2,62),Y.write_shift(2,3),Y.write_shift(2,65534),Y.write_shift(2,9),Y.write_shift(2,6),J=0;J<3;++J)Y.write_shift(2,0);for(Y.write_shift(4,0),Y.write_shift(4,G[2]),Y.write_shift(4,G[0]+G[1]+G[2]+G[3]-1),Y.write_shift(4,0),Y.write_shift(4,4096),Y.write_shift(4,G[3]?G[0]+G[1]+G[2]-1:T),Y.write_shift(4,G[3]),Y.write_shift(-4,G[1]?G[0]-1:T),Y.write_shift(4,G[1]),J=0;J<109;++J)Y.write_shift(-4,J<G[2]?G[1]+J:-1)}if(G[1])for(ne=0;ne<G[1];++ne){for(;J<236+ne*127;++J)Y.write_shift(-4,J<G[2]?G[1]+J:-1);Y.write_shift(-4,ne===G[1]-1?T:ne+1)}var fe=function(Oe){for(ne+=Oe;J<ne-1;++J)Y.write_shift(-4,J+1);Oe&&(++J,Y.write_shift(-4,T))};for(ne=J=0,ne+=G[1];J<ne;++J)Y.write_shift(-4,H.DIFSECT);for(ne+=G[2];J<ne;++J)Y.write_shift(-4,H.FATSECT);fe(G[3]),fe(G[4]);for(var ae=0,ie=0,le=R.FileIndex[0];ae<R.FileIndex.length;++ae)le=R.FileIndex[ae],le.content&&(ie=le.content.length,!(ie<4096)&&(le.start=ne,fe(ie+511>>9)));for(fe(G[6]+7>>3);Y.l&511;)Y.write_shift(-4,H.ENDOFCHAIN);for(ne=J=0,ae=0;ae<R.FileIndex.length;++ae)le=R.FileIndex[ae],le.content&&(ie=le.content.length,!(!ie||ie>=4096)&&(le.start=ne,fe(ie+63>>6)));for(;Y.l&511;)Y.write_shift(-4,H.ENDOFCHAIN);for(J=0;J<G[4]<<2;++J){var ye=R.FullPaths[J];if(!ye||ye.length===0){for(ae=0;ae<17;++ae)Y.write_shift(4,0);for(ae=0;ae<3;++ae)Y.write_shift(4,-1);for(ae=0;ae<12;++ae)Y.write_shift(4,0);continue}le=R.FileIndex[J],J===0&&(le.start=le.size?le.start-1:T);var ke=J===0&&U.root||le.name;if(ie=2*(ke.length+1),Y.write_shift(64,ke,"utf16le"),Y.write_shift(2,ie),Y.write_shift(1,le.type),Y.write_shift(1,le.color),Y.write_shift(-4,le.L),Y.write_shift(-4,le.R),Y.write_shift(-4,le.C),le.clsid)Y.write_shift(16,le.clsid,"hex");else for(ae=0;ae<4;++ae)Y.write_shift(4,0);Y.write_shift(4,le.state||0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,le.start),Y.write_shift(4,le.size),Y.write_shift(4,0)}for(J=1;J<R.FileIndex.length;++J)if(le=R.FileIndex[J],le.size>=4096)if(Y.l=le.start+1<<9,rt&&Buffer.isBuffer(le.content))le.content.copy(Y,Y.l,0,le.size),Y.l+=le.size+511&-512;else{for(ae=0;ae<le.size;++ae)Y.write_shift(1,le.content[ae]);for(;ae&511;++ae)Y.write_shift(1,0)}for(J=1;J<R.FileIndex.length;++J)if(le=R.FileIndex[J],le.size>0&&le.size<4096)if(rt&&Buffer.isBuffer(le.content))le.content.copy(Y,Y.l,0,le.size),Y.l+=le.size+63&-64;else{for(ae=0;ae<le.size;++ae)Y.write_shift(1,le.content[ae]);for(;ae&63;++ae)Y.write_shift(1,0)}if(rt)Y.l=Y.length;else for(;Y.l<Y.length;)Y.write_shift(1,0);return Y}function P(R,X){var U=R.FullPaths.map(function(ae){return ae.toUpperCase()}),G=U.map(function(ae){var ie=ae.split("/");return ie[ie.length-(ae.slice(-1)=="/"?2:1)]}),Y=!1;X.charCodeAt(0)===47?(Y=!0,X=U[0].slice(0,-1)+X):Y=X.indexOf("/")!==-1;var J=X.toUpperCase(),ne=Y===!0?U.indexOf(J):G.indexOf(J);if(ne!==-1)return R.FileIndex[ne];var fe=!J.match(Il);for(J=J.replace(ia,""),fe&&(J=J.replace(Il,"!")),ne=0;ne<U.length;++ne)if((fe?U[ne].replace(Il,"!"):U[ne]).replace(ia,"")==J||(fe?G[ne].replace(Il,"!"):G[ne]).replace(ia,"")==J)return R.FileIndex[ne];return null}var C=64,T=-2,M="d0cf11e0a1b11ae1",A=[208,207,17,224,161,177,26,225],F="00000000000000000000000000000000",H={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:T,FREESECT:-1,HEADER_SIGNATURE:M,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:F,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function V(R,X,U){d();var G=E(R,U);c.writeFileSync(X,G)}function B(R){for(var X=new Array(R.length),U=0;U<R.length;++U)X[U]=String.fromCharCode(R[U]);return X.join("")}function L(R,X){var U=E(R,X);switch(X&&X.type||"buffer"){case"file":return d(),c.writeFileSync(X.filename,U),U;case"binary":return typeof U=="string"?U:B(U);case"base64":return Vc(typeof U=="string"?U:B(U));case"buffer":if(rt)return Buffer.isBuffer(U)?U:os(U);case"array":return typeof U=="string"?_a(U):U}return U}var ee;function I(R){try{var X=R.InflateRaw,U=new X;if(U._processChunk(new Uint8Array([3,0]),U._finishFlushFlag),U.bytesRead)ee=R;else throw new Error("zlib does not expose bytesRead")}catch(G){console.error("cannot use native zlib: "+(G.message||G))}}function K(R,X){if(!ee)return ds(R,X);var U=ee.InflateRaw,G=new U,Y=G._processChunk(R.slice(R.l),G._finishFlushFlag);return R.l+=G.bytesRead,Y}function z(R){return ee?ee.deflateRawSync(R):Qe(R)}var W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],re=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],xe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function me(R){var X=(R<<1|R<<11)&139536|(R<<5|R<<15)&558144;return(X>>16|X>>8|X)&255}for(var Q=typeof Uint8Array<"u",q=Q?new Uint8Array(256):[],se=0;se<256;++se)q[se]=me(se);function D(R,X){var U=q[R&255];return X<=8?U>>>8-X:(U=U<<8|q[R>>8&255],X<=16?U>>>16-X:(U=U<<8|q[R>>16&255],U>>>24-X))}function ve(R,X){var U=X&7,G=X>>>3;return(R[G]|(U<=6?0:R[G+1]<<8))>>>U&3}function we(R,X){var U=X&7,G=X>>>3;return(R[G]|(U<=5?0:R[G+1]<<8))>>>U&7}function Ae(R,X){var U=X&7,G=X>>>3;return(R[G]|(U<=4?0:R[G+1]<<8))>>>U&15}function ce(R,X){var U=X&7,G=X>>>3;return(R[G]|(U<=3?0:R[G+1]<<8))>>>U&31}function he(R,X){var U=X&7,G=X>>>3;return(R[G]|(U<=1?0:R[G+1]<<8))>>>U&127}function oe(R,X,U){var G=X&7,Y=X>>>3,J=(1<<U)-1,ne=R[Y]>>>G;return U<8-G||(ne|=R[Y+1]<<8-G,U<16-G)||(ne|=R[Y+2]<<16-G,U<24-G)||(ne|=R[Y+3]<<24-G),ne&J}function Ve(R,X,U){var G=X&7,Y=X>>>3;return G<=5?R[Y]|=(U&7)<<G:(R[Y]|=U<<G&255,R[Y+1]=(U&7)>>8-G),X+3}function ct(R,X,U){var G=X&7,Y=X>>>3;return U=(U&1)<<G,R[Y]|=U,X+1}function nt(R,X,U){var G=X&7,Y=X>>>3;return U<<=G,R[Y]|=U&255,U>>>=8,R[Y+1]=U,X+8}function At(R,X,U){var G=X&7,Y=X>>>3;return U<<=G,R[Y]|=U&255,U>>>=8,R[Y+1]=U&255,R[Y+2]=U>>>8,X+16}function Xt(R,X){var U=R.length,G=2*U>X?2*U:X+5,Y=0;if(U>=X)return R;if(rt){var J=ow(G);if(R.copy)R.copy(J);else for(;Y<R.length;++Y)J[Y]=R[Y];return J}else if(Q){var ne=new Uint8Array(G);if(ne.set)ne.set(R);else for(;Y<U;++Y)ne[Y]=R[Y];return ne}return R.length=G,R}function er(R){for(var X=new Array(R),U=0;U<R;++U)X[U]=0;return X}function ea(R,X,U){var G=1,Y=0,J=0,ne=0,fe=0,ae=R.length,ie=Q?new Uint16Array(32):er(32);for(J=0;J<32;++J)ie[J]=0;for(J=ae;J<U;++J)R[J]=0;ae=R.length;var le=Q?new Uint16Array(ae):er(ae);for(J=0;J<ae;++J)ie[Y=R[J]]++,G<Y&&(G=Y),le[J]=0;for(ie[0]=0,J=1;J<=G;++J)ie[J+16]=fe=fe+ie[J-1]<<1;for(J=0;J<ae;++J)fe=R[J],fe!=0&&(le[J]=ie[fe+16]++);var ye=0;for(J=0;J<ae;++J)if(ye=R[J],ye!=0)for(fe=D(le[J],G)>>G-ye,ne=(1<<G+4-ye)-1;ne>=0;--ne)X[fe|ne<<ye]=ye&15|J<<4;return G}var la=Q?new Uint16Array(512):er(512),Ms=Q?new Uint16Array(32):er(32);if(!Q){for(var Fr=0;Fr<512;++Fr)la[Fr]=0;for(Fr=0;Fr<32;++Fr)Ms[Fr]=0}(function(){for(var R=[],X=0;X<32;X++)R.push(5);ea(R,Ms,32);var U=[];for(X=0;X<=143;X++)U.push(8);for(;X<=255;X++)U.push(9);for(;X<=279;X++)U.push(7);for(;X<=287;X++)U.push(8);ea(U,la,288)})();var Ca=function(){for(var X=Q?new Uint8Array(32768):[],U=0,G=0;U<xe.length-1;++U)for(;G<xe[U+1];++G)X[G]=U;for(;G<32768;++G)X[G]=29;var Y=Q?new Uint8Array(259):[];for(U=0,G=0;U<re.length-1;++U)for(;G<re[U+1];++G)Y[G]=U;function J(fe,ae){for(var ie=0;ie<fe.length;){var le=Math.min(65535,fe.length-ie),ye=ie+le==fe.length;for(ae.write_shift(1,+ye),ae.write_shift(2,le),ae.write_shift(2,~le&65535);le-- >0;)ae[ae.l++]=fe[ie++]}return ae.l}function ne(fe,ae){for(var ie=0,le=0,ye=Q?new Uint16Array(32768):[];le<fe.length;){var ke=Math.min(65535,fe.length-le);if(ke<10){for(ie=Ve(ae,ie,+(le+ke==fe.length)),ie&7&&(ie+=8-(ie&7)),ae.l=ie/8|0,ae.write_shift(2,ke),ae.write_shift(2,~ke&65535);ke-- >0;)ae[ae.l++]=fe[le++];ie=ae.l*8;continue}ie=Ve(ae,ie,+(le+ke==fe.length)+2);for(var Oe=0;ke-- >0;){var Ne=fe[le];Oe=(Oe<<5^Ne)&32767;var Te=-1,Ke=0;if((Te=ye[Oe])&&(Te|=le&-32768,Te>le&&(Te-=32768),Te<le))for(;fe[Te+Ke]==fe[le+Ke]&&Ke<250;)++Ke;if(Ke>2){Ne=Y[Ke],Ne<=22?ie=nt(ae,ie,q[Ne+1]>>1)-1:(nt(ae,ie,3),ie+=5,nt(ae,ie,q[Ne-23]>>5),ie+=3);var Vt=Ne<8?0:Ne-4>>2;Vt>0&&(At(ae,ie,Ke-re[Ne]),ie+=Vt),Ne=X[le-Te],ie=nt(ae,ie,q[Ne]>>3),ie-=3;var Gt=Ne<4?0:Ne-2>>1;Gt>0&&(At(ae,ie,le-Te-xe[Ne]),ie+=Gt);for(var Ur=0;Ur<Ke;++Ur)ye[Oe]=le&32767,Oe=(Oe<<5^fe[le])&32767,++le;ke-=Ke-1}else Ne<=143?Ne=Ne+48:ie=ct(ae,ie,1),ie=nt(ae,ie,q[Ne]),ye[Oe]=le&32767,++le}ie=nt(ae,ie,0)-1}return ae.l=(ie+7)/8|0,ae.l}return function(ae,ie){return ae.length<8?J(ae,ie):ne(ae,ie)}}();function Qe(R){var X=de(50+Math.floor(R.length*1.1)),U=Ca(R,X);return X.slice(0,U)}var zt=Q?new Uint16Array(32768):er(32768),ca=Q?new Uint16Array(32768):er(32768),tr=Q?new Uint16Array(128):er(128),Fn=1,kd=1;function je(R,X){var U=ce(R,X)+257;X+=5;var G=ce(R,X)+1;X+=5;var Y=Ae(R,X)+4;X+=4;for(var J=0,ne=Q?new Uint8Array(19):er(19),fe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ae=1,ie=Q?new Uint8Array(8):er(8),le=Q?new Uint8Array(8):er(8),ye=ne.length,ke=0;ke<Y;++ke)ne[W[ke]]=J=we(R,X),ae<J&&(ae=J),ie[J]++,X+=3;var Oe=0;for(ie[0]=0,ke=1;ke<=ae;++ke)le[ke]=Oe=Oe+ie[ke-1]<<1;for(ke=0;ke<ye;++ke)(Oe=ne[ke])!=0&&(fe[ke]=le[Oe]++);var Ne=0;for(ke=0;ke<ye;++ke)if(Ne=ne[ke],Ne!=0){Oe=q[fe[ke]]>>8-Ne;for(var Te=(1<<7-Ne)-1;Te>=0;--Te)tr[Oe|Te<<Ne]=Ne&7|ke<<3}var Ke=[];for(ae=1;Ke.length<U+G;)switch(Oe=tr[he(R,X)],X+=Oe&7,Oe>>>=3){case 16:for(J=3+ve(R,X),X+=2,Oe=Ke[Ke.length-1];J-- >0;)Ke.push(Oe);break;case 17:for(J=3+we(R,X),X+=3;J-- >0;)Ke.push(0);break;case 18:for(J=11+he(R,X),X+=7;J-- >0;)Ke.push(0);break;default:Ke.push(Oe),ae<Oe&&(ae=Oe);break}var Vt=Ke.slice(0,U),Gt=Ke.slice(U);for(ke=U;ke<286;++ke)Vt[ke]=0;for(ke=G;ke<30;++ke)Gt[ke]=0;return Fn=ea(Vt,zt,286),kd=ea(Gt,ca,30),X}function fn(R,X){if(R[0]==3&&!(R[1]&3))return[Ns(X),2];for(var U=0,G=0,Y=ow(X||1<<18),J=0,ne=Y.length>>>0,fe=0,ae=0;!(G&1);){if(G=we(R,U),U+=3,G>>>1)G>>1==1?(fe=9,ae=5):(U=je(R,U),fe=Fn,ae=kd);else{U&7&&(U+=8-(U&7));var ie=R[U>>>3]|R[(U>>>3)+1]<<8;if(U+=32,ie>0)for(!X&&ne<J+ie&&(Y=Xt(Y,J+ie),ne=Y.length);ie-- >0;)Y[J++]=R[U>>>3],U+=8;continue}for(;;){!X&&ne<J+32767&&(Y=Xt(Y,J+32767),ne=Y.length);var le=oe(R,U,fe),ye=G>>>1==1?la[le]:zt[le];if(U+=ye&15,ye>>>=4,!(ye>>>8&255))Y[J++]=ye;else{if(ye==256)break;ye-=257;var ke=ye<8?0:ye-4>>2;ke>5&&(ke=0);var Oe=J+re[ye];ke>0&&(Oe+=oe(R,U,ke),U+=ke),le=oe(R,U,ae),ye=G>>>1==1?Ms[le]:ca[le],U+=ye&15,ye>>>=4;var Ne=ye<4?0:ye-2>>1,Te=xe[ye];for(Ne>0&&(Te+=oe(R,U,Ne),U+=Ne),!X&&ne<Oe&&(Y=Xt(Y,Oe+100),ne=Y.length);J<Oe;)Y[J]=Y[J-Te],++J}}}return X?[Y,U+7>>>3]:[Y.slice(0,J),U+7>>>3]}function ds(R,X){var U=R.slice(R.l||0),G=fn(U,X);return R.l+=G[1],G[0]}function Ed(R,X){if(R)typeof console<"u"&&console.error(X);else throw new Error(X)}function Ad(R,X){var U=R;Rr(U,0);var G=[],Y=[],J={FileIndex:G,FullPaths:Y};N(J,{root:X.root});for(var ne=U.length-4;(U[ne]!=80||U[ne+1]!=75||U[ne+2]!=5||U[ne+3]!=6)&&ne>=0;)--ne;U.l=ne+4,U.l+=4;var fe=U.read_shift(2);U.l+=6;var ae=U.read_shift(4);for(U.l=ae,ne=0;ne<fe;++ne){U.l+=20;var ie=U.read_shift(4),le=U.read_shift(4),ye=U.read_shift(2),ke=U.read_shift(2),Oe=U.read_shift(2);U.l+=8;var Ne=U.read_shift(4),Te=l(U.slice(U.l+ye,U.l+ye+ke));U.l+=ye+ke+Oe;var Ke=U.l;U.l=Ne+4,g3(U,ie,le,J,Te),U.l=Ke}return J}function g3(R,X,U,G,Y){R.l+=2;var J=R.read_shift(2),ne=R.read_shift(2),fe=o(R);if(J&8257)throw new Error("Unsupported ZIP encryption");for(var ae=R.read_shift(4),ie=R.read_shift(4),le=R.read_shift(4),ye=R.read_shift(2),ke=R.read_shift(2),Oe="",Ne=0;Ne<ye;++Ne)Oe+=String.fromCharCode(R[R.l++]);if(ke){var Te=l(R.slice(R.l,R.l+ke));(Te[21589]||{}).mt&&(fe=Te[21589].mt),((Y||{})[21589]||{}).mt&&(fe=Y[21589].mt)}R.l+=ke;var Ke=R.slice(R.l,R.l+ie);switch(ne){case 8:Ke=K(R,le);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ne)}var Vt=!1;J&8&&(ae=R.read_shift(4),ae==134695760&&(ae=R.read_shift(4),Vt=!0),ie=R.read_shift(4),le=R.read_shift(4)),ie!=X&&Ed(Vt,"Bad compressed size: "+X+" != "+ie),le!=U&&Ed(Vt,"Bad uncompressed size: "+U+" != "+le),$0(G,Oe,Ke,{unsafe:!0,mt:fe})}function v3(R,X){var U=X||{},G=[],Y=[],J=de(1),ne=U.compression?8:0,fe=0,ae=0,ie=0,le=0,ye=0,ke=R.FullPaths[0],Oe=ke,Ne=R.FileIndex[0],Te=[],Ke=0;for(ae=1;ae<R.FullPaths.length;++ae)if(Oe=R.FullPaths[ae].slice(ke.length),Ne=R.FileIndex[ae],!(!Ne.size||!Ne.content||Oe=="Sh33tJ5")){var Vt=le,Gt=de(Oe.length);for(ie=0;ie<Oe.length;++ie)Gt.write_shift(1,Oe.charCodeAt(ie)&127);Gt=Gt.slice(0,Gt.l),Te[ye]=MQ.buf(Ne.content,0);var Ur=Ne.content;ne==8&&(Ur=z(Ur)),J=de(30),J.write_shift(4,67324752),J.write_shift(2,20),J.write_shift(2,fe),J.write_shift(2,ne),Ne.mt?i(J,Ne.mt):J.write_shift(4,0),J.write_shift(-4,Te[ye]),J.write_shift(4,Ur.length),J.write_shift(4,Ne.content.length),J.write_shift(2,Gt.length),J.write_shift(2,0),le+=J.length,G.push(J),le+=Gt.length,G.push(Gt),le+=Ur.length,G.push(Ur),J=de(46),J.write_shift(4,33639248),J.write_shift(2,0),J.write_shift(2,20),J.write_shift(2,fe),J.write_shift(2,ne),J.write_shift(4,0),J.write_shift(-4,Te[ye]),J.write_shift(4,Ur.length),J.write_shift(4,Ne.content.length),J.write_shift(2,Gt.length),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(4,0),J.write_shift(4,Vt),Ke+=J.l,Y.push(J),Ke+=Gt.length,Y.push(Gt),++ye}return J=de(22),J.write_shift(4,101010256),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,ye),J.write_shift(2,ye),J.write_shift(4,Ke),J.write_shift(4,le),J.write_shift(2,0),Ar([Ar(G),Ar(Y),J])}var Td={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function y3(R,X){if(R.ctype)return R.ctype;var U=R.name||"",G=U.match(/\.([^\.]+)$/);return G&&Td[G[1]]||X&&(G=(U=X).match(/[\.\\]([^\.\\])+$/),G&&Td[G[1]])?Td[G[1]]:"application/octet-stream"}function b3(R){for(var X=Vc(R),U=[],G=0;G<X.length;G+=76)U.push(X.slice(G,G+76));return U.join(`\r
`)+`\r
`}function w3(R){var X=R.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ie){var le=ie.charCodeAt(0).toString(16).toUpperCase();return"="+(le.length==1?"0"+le:le)});X=X.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),X.charAt(0)==`
`&&(X="=0D"+X.slice(1)),X=X.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var U=[],G=X.split(`\r
`),Y=0;Y<G.length;++Y){var J=G[Y];if(J.length==0){U.push("");continue}for(var ne=0;ne<J.length;){var fe=76,ae=J.slice(ne,ne+fe);ae.charAt(fe-1)=="="?fe--:ae.charAt(fe-2)=="="?fe-=2:ae.charAt(fe-3)=="="&&(fe-=3),ae=J.slice(ne,ne+fe),ne+=fe,ne<J.length&&(ae+="="),U.push(ae)}}return U.join(`\r
`)}function j3(R){for(var X=[],U=0;U<R.length;++U){for(var G=R[U];U<=R.length&&G.charAt(G.length-1)=="=";)G=G.slice(0,G.length-1)+R[++U];X.push(G)}for(var Y=0;Y<X.length;++Y)X[Y]=X[Y].replace(/[=][0-9A-Fa-f]{2}/g,function(J){return String.fromCharCode(parseInt(J.slice(1),16))});return _a(X.join(`\r
`))}function N3(R,X,U){for(var G="",Y="",J="",ne,fe=0;fe<10;++fe){var ae=X[fe];if(!ae||ae.match(/^\s*$/))break;var ie=ae.match(/^(.*?):\s*([^\s].*)$/);if(ie)switch(ie[1].toLowerCase()){case"content-location":G=ie[2].trim();break;case"content-type":J=ie[2].trim();break;case"content-transfer-encoding":Y=ie[2].trim();break}}switch(++fe,Y.toLowerCase()){case"base64":ne=_a(Pa(X.slice(fe).join("")));break;case"quoted-printable":ne=j3(X.slice(fe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Y)}var le=$0(R,G.slice(U.length),ne,{unsafe:!0});J&&(le.ctype=J)}function _3(R,X){if(B(R.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var U=X&&X.root||"",G=(rt&&Buffer.isBuffer(R)?R.toString("binary"):B(R)).split(`\r
`),Y=0,J="";for(Y=0;Y<G.length;++Y)if(J=G[Y],!!/^Content-Location:/i.test(J)&&(J=J.slice(J.indexOf("file")),U||(U=J.slice(0,J.lastIndexOf("/")+1)),J.slice(0,U.length)!=U))for(;U.length>0&&(U=U.slice(0,U.length-1),U=U.slice(0,U.lastIndexOf("/")+1),J.slice(0,U.length)!=U););var ne=(G[1]||"").match(/boundary="(.*?)"/);if(!ne)throw new Error("MAD cannot find boundary");var fe="--"+(ne[1]||""),ae=[],ie=[],le={FileIndex:ae,FullPaths:ie};N(le);var ye,ke=0;for(Y=0;Y<G.length;++Y){var Oe=G[Y];Oe!==fe&&Oe!==fe+"--"||(ke++&&N3(le,G.slice(ye,Y),U),ye=Y)}return le}function S3(R,X){var U=X||{},G=U.boundary||"SheetJS";G="------="+G;for(var Y=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+G.slice(2)+'"',"","",""],J=R.FullPaths[0],ne=J,fe=R.FileIndex[0],ae=1;ae<R.FullPaths.length;++ae)if(ne=R.FullPaths[ae].slice(J.length),fe=R.FileIndex[ae],!(!fe.size||!fe.content||ne=="Sh33tJ5")){ne=ne.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ke){return"_x"+Ke.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ke){return"_u"+Ke.charCodeAt(0).toString(16)+"_"});for(var ie=fe.content,le=rt&&Buffer.isBuffer(ie)?ie.toString("binary"):B(ie),ye=0,ke=Math.min(1024,le.length),Oe=0,Ne=0;Ne<=ke;++Ne)(Oe=le.charCodeAt(Ne))>=32&&Oe<128&&++ye;var Te=ye>=ke*4/5;Y.push(G),Y.push("Content-Location: "+(U.root||"file:///C:/SheetJS/")+ne),Y.push("Content-Transfer-Encoding: "+(Te?"quoted-printable":"base64")),Y.push("Content-Type: "+y3(fe,ne)),Y.push(""),Y.push(Te?w3(le):b3(le))}return Y.push(G+`--\r
`),Y.join(`\r
`)}function k3(R){var X={};return N(X,R),X}function $0(R,X,U,G){var Y=G&&G.unsafe;Y||N(R);var J=!Y&&Fe.find(R,X);if(!J){var ne=R.FullPaths[0];X.slice(0,ne.length)==ne?ne=X:(ne.slice(-1)!="/"&&(ne+="/"),ne=(ne+X).replace("//","/")),J={name:s(X),type:2},R.FileIndex.push(J),R.FullPaths.push(ne),Y||Fe.utils.cfb_gc(R)}return J.content=U,J.size=U?U.length:0,G&&(G.CLSID&&(J.clsid=G.CLSID),G.mt&&(J.mt=G.mt),G.ct&&(J.ct=G.ct)),J}function E3(R,X){N(R);var U=Fe.find(R,X);if(U){for(var G=0;G<R.FileIndex.length;++G)if(R.FileIndex[G]==U)return R.FileIndex.splice(G,1),R.FullPaths.splice(G,1),!0}return!1}function A3(R,X,U){N(R);var G=Fe.find(R,X);if(G){for(var Y=0;Y<R.FileIndex.length;++Y)if(R.FileIndex[Y]==G)return R.FileIndex[Y].name=s(U),R.FullPaths[Y]=U,!0}return!1}function T3(R){S(R,!0)}return t.find=P,t.read=j,t.parse=u,t.write=L,t.writeFile=V,t.utils={cfb_new:k3,cfb_add:$0,cfb_del:E3,cfb_mov:A3,cfb_gc:T3,ReadShift:Kl,CheckField:T4,prep_blob:Rr,bconcat:Ar,use_zlib:I,_deflateRaw:Qe,_inflateRaw:ds,consts:H},t}();function $Q(e){return typeof e=="string"?A0(e):Array.isArray(e)?dQ(e):e}function vd(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=A0(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?bn(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var s=new Blob([$Q(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=Is(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function LQ(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function Qt(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function xw(e,t){for(var r=[],a=Qt(e),s=0;s!==a.length;++s)r[e[a[s]][t]]==null&&(r[e[a[s]][t]]=a[s]);return r}function O0(e){for(var t=[],r=Qt(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function P0(e){for(var t=[],r=Qt(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function BQ(e){for(var t=[],r=Qt(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var pf=new Date(1899,11,30,0,0,0);function Nr(e,t){var r=e.getTime(),a=pf.getTime()+(e.getTimezoneOffset()-pf.getTimezoneOffset())*6e4;return(r-a)/(24*60*60*1e3)}var l4=new Date,UQ=pf.getTime()+(l4.getTimezoneOffset()-pf.getTimezoneOffset())*6e4,pw=l4.getTimezoneOffset();function C0(e){var t=new Date;return t.setTime(e*24*60*60*1e3+UQ),t.getTimezoneOffset()!==pw&&t.setTime(t.getTime()+(t.getTimezoneOffset()-pw)*6e4),t}function WQ(e){var t=0,r=0,a=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(r=1,i>3&&(a=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[i],10)}return t}var gw=new Date("2017-02-19T19:06:09.000Z"),c4=isNaN(gw.getFullYear())?new Date("2/19/17"):gw,HQ=c4.getFullYear()==2017;function Lt(e,t){var r=new Date(e);if(HQ)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(c4.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Si(e,t){if(rt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return bn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return bn(YS(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return bn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return bn(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return r[i]||i})}catch{}for(var a=[],s=0;s!=e.length;++s)a.push(String.fromCharCode(e[s]));return a.join("")}function Bt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Bt(e[r]));return t}function Jt(e,t){for(var r="";r.length<t;)r+=e;return r}function ln(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(t=Number(a)))?t/r:t}var zQ=["january","february","march","april","may","june","july","august","september","october","november","december"];function Wo(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),s=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&zQ.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return a<0||a>8099?r:(s>0||i>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var VQ=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,s){if(e||typeof a=="string")return r.split(a);for(var i=r.split(a),o=[i[0]],l=1;l<i.length;++l)o.push(s),o.push(i[l]);return o}}();function d4(e){return e?e.content&&e.type?Si(e.content,!0):e.data?Fl(e.data):e.asNodeBuffer&&rt?Fl(e.asNodeBuffer().toString("binary")):e.asBinary?Fl(e.asBinary()):e._data&&e._data.getContent?Fl(Si(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function u4(e){if(!e)return null;if(e.data)return sw(e.data);if(e.asNodeBuffer&&rt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?sw(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function GQ(e){return e&&e.name.slice(-4)===".bin"?u4(e):d4(e)}function Ba(e,t){for(var r=e.FullPaths||Qt(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),s=a.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==o||s==o)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function rg(e,t){var r=Ba(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function ur(e,t,r){if(!r)return GQ(rg(e,t));if(!t)return null;try{return ur(e,t)}catch{return null}}function Sa(e,t,r){if(!r)return d4(rg(e,t));if(!t)return null;try{return Sa(e,t)}catch{return null}}function KQ(e,t,r){return u4(rg(e,t))}function vw(e){for(var t=e.FullPaths||Qt(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function Ye(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return rt?a=os(r):a=uQ(r),Fe.utils.cfb_add(e,t,a)}Fe.utils.cfb_add(e,t,r)}else e.file(t,r)}function ag(){return Fe.utils.cfb_new()}function f4(e,t){switch(t.type){case"base64":return Fe.read(e,{type:"base64"});case"binary":return Fe.read(e,{type:"binary"});case"buffer":case"array":return Fe.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Dl(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var s=a.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var lr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,qQ=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,yw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,XQ=/<[^>]*>/g,Zr=lr.match(yw)?yw:XQ,YQ=/<\w*:/,JQ=/<(\/?)\w+:/;function Be(e,t,r){for(var a={},s=0,i=0;s!==e.length&&!((i=e.charCodeAt(s))===32||i===10||i===13);++s);if(t||(a[0]=e.slice(0,s)),s===e.length)return a;var o=e.match(qQ),l=0,c="",d=0,u="",f="",h=1;if(o)for(d=0;d!=o.length;++d){for(f=o[d],i=0;i!=f.length&&f.charCodeAt(i)!==61;++i);for(u=f.slice(0,i).trim();f.charCodeAt(i+1)==32;)++i;for(h=(s=f.charCodeAt(i+1))==34||s==39?1:0,c=f.slice(i+1+h,f.length-h),l=0;l!=u.length&&u.charCodeAt(l)!==58;++l);if(l===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),a[u]=c,a[u.toLowerCase()]=c;else{var m=(l===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(l+1);if(a[m]&&u.slice(l-3,l)=="ext")continue;a[m]=c,a[m.toLowerCase()]=c}}return a}function Pn(e){return e.replace(JQ,"<$1")}var h4={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ng=O0(h4),dt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var s=a+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(e,function(l,c){return h4[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,o)+r(s.slice(o+3))}}(),sg=/[&<>'"]/g,ZQ=/[\u0000-\u0008\u000b-\u001f]/g;function St(e){var t=e+"";return t.replace(sg,function(r){return ng[r]}).replace(ZQ,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function bw(e){return St(e).replace(/ /g,"_x0020_")}var m4=/[\u0000-\u001f]/g;function ig(e){var t=e+"";return t.replace(sg,function(r){return ng[r]}).replace(/\n/g,"<br/>").replace(m4,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function QQ(e){var t=e+"";return t.replace(sg,function(r){return ng[r]}).replace(m4,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var ww=function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}}();function eee(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function $t(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function yh(e){for(var t="",r=0,a=0,s=0,i=0,o=0,l=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),a>191&&a<224){o=(a&31)<<6,o|=s&63,t+=String.fromCharCode(o);continue}if(i=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(s&63)<<6|i&63);continue}o=e.charCodeAt(r++),l=((a&7)<<18|(s&63)<<12|(i&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function jw(e){var t=Ns(2*e.length),r,a,s=1,i=0,o=0,l;for(a=0;a<e.length;a+=s)s=1,(l=e.charCodeAt(a))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(a+1)&63),s=2):l<240?(r=(l&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),s=3):(s=4,r=(l&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[i++]=o&255,t[i++]=o>>>8,o=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function Nw(e){return os(e,"binary").toString("utf8")}var Vd="foo bar bazâð£",Ot=rt&&(Nw(Vd)==yh(Vd)&&Nw||jw(Vd)==yh(Vd)&&jw)||yh,bn=rt?function(e){return os(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,s=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,s=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},Kc=function(){var e={};return function(r,a){var s=r+"|"+(a||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}}(),x4=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)a=a.replace(e[s][0],e[s][1]);return a}}(),tee=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),ree=/<\/?(?:vt:)?variant>/g,aee=/<(?:vt:)([^>]*)>([\s\S]*)</;function _w(e,t){var r=Be(e),a=e.match(tee(r.baseType))||[],s=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return s}return a.forEach(function(i){var o=i.replace(ree,"").match(aee);o&&s.push({v:Ot(o[2]),t:o[1]})}),s}var p4=/(^\s|\s$|\n)/;function $r(e,t){return"<"+e+(t.match(p4)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function qc(e){return Qt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function _e(e,t,r){return"<"+e+(r!=null?qc(r):"")+(t!=null?(t.match(p4)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function yx(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function nee(e,t){switch(typeof e){case"string":var r=_e("vt:lpwstr",St(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return _e((e|0)==e?"vt:i4":"vt:r8",St(String(e)));case"boolean":return _e("vt:bool",e?"true":"false")}if(e instanceof Date)return _e("vt:filetime",yx(e));throw new Error("Unable to serialize "+e)}function og(e){if(rt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Ot(Is(Qp(e)));throw new Error("Bad input format: expected Buffer or string")}var Xc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,yr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},$i=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],wa={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function see(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,i=5;i>=0;--i)s=s*256+e[t+i];return a==2047?s==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,s+=Math.pow(2,52)),r*Math.pow(2,a-52)*s)}function iee(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,s=0,i=0,o=a?-t:t;isFinite(o)?o==0?s=i=0:(s=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(s&15)<<4|i&15,e[r+7]=s>>4|a}var Sw=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var s=0,i=e[0][a].length;s<i;s+=r)t.push.apply(t,e[0][a].slice(s,s+r));return t},kw=rt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:os(t)})):Sw(e)}:Sw,Ew=function(e,t,r){for(var a=[],s=t;s<r;s+=2)a.push(String.fromCharCode(Hn(e,s)));return a.join("").replace(ia,"")},lg=rt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(ia,""):Ew(e,t,r)}:Ew,Aw=function(e,t,r){for(var a=[],s=t;s<t+r;++s)a.push(("0"+e[s].toString(16)).slice(-2));return a.join("")},g4=rt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Aw(e,t,r)}:Aw,Tw=function(e,t,r){for(var a=[],s=t;s<r;s++)a.push(String.fromCharCode(Qi(e,s)));return a.join("")},yd=rt?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):Tw(t,r,a)}:Tw,v4=function(e,t){var r=ja(e,t);return r>0?yd(e,t+4,t+4+r-1):""},y4=v4,b4=function(e,t){var r=ja(e,t);return r>0?yd(e,t+4,t+4+r-1):""},w4=b4,j4=function(e,t){var r=2*ja(e,t);return r>0?yd(e,t+4,t+4+r-1):""},N4=j4,_4=function(t,r){var a=ja(t,r);return a>0?lg(t,r+4,r+4+a):""},S4=_4,k4=function(e,t){var r=ja(e,t);return r>0?yd(e,t+4,t+4+r):""},E4=k4,A4=function(e,t){return see(e,t)},gf=A4,cg=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};rt&&(y4=function(t,r){if(!Buffer.isBuffer(t))return v4(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},w4=function(t,r){if(!Buffer.isBuffer(t))return b4(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},N4=function(t,r){if(!Buffer.isBuffer(t))return j4(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},S4=function(t,r){if(!Buffer.isBuffer(t))return _4(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},E4=function(t,r){if(!Buffer.isBuffer(t))return k4(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},gf=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):A4(t,r)},cg=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Qi=function(e,t){return e[t]},Hn=function(e,t){return e[t+1]*256+e[t]},oee=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},ja=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Gs=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},lee=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Kl(e,t){var r="",a,s,i=[],o,l,c,d;switch(t){case"dbcs":if(d=this.l,rt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Hn(this,d)),d+=2;e*=2;break;case"utf8":r=yd(this,this.l,this.l+e);break;case"utf16le":e*=2,r=lg(this,this.l,this.l+e);break;case"wstr":return Kl.call(this,e,"dbcs");case"lpstr-ansi":r=y4(this,this.l),e=4+ja(this,this.l);break;case"lpstr-cp":r=w4(this,this.l),e=4+ja(this,this.l);break;case"lpwstr":r=N4(this,this.l),e=4+2*ja(this,this.l);break;case"lpp4":e=4+ja(this,this.l),r=S4(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ja(this,this.l),r=E4(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Qi(this,this.l+e++))!==0;)i.push(zd(o));r=i.join("");break;case"_wstr":for(e=0,r="";(o=Hn(this,this.l+e))!==0;)i.push(zd(o)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Qi(this,d),this.l=d+1,l=Kl.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(zd(Hn(this,d))),d+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Qi(this,d),this.l=d+1,l=Kl.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(zd(Qi(this,d))),d+=1}r=i.join("");break;default:switch(e){case 1:return a=Qi(this,this.l),this.l++,a;case 2:return a=(t==="i"?oee:Hn)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(a=(e>0?Gs:lee)(this,this.l),this.l+=4,a):(s=ja(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=gf(this,this.l):s=gf([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=g4(this,this.l,e);break}}return this.l+=e,r}var cee=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},dee=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},uee=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function fee(e,t,r){var a=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)uee(this,t.charCodeAt(s),this.l+2*s);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;a=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var o=t.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,cee(this,t,this.l);break;case 8:if(a=8,r==="f"){iee(this,t,this.l);break}case 16:break;case-4:a=4,dee(this,t,this.l);break}return this.l+=a,this}function T4(e,t){var r=g4(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Rr(e,t){e.l=t,e.read_shift=Kl,e.chk=T4,e.write_shift=fee}function Yr(e,t){e.l+=t}function de(e){var t=Ns(e);return Rr(t,0),t}function ls(e,t,r){if(e){var a,s,i;Rr(e,e.l||0);for(var o=e.length,l=0,c=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var d=td[l]||td[65535];for(a=e.read_shift(1),i=a&127,s=1;s<4&&a&128;++s)i+=((a=e.read_shift(1))&127)<<7*s;c=e.l+i;var u=d.f&&d.f(e,i,r);if(e.l=c,t(u,d,l))return}}}function ma(){var e=[],t=rt?256:2048,r=function(d){var u=de(d);return Rr(u,0),u},a=r(t),s=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},i=function(d){return a&&d<a.length-a.l?a:(s(),a=r(Math.max(d+1,t)))},o=function(){return s(),Ar(e)},l=function(d){s(),a=d,a.l==null&&(a.l=a.length),i(t)};return{next:i,push:l,end:o,_bufs:e}}function ge(e,t,r,a){var s=+t,i;if(!isNaN(s)){a||(a=td[s].p||(r||[]).length||0),i=1+(s>=128?1:0)+1,a>=128&&++i,a>=16384&&++i,a>=2097152&&++i;var o=e.next(i);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var l=0;l!=4;++l)if(a>=128)o.write_shift(1,(a&127)+128),a>>=7;else{o.write_shift(1,a);break}a>0&&cg(r)&&e.push(r)}}function ql(e,t,r){var a=Bt(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function Ow(e,t,r){var a=Bt(e);return a.s=ql(a.s,t.s,r),a.e=ql(a.e,t.s,r),a}function Xl(e,t){if(e.cRel&&e.c<0)for(e=Bt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Bt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Le(e);return!e.cRel&&e.cRel!=null&&(r=xee(r)),!e.rRel&&e.rRel!=null&&(r=hee(r)),r}function bh(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Kt(e.s.c)+":"+(e.e.cRel?"":"$")+Kt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+or(e.s.r)+":"+(e.e.rRel?"":"$")+or(e.e.r):Xl(e.s,t.biff)+":"+Xl(e.e,t.biff)}function dg(e){return parseInt(mee(e),10)-1}function or(e){return""+(e+1)}function hee(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function mee(e){return e.replace(/\$(\d+)$/,"$1")}function ug(e){for(var t=pee(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function Kt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function xee(e){return e.replace(/^([A-Z])/,"$$$1")}function pee(e){return e.replace(/^\$([A-Z])/,"$1")}function gee(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function qt(e){for(var t=0,r=0,a=0;a<e.length;++a){var s=e.charCodeAt(a);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Le(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function pa(e){var t=e.indexOf(":");return t==-1?{s:qt(e),e:qt(e)}:{s:qt(e.slice(0,t)),e:qt(e.slice(t+1))}}function Xe(e,t){return typeof t>"u"||typeof t=="number"?Xe(e.s,e.e):(typeof e!="string"&&(e=Le(e)),typeof t!="string"&&(t=Le(t)),e==t?e:e+":"+t)}function ft(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,s=0,i=e.length;for(r=0;a<i&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.s.c=--r,r=0;a<i&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;if(t.s.r=--r,a===i||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=i&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.e.c=--r,r=0;a!=i&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;return t.e.r=--r,t}function Pw(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=qa(e.z,r?Nr(t):t)}catch{}try{return e.w=qa((e.XF||{}).numFmtId||(r?14:0),r?Nr(t):t)}catch{return""+t}}function rs(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?cs[e.v]||e.v:t==null?Pw(e,e.v):Pw(e,t))}function Ds(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function O4(e,t,r){var a=r||{},s=e?Array.isArray(e):a.dense,i=e||(s?[]:{}),o=0,l=0;if(i&&a.origin!=null){if(typeof a.origin=="number")o=a.origin;else{var c=typeof a.origin=="string"?qt(a.origin):a.origin;o=c.r,l=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=ft(i["!ref"]);d.s.c=u.s.c,d.s.r=u.s.r,d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),o==-1&&(d.e.r=o=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var m={v:t[f][h]},x=o+f,p=l+h;if(d.s.r>x&&(d.s.r=x),d.s.c>p&&(d.s.c=p),d.e.r<x&&(d.e.r=x),d.e.c<p&&(d.e.c=p),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))m=t[f][h];else if(Array.isArray(m.v)&&(m.f=t[f][h][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(a.nullError)m.t="e",m.v=0;else if(a.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=a.dateNF||Me[14],a.cellDates?(m.t="d",m.w=qa(m.z,Nr(m.v))):(m.t="n",m.v=Nr(m.v),m.w=qa(m.z,m.v))):m.t="s";if(s)i[x]||(i[x]=[]),i[x][p]&&i[x][p].z&&(m.z=i[x][p].z),i[x][p]=m;else{var g=Le({c:p,r:x});i[g]&&i[g].z&&(m.z=i[g].z),i[g]=m}}}return d.s.c<1e7&&(i["!ref"]=Xe(d)),i}function cl(e,t){return O4(null,e,t)}function vee(e){return e.read_shift(4,"i")}function cn(e,t){return t||(t=de(4)),t.write_shift(4,e),t}function Xr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Or(e,t){var r=!1;return t==null&&(r=!0,t=de(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function yee(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function bee(e,t){return t||(t=de(4)),t.write_shift(2,0),t.write_shift(2,0),t}function fg(e,t){var r=e.l,a=e.read_shift(1),s=Xr(e),i=[],o={t:s,h:s};if(a&1){for(var l=e.read_shift(4),c=0;c!=l;++c)i.push(yee(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function wee(e,t){var r=!1;return t==null&&(r=!0,t=de(15+4*e.t.length)),t.write_shift(1,0),Or(e.t,t),r?t.slice(0,t.l):t}var jee=fg;function Nee(e,t){var r=!1;return t==null&&(r=!0,t=de(23+4*e.t.length)),t.write_shift(1,1),Or(e.t,t),t.write_shift(4,1),bee({},t),r?t.slice(0,t.l):t}function Ja(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Li(e,t){return t==null&&(t=de(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Bi(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Ui(e,t){return t==null&&(t=de(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var _ee=Xr,P4=Or;function hg(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function vf(e,t){var r=!1;return t==null&&(r=!0,t=de(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var See=Xr,bx=hg,mg=vf;function xg(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var s=a===0?gf([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Gs(t,0)>>2;return r?s/100:s}function C4(e,t){t==null&&(t=de(4));var r=0,a=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function F4(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function kee(e,t){return t||(t=de(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Wi=F4,dl=kee;function qr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ki(e,t){return(t||de(8)).write_shift(8,e,"f")}function Eee(e){var t={},r=e.read_shift(1),a=r>>>1,s=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=s;var d=li[s];d&&(t.rgb=Jc(d));break;case 2:t.rgb=Jc([o,l,c]);break;case 3:t.theme=s;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function yf(e,t){if(t||(t=de(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function Aee(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Tee(e,t){t||(t=de(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function I4(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function Oee(e){return I4(e,1)}function Pee(e){return I4(e,2)}var pg=2,da=3,Gd=11,Cw=12,bf=19,Kd=64,Cee=65,Fee=71,Iee=4108,Dee=4126,kr=80,D4=81,Ree=[kr,D4],wx={1:{n:"CodePage",t:pg},2:{n:"Category",t:kr},3:{n:"PresentationFormat",t:kr},4:{n:"ByteCount",t:da},5:{n:"LineCount",t:da},6:{n:"ParagraphCount",t:da},7:{n:"SlideCount",t:da},8:{n:"NoteCount",t:da},9:{n:"HiddenCount",t:da},10:{n:"MultimediaClipCount",t:da},11:{n:"ScaleCrop",t:Gd},12:{n:"HeadingPairs",t:Iee},13:{n:"TitlesOfParts",t:Dee},14:{n:"Manager",t:kr},15:{n:"Company",t:kr},16:{n:"LinksUpToDate",t:Gd},17:{n:"CharacterCount",t:da},19:{n:"SharedDoc",t:Gd},22:{n:"HyperlinksChanged",t:Gd},23:{n:"AppVersion",t:da,p:"version"},24:{n:"DigSig",t:Cee},26:{n:"ContentType",t:kr},27:{n:"ContentStatus",t:kr},28:{n:"Language",t:kr},29:{n:"Version",t:kr},255:{},2147483648:{n:"Locale",t:bf},2147483651:{n:"Behavior",t:bf},1919054434:{}},jx={1:{n:"CodePage",t:pg},2:{n:"Title",t:kr},3:{n:"Subject",t:kr},4:{n:"Author",t:kr},5:{n:"Keywords",t:kr},6:{n:"Comments",t:kr},7:{n:"Template",t:kr},8:{n:"LastAuthor",t:kr},9:{n:"RevNumber",t:kr},10:{n:"EditTime",t:Kd},11:{n:"LastPrinted",t:Kd},12:{n:"CreatedDate",t:Kd},13:{n:"ModifiedDate",t:Kd},14:{n:"PageCount",t:da},15:{n:"WordCount",t:da},16:{n:"CharCount",t:da},17:{n:"Thumbnail",t:Fee},18:{n:"Application",t:kr},19:{n:"DocSecurity",t:da},255:{},2147483648:{n:"Locale",t:bf},2147483651:{n:"Behavior",t:bf},1919054434:{}},Fw={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Mee=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function $ee(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Lee=$ee([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),li=Bt(Lee),cs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},R4={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Nx={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},qd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function gg(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Bee(e){var t=gg();if(!e||!e.match)return t;var r={};if((e.match(Zr)||[]).forEach(function(a){var s=Be(a);switch(s[0].replace(YQ,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[Nx[s.ContentType]]!==void 0&&t[Nx[s.ContentType]].push(s.PartName);break}}),t.xmlns!==yr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function M4(e,t){var r=BQ(Nx),a=[],s;a[a.length]=lr,a[a.length]=_e("Types",null,{xmlns:yr.CT,"xmlns:xsd":yr.xsd,"xmlns:xsi":yr.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return _e("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(s=e[c][0],a[a.length]=_e("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:qd[c][t.bookType]||qd[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(d){a[a.length]=_e("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:qd[c][t.bookType]||qd[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(d){a[a.length]=_e("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[c][0]})})};return i("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var st={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Yc(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Yl(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(Zr)||[]).forEach(function(s){var i=Be(s);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var l=i.TargetMode==="External"?i.Target:Dl(i.Target,t);r[l]=o,a[i.Id]=o}}),r["!id"]=a,r}function fo(e){var t=[lr,_e("Relationships",null,{xmlns:yr.RELS})];return Qt(e["!id"]).forEach(function(r){t[t.length]=_e("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function _t(e,t,r,a,s,i){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=a,s.Target=r,[st.HLINK,st.XPATH,st.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var Uee="application/vnd.oasis.opendocument.spreadsheet";function Wee(e,t){for(var r=og(e),a,s;a=Xc.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(s=Be(a[0],!1),s.path=="/"&&s.type!==Uee)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function Hee(e){var t=[lr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Iw(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function zee(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function Vee(e){var t=[lr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Iw(e[r][0],e[r][1])),t.push(zee("",e[r][0]));return t.push(Iw("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function $4(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+ff.version+"</meta:generator></office:meta></office:document-meta>"}var za=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Gee=function(){for(var e=new Array(za.length),t=0;t<za.length;++t){var r=za[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e}();function L4(e){var t={};e=Ot(e);for(var r=0;r<za.length;++r){var a=za[r],s=e.match(Gee[r]);s!=null&&s.length>0&&(t[a[1]]=dt(s[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=Lt(t[a[1]]))}return t}function wh(e,t,r,a,s){s[e]!=null||t==null||t===""||(s[e]=t,t=St(t),a[a.length]=r?_e(e,t,r):$r(e,t))}function B4(e,t){var r=t||{},a=[lr,_e("cp:coreProperties",null,{"xmlns:cp":yr.CORE_PROPS,"xmlns:dc":yr.dc,"xmlns:dcterms":yr.dcterms,"xmlns:dcmitype":yr.dcmitype,"xmlns:xsi":yr.xsi})],s={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&wh("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:yx(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s),e.ModifiedDate!=null&&wh("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:yx(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s));for(var i=0;i!=za.length;++i){var o=za[i],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&wh(o[0],l,null,a,s)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var ci=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],U4=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function W4(e,t,r,a){var s=[];if(typeof e=="string")s=_w(e,a);else for(var i=0;i<e.length;++i)s=s.concat(e[i].map(function(u){return{v:u}}));var o=typeof t=="string"?_w(t,a).map(function(u){return u.v}):t,l=0,c=0;if(o.length>0)for(var d=0;d!==s.length;d+=2){switch(c=+s[d+1].v,s[d].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function Kee(e,t,r){var a={};return t||(t={}),e=Ot(e),ci.forEach(function(s){var i=(e.match(Kc(s[0]))||[])[1];switch(s[2]){case"string":i&&(t[s[1]]=dt(i));break;case"bool":t[s[1]]=i==="true";break;case"raw":var o=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(a[s[1]]=o[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&W4(a.HeadingPairs,a.TitlesOfParts,t,r),t}function H4(e){var t=[],r=_e;return e||(e={}),e.Application="SheetJS",t[t.length]=lr,t[t.length]=_e("Properties",null,{xmlns:yr.EXT_PROPS,"xmlns:vt":yr.vt}),ci.forEach(function(a){if(e[a[1]]!==void 0){var s;switch(a[2]){case"string":s=St(String(e[a[1]]));break;case"bool":s=e[a[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(a[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+St(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var qee=/<[^>]+>[^<]*/g;function Xee(e,t){var r={},a="",s=e.match(qee);if(s)for(var i=0;i!=s.length;++i){var o=s[i],l=Be(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":a=dt(l.name);break;case"</property>":a=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),d=c[0].slice(4),u=c[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[a]=dt(u);break;case"bool":r[a]=$t(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(u);break;case"filetime":case"date":r[a]=Lt(u);break;case"cy":case"error":r[a]=dt(u);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,c)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function z4(e){var t=[lr,_e("Properties",null,{xmlns:yr.CUST_PROPS,"xmlns:vt":yr.vt})];if(!e)return t.join("");var r=1;return Qt(e).forEach(function(s){++r,t[t.length]=_e("property",nee(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:St(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var _x={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},jh;function Yee(e,t,r){jh||(jh=O0(_x)),t=jh[t]||t,e[t]=r}function Jee(e,t){var r=[];return Qt(_x).map(function(a){for(var s=0;s<za.length;++s)if(za[s][1]==a)return za[s];for(s=0;s<ci.length;++s)if(ci[s][1]==a)return ci[s];throw a}).forEach(function(a){if(e[a[1]]!=null){var s=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push($r(_x[a[1]]||a[1],s))}}),_e("DocumentProperties",r.join(""),{xmlns:wa.o})}function Zee(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",s=[];return e&&Qt(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var o=0;o<za.length;++o)if(i==za[o][1])return;for(o=0;o<ci.length;++o)if(i==ci[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var l=e[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),s.push(_e(bw(i),l,{"dt:dt":c}))}}),t&&Qt(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var o=t[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),s.push(_e(bw(i),o,{"dt:dt":l}))}}),"<"+a+' xmlns="'+wa.o+'">'+s.join("")+"</"+a+">"}function vg(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Qee(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),s=(r-a)/Math.pow(2,32);a*=1e7,s*=1e7;var i=a/Math.pow(2,32)|0;i>0&&(a=a%Math.pow(2,32),s+=i);var o=de(8);return o.write_shift(4,a),o.write_shift(4,s),o}function V4(e,t,r){var a=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return s}function G4(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function K4(e,t,r){return t===31?G4(e):V4(e,t,r)}function Sx(e,t,r){return K4(e,t,r===!1?0:4)}function ete(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return K4(e,t,0)}function tte(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var s=e.l;r[a]=e.read_shift(0,"lpwstr").replace(ia,""),e.l-s&2&&(e.l+=2)}return r}function rte(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(ia,"");return r}function ate(e){var t=e.l,r=wf(e,D4);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=wf(e,da);return[r,a]}function nte(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(ate(e));return r}function Dw(e,t){for(var r=e.read_shift(4),a={},s=0;s!=r;++s){var i=e.read_shift(4),o=e.read_shift(4);a[i]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(ia,"").replace(Il,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function q4(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function ste(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function wf(e,t,r){var a=e.read_shift(2),s,i=r||{};if(e.l+=2,t!==Cw&&a!==t&&Ree.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===Cw?a:t){case 2:return s=e.read_shift(2,"i"),i.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return V4(e,a,4).replace(ia,"");case 31:return G4(e);case 64:return vg(e);case 65:return q4(e);case 71:return ste(e);case 80:return Sx(e,a,!i.raw).replace(ia,"");case 81:return ete(e,a).replace(ia,"");case 4108:return nte(e);case 4126:case 4127:return a==4127?tte(e):rte(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function Rw(e,t){var r=de(4),a=de(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=de(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=Qee(t);break;case 31:case 80:for(a=de(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Ar([r,a])}function Mw(e,t){var r=e.l,a=e.read_shift(4),s=e.read_shift(4),i=[],o=0,l=0,c=-1,d={};for(o=0;o!=s;++o){var u=e.read_shift(4),f=e.read_shift(4);i[o]=[u,f+r]}i.sort(function(w,v){return w[1]-v[1]});var h={};for(o=0;o!=s;++o){if(e.l!==i[o][1]){var m=!0;if(o>0&&t)switch(t[i[o-1][0]].t){case 2:e.l+2===i[o][1]&&(e.l+=2,m=!1);break;case 80:e.l<=i[o][1]&&(e.l=i[o][1],m=!1);break;case 4108:e.l<=i[o][1]&&(e.l=i[o][1],m=!1);break}if((!t||o==0)&&e.l<=i[o][1]&&(m=!1,e.l=i[o][1]),m)throw new Error("Read Error: Expected address "+i[o][1]+" at "+e.l+" :"+o)}if(t){var x=t[i[o][0]];if(h[x.n]=wf(e,x.t,{raw:!0}),x.p==="version"&&(h[x.n]=String(h[x.n]>>16)+"."+("0000"+String(h[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(h[x.n]){case 0:h[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:nn(l=h[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[x.n])}}else if(i[o][0]===1){if(l=h.CodePage=wf(e,pg),nn(l),c!==-1){var p=e.l;e.l=i[c][1],d=Dw(e,l),e.l=p}}else if(i[o][0]===0){if(l===0){c=o,e.l=i[o+1][1];continue}d=Dw(e,l)}else{var g=d[i[o][0]],y;switch(e[e.l]){case 65:e.l+=4,y=q4(e);break;case 30:e.l+=4,y=Sx(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,y=Sx(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,y=e.read_shift(4,"i");break;case 19:e.l+=4,y=e.read_shift(4);break;case 5:e.l+=4,y=e.read_shift(8,"f");break;case 11:e.l+=4,y=rr(e,4);break;case 64:e.l+=4,y=Lt(vg(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[g]=y}}return e.l=r+a,h}var X4=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function ite(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function $w(e,t,r){var a=de(8),s=[],i=[],o=8,l=0,c=de(8),d=de(8);if(c.write_shift(4,2),c.write_shift(4,1200),d.write_shift(4,1),i.push(c),s.push(d),o+=8+c.length,!t){d=de(8),d.write_shift(4,0),s.unshift(d);var u=[de(4)];for(u[0].write_shift(4,e.length),l=0;l<e.length;++l){var f=e[l][0];for(c=de(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);u.push(c)}c=Ar(u),i.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(X4.indexOf(e[l][0])>-1||U4.indexOf(e[l][0])>-1)&&e[l][1]!=null){var h=e[l][1],m=0;if(t){m=+t[e[l][0]];var x=r[m];if(x.p=="version"&&typeof h=="string"){var p=h.split(".");h=(+p[0]<<16)+(+p[1]||0)}c=Rw(x.t,h)}else{var g=ite(h);g==-1&&(g=31,h=String(h)),c=Rw(g,h)}i.push(c),d=de(8),d.write_shift(4,t?m:2+l),s.push(d),o+=8+c.length}var y=8*(i.length+1);for(l=0;l<i.length;++l)s[l].write_shift(4,y),y+=i[l].length;return a.write_shift(4,o),a.write_shift(4,i.length),Ar([a].concat(s).concat(i))}function Lw(e,t,r){var a=e.content;if(!a)return{};Rr(a,0);var s,i,o,l,c=0;a.chk("feff","Byte Order: "),a.read_shift(2);var d=a.read_shift(4),u=a.read_shift(16);if(u!==Fe.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(s=a.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=a.read_shift(16),l=a.read_shift(4),s===1&&l!==a.l)throw new Error("Length mismatch: "+l+" !== "+a.l);s===2&&(o=a.read_shift(16),c=a.read_shift(4));var f=Mw(a,t),h={SystemIdentifier:d};for(var m in f)h[m]=f[m];if(h.FMTID=i,s===1)return h;if(c-a.l==2&&(a.l+=2),a.l!==c)throw new Error("Length mismatch 2: "+a.l+" !== "+c);var x;try{x=Mw(a,null)}catch{}for(m in x)h[m]=x[m];return h.FMTID=[i,o],h}function Bw(e,t,r,a,s,i){var o=de(s?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Fe.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,s?68:48);var c=$w(e,r,a);if(l.push(c),s){var d=$w(s,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+c.length),l.push(d)}return Ar(l)}function us(e,t){return e.read_shift(t),null}function ote(e,t){t||(t=de(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function lte(e,t,r){for(var a=[],s=e.l+t;e.l<s;)a.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return a}function rr(e,t){return e.read_shift(t)===1}function ra(e,t){return t||(t=de(2)),t.write_shift(2,+!!e),t}function fr(e){return e.read_shift(2,"u")}function Ua(e,t){return t||(t=de(2)),t.write_shift(2,e),t}function Y4(e,t){return lte(e,t,fr)}function cte(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function J4(e,t,r){return r||(r=de(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function bd(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var o=a?e.read_shift(a,s):"";return o}function dte(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,s=r&8,i=1+(r&1),o=0,l,c={};s&&(o=e.read_shift(2)),a&&(l=e.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,d);return s&&(e.l+=4*o),a&&(e.l+=l),c.t=u,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function ute(e){var t=e.t||"",r=de(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=de(2*t.length);a.write_shift(2*t.length,t,"utf16le");var s=[r,a];return Ar(s)}function Ei(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function wd(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):Ei(e,a,r)}function Hi(e,t,r){if(r.biff>5)return wd(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Z4(e,t,r){return r||(r=de(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function fte(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function hte(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var s=e.read_shift((a?t-24:t)>>1,"utf16le").replace(ia,"");return a&&(e.l+=24),s}function mte(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+a.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(i>>1,"utf16le").replace(ia,"");return r+o}function xte(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return hte(e);case"0303000000000000c000000000000046":return mte(e);default:throw new Error("Unsupported Moniker "+r)}}function Xd(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(ia,""):"";return r}function Uw(e,t){t||(t=de(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function pte(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var s=e.read_shift(2);e.l+=2;var i,o,l,c,d="",u,f;s&16&&(i=Xd(e,r-e.l)),s&128&&(o=Xd(e,r-e.l)),(s&257)===257&&(l=Xd(e,r-e.l)),(s&257)===1&&(c=xte(e,r-e.l)),s&8&&(d=Xd(e,r-e.l)),s&32&&(u=e.read_shift(16)),s&64&&(f=vg(e)),e.l=r;var h=o||l||c||"";h&&d&&(h+="#"+d),h||(h="#"+d),s&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var m={Target:h};return u&&(m.guid=u),f&&(m.time=f),i&&(m.Tooltip=i),m}function gte(e){var t=de(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var s=a.indexOf("#"),i=s>-1?31:23;switch(a.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(i==28)a=a.slice(1),Uw(a,t);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=s>-1?a.slice(0,s):a;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),i&8&&Uw(s>-1?a.slice(s+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;a.slice(c*3,c*3+3)=="../"||a.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,a.length-3*c+1),r=0;r<a.length-3*c;++r)t.write_shift(1,a.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Q4(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),s=e.read_shift(1);return[t,r,a,s]}function ek(e,t){var r=Q4(e);return r[3]=0,r}function Cn(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function Ai(e,t,r,a){return a||(a=de(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function vte(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function yte(e,t,r){return t===0?"":Hi(e,t,r)}function bte(e,t,r){var a=r.biff>8?4:2,s=e.read_shift(a),i=e.read_shift(a,"i"),o=e.read_shift(a,"i");return[s,i,o]}function tk(e){var t=e.read_shift(2),r=xg(e);return[t,r]}function wte(e,t,r){e.l+=4,t-=4;var a=e.l+t,s=bd(e,t,r),i=e.read_shift(2);if(a-=e.l,i!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+i);return e.l+=i,s}function F0(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);return{s:{c:a,r:t},e:{c:s,r}}}function rk(e,t){return t||(t=de(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function ak(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),s=e.read_shift(1);return{s:{c:a,r:t},e:{c:s,r}}}var jte=ak;function nk(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function Nte(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function _te(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Wr(e){e.l+=2,e.l+=e.read_shift(2)}var Ste={0:Wr,4:Wr,5:Wr,6:Wr,7:_te,8:Wr,9:Wr,10:Wr,11:Wr,12:Wr,13:Nte,14:Wr,15:Wr,16:Wr,17:Wr,18:Wr,19:Wr,20:Wr,21:nk};function kte(e,t){for(var r=e.l+t,a=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{a.push(Ste[s](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function Yd(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function yg(e,t,r){var a=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,s=8;break;case"biff4":a=4,s=6;break;case"biff3":a=3,s=6;break;case"biff2":a=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=de(s);return i.write_shift(2,a),i.write_shift(2,t),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function Ete(e,t){return t===0||e.read_shift(2),1200}function Ate(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,s=Hi(e,0,r);return e.read_shift(t+a-e.l),s}function Tte(e,t){var r=!t||t.biff==8,a=de(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function Ote(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function Pte(e,t,r){var a=e.read_shift(4),s=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=bd(e,0,r);return o.length===0&&(o="Sheet1"),{pos:a,hs:s,dt:i,name:o}}function Cte(e,t){var r=!t||t.biff>=8?2:1,a=de(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=a.slice(0,a.l);return s.l=a.l,s}function Fte(e,t){for(var r=e.l+t,a=e.read_shift(4),s=e.read_shift(4),i=[],o=0;o!=s&&e.l<r;++o)i.push(dte(e));return i.Count=a,i.Unique=s,i}function Ite(e,t){var r=de(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],s=0;s<e.length;++s)a[s]=ute(e[s]);var i=Ar([r].concat(a));return i.parts=[r.length].concat(a.map(function(o){return o.length})),i}function Dte(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function Rte(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function Mte(e){var t=vte(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function $te(e){return e.read_shift(2),e.read_shift(4)}function Ww(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(a=1-(s>>15),s&=32767);var i={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[i,s]}function Lte(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[a,s],Flags:i,CurTab:o,FirstTab:l,Selected:c,TabRatio:d}}function Bte(){var e=de(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Ute(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function Wte(e){var t=de(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function Hte(){}function zte(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=bd(e,0,r),a}function Vte(e,t){var r=e.name||"Arial",a=t&&t.biff==5,s=a?15+r.length:16+2*r.length,i=de(s);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),a||i.write_shift(1,1),i.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),i}function Gte(e){var t=Cn(e);return t.isst=e.read_shift(4),t}function Kte(e,t,r,a){var s=de(10);return Ai(e,t,a,s),s.write_shift(4,r),s}function qte(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,s=Cn(e);r.biff==2&&e.l++;var i=wd(e,a-e.l,r);return s.val=i,s}function Xte(e,t,r,a,s){var i=!s||s.biff==8,o=de(8+ +i+(1+i)*r.length);return Ai(e,t,a,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function Yte(e,t,r){var a=e.read_shift(2),s=Hi(e,0,r);return[a,s]}function Jte(e,t,r,a){var s=r&&r.biff==5;a||(a=de(s?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(s?1:2,t.length),s||a.write_shift(1,1),a.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var i=a.length>a.l?a.slice(0,a.l):a;return i.l==null&&(i.l=i.length),i}var Zte=Hi;function Hw(e,t,r){var a=e.l+t,s=r.biff==8||!r.biff?4:2,i=e.read_shift(s),o=e.read_shift(s),l=e.read_shift(2),c=e.read_shift(2);return e.l=a,{s:{r:i,c:l},e:{r:o,c}}}function Qte(e,t){var r=t.biff==8||!t.biff?4:2,a=de(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function ere(e){var t=e.read_shift(2),r=e.read_shift(2),a=tk(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function tre(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),i=[];e.l<r;)i.push(tk(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(i.length!=o-s+1)throw new Error("MulRK length mismatch");return{r:a,c:s,C:o,rkrec:i}}function rre(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(i.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r:a,c:s,C:o,ixfe:i}}function are(e,t,r,a){var s={},i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return s.patternType=Mee[l>>26],a.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=l&127,s.icvBottom=l>>7&127,s.icvDiag=l>>14&127,s.dgDiag=l>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function nre(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=are(e,t,a.fStyle,r),a}function zw(e,t,r,a){var s=r&&r.biff==5;a||(a=de(s?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&s&&(i|=1024),a.write_shift(4,i),a.write_shift(4,0),s||a.write_shift(4,0),a.write_shift(2,0),a}function sre(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function ire(e){var t=de(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Vw(e,t,r){var a=Cn(e);(r.biff==2||t==9)&&++e.l;var s=cte(e);return a.val=s,a.t=s===!0||s===!1?"b":"e",a}function ore(e,t,r,a,s,i){var o=de(8);return Ai(e,t,a,o),J4(r,i,o),o}function lre(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=Cn(e),s=qr(e);return a.val=s,a}function cre(e,t,r,a){var s=de(14);return Ai(e,t,a,s),ki(r,s),s}var Gw=yte;function dre(e,t,r){var a=e.l+t,s=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=Ei(e,i),l=[];a>e.l;)l.push(wd(e));return[i,s,o,l]}function Kw(e,t,r){var a=e.read_shift(2),s,i={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(s=wte(e,t-2,r)),i.body=s||e.read_shift(t-2),typeof s=="string"&&(i.Name=s),i}var ure=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function qw(e,t,r){var a=e.l+t,s=e.read_shift(2),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=Ei(e,o,r);s&32&&(d=ure[d.charCodeAt(0)]);var u=a-e.l;r&&r.biff==2&&--u;var f=a==e.l||l===0||!(u>0)?[]:kie(e,u,r,l);return{chKey:i,Name:d,itab:c,rgce:f}}function sk(e,t,r){if(r.biff<8)return fre(e,t,r);for(var a=[],s=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)a.push(bte(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return a}function fre(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=bd(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function hre(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),s=e.read_shift(2),i=Ei(e,a,r),o=Ei(e,s,r);return[i,o]}function mre(e,t,r){var a=ak(e);e.l++;var s=e.read_shift(1);return t-=8,[Eie(e,t,r),s,a]}function Xw(e,t,r){var a=jte(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,_ie(e,t,r)]}function xre(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function pre(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=Hi(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:s},l,o,i]}}function gre(e,t,r){return pre(e,t,r)}function vre(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(F0(e));return r}function yre(e){var t=de(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)rk(e[r],t);return t}function bre(e,t,r){if(r&&r.biff<8)return jre(e,t,r);var a=nk(e),s=kte(e,t-22,a[1]);return{cmo:a,ft:s}}var wre={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:a}}};function jre(e,t,r){e.l+=4;var a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((wre[a]||Yr)(e,t,r)),{cmo:[s,a,i],ft:o}}function Nre(e,t,r){var a=e.l,s="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:o=fte(e,6,r);var l=e.read_shift(2);e.read_shift(2),fr(e,2);var c=e.read_shift(2);e.l+=c;for(var d=1;d<e.lens.length-1;++d){if(e.l-a!=e.lens[d])throw new Error("TxO: bad continue record");var u=e[e.l],f=Ei(e,e.lens[d+1]-e.lens[d]-1);if(s+=f,s.length>=(u?l:2*l))break}if(s.length!==l&&s.length!==l*2)throw new Error("cchText: "+l+" != "+s.length);return e.l=a+t,{t:s}}catch{return e.l=a+t,{t:s}}}function _re(e,t){var r=F0(e);e.l+=16;var a=pte(e,t-24);return[r,a]}function Sre(e){var t=de(24),r=qt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(a[s],16));return Ar([t,gte(e[1])])}function kre(e,t){e.read_shift(2);var r=F0(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(ia,""),[r,a]}function Ere(e){var t=e[1].Tooltip,r=de(10+2*(t.length+1));r.write_shift(2,2048);var a=qt(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function Are(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Fw[r]||r,r=e.read_shift(2),t[1]=Fw[r]||r,t}function Tre(e){return e||(e=de(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Ore(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(ek(e));return r}function Pre(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(ek(e));return r}function Cre(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function ik(e,t,r){if(!r.cellStyles)return Yr(e,t);var a=r&&r.biff>=12?4:2,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(a),l=e.read_shift(a),c=e.read_shift(2);a==2&&(e.l+=2);var d={s,e:i,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(d.level=c>>8&7),d}function Fre(e,t){var r=de(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function Ire(e,t){var r={};return t<32||(e.l+=16,r.header=qr(e),r.footer=qr(e),e.l+=2),r}function Dre(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var s=e.read_shift(1);return e.l+=3,s&16&&(a.area=!0),a}function Rre(e){for(var t=de(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var Mre=Cn,$re=Y4,Lre=wd;function Bre(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,s}function Ure(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=Cn(e);++e.l;var s=Hi(e,t-7,r);return a.t="str",a.val=s,a}function Wre(e){var t=Cn(e);++e.l;var r=qr(e);return t.t="n",t.val=r,t}function Hre(e,t,r){var a=de(15);return Sd(a,e,t),a.write_shift(8,r,"f"),a}function zre(e){var t=Cn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function Vre(e,t,r){var a=de(9);return Sd(a,e,t),a.write_shift(2,r),a}function Gre(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function Kre(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function qre(e,t,r){var a=e.l+t,s=Cn(e),i=e.read_shift(2),o=Ei(e,i,r);return e.l=a,s.t="str",s.val=o,s}var Xre=[2,3,48,49,131,139,140,245],kx=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=O0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var d=[],u=Ns(1);switch(c.type){case"base64":u=_a(Pa(l));break;case"binary":u=_a(l);break;case"buffer":case"array":u=l;break}Rr(u,0);var f=u.read_shift(1),h=!!(f&136),m=!1,x=!1;switch(f){case 2:break;case 3:break;case 48:m=!0,h=!0;break;case 49:m=!0,h=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,g=521;f==2&&(p=u.read_shift(2)),u.l+=3,f!=2&&(p=u.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(g=u.read_shift(2));var y=u.read_shift(2),w=c.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(w=e[u[u.l]]),u.l+=1,u.l+=2),x&&(u.l+=36);for(var v=[],_={},b=Math.min(u.length,f==2?521:g-10-(m?264:0)),j=x?32:11;u.l<b&&u[u.l]!=13;)switch(_={},_.name=zc.utils.decode(w,u.slice(u.l,u.l+j)).replace(/[\u0000\r\n].*$/g,""),u.l+=j,_.type=String.fromCharCode(u.read_shift(1)),f!=2&&!x&&(_.offset=u.read_shift(4)),_.len=u.read_shift(1),f==2&&(_.offset=u.read_shift(2)),_.dec=u.read_shift(1),_.name.length&&v.push(_),f!=2&&(u.l+=x?13:14),_.type){case"B":(!m||_.len!=8)&&c.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+_.type)}if(u[u.l]!==13&&(u.l=g-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=g;var N=0,k=0;for(d[0]=[],k=0;k!=v.length;++k)d[0][k]=v[k].name;for(;p-- >0;){if(u[u.l]===42){u.l+=y;continue}for(++u.l,d[++N]=[],k=0,k=0;k!=v.length;++k){var S=u.slice(u.l,u.l+v[k].len);u.l+=v[k].len,Rr(S,0);var E=zc.utils.decode(w,S);switch(v[k].type){case"C":E.trim().length&&(d[N][k]=E.replace(/\s+$/,""));break;case"D":E.length===8?d[N][k]=new Date(+E.slice(0,4),+E.slice(4,6)-1,+E.slice(6,8)):d[N][k]=E;break;case"F":d[N][k]=parseFloat(E.trim());break;case"+":case"I":d[N][k]=x?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(E.trim().toUpperCase()){case"Y":case"T":d[N][k]=!0;break;case"N":case"F":d[N][k]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+E+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));d[N][k]="##MEMO##"+(x?parseInt(E.trim(),10):S.read_shift(4));break;case"N":E=E.replace(/\u0000/g,"").trim(),E&&E!="."&&(d[N][k]=+E||0);break;case"@":d[N][k]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":d[N][k]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":d[N][k]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[N][k]=-S.read_shift(-8,"f");break;case"B":if(m&&v[k].len==8){d[N][k]=S.read_shift(8,"f");break}case"G":case"P":S.l+=v[k].len;break;case"0":if(v[k].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[k].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=v,d}function a(l,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var u=cl(r(l,d),d);return u["!cols"]=d.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete d.DBF,u}function s(l,c){try{return Ds(a(l,c),c)}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var d=c||{};if(+d.codepage>=0&&nn(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var u=ma(),f=_f(l,{header:1,raw:!0,cellDates:!0}),h=f[0],m=f.slice(1),x=l["!cols"]||[],p=0,g=0,y=0,w=1;for(p=0;p<h.length;++p){if(((x[p]||{}).DBF||{}).name){h[p]=x[p].DBF.name,++y;continue}if(h[p]!=null){if(++y,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(g=0;g<1024;++g)if(h.indexOf(h[p]+"_"+g)==-1){h[p]+="_"+g;break}}}}var v=ft(l["!ref"]),_=[],b=[],j=[];for(p=0;p<=v.e.c-v.s.c;++p){var N="",k="",S=0,E=[];for(g=0;g<m.length;++g)m[g][p]!=null&&E.push(m[g][p]);if(E.length==0||h[p]==null){_[p]="?";continue}for(g=0;g<E.length;++g){switch(typeof E[g]){case"number":k="B";break;case"string":k="C";break;case"boolean":k="L";break;case"object":k=E[g]instanceof Date?"D":"C";break;default:k="C"}S=Math.max(S,String(E[g]).length),N=N&&N!=k?"C":k}S>250&&(S=250),k=((x[p]||{}).DBF||{}).type,k=="C"&&x[p].DBF.len>S&&(S=x[p].DBF.len),N=="B"&&k=="N"&&(N="N",j[p]=x[p].DBF.dec,S=x[p].DBF.len),b[p]=N=="C"||k=="N"?S:i[N]||0,w+=b[p],_[p]=N}var P=u.next(32);for(P.write_shift(4,318902576),P.write_shift(4,m.length),P.write_shift(2,296+32*y),P.write_shift(2,w),p=0;p<4;++p)P.write_shift(4,0);for(P.write_shift(4,0|(+t[XS]||3)<<8),p=0,g=0;p<h.length;++p)if(h[p]!=null){var C=u.next(32),T=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);C.write_shift(1,T,"sbcs"),C.write_shift(1,_[p]=="?"?"C":_[p],"sbcs"),C.write_shift(4,g),C.write_shift(1,b[p]||i[_[p]]||0),C.write_shift(1,j[p]||0),C.write_shift(1,2),C.write_shift(4,0),C.write_shift(1,0),C.write_shift(4,0),C.write_shift(4,0),g+=b[p]||i[_[p]]||0}var M=u.next(264);for(M.write_shift(4,13),p=0;p<65;++p)M.write_shift(4,0);for(p=0;p<m.length;++p){var A=u.next(w);for(A.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(_[g]){case"L":A.write_shift(1,m[p][g]==null?63:m[p][g]?84:70);break;case"B":A.write_shift(8,m[p][g]||0,"f");break;case"N":var F="0";for(typeof m[p][g]=="number"&&(F=m[p][g].toFixed(j[g]||0)),y=0;y<b[g]-F.length;++y)A.write_shift(1,32);A.write_shift(1,F,"sbcs");break;case"D":m[p][g]?(A.write_shift(4,("0000"+m[p][g].getFullYear()).slice(-4),"sbcs"),A.write_shift(2,("00"+(m[p][g].getMonth()+1)).slice(-2),"sbcs"),A.write_shift(2,("00"+m[p][g].getDate()).slice(-2),"sbcs")):A.write_shift(8,"00000000","sbcs");break;case"C":var H=String(m[p][g]!=null?m[p][g]:"").slice(0,b[g]);for(A.write_shift(1,H,"sbcs"),y=0;y<b[g]-H.length;++y)A.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:a,from_sheet:o}}(),ok=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Qt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,m){var x=e[m];return typeof x=="number"?iw(x):x},a=function(h,m,x){var p=m.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return p==59?h:iw(p)};e["|"]=254;function s(h,m){switch(m.type){case"base64":return i(Pa(h),m);case"binary":return i(h,m);case"buffer":return i(rt&&Buffer.isBuffer(h)?h.toString("binary"):Is(h),m);case"array":return i(Si(h),m)}throw new Error("Unrecognized type "+m.type)}function i(h,m){var x=h.split(/[\n\r]+/),p=-1,g=-1,y=0,w=0,v=[],_=[],b=null,j={},N=[],k=[],S=[],E=0,P;for(+m.codepage>=0&&nn(+m.codepage);y!==x.length;++y){E=0;var C=x[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),T=C.replace(/;;/g,"\0").split(";").map(function(W){return W.replace(/\u0000/g,";")}),M=T[0],A;if(C.length>0)switch(M){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":T[1].charAt(0)=="P"&&_.push(C.slice(3).replace(/;;/g,";"));break;case"C":var F=!1,H=!1,V=!1,B=!1,L=-1,ee=-1;for(w=1;w<T.length;++w)switch(T[w].charAt(0)){case"A":break;case"X":g=parseInt(T[w].slice(1))-1,H=!0;break;case"Y":for(p=parseInt(T[w].slice(1))-1,H||(g=0),P=v.length;P<=p;++P)v[P]=[];break;case"K":A=T[w].slice(1),A.charAt(0)==='"'?A=A.slice(1,A.length-1):A==="TRUE"?A=!0:A==="FALSE"?A=!1:isNaN(ln(A))?isNaN(Wo(A).getDate())||(A=Lt(A)):(A=ln(A),b!==null&&ol(b)&&(A=C0(A))),F=!0;break;case"E":B=!0;var I=ho(T[w].slice(1),{r:p,c:g});v[p][g]=[v[p][g],I];break;case"S":V=!0,v[p][g]=[v[p][g],"S5S"];break;case"G":break;case"R":L=parseInt(T[w].slice(1))-1;break;case"C":ee=parseInt(T[w].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+C)}if(F&&(v[p][g]&&v[p][g].length==2?v[p][g][0]=A:v[p][g]=A,b=null),V){if(B)throw new Error("SYLK shared formula cannot have own formula");var K=L>-1&&v[L][ee];if(!K||!K[1])throw new Error("SYLK shared formula cannot find base");v[p][g][1]=Sk(K[1],{r:p-L,c:g-ee})}break;case"F":var z=0;for(w=1;w<T.length;++w)switch(T[w].charAt(0)){case"X":g=parseInt(T[w].slice(1))-1,++z;break;case"Y":for(p=parseInt(T[w].slice(1))-1,P=v.length;P<=p;++P)v[P]=[];break;case"M":E=parseInt(T[w].slice(1))/20;break;case"F":break;case"G":break;case"P":b=_[parseInt(T[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=T[w].slice(1).split(" "),P=parseInt(S[0],10);P<=parseInt(S[1],10);++P)E=parseInt(S[2],10),k[P-1]=E===0?{hidden:!0}:{wch:E},_s(k[P-1]);break;case"C":g=parseInt(T[w].slice(1))-1,k[g]||(k[g]={});break;case"R":p=parseInt(T[w].slice(1))-1,N[p]||(N[p]={}),E>0?(N[p].hpt=E,N[p].hpx=zo(E)):E===0&&(N[p].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+C)}z<1&&(b=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+C)}}return N.length>0&&(j["!rows"]=N),k.length>0&&(j["!cols"]=k),m&&m.sheetRows&&(v=v.slice(0,m.sheetRows)),[v,j]}function o(h,m){var x=s(h,m),p=x[0],g=x[1],y=cl(p,m);return Qt(g).forEach(function(w){y[w]=g[w]}),y}function l(h,m){return Ds(o(h,m),m)}function c(h,m,x,p){var g="C;Y"+(x+1)+";X"+(p+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+Sg(h.f,{r:x,c:p}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function d(h,m){m.forEach(function(x,p){var g="F;W"+(p+1)+" "+(p+1)+" ";x.hidden?g+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=Zc(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=Qc(x.wpx)),typeof x.wch=="number"&&(g+=Math.round(x.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function u(h,m){m.forEach(function(x,p){var g="F;";x.hidden?g+="M0;":x.hpt?g+="M"+20*x.hpt+";":x.hpx&&(g+="M"+20*ed(x.hpx)+";"),g.length>2&&h.push(g+"R"+(p+1))})}function f(h,m){var x=["ID;PWXL;N;E"],p=[],g=ft(h["!ref"]),y,w=Array.isArray(h),v=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),h["!cols"]&&d(x,h["!cols"]),h["!rows"]&&u(x,h["!rows"]),x.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var _=g.s.r;_<=g.e.r;++_)for(var b=g.s.c;b<=g.e.c;++b){var j=Le({r:_,c:b});y=w?(h[_]||[])[b]:h[j],!(!y||y.v==null&&(!y.f||y.F))&&p.push(c(y,h,_,b))}return x.join(v)+v+p.join(v)+v+"E"+v}return{to_workbook:l,to_sheet:o,from_sheet:f}}(),lk=function(){function e(i,o){switch(o.type){case"base64":return t(Pa(i),o);case"binary":return t(i,o);case"buffer":return t(rt&&Buffer.isBuffer(i)?i.toString("binary"):Is(i),o);case"array":return t(Si(i),o)}throw new Error("Unrecognized type "+o.type)}function t(i,o){for(var l=i.split(`
`),c=-1,d=-1,u=0,f=[];u!==l.length;++u){if(l[u].trim()==="BOT"){f[++c]=[],d=0;continue}if(!(c<0)){var h=l[u].trim().split(","),m=h[0],x=h[1];++u;for(var p=l[u]||"";(p.match(/["]/g)||[]).length&1&&u<l.length-1;)p+=`
`+l[++u];switch(p=p.trim(),+m){case-1:if(p==="BOT"){f[++c]=[],d=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[c][d]=!0:p==="FALSE"?f[c][d]=!1:isNaN(ln(x))?isNaN(Wo(x).getDate())?f[c][d]=x:f[c][d]=Lt(x):f[c][d]=ln(x),++d;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[c][d++]=p!==""?p:null;break}if(p==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(i,o){return cl(e(i,o),o)}function a(i,o){return Ds(r(i,o),o)}var s=function(){var i=function(c,d,u,f,h){c.push(d),c.push(u+","+f),c.push('"'+h.replace(/"/g,'""')+'"')},o=function(c,d,u,f){c.push(d+","+u),c.push(d==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var d=[],u=ft(c["!ref"]),f,h=Array.isArray(c);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,u.e.r-u.s.r+1,""),i(d,"TUPLES",0,u.e.c-u.s.c+1,""),i(d,"DATA",0,0,"");for(var m=u.s.r;m<=u.e.r;++m){o(d,-1,0,"BOT");for(var x=u.s.c;x<=u.e.c;++x){var p=Le({r:m,c:x});if(f=h?(c[m]||[])[x]:c[p],!f){o(d,1,0,"");continue}switch(f.t){case"n":var g=f.w;!g&&f.v!=null&&(g=f.v),g==null?f.f&&!f.F?o(d,1,0,"="+f.f):o(d,1,0,""):o(d,0,g,"V");break;case"b":o(d,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=qa(f.z||Me[14],Nr(Lt(f.v)))),o(d,0,f.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var y=`\r
`,w=d.join(y);return w}}();return{to_workbook:a,to_sheet:r,from_sheet:s}}(),ck=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var m=f.split(`
`),x=-1,p=-1,g=0,y=[];g!==m.length;++g){var w=m[g].trim().split(":");if(w[0]==="cell"){var v=qt(w[1]);if(y.length<=v.r)for(x=y.length;x<=v.r;++x)y[x]||(y[x]=[]);switch(x=v.r,p=v.c,w[2]){case"t":y[x][p]=e(w[3]);break;case"v":y[x][p]=+w[3];break;case"vtf":var _=w[w.length-1];case"vtc":switch(w[3]){case"nl":y[x][p]=!!+w[4];break;default:y[x][p]=+w[4];break}w[2]=="vtf"&&(y[x][p]=[y[x][p],_])}}}return h&&h.sheetRows&&(y=y.slice(0,h.sheetRows)),y}function a(f,h){return cl(r(f,h),h)}function s(f,h){return Ds(a(f,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function d(f){if(!f||!f["!ref"])return"";for(var h=[],m=[],x,p="",g=pa(f["!ref"]),y=Array.isArray(f),w=g.s.r;w<=g.e.r;++w)for(var v=g.s.c;v<=g.e.c;++v)if(p=Le({r:w,c:v}),x=y?(f[w]||[])[v]:f[p],!(!x||x.v==null||x.t==="z")){switch(m=["cell",p,"t"],x.t){case"s":case"str":m.push(t(x.v));break;case"n":x.f?(m[2]="vtf",m[3]="n",m[4]=x.v,m[5]=t(x.f)):(m[2]="v",m[3]=x.v);break;case"b":m[2]="vt"+(x.f?"f":"c"),m[3]="nl",m[4]=x.v?"1":"0",m[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var _=Nr(Lt(x.v));m[2]="vtc",m[3]="nd",m[4]=""+_,m[5]=x.w||qa(x.z||Me[14],_);break;case"e":continue}h.push(m.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(f){return[i,o,l,o,d(f),c].join(`
`)}return{to_workbook:s,to_sheet:a,from_sheet:u}}(),Ho=function(){function e(u,f,h,m,x){x.raw?f[h][m]=u:u===""||(u==="TRUE"?f[h][m]=!0:u==="FALSE"?f[h][m]=!1:isNaN(ln(u))?isNaN(Wo(u).getDate())?f[h][m]=u:f[h][m]=Lt(u):f[h][m]=ln(u))}function t(u,f){var h=f||{},m=[];if(!u||u.length===0)return m;for(var x=u.split(/[\r\n]/),p=x.length-1;p>=0&&x[p].length===0;)--p;for(var g=10,y=0,w=0;w<=p;++w)y=x[w].indexOf(" "),y==-1?y=x[w].length:y++,g=Math.max(g,y);for(w=0;w<=p;++w){m[w]=[];var v=0;for(e(x[w].slice(0,g).trim(),m,w,v,h),v=1;v<=(x[w].length-g)/10+1;++v)e(x[w].slice(g+(v-1)*10,g+v*10).trim(),m,w,v,h)}return h.sheetRows&&(m=m.slice(0,h.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function s(u){for(var f={},h=!1,m=0,x=0;m<u.length;++m)(x=u.charCodeAt(m))==34?h=!h:!h&&x in r&&(f[x]=(f[x]||0)+1);x=[];for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&x.push([f[m],m]);if(!x.length){f=a;for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&x.push([f[m],m])}return x.sort(function(p,g){return p[0]-g[0]||a[p[1]]-a[g[1]]}),r[x.pop()[1]]||44}function i(u,f){var h=f||{},m="",x=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(m=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(m=u.charAt(4),u=u.slice(6)):m=s(u.slice(0,1024)):h&&h.FS?m=h.FS:m=s(u.slice(0,1024));var g=0,y=0,w=0,v=0,_=0,b=m.charCodeAt(0),j=!1,N=0,k=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var S=h.dateNF!=null?DQ(h.dateNF):null;function E(){var P=u.slice(v,_),C={};if(P.charAt(0)=='"'&&P.charAt(P.length-1)=='"'&&(P=P.slice(1,-1).replace(/""/g,'"')),P.length===0)C.t="z";else if(h.raw)C.t="s",C.v=P;else if(P.trim().length===0)C.t="s",C.v=P;else if(P.charCodeAt(0)==61)P.charCodeAt(1)==34&&P.charCodeAt(P.length-1)==34?(C.t="s",C.v=P.slice(2,-1).replace(/""/g,'"')):dse(P)?(C.t="n",C.f=P.slice(1)):(C.t="s",C.v=P);else if(P=="TRUE")C.t="b",C.v=!0;else if(P=="FALSE")C.t="b",C.v=!1;else if(!isNaN(w=ln(P)))C.t="n",h.cellText!==!1&&(C.w=P),C.v=w;else if(!isNaN(Wo(P).getDate())||S&&P.match(S)){C.z=h.dateNF||Me[14];var T=0;S&&P.match(S)&&(P=RQ(P,h.dateNF,P.match(S)||[]),T=1),h.cellDates?(C.t="d",C.v=Lt(P,T)):(C.t="n",C.v=Nr(Lt(P,T))),h.cellText!==!1&&(C.w=qa(C.z,C.v instanceof Date?Nr(C.v):C.v)),h.cellNF||delete C.z}else C.t="s",C.v=P;if(C.t=="z"||(h.dense?(x[g]||(x[g]=[]),x[g][y]=C):x[Le({c:y,r:g})]=C),v=_+1,k=u.charCodeAt(v),p.e.c<y&&(p.e.c=y),p.e.r<g&&(p.e.r=g),N==b)++y;else if(y=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;_<u.length;++_)switch(N=u.charCodeAt(_)){case 34:k===34&&(j=!j);break;case b:case 10:case 13:if(!j&&E())break e;break}return _-v>0&&E(),x["!ref"]=Xe(p),x}function o(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,f):cl(t(u,f),f)}function l(u,f){var h="",m=f.type=="string"?[0,0,0,0]:Fg(u,f);switch(f.type){case"base64":h=Pa(u);break;case"binary":h=u;break;case"buffer":f.codepage==65001?h=u.toString("utf8"):f.codepage&&typeof zc<"u"||(h=rt&&Buffer.isBuffer(u)?u.toString("binary"):Is(u));break;case"array":h=Si(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+f.type)}return m[0]==239&&m[1]==187&&m[2]==191?h=Ot(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=Ot(h):f.type=="binary"&&typeof zc<"u",h.slice(0,19)=="socialcalc:version:"?ck.to_sheet(f.type=="string"?h:Ot(h),f):o(h,f)}function c(u,f){return Ds(l(u,f),f)}function d(u){for(var f=[],h=ft(u["!ref"]),m,x=Array.isArray(u),p=h.s.r;p<=h.e.r;++p){for(var g=[],y=h.s.c;y<=h.e.c;++y){var w=Le({r:p,c:y});if(m=x?(u[p]||[])[y]:u[w],!m||m.v==null){g.push("          ");continue}for(var v=(m.w||(rs(m),m.w)||"").slice(0,10);v.length<10;)v+=" ";g.push(v+(y===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:d}}();function Yre(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var s=ok.to_workbook(e,r);return r.WTF=a,s}catch(i){if(r.WTF=a,!i.message.match(/SYLK bad record ID/)&&a)throw i;return Ho.to_workbook(e,t)}}var di=function(){function e(I,K,z){if(I){Rr(I,I.l||0);for(var W=z.Enum||L;I.l<I.length;){var re=I.read_shift(2),xe=W[re]||W[65535],me=I.read_shift(2),Q=I.l+me,q=xe.f&&xe.f(I,me,z);if(I.l=Q,K(q,xe,re))return}}}function t(I,K){switch(K.type){case"base64":return r(_a(Pa(I)),K);case"binary":return r(_a(I),K);case"buffer":case"array":return r(I,K)}throw"Unsupported type "+K.type}function r(I,K){if(!I)return I;var z=K||{},W=z.dense?[]:{},re="Sheet1",xe="",me=0,Q={},q=[],se=[],D={s:{r:0,c:0},e:{r:0,c:0}},ve=z.sheetRows||0;if(I[2]==0&&(I[3]==8||I[3]==9)&&I.length>=16&&I[14]==5&&I[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(I[2]==2)z.Enum=L,e(I,function(he,oe,Ve){switch(Ve){case 0:z.vers=he,he>=4096&&(z.qpro=!0);break;case 6:D=he;break;case 204:he&&(xe=he);break;case 222:xe=he;break;case 15:case 51:z.qpro||(he[1].v=he[1].v.slice(1));case 13:case 14:case 16:Ve==14&&(he[2]&112)==112&&(he[2]&15)>1&&(he[2]&15)<15&&(he[1].z=z.dateNF||Me[14],z.cellDates&&(he[1].t="d",he[1].v=C0(he[1].v))),z.qpro&&he[3]>me&&(W["!ref"]=Xe(D),Q[re]=W,q.push(re),W=z.dense?[]:{},D={s:{r:0,c:0},e:{r:0,c:0}},me=he[3],re=xe||"Sheet"+(me+1),xe="");var ct=z.dense?(W[he[0].r]||[])[he[0].c]:W[Le(he[0])];if(ct){ct.t=he[1].t,ct.v=he[1].v,he[1].z!=null&&(ct.z=he[1].z),he[1].f!=null&&(ct.f=he[1].f);break}z.dense?(W[he[0].r]||(W[he[0].r]=[]),W[he[0].r][he[0].c]=he[1]):W[Le(he[0])]=he[1];break}},z);else if(I[2]==26||I[2]==14)z.Enum=ee,I[2]==14&&(z.qpro=!0,I.l=0),e(I,function(he,oe,Ve){switch(Ve){case 204:re=he;break;case 22:he[1].v=he[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(he[3]>me&&(W["!ref"]=Xe(D),Q[re]=W,q.push(re),W=z.dense?[]:{},D={s:{r:0,c:0},e:{r:0,c:0}},me=he[3],re="Sheet"+(me+1)),ve>0&&he[0].r>=ve)break;z.dense?(W[he[0].r]||(W[he[0].r]=[]),W[he[0].r][he[0].c]=he[1]):W[Le(he[0])]=he[1],D.e.c<he[0].c&&(D.e.c=he[0].c),D.e.r<he[0].r&&(D.e.r=he[0].r);break;case 27:he[14e3]&&(se[he[14e3][0]]=he[14e3][1]);break;case 1537:se[he[0]]=he[1],he[0]==me&&(re=he[1]);break}},z);else throw new Error("Unrecognized LOTUS BOF "+I[2]);if(W["!ref"]=Xe(D),Q[xe||re]=W,q.push(xe||re),!se.length)return{SheetNames:q,Sheets:Q};for(var we={},Ae=[],ce=0;ce<se.length;++ce)Q[q[ce]]?(Ae.push(se[ce]||q[ce]),we[se[ce]]=Q[se[ce]]||Q[q[ce]]):(Ae.push(se[ce]),we[se[ce]]={"!ref":"A1"});return{SheetNames:Ae,Sheets:we}}function a(I,K){var z=K||{};if(+z.codepage>=0&&nn(+z.codepage),z.type=="string")throw new Error("Cannot write WK1 to JS string");var W=ma(),re=ft(I["!ref"]),xe=Array.isArray(I),me=[];Se(W,0,i(1030)),Se(W,6,c(re));for(var Q=Math.min(re.e.r,8191),q=re.s.r;q<=Q;++q)for(var se=or(q),D=re.s.c;D<=re.e.c;++D){q===re.s.r&&(me[D]=Kt(D));var ve=me[D]+se,we=xe?(I[q]||[])[D]:I[ve];if(!(!we||we.t=="z"))if(we.t=="n")(we.v|0)==we.v&&we.v>=-32768&&we.v<=32767?Se(W,13,m(q,D,we.v)):Se(W,14,p(q,D,we.v));else{var Ae=rs(we);Se(W,15,f(q,D,Ae.slice(0,239)))}}return Se(W,1),W.end()}function s(I,K){var z=K||{};if(+z.codepage>=0&&nn(+z.codepage),z.type=="string")throw new Error("Cannot write WK3 to JS string");var W=ma();Se(W,0,o(I));for(var re=0,xe=0;re<I.SheetNames.length;++re)(I.Sheets[I.SheetNames[re]]||{})["!ref"]&&Se(W,27,B(I.SheetNames[re],xe++));var me=0;for(re=0;re<I.SheetNames.length;++re){var Q=I.Sheets[I.SheetNames[re]];if(!(!Q||!Q["!ref"])){for(var q=ft(Q["!ref"]),se=Array.isArray(Q),D=[],ve=Math.min(q.e.r,8191),we=q.s.r;we<=ve;++we)for(var Ae=or(we),ce=q.s.c;ce<=q.e.c;++ce){we===q.s.r&&(D[ce]=Kt(ce));var he=D[ce]+Ae,oe=se?(Q[we]||[])[ce]:Q[he];if(!(!oe||oe.t=="z"))if(oe.t=="n")Se(W,23,E(we,ce,me,oe.v));else{var Ve=rs(oe);Se(W,22,N(we,ce,me,Ve.slice(0,239)))}}++me}}return Se(W,1),W.end()}function i(I){var K=de(2);return K.write_shift(2,I),K}function o(I){var K=de(26);K.write_shift(2,4096),K.write_shift(2,4),K.write_shift(4,0);for(var z=0,W=0,re=0,xe=0;xe<I.SheetNames.length;++xe){var me=I.SheetNames[xe],Q=I.Sheets[me];if(!(!Q||!Q["!ref"])){++re;var q=pa(Q["!ref"]);z<q.e.r&&(z=q.e.r),W<q.e.c&&(W=q.e.c)}}return z>8191&&(z=8191),K.write_shift(2,z),K.write_shift(1,re),K.write_shift(1,W),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(1,1),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(4,0),K}function l(I,K,z){var W={s:{c:0,r:0},e:{c:0,r:0}};return K==8&&z.qpro?(W.s.c=I.read_shift(1),I.l++,W.s.r=I.read_shift(2),W.e.c=I.read_shift(1),I.l++,W.e.r=I.read_shift(2),W):(W.s.c=I.read_shift(2),W.s.r=I.read_shift(2),K==12&&z.qpro&&(I.l+=2),W.e.c=I.read_shift(2),W.e.r=I.read_shift(2),K==12&&z.qpro&&(I.l+=2),W.s.c==65535&&(W.s.c=W.e.c=W.s.r=W.e.r=0),W)}function c(I){var K=de(8);return K.write_shift(2,I.s.c),K.write_shift(2,I.s.r),K.write_shift(2,I.e.c),K.write_shift(2,I.e.r),K}function d(I,K,z){var W=[{c:0,r:0},{t:"n",v:0},0,0];return z.qpro&&z.vers!=20768?(W[0].c=I.read_shift(1),W[3]=I.read_shift(1),W[0].r=I.read_shift(2),I.l+=2):(W[2]=I.read_shift(1),W[0].c=I.read_shift(2),W[0].r=I.read_shift(2)),W}function u(I,K,z){var W=I.l+K,re=d(I,K,z);if(re[1].t="s",z.vers==20768){I.l++;var xe=I.read_shift(1);return re[1].v=I.read_shift(xe,"utf8"),re}return z.qpro&&I.l++,re[1].v=I.read_shift(W-I.l,"cstr"),re}function f(I,K,z){var W=de(7+z.length);W.write_shift(1,255),W.write_shift(2,K),W.write_shift(2,I),W.write_shift(1,39);for(var re=0;re<W.length;++re){var xe=z.charCodeAt(re);W.write_shift(1,xe>=128?95:xe)}return W.write_shift(1,0),W}function h(I,K,z){var W=d(I,K,z);return W[1].v=I.read_shift(2,"i"),W}function m(I,K,z){var W=de(7);return W.write_shift(1,255),W.write_shift(2,K),W.write_shift(2,I),W.write_shift(2,z,"i"),W}function x(I,K,z){var W=d(I,K,z);return W[1].v=I.read_shift(8,"f"),W}function p(I,K,z){var W=de(13);return W.write_shift(1,255),W.write_shift(2,K),W.write_shift(2,I),W.write_shift(8,z,"f"),W}function g(I,K,z){var W=I.l+K,re=d(I,K,z);if(re[1].v=I.read_shift(8,"f"),z.qpro)I.l=W;else{var xe=I.read_shift(2);_(I.slice(I.l,I.l+xe),re),I.l+=xe}return re}function y(I,K,z){var W=K&32768;return K&=-32769,K=(W?I:0)+(K>=8192?K-16384:K),(W?"":"$")+(z?Kt(K):or(K))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function _(I,K){Rr(I,0);for(var z=[],W=0,re="",xe="",me="",Q="";I.l<I.length;){var q=I[I.l++];switch(q){case 0:z.push(I.read_shift(8,"f"));break;case 1:xe=y(K[0].c,I.read_shift(2),!0),re=y(K[0].r,I.read_shift(2),!1),z.push(xe+re);break;case 2:{var se=y(K[0].c,I.read_shift(2),!0),D=y(K[0].r,I.read_shift(2),!1);xe=y(K[0].c,I.read_shift(2),!0),re=y(K[0].r,I.read_shift(2),!1),z.push(se+D+":"+xe+re)}break;case 3:if(I.l<I.length){console.error("WK1 premature formula end");return}break;case 4:z.push("("+z.pop()+")");break;case 5:z.push(I.read_shift(2));break;case 6:{for(var ve="";q=I[I.l++];)ve+=String.fromCharCode(q);z.push('"'+ve.replace(/"/g,'""')+'"')}break;case 8:z.push("-"+z.pop());break;case 23:z.push("+"+z.pop());break;case 22:z.push("NOT("+z.pop()+")");break;case 20:case 21:Q=z.pop(),me=z.pop(),z.push(["AND","OR"][q-20]+"("+me+","+Q+")");break;default:if(q<32&&v[q])Q=z.pop(),me=z.pop(),z.push(me+v[q]+Q);else if(w[q]){if(W=w[q][1],W==69&&(W=I[I.l++]),W>z.length){console.error("WK1 bad formula parse 0x"+q.toString(16)+":|"+z.join("|")+"|");return}var we=z.slice(-W);z.length-=W,z.push(w[q][0]+"("+we.join(",")+")")}else return q<=7?console.error("WK1 invalid opcode "+q.toString(16)):q<=24?console.error("WK1 unsupported op "+q.toString(16)):q<=30?console.error("WK1 invalid opcode "+q.toString(16)):q<=115?console.error("WK1 unsupported function opcode "+q.toString(16)):console.error("WK1 unrecognized opcode "+q.toString(16))}}z.length==1?K[1].f=""+z[0]:console.error("WK1 bad formula parse |"+z.join("|")+"|")}function b(I){var K=[{c:0,r:0},{t:"n",v:0},0];return K[0].r=I.read_shift(2),K[3]=I[I.l++],K[0].c=I[I.l++],K}function j(I,K){var z=b(I);return z[1].t="s",z[1].v=I.read_shift(K-4,"cstr"),z}function N(I,K,z,W){var re=de(6+W.length);re.write_shift(2,I),re.write_shift(1,z),re.write_shift(1,K),re.write_shift(1,39);for(var xe=0;xe<W.length;++xe){var me=W.charCodeAt(xe);re.write_shift(1,me>=128?95:me)}return re.write_shift(1,0),re}function k(I,K){var z=b(I);z[1].v=I.read_shift(2);var W=z[1].v>>1;if(z[1].v&1)switch(W&7){case 0:W=(W>>3)*5e3;break;case 1:W=(W>>3)*500;break;case 2:W=(W>>3)/20;break;case 3:W=(W>>3)/200;break;case 4:W=(W>>3)/2e3;break;case 5:W=(W>>3)/2e4;break;case 6:W=(W>>3)/16;break;case 7:W=(W>>3)/64;break}return z[1].v=W,z}function S(I,K){var z=b(I),W=I.read_shift(4),re=I.read_shift(4),xe=I.read_shift(2);if(xe==65535)return W===0&&re===3221225472?(z[1].t="e",z[1].v=15):W===0&&re===3489660928?(z[1].t="e",z[1].v=42):z[1].v=0,z;var me=xe&32768;return xe=(xe&32767)-16446,z[1].v=(1-me*2)*(re*Math.pow(2,xe+32)+W*Math.pow(2,xe)),z}function E(I,K,z,W){var re=de(14);if(re.write_shift(2,I),re.write_shift(1,z),re.write_shift(1,K),W==0)return re.write_shift(4,0),re.write_shift(4,0),re.write_shift(2,65535),re;var xe=0,me=0,Q=0,q=0;return W<0&&(xe=1,W=-W),me=Math.log2(W)|0,W/=Math.pow(2,me-31),q=W>>>0,q&2147483648||(W/=2,++me,q=W>>>0),W-=q,q|=2147483648,q>>>=0,W*=Math.pow(2,32),Q=W>>>0,re.write_shift(4,Q),re.write_shift(4,q),me+=16383+(xe?32768:0),re.write_shift(2,me),re}function P(I,K){var z=S(I);return I.l+=K-14,z}function C(I,K){var z=b(I),W=I.read_shift(4);return z[1].v=W>>6,z}function T(I,K){var z=b(I),W=I.read_shift(8,"f");return z[1].v=W,z}function M(I,K){var z=T(I);return I.l+=K-10,z}function A(I,K){return I[I.l+K-1]==0?I.read_shift(K,"cstr"):""}function F(I,K){var z=I[I.l++];z>K-1&&(z=K-1);for(var W="";W.length<z;)W+=String.fromCharCode(I[I.l++]);return W}function H(I,K,z){if(!(!z.qpro||K<21)){var W=I.read_shift(1);I.l+=17,I.l+=1,I.l+=2;var re=I.read_shift(K-21,"cstr");return[W,re]}}function V(I,K){for(var z={},W=I.l+K;I.l<W;){var re=I.read_shift(2);if(re==14e3){for(z[re]=[0,""],z[re][0]=I.read_shift(2);I[I.l];)z[re][1]+=String.fromCharCode(I[I.l]),I.l++;I.l++}}return z}function B(I,K){var z=de(5+I.length);z.write_shift(2,14e3),z.write_shift(2,K);for(var W=0;W<I.length;++W){var re=I.charCodeAt(W);z[z.l++]=re>127?95:re}return z[z.l++]=0,z}var L={0:{n:"BOF",f:fr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:A},222:{n:"SHEETNAMELP",f:F},65535:{n:""}},ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:j},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:k},25:{n:"FORMULA19",f:P},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:V},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:C},38:{n:"??"},39:{n:"NUMBER27",f:T},40:{n:"FORMULA28",f:M},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:A},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:H},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:s,to_workbook:t}}();function Jre(e){var t={},r=e.match(Zr),a=0,s=!1;if(r)for(;a!=r.length;++a){var i=Be(r[a]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=Yp[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return t}var Zre=function(){var e=Kc("t"),t=Kc("rPr");function r(i){var o=i.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:dt(o[1])},c=i.match(t);return c&&(l.s=Jre(c[1])),l}var a=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(a,"").split(s).map(r).filter(function(l){return l.v})}}(),Qre=function(){var t=/(\r\n|\n)/g;function r(s,i,o){var l=[];s.u&&l.push("text-decoration: underline;"),s.uval&&l.push("text-underline-style:"+s.uval+";"),s.sz&&l.push("font-size:"+s.sz+"pt;"),s.outline&&l.push("text-effect: outline;"),s.shadow&&l.push("text-shadow: auto;"),i.push('<span style="'+l.join("")+'">'),s.b&&(i.push("<b>"),o.push("</b>")),s.i&&(i.push("<i>"),o.push("</i>")),s.strike&&(i.push("<s>"),o.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),s}function a(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(a).join("")}}(),eae=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,tae=/<(?:\w+:)?r>/,rae=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function bg(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=dt(Ot(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=Ot(e),r&&(a.h=ig(a.t))):e.match(tae)&&(a.r=Ot(e),a.t=dt(Ot((e.replace(rae,"").match(eae)||[]).join("").replace(Zr,""))),r&&(a.h=Qre(Zre(a.r)))),a):{t:""}}var aae=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,nae=/<(?:\w+:)?(?:si|sstItem)>/g,sae=/<\/(?:\w+:)?(?:si|sstItem)>/;function iae(e,t){var r=[],a="";if(!e)return r;var s=e.match(aae);if(s){a=s[2].replace(nae,"").split(sae);for(var i=0;i!=a.length;++i){var o=bg(a[i].trim(),t);o!=null&&(r[r.length]=o)}s=Be(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var oae=/^\s|\s$|[\t\n\r]/;function dk(e,t){if(!t.bookSST)return"";var r=[lr];r[r.length]=_e("sst",null,{xmlns:$i[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var s=e[a],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(oae)&&(i+=' xml:space="preserve"'),i+=">"+St(s.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function lae(e){return[e.read_shift(4),e.read_shift(4)]}function cae(e,t){var r=[],a=!1;return ls(e,function(i,o,l){switch(l){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(o.T,!a||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function dae(e,t){return t||(t=de(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var uae=wee;function fae(e){var t=ma();ge(t,159,dae(e));for(var r=0;r<e.length;++r)ge(t,19,uae(e[r]));return ge(t,160),t.end()}function uk(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function Xn(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function hae(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Xn(e,4),t.U=Xn(e,4),t.W=Xn(e,4),t}function mae(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},s=e.read_shift(4),i=[];s-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function xae(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(mae(e));return t}function pae(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function gae(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Xn(e,4),t.U=Xn(e,4),t.W=Xn(e,4),t}function vae(e){var t=gae(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function fk(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var s=!1;switch(a.AlgID){case 26126:case 26127:case 26128:s=a.Flags==36;break;case 26625:s=a.Flags==4;break;case 0:s=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function hk(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function yae(e){var t=Xn(e);switch(t.Minor){case 2:return[t.Minor,bae(e)];case 3:return[t.Minor,wae()];case 4:return[t.Minor,jae(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function bae(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=fk(e,r),s=hk(e,e.length-e.l);return{t:"Std",h:a,v:s}}function wae(){throw new Error("File is password-protected: ECMA-376 Extensible")}function jae(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(Zr,function(i){var o=Be(i);switch(Pn(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){a[l]=o[l]});break;case"<dataIntegrity":a.encryptedHmacKey=o.encryptedHmacKey,a.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(o);break;default:throw o[0]}}),a}function Nae(e,t){var r={},a=r.EncryptionVersionInfo=Xn(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=fk(e,s),t-=s,r.EncryptionVerifier=hk(e,t),r}function _ae(e){var t={},r=t.EncryptionVersionInfo=Xn(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function wg(e){var t=0,r,a=uk(e),s=a.length+1,i,o,l,c,d;for(r=Ns(s),r[0]=a.length,i=1;i!=s;++i)r[i]=a[i-1];for(i=s-1;i>=0;--i)o=r[i],l=t&16384?1:0,c=t<<1&32767,d=l|c,t=d^o;return t^52811}var mk=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(o){return(o/2|o*128)&255},s=function(o,l){return a(o^l)},i=function(o){for(var l=t[o.length-1],c=104,d=o.length-1;d>=0;--d)for(var u=o[d],f=0;f!=7;++f)u&64&&(l^=r[c]),u*=2,--c;return l};return function(o){for(var l=uk(o),c=i(l),d=l.length,u=Ns(16),f=0;f!=16;++f)u[f]=0;var h,m,x;for((d&1)===1&&(h=c>>8,u[d]=s(e[0],h),--d,h=c&255,m=l[l.length-1],u[d]=s(m,h));d>0;)--d,h=c>>8,u[d]=s(l[d],h),--d,h=c&255,u[d]=s(l[d],h);for(d=15,x=15-l.length;x>0;)h=c>>8,u[d]=s(e[x],h),--d,--x,h=c&255,u[d]=s(l[d],h),--d,--x;return u}}(),Sae=function(e,t,r,a,s){s||(s=t),a||(a=mk(e));var i,o;for(i=0;i!=t.length;++i)o=t[i],o^=a[r],o=(o>>5|o<<3)&255,s[i]=o,++r;return[s,r,a]},kae=function(e){var t=0,r=mk(e);return function(a){var s=Sae("",a,t,r);return t=s[1],s[0]}};function Eae(e,t,r,a){var s={key:fr(e),verificationBytes:fr(e)};return r.password&&(s.verifier=wg(r.password)),a.valid=s.verificationBytes===s.verifier,a.valid&&(a.insitu=kae(r.password)),s}function Aae(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=_ae(e):a.Data=Nae(e,t),a}function Tae(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?Aae(e,t-2,a):Eae(e,r.biff>=8?t:t-2,r,a),a}var xk=function(){function e(s,i){switch(i.type){case"base64":return t(Pa(s),i);case"binary":return t(s,i);case"buffer":return t(rt&&Buffer.isBuffer(s)?s.toString("binary"):Is(s),i);case"array":return t(Si(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){var o=i||{},l=o.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,f){Array.isArray(l)&&(l[f]=[]);for(var h=/\\\w+\b/g,m=0,x,p=-1;x=h.exec(u);){switch(x[0]){case"\\cell":var g=u.slice(m,h.lastIndex-x[0].length);if(g[0]==" "&&(g=g.slice(1)),++p,g.length){var y={v:g,t:"s"};Array.isArray(l)?l[f][p]=y:l[Le({r:f,c:p})]=y}break}m=h.lastIndex}p>d.e.c&&(d.e.c=p)}),l["!ref"]=Xe(d),l}function r(s,i){return Ds(e(s,i),i)}function a(s){for(var i=["{\\rtf1\\ansi"],o=ft(s["!ref"]),l,c=Array.isArray(s),d=o.s.r;d<=o.e.r;++d){i.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var f=Le({r:d,c:u});l=c?(s[d]||[])[u]:s[f],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(rs(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}}();function Oae(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Jc(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function Pae(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,s=Math.max(t,r,a),i=Math.min(t,r,a),o=s-i;if(o===0)return[0,0,t];var l=0,c=0,d=s+i;switch(c=o/(d>1?2-d:d),s){case t:l=((r-a)/o+6)%6;break;case r:l=(a-t)/o+2;break;case a:l=(t-r)/o+4;break}return[l/6,c,d/2]}function Cae(e){var t=e[0],r=e[1],a=e[2],s=r*2*(a<.5?a:1-a),i=a-s/2,o=[i,i,i],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=s*l,o[0]+=s,o[1]+=c;break;case 1:c=s*(2-l),o[0]+=c,o[1]+=s;break;case 2:c=s*(l-2),o[1]+=s,o[2]+=c;break;case 3:c=s*(4-l),o[1]+=c,o[2]+=s;break;case 4:c=s*(l-4),o[2]+=s,o[0]+=c;break;case 5:c=s*(6-l),o[2]+=c,o[0]+=s;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function jf(e,t){if(t===0)return e;var r=Pae(Oae(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Jc(Cae(r))}var pk=6,Fae=15,Iae=1,Kr=pk;function Zc(e){return Math.floor((e+Math.round(128/Kr)/256)*Kr)}function Qc(e){return Math.floor((e-5)/Kr*100+.5)/100}function Nf(e){return Math.round((e*Kr+5)/Kr*256)/256}function Nh(e){return Nf(Qc(Zc(e)))}function jg(e){var t=Math.abs(e-Nh(e)),r=Kr;if(t>.005)for(Kr=Iae;Kr<Fae;++Kr)Math.abs(e-Nh(e))<=t&&(t=Math.abs(e-Nh(e)),r=Kr);Kr=r}function _s(e){e.width?(e.wpx=Zc(e.width),e.wch=Qc(e.wpx),e.MDW=Kr):e.wpx?(e.wch=Qc(e.wpx),e.width=Nf(e.wch),e.MDW=Kr):typeof e.wch=="number"&&(e.width=Nf(e.wch),e.wpx=Zc(e.width),e.MDW=Kr),e.customWidth&&delete e.customWidth}var Dae=96,gk=Dae;function ed(e){return e*96/gk}function zo(e){return e*gk/96}var Rae={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Mae(e,t,r,a){t.Borders=[];var s={},i=!1;(e[0].match(Zr)||[]).forEach(function(o){var l=Be(o);switch(Pn(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},l.diagonalUp&&(s.diagonalUp=$t(l.diagonalUp)),l.diagonalDown&&(s.diagonalDown=$t(l.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+l[0]+" in borders")}})}function $ae(e,t,r,a){t.Fills=[];var s={},i=!1;(e[0].match(Zr)||[]).forEach(function(o){var l=Be(o);switch(Pn(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":l.patternType&&(s.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),l.indexed&&(s.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(s.bgColor.theme=parseInt(l.theme,10)),l.tint&&(s.bgColor.tint=parseFloat(l.tint)),l.rgb&&(s.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),l.theme&&(s.fgColor.theme=parseInt(l.theme,10)),l.tint&&(s.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(s.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fills")}})}function Lae(e,t,r,a){t.Fonts=[];var s={},i=!1;(e[0].match(Zr)||[]).forEach(function(o){var l=Be(o);switch(Pn(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":l.val&&(s.name=Ot(l.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=l.val?$t(l.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=l.val?$t(l.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(l.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=l.val?$t(l.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=l.val?$t(l.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=l.val?$t(l.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=l.val?$t(l.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=l.val?$t(l.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":l.val&&(s.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(s.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(s.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(s.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Yp[parseInt(l.val,10)];break;case"<color":if(s.color||(s.color={}),l.auto&&(s.color.auto=$t(l.auto)),l.rgb)s.color.rgb=l.rgb.slice(-6);else if(l.indexed){s.color.index=parseInt(l.indexed,10);var c=li[s.color.index];s.color.index==81&&(c=li[1]),c||(c=li[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(s.color.theme=parseInt(l.theme,10),l.tint&&(s.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=jf(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fonts")}})}function Bae(e,t,r){t.NumberFmt=[];for(var a=Qt(Me),s=0;s<a.length;++s)t.NumberFmt[a[s]]=Me[a[s]];var i=e[0].match(Zr);if(i)for(s=0;s<i.length;++s){var o=Be(i[s]);switch(Pn(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=dt(Ot(o.formatCode)),c=parseInt(o.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}qn(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function Uae(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=_e("numFmt",null,{numFmtId:a,formatCode:St(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=_e("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Jd=["numFmtId","fillId","fontId","borderId","xfId"],Zd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Wae(e,t,r){t.CellXf=[];var a,s=!1;(e[0].match(Zr)||[]).forEach(function(i){var o=Be(i),l=0;switch(Pn(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=o,delete a[0],l=0;l<Jd.length;++l)a[Jd[l]]&&(a[Jd[l]]=parseInt(a[Jd[l]],10));for(l=0;l<Zd.length;++l)a[Zd[l]]&&(a[Zd[l]]=$t(a[Zd[l]]));if(t.NumberFmt&&a.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[l]){a.numFmtId=l;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=$t(o.wrapText)),a.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function Hae(e){var t=[];return t[t.length]=_e("cellXfs",null),e.forEach(function(r){t[t.length]=_e("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=_e("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var zae=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,d){var u={};if(!l)return u;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(t))&&Bae(f,u,d),(f=l.match(s))&&Lae(f,u,c,d),(f=l.match(a))&&$ae(f,u,c,d),(f=l.match(i))&&Mae(f,u,c,d),(f=l.match(r))&&Wae(f,u,d),u}}();function vk(e,t){var r=[lr,_e("styleSheet",null,{xmlns:$i[0],"xmlns:vt":yr.vt})],a;return e.SSF&&(a=Uae(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=Hae(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Vae(e,t){var r=e.read_shift(2),a=Xr(e);return[r,a]}function Gae(e,t,r){r||(r=de(6+4*t.length)),r.write_shift(2,e),Or(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function Kae(e,t,r){var a={};a.sz=e.read_shift(2)/20;var s=Aee(e);s.fItalic&&(a.italic=1),s.fCondense&&(a.condense=1),s.fExtend&&(a.extend=1),s.fShadow&&(a.shadow=1),s.fOutline&&(a.outline=1),s.fStrikeout&&(a.strike=1);var i=e.read_shift(2);switch(i===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(a.underline=o);var l=e.read_shift(1);l>0&&(a.family=l);var c=e.read_shift(1);switch(c>0&&(a.charset=c),e.l++,a.color=Eee(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Xr(e),a}function qae(e,t){t||(t=de(25+4*32)),t.write_shift(2,e.sz*20),Tee(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),yf(e.color,t);var a=0;return a=2,t.write_shift(1,a),Or(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Xae=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],_h,Yae=Yr;function Yw(e,t){t||(t=de(4*3+8*7+16*1)),_h||(_h=O0(Xae));var r=_h[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(yf({auto:1},t),yf({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Jae(e,t){var r=e.l+t,a=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:s}}function yk(e,t,r){r||(r=de(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function kl(e,t){return t||(t=de(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Zae=Yr;function Qae(e,t){return t||(t=de(51)),t.write_shift(1,0),kl(null,t),kl(null,t),kl(null,t),kl(null,t),kl(null,t),t.length>t.l?t.slice(0,t.l):t}function ene(e,t){return t||(t=de(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),vf(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function tne(e,t,r){var a=de(2052);return a.write_shift(4,e),vf(t,a),vf(r,a),a.length>a.l?a.slice(0,a.l):a}function rne(e,t,r){var a={};a.NumberFmt=[];for(var s in Me)a.NumberFmt[s]=Me[s];a.CellXf=[],a.Fonts=[];var i=[],o=!1;return ls(e,function(c,d,u){switch(u){case 44:a.NumberFmt[c[0]]=c[1],qn(c[1],c[0]);break;case 43:a.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=jf(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&a.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(u),o=!0;break;case 38:i.pop(),o=!1;break;default:if(d.T>0)i.push(u);else if(d.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),a}function ane(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&++r}),r!=0&&(ge(e,615,cn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&ge(e,44,Gae(s,t[s]))}),ge(e,616))}}function nne(e){var t=1;ge(e,611,cn(t)),ge(e,43,qae({sz:12,color:{theme:1},name:"Calibri",family:2})),ge(e,612)}function sne(e){var t=2;ge(e,603,cn(t)),ge(e,45,Yw({patternType:"none"})),ge(e,45,Yw({patternType:"gray125"})),ge(e,604)}function ine(e){var t=1;ge(e,613,cn(t)),ge(e,46,Qae()),ge(e,614)}function one(e){var t=1;ge(e,626,cn(t)),ge(e,47,yk({numFmtId:0},65535)),ge(e,627)}function lne(e,t){ge(e,617,cn(t.length)),t.forEach(function(r){ge(e,47,yk(r,0))}),ge(e,618)}function cne(e){var t=1;ge(e,619,cn(t)),ge(e,48,ene({xfId:0,name:"Normal"})),ge(e,620)}function dne(e){var t=0;ge(e,505,cn(t)),ge(e,506)}function une(e){var t=0;ge(e,508,tne(t,"TableStyleMedium9","PivotStyleMedium4")),ge(e,509)}function fne(e,t){var r=ma();return ge(r,278),ane(r,e.SSF),nne(r),sne(r),ine(r),one(r),lne(r,t.cellXfs),cne(r),dne(r),une(r),ge(r,279),r.end()}var hne=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function mne(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(Zr)||[]).forEach(function(s){var i=Be(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=i.val;break;case"<a:sysClr":a.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[hne.indexOf(i[0])]=a,a={}):a.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function xne(){}function pne(){}var gne=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,vne=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,yne=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function bne(e,t,r){t.themeElements={};var a;[["clrScheme",gne,mne],["fontScheme",vne,xne],["fmtScheme",yne,pne]].forEach(function(s){if(!(a=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](a,t,r)})}var wne=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function bk(e,t){(!e||e.length===0)&&(e=Ng());var r,a={};if(!(r=e.match(wne)))throw new Error("themeElements not found in theme");return bne(r[0],a,t),a.raw=e,a}function Ng(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[lr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function jne(e,t,r){var a=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=a;return}var i=e.slice(e.l);e.l=a;var o;try{o=f4(i,{type:"array"})}catch{return}var l=Sa(o,"theme/theme/theme1.xml",!0);if(l)return bk(l,r)}}function Nne(e){return e.read_shift(4)}function _ne(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Sne(e,4);break;case 2:t.xclrValue=Q4(e);break;case 3:t.xclrValue=Nne(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Sne(e,t){return Yr(e,t)}function kne(e,t){return Yr(e,t)}function Ene(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=_ne(e);break;case 6:a[1]=kne(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function Ane(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),i=[];s-- >0;)i.push(Ene(e,r-e.l));return{ixfe:a,ext:i}}function Tne(e,t){t.forEach(function(r){switch(r[0]){}})}function One(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Xr(e)}}function Pne(e){var t=de(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Or(e.name,t),t.slice(0,t.l)}function Cne(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Fne(e){var t=de(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Ine(e,t){var r=de(8+2*t.length);return r.write_shift(4,e),Or(t,r),r.slice(0,r.l)}function Dne(e){return e.l+=4,e.read_shift(4)!=0}function Rne(e,t){var r=de(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Mne(e,t,r){var a={Types:[],Cell:[],Value:[]},s=r||{},i=[],o=!1,l=2;return ls(e,function(c,d,u){switch(u){case 335:a.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?a.Cell.push({type:a.Types[f[0]-1].name,index:f[1]}):l==0&&a.Value.push({type:a.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:i.push(u),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!d.T){if(!o||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),a}function $ne(){var e=ma();return ge(e,332),ge(e,334,cn(1)),ge(e,335,Pne({name:"XLDAPR",version:12e4,flags:3496657072})),ge(e,336),ge(e,339,Ine(1,"XLDAPR")),ge(e,52),ge(e,35,cn(514)),ge(e,4096,cn(0)),ge(e,4097,Ua(1)),ge(e,36),ge(e,53),ge(e,340),ge(e,337,Rne(1)),ge(e,51,Fne([[1,0]])),ge(e,338),ge(e,333),e.end()}function Lne(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var s=!1,i=2,o;return e.replace(Zr,function(l){var c=Be(l);switch(Pn(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<a.Types.length;++d)a.Types[d].name==c.name&&(o=a.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?a.Cell.push({type:a.Types[c.t-1].name,index:+c.v}):i==0&&a.Value.push({type:a.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),a}function wk(){var e=[lr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Bne(e){var t=[];if(!e)return t;var r=1;return(e.match(Zr)||[]).forEach(function(a){var s=Be(a);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function Une(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Le(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function Wne(e,t,r){var a=[];return ls(e,function(i,o,l){switch(l){case 63:a.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),a}function Hne(e,t,r,a){if(!e)return e;var s=a||{},i=!1;ls(e,function(l,c,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},s)}function zne(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var so=1024;function jk(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[_e("xml",null,{"xmlns:v":wa.v,"xmlns:o":wa.o,"xmlns:x":wa.x,"xmlns:mv":wa.mv}).replace(/\/>/,">"),_e("o:shapelayout",_e("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),_e("v:shapetype",[_e("v:stroke",null,{joinstyle:"miter"}),_e("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];so<e*1e3;)so+=1e3;return t.forEach(function(i){var o=qt(i[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?_e("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=_e("v:fill",c,l),u={on:"t",obscured:"t"};++so,s=s.concat(["<v:shape"+qc({id:"_x0000_s"+so,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,_e("v:shadow",null,u),_e("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",$r("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),$r("x:AutoFill","False"),$r("x:Row",String(o.r)),$r("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function Jw(e,t,r,a){var s=Array.isArray(e),i;t.forEach(function(o){var l=qt(o.ref);if(s?(e[l.r]||(e[l.r]=[]),i=e[l.r][l.c]):i=e[o.ref],!i){i={t:"z"},s?e[l.r][l.c]=i:e[o.ref]=i;var c=ft(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var d=Xe(c);d!==e["!ref"]&&(e["!ref"]=d)}i.c||(i.c=[]);var u={a:o.author,t:o.t,r:o.r,T:r};o.h&&(u.h=o.h);for(var f=i.c.length-1;f>=0;--f){if(!r&&i.c[f].T)return;r&&!i.c[f].T&&i.c.splice(f,1)}if(r&&a){for(f=0;f<a.length;++f)if(u.a==a[f].id){u.a=a[f].name||u.a;break}}i.c.push(u)})}function Vne(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Be(l[0]),d={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},u=qt(c.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&bg(f[1])||{r:"",t:"",h:""};d.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),d.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=h.h),a.push(d)}}}}),a}function Nk(e){var t=[lr,_e("comments",null,{xmlns:$i[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(s){var i=St(s.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var s=0,i=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?s=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(c){c.a&&(s=r.indexOf(St(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+s+'"><text>'),i.length<=1)t.push($r("t",St(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,l=1;l<i.length;++l)o+=`Reply:
    `+i[l]+`
`;t.push($r("t",St(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Gne(e,t){var r=[],a=!1,s={},i=0;return e.replace(Zr,function(l,c){var d=Be(l);switch(Pn(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=c+l.length;break;case"</text>":s.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return l}),r}function Kne(e,t,r){var a=[lr,_e("ThreadedComments",null,{xmlns:yr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var i="";(s[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?i=c.id:c.parentId=i,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),a.push(_e("threadedComment",$r("text",o.t||""),c))})}),a.push("</ThreadedComments>"),a.join("")}function qne(e,t){var r=[],a=!1;return e.replace(Zr,function(i){var o=Be(i);switch(Pn(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function Xne(e){var t=[lr,_e("personList",null,{xmlns:yr.TCMNT,"xmlns:x":$i[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(_e("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function Yne(e){var t={};t.iauthor=e.read_shift(4);var r=Wi(e);return t.rfx=r.s,t.ref=Le(r.s),e.l+=16,t}function Jne(e,t){return t==null&&(t=de(36)),t.write_shift(4,e[1].iauthor),dl(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var Zne=Xr;function Qne(e){return Or(e.slice(0,54))}function ese(e,t){var r=[],a=[],s={},i=!1;return ls(e,function(l,c,d){switch(d){case 632:a.push(l);break;case 635:s=l;break;case 637:s.t=l.t,s.h=l.h,s.r=l.r;break;case 636:if(s.author=a[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function tse(e){var t=ma(),r=[];return ge(t,628),ge(t,630),e.forEach(function(a){a[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),ge(t,632,Qne(s.a)))})}),ge(t,631),ge(t,633),e.forEach(function(a){a[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var i={s:qt(a[0]),e:qt(a[0])};ge(t,635,Jne([i,s])),s.t&&s.t.length>0&&ge(t,637,Nee(s)),ge(t,636),delete s.iauthor})}),ge(t,634),ge(t,629),t.end()}var rse="application/vnd.ms-office.vbaProject";function ase(e){var t=Fe.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Fe.utils.cfb_add(t,s,e.FileIndex[a].content)}}),Fe.write(t)}function nse(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Fe.utils.cfb_add(e,s,t.FileIndex[a].content)}})}var _k=["xlsb","xlsm","xlam","biff8","xla"];function sse(){return{"!type":"dialog"}}function ise(){return{"!type":"dialog"}}function ose(){return{"!type":"macro"}}function lse(){return{"!type":"macro"}}var ho=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,s,i,o){var l=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return l?u+=t.c:--u,c?d+=t.r:--d,s+(l?"":"$")+Kt(u)+(c?"":"$")+or(d)}return function(s,i){return t=i,s.replace(e,r)}}(),_g=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Sg=function(){return function(t,r){return t.replace(_g,function(a,s,i,o,l,c){var d=ug(o)-(i?0:r.c),u=dg(c)-(l?0:r.r),f=u==0?"":l?u+1:"["+u+"]",h=d==0?"":i?d+1:"["+d+"]";return s+"R"+f+"C"+h})}}();function Sk(e,t){return e.replace(_g,function(r,a,s,i,o,l){return a+(s=="$"?s+i:Kt(ug(i)+t.c))+(o=="$"?o+l:or(dg(l)+t.r))})}function cse(e,t,r){var a=pa(t),s=a.s,i=qt(r),o={r:i.r-s.r,c:i.c-s.c};return Sk(e,o)}function dse(e){return e.length!=1}function Zw(e){return e.replace(/_xlfn\./g,"")}function cr(e){e.l+=1}function Ss(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function kk(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return Ek(e);r.biff==12&&(a=4)}var s=e.read_shift(a),i=e.read_shift(a),o=Ss(e),l=Ss(e);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function Ek(e){var t=Ss(e),r=Ss(e),a=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function use(e,t,r){if(r.biff<8)return Ek(e);var a=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),i=Ss(e),o=Ss(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Ak(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return fse(e);var a=e.read_shift(r&&r.biff==12?4:2),s=Ss(e);return{r:a,c:s[0],cRel:s[1],rRel:s[2]}}function fse(e){var t=Ss(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function hse(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function mse(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return xse(e);var s=e.read_shift(a>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;s>524287;)s-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:o,rRel:l}}function xse(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:a}}function pse(e,t,r){var a=(e[e.l++]&96)>>5,s=kk(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,s]}function gse(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=kk(e,i,r);return[a,s,o]}function vse(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function yse(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[a,s]}function bse(e,t,r){var a=(e[e.l++]&96)>>5,s=use(e,t-1,r);return[a,s]}function wse(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function Qw(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function jse(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=a;++i)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function Nse(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function _se(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function Sse(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function kse(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function Tk(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Ese(e){return e.read_shift(2),Tk(e)}function Ase(e){return e.read_shift(2),Tk(e)}function Tse(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=Ak(e,0,r);return[a,s]}function Ose(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=mse(e,0,r);return[a,s]}function Pse(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=Ak(e,0,r);return[a,s,i]}function Cse(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[Die[s],Ck[s],a]}function Fse(e,t,r){var a=e[e.l++],s=e.read_shift(1),i=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:Ise(e);return[s,(i[0]===0?Ck:Iie)[i[1]]]}function Ise(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Dse(e,t,r){e.l+=r&&r.biff==2?3:4}function Rse(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function Mse(e){return e.l++,cs[e.read_shift(1)]}function $se(e){return e.l++,e.read_shift(2)}function Lse(e){return e.l++,e.read_shift(1)!==0}function Bse(e){return e.l++,qr(e)}function Use(e,t,r){return e.l++,bd(e,t-1,r)}function Wse(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=rr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=cs[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=qr(e);break;case 2:r[1]=Hi(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Hse(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),s=[],i=0;i!=a;++i)s.push((r.biff==12?Wi:F0)(e));return s}function zse(e,t,r){var a=0,s=0;r.biff==12?(a=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--s==0&&(s=256));for(var i=0,o=[];i!=a&&(o[i]=[]);++i)for(var l=0;l!=s;++l)o[i][l]=Wse(e,r.biff);return o}function Vse(e,t,r){var a=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,i]}function Gse(e,t,r){if(r.biff==5)return Kse(e);var a=e.read_shift(1)>>>5&3,s=e.read_shift(2),i=e.read_shift(4);return[a,s,i]}function Kse(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function qse(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function Xse(e,t,r){var a=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function Yse(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function Jse(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[a,s]}var Zse=Yr,Qse=Yr,eie=Yr;function jd(e,t,r){return e.l+=2,[hse(e)]}function kg(e){return e.l+=6,[]}var tie=jd,rie=kg,aie=kg,nie=jd;function Ok(e){return e.l+=2,[fr(e),e.read_shift(2)&1]}var sie=jd,iie=Ok,oie=kg,lie=jd,cie=jd,die=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function uie(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s=e.read_shift(2),i=e.read_shift(2),o=die[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:a,c:s,C:i}}function fie(e){return e.l+=2,[e.read_shift(4)]}function hie(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function mie(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function xie(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function pie(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function gie(e){return e.l+=4,[0,0]}var ej={1:{n:"PtgExp",f:Rse},2:{n:"PtgTbl",f:eie},3:{n:"PtgAdd",f:cr},4:{n:"PtgSub",f:cr},5:{n:"PtgMul",f:cr},6:{n:"PtgDiv",f:cr},7:{n:"PtgPower",f:cr},8:{n:"PtgConcat",f:cr},9:{n:"PtgLt",f:cr},10:{n:"PtgLe",f:cr},11:{n:"PtgEq",f:cr},12:{n:"PtgGe",f:cr},13:{n:"PtgGt",f:cr},14:{n:"PtgNe",f:cr},15:{n:"PtgIsect",f:cr},16:{n:"PtgUnion",f:cr},17:{n:"PtgRange",f:cr},18:{n:"PtgUplus",f:cr},19:{n:"PtgUminus",f:cr},20:{n:"PtgPercent",f:cr},21:{n:"PtgParen",f:cr},22:{n:"PtgMissArg",f:cr},23:{n:"PtgStr",f:Use},26:{n:"PtgSheet",f:hie},27:{n:"PtgEndSheet",f:mie},28:{n:"PtgErr",f:Mse},29:{n:"PtgBool",f:Lse},30:{n:"PtgInt",f:$se},31:{n:"PtgNum",f:Bse},32:{n:"PtgArray",f:wse},33:{n:"PtgFunc",f:Cse},34:{n:"PtgFuncVar",f:Fse},35:{n:"PtgName",f:Vse},36:{n:"PtgRef",f:Tse},37:{n:"PtgArea",f:pse},38:{n:"PtgMemArea",f:qse},39:{n:"PtgMemErr",f:Zse},40:{n:"PtgMemNoMem",f:Qse},41:{n:"PtgMemFunc",f:Xse},42:{n:"PtgRefErr",f:Yse},43:{n:"PtgAreaErr",f:vse},44:{n:"PtgRefN",f:Ose},45:{n:"PtgAreaN",f:bse},46:{n:"PtgMemAreaN",f:xie},47:{n:"PtgMemNoMemN",f:pie},57:{n:"PtgNameX",f:Gse},58:{n:"PtgRef3d",f:Pse},59:{n:"PtgArea3d",f:gse},60:{n:"PtgRefErr3d",f:Jse},61:{n:"PtgAreaErr3d",f:yse},255:{}},vie={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},yie={1:{n:"PtgElfLel",f:Ok},2:{n:"PtgElfRw",f:lie},3:{n:"PtgElfCol",f:tie},6:{n:"PtgElfRwV",f:cie},7:{n:"PtgElfColV",f:nie},10:{n:"PtgElfRadical",f:sie},11:{n:"PtgElfRadicalS",f:oie},13:{n:"PtgElfColS",f:rie},15:{n:"PtgElfColSV",f:aie},16:{n:"PtgElfRadicalLel",f:iie},25:{n:"PtgList",f:uie},29:{n:"PtgSxName",f:fie},255:{}},bie={0:{n:"PtgAttrNoop",f:gie},1:{n:"PtgAttrSemi",f:kse},2:{n:"PtgAttrIf",f:_se},4:{n:"PtgAttrChoose",f:jse},8:{n:"PtgAttrGoto",f:Nse},16:{n:"PtgAttrSum",f:Dse},32:{n:"PtgAttrBaxcel",f:Qw},33:{n:"PtgAttrBaxcel",f:Qw},64:{n:"PtgAttrSpace",f:Ese},65:{n:"PtgAttrSpaceSemi",f:Ase},128:{n:"PtgAttrIfError",f:Sse},255:{}};function Nd(e,t,r,a){if(a.biff<8)return Yr(e,t);for(var s=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=zse(e,0,a),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=Hse(e,r[o][1],a),i.push(r[o][2]);break;case"PtgExp":a&&a.biff==12&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=s-e.l,t!==0&&i.push(Yr(e,t)),i}function _d(e,t,r){for(var a=e.l+t,s,i,o=[];a!=e.l;)t=a-e.l,i=e[e.l],s=ej[i]||ej[vie[i]],(i===24||i===25)&&(s=(i===24?yie:bie)[e[e.l+1]]),!s||!s.f?Yr(e,t):o.push([s.n,s.f(e,t,r)]);return o}function wie(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],s=[],i=0;i<a.length;++i){var o=a[i];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var jie={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Nie(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Pk(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[a[0]][0]){case 357:return s=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return s=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[a[0]][0][3]?(s=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?s:s+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function tj(e,t,r){var a=Pk(e,t,r);return a=="#REF"?a:Nie(a,r)}function Vr(e,t,r,a,s){var i=s&&s.biff||8,o={s:{c:0,r:0}},l=[],c,d,u,f=0,h=0,m,x="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",y=0,w=e[0].length;y<w;++y){var v=e[0][y];switch(v[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),d=l.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=Jt(" ",e[0][p][1][1]);break;case 1:g=Jt("\r",e[0][p][1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}d=d+g,p=-1}l.push(d+jie[v[0]]+c);break;case"PtgIsect":c=l.pop(),d=l.pop(),l.push(d+" "+c);break;case"PtgUnion":c=l.pop(),d=l.pop(),l.push(d+","+c);break;case"PtgRange":c=l.pop(),d=l.pop(),l.push(d+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=ql(v[1][1],o,s),l.push(Xl(u,i));break;case"PtgRefN":u=r?ql(v[1][1],r,s):v[1][1],l.push(Xl(u,i));break;case"PtgRef3d":f=v[1][1],u=ql(v[1][2],o,s),x=tj(a,f,s),l.push(x+"!"+Xl(u,i));break;case"PtgFunc":case"PtgFuncVar":var _=v[1][0],b=v[1][1];_||(_=0),_&=127;var j=_==0?[]:l.slice(-_);l.length-=_,b==="User"&&(b=j.shift()),l.push(b+"("+j.join(",")+")");break;case"PtgBool":l.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(v[1]);break;case"PtgNum":l.push(String(v[1]));break;case"PtgStr":l.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(v[1]);break;case"PtgAreaN":m=Ow(v[1][1],r?{s:r}:o,s),l.push(bh(m,s));break;case"PtgArea":m=Ow(v[1][1],o,s),l.push(bh(m,s));break;case"PtgArea3d":f=v[1][1],m=v[1][2],x=tj(a,f,s),l.push(x+"!"+bh(m,s));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=v[1][2];var N=(a.names||[])[h-1]||(a[0]||[])[h],k=N?N.Name:"SH33TJSNAME"+String(h);k&&k.slice(0,6)=="_xlfn."&&!s.xlfn&&(k=k.slice(6)),l.push(k);break;case"PtgNameX":var S=v[1][1];h=v[1][2];var E;if(s.biff<=5)S<0&&(S=-S),a[S]&&(E=a[S][h]);else{var P="";if(((a[S]||[])[0]||[])[0]==14849||(((a[S]||[])[0]||[])[0]==1025?a[S][h]&&a[S][h].itab>0&&(P=a.SheetNames[a[S][h].itab-1]+"!"):P=a.SheetNames[h-1]+"!"),a[S]&&a[S][h])P+=a[S][h].Name;else if(a[0]&&a[0][h])P+=a[0][h].Name;else{var C=(Pk(a,S,s)||"").split(";;");C[h-1]?P=C[h-1]:P+="SH33TJSERRX"}l.push(P);break}E||(E={Name:"SH33TJSERRY"}),l.push(E.Name);break;case"PtgParen":var T="(",M=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:T=Jt(" ",e[0][p][1][1])+T;break;case 3:T=Jt("\r",e[0][p][1][1])+T;break;case 4:M=Jt(" ",e[0][p][1][1])+M;break;case 5:M=Jt("\r",e[0][p][1][1])+M;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}l.push(T+l.pop()+M);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":u={c:v[1][1],r:v[1][0]};var A={c:r.c,r:r.r};if(a.sharedf[Le(u)]){var F=a.sharedf[Le(u)];l.push(Vr(F,o,A,a,s))}else{var H=!1;for(c=0;c!=a.arrayf.length;++c)if(d=a.arrayf[c],!(u.c<d[0].s.c||u.c>d[0].e.c)&&!(u.r<d[0].s.r||u.r>d[0].e.r)){l.push(Vr(d[1],o,A,a,s)),H=!0;break}H||l.push(v[1])}break;case"PtgArray":l.push("{"+wie(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var V=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&p>=0&&V.indexOf(e[0][y][0])==-1){v=e[0][p];var B=!0;switch(v[1][0]){case 4:B=!1;case 0:g=Jt(" ",v[1][1]);break;case 5:B=!1;case 1:g=Jt("\r",v[1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}l.push((B?g:"")+l.pop()+(B?"":g)),p=-1}}if(l.length>1&&s.WTF)throw new Error("bad formula stack");return l[0]}function _ie(e,t,r){var a=e.l+t,s=r.biff==2?1:2,i,o=e.read_shift(s);if(o==65535)return[[],Yr(e,t-2)];var l=_d(e,o,r);return t!==o+s&&(i=Nd(e,t-o-s,l,r)),e.l=a,[l,i]}function Sie(e,t,r){var a=e.l+t,s=r.biff==2?1:2,i,o=e.read_shift(s);if(o==65535)return[[],Yr(e,t-2)];var l=_d(e,o,r);return t!==o+s&&(i=Nd(e,t-o-s,l,r)),e.l=a,[l,i]}function kie(e,t,r,a){var s=e.l+t,i=_d(e,a,r),o;return s!==e.l&&(o=Nd(e,s-e.l,i,r)),[i,o]}function Eie(e,t,r){var a=e.l+t,s,i=e.read_shift(2),o=_d(e,i,r);return i==65535?[[],Yr(e,t-2)]:(t!==i+2&&(s=Nd(e,a-i-2,o,r)),[o,s])}function Aie(e){var t;if(Hn(e,e.l+6)!==65535)return[qr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Tie(e){if(e==null){var t=de(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ki(e);return ki(0)}function Sh(e,t,r){var a=e.l+t,s=Cn(e);r.biff==2&&++e.l;var i=Aie(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=Sie(e,a-e.l,r);return{cell:s,val:i[0],formula:l,shared:o>>3&1,tt:i[1]}}function Oie(e,t,r,a,s){var i=Ai(t,r,s),o=Tie(e.v),l=de(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var d=de(e.bf.length),u=0;u<e.bf.length;++u)d[u]=e.bf[u];var f=Ar([i,o,l,d]);return f}function I0(e,t,r){var a=e.read_shift(4),s=_d(e,a,r),i=e.read_shift(4),o=i>0?Nd(e,i,s,r):null;return[s,o]}var Pie=I0,D0=I0,Cie=I0,Fie=I0,Iie={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ck={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Die={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function rj(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Rie(e){var t="of:="+e.replace(_g,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function kh(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Mie(e){return e.replace(/\./,"!")}var Jl={},mo={},Zl=typeof Map<"u";function Eg(e,t,r){var a=0,s=e.length;if(r){if(Zl?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Zl?r.get(t):r[t];a<i.length;++a)if(e[i[a]].t===t)return e.Count++,i[a]}}else for(;a<s;++a)if(e[a].t===t)return e.Count++,a;return e[s]={t},e.Count++,e.Unique++,r&&(Zl?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function R0(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(Kr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=Qc(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=Nf(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function ui(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Rs(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],s=60,i=e.length;if(a==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){qn(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=a=s;break}}for(s=0;s!=i;++s)if(e[s].numFmtId===a)return s;return e[i]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function Fk(e,t,r,a,s,i){try{a.cellNF&&(e.z=Me[t])}catch(l){if(a.WTF)throw l}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Lt(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(Me[t]==null&&qn(IQ[t]||"General",t),e.t==="e")e.w=e.w||cs[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Gc(e.v);else if(e.t==="d"){var o=Nr(e.v);(o|0)===o?e.w=o.toString(10):e.w=Gc(o)}else{if(e.v===void 0)return"";e.w=_i(e.v,mo)}else e.t==="d"?e.w=qa(t,Nr(e.v),mo):e.w=qa(t,e.v,mo)}catch(l){if(a.WTF)throw l}if(a.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=jf(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=jf(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(a.WTF&&i.Fills)throw l}}}function $ie(e,t,r){if(e&&e["!ref"]){var a=ft(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function Lie(e,t){var r=ft(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Xe(r))}var Bie=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Uie=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Wie=/<(?:\w:)?hyperlink [^>]*>/mg,Hie=/"(\w*:\w*)"/,zie=/<(?:\w:)?col\b[^>]*[\/]?>/g,Vie=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Gie=/<(?:\w:)?pageMargins[^>]*\/>/g,Ik=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Kie=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,qie=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Xie(e,t,r,a,s,i,o){if(!e)return e;a||(a={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",u="",f=e.match(Uie);f?(d=e.slice(0,f.index),u=e.slice(f.index+f[0].length)):d=u=e;var h=d.match(Ik);h?Ag(h[0],l,s,r):(h=d.match(Kie))&&Jie(h[0],h[1]||"",l,s,r);var m=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var x=d.slice(m,m+50).match(Hie);x&&Lie(l,x[1])}var p=d.match(qie);p&&p[1]&&doe(p[1],s);var g=[];if(t.cellStyles){var y=d.match(zie);y&&soe(g,y)}f&&hoe(f[1],l,t,c,i,o);var w=u.match(Vie);w&&(l["!autofilter"]=ooe(w[0]));var v=[],_=u.match(Bie);if(_)for(m=0;m!=_.length;++m)v[m]=ft(_[m].slice(_[m].indexOf('"')+1));var b=u.match(Wie);b&&roe(l,b,a);var j=u.match(Gie);if(j&&(l["!margins"]=aoe(Be(j[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=Xe(c)),t.sheetRows>0&&l["!ref"]){var N=ft(l["!ref"]);t.sheetRows<=+N.e.r&&(N.e.r=t.sheetRows-1,N.e.r>c.e.r&&(N.e.r=c.e.r),N.e.r<N.s.r&&(N.s.r=N.e.r),N.e.c>c.e.c&&(N.e.c=c.e.c),N.e.c<N.s.c&&(N.s.c=N.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Xe(N))}return g.length>0&&(l["!cols"]=g),v.length>0&&(l["!merges"]=v),l}function Yie(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Xe(e[r])+'"/>';return t+"</mergeCells>"}function Ag(e,t,r,a){var s=Be(e);r.Sheets[a]||(r.Sheets[a]={}),s.codeName&&(r.Sheets[a].CodeName=dt(Ot(s.codeName)))}function Jie(e,t,r,a,s){Ag(e.slice(0,e.indexOf(">")),r,a,s)}function Zie(e,t,r,a,s){var i=!1,o={},l=null;if(a.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,o.codeName=bn(St(c))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),l=(l||"")+_e("outlinePr",null,d)}!i&&!l||(s[s.length]=_e("sheetPr",l,o))}var Qie=["objects","scenarios","selectLockedCells","selectUnlockedCells"],eoe=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function toe(e){var t={sheet:1};return Qie.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),eoe.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=wg(e.password).toString(16).toUpperCase()),_e("sheetProtection",null,t)}function roe(e,t,r){for(var a=Array.isArray(e),s=0;s!=t.length;++s){var i=Be(Ot(t[s]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+dt(i.location))):(i.Target="#"+dt(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var l=ft(i.ref),c=l.s.r;c<=l.e.r;++c)for(var d=l.s.c;d<=l.e.c;++d){var u=Le({c:d,r:c});a?(e[c]||(e[c]=[]),e[c][d]||(e[c][d]={t:"z",v:void 0}),e[c][d].l=i):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=i)}}}function aoe(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function noe(e){return ui(e),_e("pageMargins",null,e)}function soe(e,t){for(var r=!1,a=0;a!=t.length;++a){var s=Be(t[a],!0);s.hidden&&(s.hidden=$t(s.hidden));var i=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,jg(s.width)),_s(s);i<=o;)e[i++]=Bt(s)}}function ioe(e,t){for(var r=["<cols>"],a,s=0;s!=t.length;++s)(a=t[s])&&(r[r.length]=_e("col",null,R0(s,a)));return r[r.length]="</cols>",r.join("")}function ooe(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function loe(e,t,r,a){var s=typeof e.ref=="string"?e.ref:Xe(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=pa(s);o.s.r==o.e.r&&(o.e.r=pa(t["!ref"]).e.r,s=Xe(o));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==a){c.Ref="'"+r.SheetNames[a]+"'!"+s;break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+s}),_e("autoFilter",null,{ref:s})}var coe=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function doe(e,t){t.Views||(t.Views=[{}]),(e.match(coe)||[]).forEach(function(r,a){var s=Be(r);t.Views[a]||(t.Views[a]={}),+s.zoomScale&&(t.Views[a].zoom=+s.zoomScale),$t(s.rightToLeft)&&(t.Views[a].RTL=!0)})}function uoe(e,t,r,a){var s={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),_e("sheetViews",_e("sheetView",null,s),{})}function foe(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",i=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=cs[e.v];break;case"d":a&&a.cellDates?s=Lt(e.v,-1).toISOString():(e=Bt(e),e.t="n",s=""+(e.v=Nr(Lt(e.v)))),typeof e.z>"u"&&(e.z=Me[14]);break;default:s=e.v;break}var l=$r("v",St(s)),c={r:t},d=Rs(a.cellXfs,e,a);switch(d!==0&&(c.s=d),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){l=$r("v",""+Eg(a.Strings,e.v,a.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=o),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=_e("f",St(e.f),u)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),_e("c",l,c)}var hoe=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=Kc("v"),o=Kc("f");return function(c,d,u,f,h,m){for(var x=0,p="",g=[],y=[],w=0,v=0,_=0,b="",j,N,k=0,S=0,E,P,C=0,T=0,M=Array.isArray(m.CellXf),A,F=[],H=[],V=Array.isArray(d),B=[],L={},ee=!1,I=!!u.sheetStubs,K=c.split(t),z=0,W=K.length;z!=W;++z){p=K[z].trim();var re=p.length;if(re!==0){var xe=0;e:for(x=0;x<re;++x)switch(p[x]){case">":if(p[x-1]!="/"){++x;break e}if(u&&u.cellStyles){if(N=Be(p.slice(xe,x),!0),k=N.r!=null?parseInt(N.r,10):k+1,S=-1,u.sheetRows&&u.sheetRows<k)continue;L={},ee=!1,N.ht&&(ee=!0,L.hpt=parseFloat(N.ht),L.hpx=zo(L.hpt)),N.hidden=="1"&&(ee=!0,L.hidden=!0),N.outlineLevel!=null&&(ee=!0,L.level=+N.outlineLevel),ee&&(B[k-1]=L)}break;case"<":xe=x;break}if(xe>=x)break;if(N=Be(p.slice(xe,x),!0),k=N.r!=null?parseInt(N.r,10):k+1,S=-1,!(u.sheetRows&&u.sheetRows<k)){f.s.r>k-1&&(f.s.r=k-1),f.e.r<k-1&&(f.e.r=k-1),u&&u.cellStyles&&(L={},ee=!1,N.ht&&(ee=!0,L.hpt=parseFloat(N.ht),L.hpx=zo(L.hpt)),N.hidden=="1"&&(ee=!0,L.hidden=!0),N.outlineLevel!=null&&(ee=!0,L.level=+N.outlineLevel),ee&&(B[k-1]=L)),g=p.slice(x).split(e);for(var me=0;me!=g.length&&g[me].trim().charAt(0)=="<";++me);for(g=g.slice(me),x=0;x!=g.length;++x)if(p=g[x].trim(),p.length!==0){if(y=p.match(r),w=x,v=0,_=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,y!=null&&y.length===2){for(w=0,b=y[1],v=0;v!=b.length&&!((_=b.charCodeAt(v)-64)<1||_>26);++v)w=26*w+_;--w,S=w}else++S;for(v=0;v!=p.length&&p.charCodeAt(v)!==62;++v);if(++v,N=Be(p.slice(0,v),!0),N.r||(N.r=Le({r:k-1,c:S})),b=p.slice(v),j={t:""},(y=b.match(i))!=null&&y[1]!==""&&(j.v=dt(y[1])),u.cellFormula){if((y=b.match(o))!=null&&y[1]!==""){if(j.f=dt(Ot(y[1])).replace(/\r\n/g,`
`),u.xlfn||(j.f=Zw(j.f)),y[0].indexOf('t="array"')>-1)j.F=(b.match(s)||[])[1],j.F.indexOf(":")>-1&&F.push([ft(j.F),j.F]);else if(y[0].indexOf('t="shared"')>-1){P=Be(y[0]);var Q=dt(Ot(y[1]));u.xlfn||(Q=Zw(Q)),H[parseInt(P.si,10)]=[P,Q,N.r]}}else(y=b.match(/<f[^>]*\/>/))&&(P=Be(y[0]),H[P.si]&&(j.f=cse(H[P.si][1],H[P.si][2],N.r)));var q=qt(N.r);for(v=0;v<F.length;++v)q.r>=F[v][0].s.r&&q.r<=F[v][0].e.r&&q.c>=F[v][0].s.c&&q.c<=F[v][0].e.c&&(j.F=F[v][1])}if(N.t==null&&j.v===void 0)if(j.f||j.F)j.v=0,j.t="n";else if(I)j.t="z";else continue;else j.t=N.t||"n";switch(f.s.c>S&&(f.s.c=S),f.e.c<S&&(f.e.c=S),j.t){case"n":if(j.v==""||j.v==null){if(!I)continue;j.t="z"}else j.v=parseFloat(j.v);break;case"s":if(typeof j.v>"u"){if(!I)continue;j.t="z"}else E=Jl[parseInt(j.v,10)],j.v=E.t,j.r=E.r,u.cellHTML&&(j.h=E.h);break;case"str":j.t="s",j.v=j.v!=null?Ot(j.v):"",u.cellHTML&&(j.h=ig(j.v));break;case"inlineStr":y=b.match(a),j.t="s",y!=null&&(E=bg(y[1]))?(j.v=E.t,u.cellHTML&&(j.h=E.h)):j.v="";break;case"b":j.v=$t(j.v);break;case"d":u.cellDates?j.v=Lt(j.v,1):(j.v=Nr(Lt(j.v,1)),j.t="n");break;case"e":(!u||u.cellText!==!1)&&(j.w=j.v),j.v=R4[j.v];break}if(C=T=0,A=null,M&&N.s!==void 0&&(A=m.CellXf[N.s],A!=null&&(A.numFmtId!=null&&(C=A.numFmtId),u.cellStyles&&A.fillId!=null&&(T=A.fillId))),Fk(j,C,T,u,h,m),u.cellDates&&M&&j.t=="n"&&ol(Me[C])&&(j.t="d",j.v=C0(j.v)),N.cm&&u.xlmeta){var se=(u.xlmeta.Cell||[])[+N.cm-1];se&&se.type=="XLDAPR"&&(j.D=!0)}if(V){var D=qt(N.r);d[D.r]||(d[D.r]=[]),d[D.r][D.c]=j}else d[N.r]=j}}}}B.length>0&&(d["!rows"]=B)}}();function moe(e,t,r,a){var s=[],i=[],o=ft(e["!ref"]),l="",c,d="",u=[],f=0,h=0,m=e["!rows"],x=Array.isArray(e),p={r:d},g,y=-1;for(h=o.s.c;h<=o.e.c;++h)u[h]=Kt(h);for(f=o.s.r;f<=o.e.r;++f){for(i=[],d=or(f),h=o.s.c;h<=o.e.c;++h){c=u[h]+d;var w=x?(e[f]||[])[h]:e[c];w!==void 0&&(l=foe(w,c,e,t))!=null&&i.push(l)}(i.length>0||m&&m[f])&&(p={r:d},m&&m[f]&&(g=m[f],g.hidden&&(p.hidden=1),y=-1,g.hpx?y=ed(g.hpx):g.hpt&&(y=g.hpt),y>-1&&(p.ht=y,p.customHeight=1),g.level&&(p.outlineLevel=g.level)),s[s.length]=_e("row",i.join(""),p))}if(m)for(;f<m.length;++f)m&&m[f]&&(p={r:f+1},g=m[f],g.hidden&&(p.hidden=1),y=-1,g.hpx?y=ed(g.hpx):g.hpt&&(y=g.hpt),y>-1&&(p.ht=y,p.customHeight=1),g.level&&(p.outlineLevel=g.level),s[s.length]=_e("row","",p));return s.join("")}function Dk(e,t,r,a){var s=[lr,_e("worksheet",null,{xmlns:$i[0],"xmlns:r":yr.r})],i=r.SheetNames[e],o=0,l="",c=r.Sheets[i];c==null&&(c={});var d=c["!ref"]||"A1",u=ft(d);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),d=Xe(u)}a||(a={}),c["!comments"]=[];var f=[];Zie(c,r,e,t,s),s[s.length]=_e("dimension",null,{ref:d}),s[s.length]=uoe(c,t,e,r),t.sheetFormat&&(s[s.length]=_e("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=ioe(c,c["!cols"])),s[o=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=moe(c,t),l.length>0&&(s[s.length]=l)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),c["!protect"]&&(s[s.length]=toe(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=loe(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=Yie(c["!merges"]));var h=-1,m,x=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(m={ref:p[0]},p[1].Target.charAt(0)!="#"&&(x=_t(a,-1,St(p[1].Target).replace(/#.*$/,""),st.HLINK),m["r:id"]="rId"+x),(h=p[1].Target.indexOf("#"))>-1&&(m.location=St(p[1].Target.slice(h+1))),p[1].Tooltip&&(m.tooltip=St(p[1].Tooltip)),s[s.length]=_e("hyperlink",null,m))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=noe(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=$r("ignoredErrors",_e("ignoredError",null,{numberStoredAsText:1,sqref:d}))),f.length>0&&(x=_t(a,-1,"../drawings/drawing"+(e+1)+".xml",st.DRAW),s[s.length]=_e("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=f),c["!comments"].length>0&&(x=_t(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",st.VML),s[s.length]=_e("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function xoe(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=a,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}function poe(e,t,r){var a=de(145),s=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var i=320;s.hpx?i=ed(s.hpx)*20:s.hpt&&(i=s.hpt*20),a.write_shift(2,i),a.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),a.write_shift(1,o),a.write_shift(1,0);var l=0,c=a.l;a.l+=4;for(var d={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var f=-1,h=-1,m=u<<10;m<u+1<<10;++m){d.c=m;var x=Array.isArray(r)?(r[d.r]||[])[d.c]:r[Le(d)];x&&(f<0&&(f=m),h=m)}f<0||(++l,a.write_shift(4,f),a.write_shift(4,h))}var p=a.l;return a.l=c,a.write_shift(4,l),a.l=p,a.length>a.l?a.slice(0,a.l):a}function goe(e,t,r,a){var s=poe(a,r,t);(s.length>17||(t["!rows"]||[])[a])&&ge(e,0,s)}var voe=Wi,yoe=dl;function boe(){}function woe(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=_ee(e),r}function joe(e,t,r){r==null&&(r=de(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var s=1;s<3;++s)r.write_shift(1,0);return yf({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),P4(e,r),r.slice(0,r.l)}function Noe(e){var t=Ja(e);return[t]}function _oe(e,t,r){return r==null&&(r=de(8)),Li(t,r)}function Soe(e){var t=Bi(e);return[t]}function koe(e,t,r){return r==null&&(r=de(4)),Ui(t,r)}function Eoe(e){var t=Ja(e),r=e.read_shift(1);return[t,r,"b"]}function Aoe(e,t,r){return r==null&&(r=de(9)),Li(t,r),r.write_shift(1,e.v?1:0),r}function Toe(e){var t=Bi(e),r=e.read_shift(1);return[t,r,"b"]}function Ooe(e,t,r){return r==null&&(r=de(5)),Ui(t,r),r.write_shift(1,e.v?1:0),r}function Poe(e){var t=Ja(e),r=e.read_shift(1);return[t,r,"e"]}function Coe(e,t,r){return r==null&&(r=de(9)),Li(t,r),r.write_shift(1,e.v),r}function Foe(e){var t=Bi(e),r=e.read_shift(1);return[t,r,"e"]}function Ioe(e,t,r){return r==null&&(r=de(8)),Ui(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function Doe(e){var t=Ja(e),r=e.read_shift(4);return[t,r,"s"]}function Roe(e,t,r){return r==null&&(r=de(12)),Li(t,r),r.write_shift(4,t.v),r}function Moe(e){var t=Bi(e),r=e.read_shift(4);return[t,r,"s"]}function $oe(e,t,r){return r==null&&(r=de(8)),Ui(t,r),r.write_shift(4,t.v),r}function Loe(e){var t=Ja(e),r=qr(e);return[t,r,"n"]}function Boe(e,t,r){return r==null&&(r=de(16)),Li(t,r),ki(e.v,r),r}function Rk(e){var t=Bi(e),r=qr(e);return[t,r,"n"]}function Uoe(e,t,r){return r==null&&(r=de(12)),Ui(t,r),ki(e.v,r),r}function Woe(e){var t=Ja(e),r=xg(e);return[t,r,"n"]}function Hoe(e,t,r){return r==null&&(r=de(12)),Li(t,r),C4(e.v,r),r}function zoe(e){var t=Bi(e),r=xg(e);return[t,r,"n"]}function Voe(e,t,r){return r==null&&(r=de(8)),Ui(t,r),C4(e.v,r),r}function Goe(e){var t=Ja(e),r=fg(e);return[t,r,"is"]}function Koe(e){var t=Ja(e),r=Xr(e);return[t,r,"str"]}function qoe(e,t,r){return r==null&&(r=de(12+4*e.v.length)),Li(t,r),Or(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Xoe(e){var t=Bi(e),r=Xr(e);return[t,r,"str"]}function Yoe(e,t,r){return r==null&&(r=de(8+4*e.v.length)),Ui(t,r),Or(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Joe(e,t,r){var a=e.l+t,s=Ja(e);s.r=r["!row"];var i=e.read_shift(1),o=[s,i,"b"];if(r.cellFormula){e.l+=2;var l=D0(e,a-e.l,r);o[3]=Vr(l,null,s,r.supbooks,r)}else e.l=a;return o}function Zoe(e,t,r){var a=e.l+t,s=Ja(e);s.r=r["!row"];var i=e.read_shift(1),o=[s,i,"e"];if(r.cellFormula){e.l+=2;var l=D0(e,a-e.l,r);o[3]=Vr(l,null,s,r.supbooks,r)}else e.l=a;return o}function Qoe(e,t,r){var a=e.l+t,s=Ja(e);s.r=r["!row"];var i=qr(e),o=[s,i,"n"];if(r.cellFormula){e.l+=2;var l=D0(e,a-e.l,r);o[3]=Vr(l,null,s,r.supbooks,r)}else e.l=a;return o}function ele(e,t,r){var a=e.l+t,s=Ja(e);s.r=r["!row"];var i=Xr(e),o=[s,i,"str"];if(r.cellFormula){e.l+=2;var l=D0(e,a-e.l,r);o[3]=Vr(l,null,s,r.supbooks,r)}else e.l=a;return o}var tle=Wi,rle=dl;function ale(e,t){return t==null&&(t=de(4)),t.write_shift(4,e),t}function nle(e,t){var r=e.l+t,a=Wi(e),s=hg(e),i=Xr(e),o=Xr(e),l=Xr(e);e.l=r;var c={rfx:a,relId:s,loc:i,display:l};return o&&(c.Tooltip=o),c}function sle(e,t){var r=de(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));dl({s:qt(e[0]),e:qt(e[0])},r),mg("rId"+t,r);var a=e[1].Target.indexOf("#"),s=a==-1?"":e[1].Target.slice(a+1);return Or(s||"",r),Or(e[1].Tooltip||"",r),Or("",r),r.slice(0,r.l)}function ile(){}function ole(e,t,r){var a=e.l+t,s=F4(e),i=e.read_shift(1),o=[s];if(o[2]=i,r.cellFormula){var l=Pie(e,a-e.l,r);o[1]=l}else e.l=a;return o}function lle(e,t,r){var a=e.l+t,s=Wi(e),i=[s];if(r.cellFormula){var o=Fie(e,a-e.l,r);i[1]=o,e.l=a}else e.l=a;return i}function cle(e,t,r){r==null&&(r=de(18));var a=R0(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof a.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var Mk=["left","right","top","bottom","header","footer"];function dle(e){var t={};return Mk.forEach(function(r){t[r]=qr(e)}),t}function ule(e,t){return t==null&&(t=de(6*8)),ui(e),Mk.forEach(function(r){ki(e[r],t)}),t}function fle(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function hle(e,t,r){r==null&&(r=de(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function mle(e){var t=de(24);return t.write_shift(4,4),t.write_shift(4,1),dl(e,t),t}function xle(e,t){return t==null&&(t=de(16*4+2)),t.write_shift(2,e.password?wg(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function ple(){}function gle(){}function vle(e,t,r,a,s,i,o){if(!e)return e;var l=t||{};a||(a={"!id":{}});var c=l.dense?[]:{},d,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,m,x,p,g,y,w,v,_,b,j=[];l.biff=12,l["!row"]=0;var N=0,k=!1,S=[],E={},P=l.supbooks||s.supbooks||[[]];if(P.sharedf=E,P.arrayf=S,P.SheetNames=s.SheetNames||s.Sheets.map(function(V){return V.name}),!l.supbooks&&(l.supbooks=P,s.Names))for(var C=0;C<s.Names.length;++C)P[0][C+1]=s.Names[C];var T=[],M=[],A=!1;td[16]={n:"BrtShortReal",f:Rk};var F;if(ls(e,function(B,L,ee){if(!h)switch(ee){case 148:d=B;break;case 0:m=B,l.sheetRows&&l.sheetRows<=m.r&&(h=!0),_=or(g=m.r),l["!row"]=m.r,(B.hidden||B.hpt||B.level!=null)&&(B.hpt&&(B.hpx=zo(B.hpt)),M[B.r]=B);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:B[2]},B[2]){case"n":x.v=B[1];break;case"s":v=Jl[B[1]],x.v=v.t,x.r=v.r;break;case"b":x.v=!!B[1];break;case"e":x.v=B[1],l.cellText!==!1&&(x.w=cs[x.v]);break;case"str":x.t="s",x.v=B[1];break;case"is":x.t="s",x.v=B[1].t;break}if((p=o.CellXf[B[0].iStyleRef])&&Fk(x,p.numFmtId,null,l,i,o),y=B[0].c==-1?y+1:B[0].c,l.dense?(c[g]||(c[g]=[]),c[g][y]=x):c[Kt(y)+_]=x,l.cellFormula){for(k=!1,N=0;N<S.length;++N){var I=S[N];m.r>=I[0].s.r&&m.r<=I[0].e.r&&y>=I[0].s.c&&y<=I[0].e.c&&(x.F=Xe(I[0]),k=!0)}!k&&B.length>3&&(x.f=B[3])}if(u.s.r>m.r&&(u.s.r=m.r),u.s.c>y&&(u.s.c=y),u.e.r<m.r&&(u.e.r=m.r),u.e.c<y&&(u.e.c=y),l.cellDates&&p&&x.t=="n"&&ol(Me[p.numFmtId])){var K=ri(x.v);K&&(x.t="d",x.v=new Date(K.y,K.m-1,K.d,K.H,K.M,K.S,K.u))}F&&(F.type=="XLDAPR"&&(x.D=!0),F=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;x={t:"z",v:void 0},y=B[0].c==-1?y+1:B[0].c,l.dense?(c[g]||(c[g]=[]),c[g][y]=x):c[Kt(y)+_]=x,u.s.r>m.r&&(u.s.r=m.r),u.s.c>y&&(u.s.c=y),u.e.r<m.r&&(u.e.r=m.r),u.e.c<y&&(u.e.c=y),F&&(F.type=="XLDAPR"&&(x.D=!0),F=void 0);break;case 176:j.push(B);break;case 49:F=((l.xlmeta||{}).Cell||[])[B-1];break;case 494:var z=a["!id"][B.relId];for(z?(B.Target=z.Target,B.loc&&(B.Target+="#"+B.loc),B.Rel=z):B.relId==""&&(B.Target="#"+B.loc),g=B.rfx.s.r;g<=B.rfx.e.r;++g)for(y=B.rfx.s.c;y<=B.rfx.e.c;++y)l.dense?(c[g]||(c[g]=[]),c[g][y]||(c[g][y]={t:"z",v:void 0}),c[g][y].l=B):(w=Le({c:y,r:g}),c[w]||(c[w]={t:"z",v:void 0}),c[w].l=B);break;case 426:if(!l.cellFormula)break;S.push(B),b=l.dense?c[g][y]:c[Kt(y)+_],b.f=Vr(B[1],u,{r:m.r,c:y},P,l),b.F=Xe(B[0]);break;case 427:if(!l.cellFormula)break;E[Le(B[0].s)]=B[1],b=l.dense?c[g][y]:c[Kt(y)+_],b.f=Vr(B[1],u,{r:m.r,c:y},P,l);break;case 60:if(!l.cellStyles)break;for(;B.e>=B.s;)T[B.e--]={width:B.w/256,hidden:!!(B.flags&1),level:B.level},A||(A=!0,jg(B.w/256)),_s(T[B.e+1]);break;case 161:c["!autofilter"]={ref:Xe(B)};break;case 476:c["!margins"]=B;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),B.name&&(s.Sheets[r].CodeName=B.name),(B.above||B.left)&&(c["!outline"]={above:B.above,left:B.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),B.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!L.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+ee.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(u.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(c["!ref"]=Xe(d||u)),l.sheetRows&&c["!ref"]){var H=ft(c["!ref"]);l.sheetRows<=+H.e.r&&(H.e.r=l.sheetRows-1,H.e.r>u.e.r&&(H.e.r=u.e.r),H.e.r<H.s.r&&(H.s.r=H.e.r),H.e.c>u.e.c&&(H.e.c=u.e.c),H.e.c<H.s.c&&(H.s.c=H.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Xe(H))}return j.length>0&&(c["!merges"]=j),T.length>0&&(c["!cols"]=T),M.length>0&&(c["!rows"]=M),c}function yle(e,t,r,a,s,i,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=Bt(t),t.z=t.z||Me[14],t.v=Nr(Lt(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:a};switch(c.s=Rs(s.cellXfs,t,s),t.l&&i["!links"].push([Le(c),t.l]),t.c&&i["!comments"].push([Le(c),t.c]),t.t){case"s":case"str":return s.bookSST?(l=Eg(s.Strings,t.v,s.revStrings),c.t="s",c.v=l,o?ge(e,18,$oe(t,c)):ge(e,7,Roe(t,c))):(c.t="str",o?ge(e,17,Yoe(t,c)):ge(e,6,qoe(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?ge(e,13,Voe(t,c)):ge(e,2,Hoe(t,c)):o?ge(e,16,Uoe(t,c)):ge(e,5,Boe(t,c)),!0;case"b":return c.t="b",o?ge(e,15,Ooe(t,c)):ge(e,4,Aoe(t,c)),!0;case"e":return c.t="e",o?ge(e,14,Ioe(t,c)):ge(e,3,Coe(t,c)),!0}return o?ge(e,12,koe(t,c)):ge(e,1,_oe(t,c)),!0}function ble(e,t,r,a){var s=ft(t["!ref"]||"A1"),i,o="",l=[];ge(e,145);var c=Array.isArray(t),d=s.e.r;t["!rows"]&&(d=Math.max(s.e.r,t["!rows"].length-1));for(var u=s.s.r;u<=d;++u){o=or(u),goe(e,t,s,u);var f=!1;if(u<=s.e.r)for(var h=s.s.c;h<=s.e.c;++h){u===s.s.r&&(l[h]=Kt(h)),i=l[h]+o;var m=c?(t[u]||[])[h]:t[i];if(!m){f=!1;continue}f=yle(e,m,u,h,a,t,f)}}ge(e,146)}function wle(e,t){!t||!t["!merges"]||(ge(e,177,ale(t["!merges"].length)),t["!merges"].forEach(function(r){ge(e,176,rle(r))}),ge(e,178))}function jle(e,t){!t||!t["!cols"]||(ge(e,390),t["!cols"].forEach(function(r,a){r&&ge(e,60,cle(a,r))}),ge(e,391))}function Nle(e,t){!t||!t["!ref"]||(ge(e,648),ge(e,649,mle(ft(t["!ref"]))),ge(e,650))}function _le(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var s=_t(r,-1,a[1].Target.replace(/#.*$/,""),st.HLINK);ge(e,494,sle(a,s))}}),delete t["!links"]}function Sle(e,t,r,a){if(t["!comments"].length>0){var s=_t(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",st.VML);ge(e,551,mg("rId"+s)),t["!legacy"]=s}}function kle(e,t,r,a){if(t["!autofilter"]){var s=t["!autofilter"],i=typeof s.ref=="string"?s.ref:Xe(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=pa(i);l.s.r==l.e.r&&(l.e.r=pa(t["!ref"]).e.r,i=Xe(l));for(var c=0;c<o.length;++c){var d=o[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==a){d.Ref="'"+r.SheetNames[a]+"'!"+i;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+i}),ge(e,161,dl(ft(i))),ge(e,162)}}function Ele(e,t,r){ge(e,133),ge(e,137,hle(t,r)),ge(e,138),ge(e,134)}function Ale(e,t){t["!protect"]&&ge(e,535,xle(t["!protect"]))}function Tle(e,t,r,a){var s=ma(),i=r.SheetNames[e],o=r.Sheets[i]||{},l=i;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=ft(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],ge(s,129),(r.vbaraw||o["!outline"])&&ge(s,147,joe(l,o["!outline"])),ge(s,148,yoe(c)),Ele(s,o,r.Workbook),jle(s,o),ble(s,o,e,t),Ale(s,o),kle(s,o,r,e),wle(s,o),_le(s,o,a),o["!margins"]&&ge(s,476,ule(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Nle(s,o),Sle(s,o,e,a),ge(s,130),s.end()}function Ole(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var s=dt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){a=i.replace(/<.*?>/g,"")}),[t,s,a]}function Ple(e,t,r,a,s,i){var o=i||{"!type":"chart"};if(!e)return i;var l=0,c=0,d="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=Ole(f);u.s.r=u.s.c=0,u.e.c=l,d=Kt(l),h[0].forEach(function(m,x){o[d+or(x)]={t:"n",v:m,z:h[1]},c=x}),u.e.r<c&&(u.e.r=c),++l}),l>0&&(o["!ref"]=Xe(u)),o}function Cle(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(Ik);return l&&Ag(l[0],i,s,r),(o=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}function Fle(e,t){e.l+=10;var r=Xr(e);return{name:r}}function Ile(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return ls(e,function(c,d,u){switch(u){case 550:i["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}var Tg=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Dle=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Rle=[],Mle=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function aj(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],s=0;s!=t.length;++s){var i=t[s];if(a[i[0]]==null)a[i[0]]=i[1];else switch(i[2]){case"bool":typeof a[i[0]]=="string"&&(a[i[0]]=$t(a[i[0]]));break;case"int":typeof a[i[0]]=="string"&&(a[i[0]]=parseInt(a[i[0]],10));break}}}function nj(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=$t(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function $k(e){nj(e.WBProps,Tg),nj(e.CalcPr,Mle),aj(e.WBView,Dle),aj(e.Sheets,Rle),mo.date1904=$t(e.WBProps.date1904)}function $le(e){return!e.Workbook||!e.Workbook.WBProps?"false":$t(e.Workbook.WBProps.date1904)?"true":"false"}var Lle="][*?/\\".split("");function Lk(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Lle.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Ble(e,t,r){e.forEach(function(a,s){Lk(a);for(var i=0;i<s;++i)if(a==e[i])throw new Error("Duplicate Sheet Name: "+a);if(r){var o=t&&t[s]&&t[s].CodeName||a;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function Ule(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];Ble(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)$ie(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var Wle=/<\w+:workbook/;function Hle(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,s="xmlns",i={},o=0;if(e.replace(Zr,function(c,d){var u=Be(c);switch(Pn(u[0])){case"<?xml":break;case"<workbook":c.match(Wle)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=u[s];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Tg.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=$t(u[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:r.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(r.WBProps.CodeName=Ot(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=dt(Ot(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":i={},i.Name=Ot(u.name),u.comment&&(i.Comment=u.comment),u.localSheetId&&(i.Sheet=+u.localSheetId),$t(u.hidden||"0")&&(i.Hidden=!0),o=d+c.length;break;case"</definedName>":i.Ref=dt(Ot(e.slice(o,d))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return c}),$i.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return $k(r),r}function Bk(e){var t=[lr];t[t.length]=_e("workbook",null,{xmlns:$i[0],"xmlns:r":yr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Tg.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(a[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=_e("workbookPr",null,a);var s=e.Workbook&&e.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var o={name:St(e.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=_e("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=_e("definedName",St(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function zle(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=bx(e),r.name=Xr(e),r}function Vle(e,t){return t||(t=de(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),mg(e.strRelID,t),Or(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Gle(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Xr(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function Kle(e,t){t||(t=de(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),P4(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function qle(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function Xle(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),i=See(e),o=Cie(e,0,r),l=hg(e);e.l=a;var c={Name:i,Ptg:o};return s<268435455&&(c.Sheet=s),l&&(c.Comment=l),c}function Yle(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],s=!1;t||(t={}),t.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],td[16]={n:"BrtFRTArchID$",f:qle},ls(e,function(c,d,u){switch(u){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Vr(c.Ptg,null,null,o,t),delete t.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([u,c]):o[0]=[u,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(u),s=!0;break;case 36:a.pop(),s=!1;break;case 37:a.push(u),s=!0;break;case 38:a.pop(),s=!1;break;case 16:break;default:if(!d.T){if(!s||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),$k(r),r.Names=i,r.supbooks=o,r}function Jle(e,t){ge(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ge(e,156,Vle(s))}ge(e,144)}function Zle(e,t){t||(t=de(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Or("SheetJS",t),Or(ff.version,t),Or(ff.version,t),Or("7262",t),t.length>t.l?t.slice(0,t.l):t}function Qle(e,t){t||(t=de(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function ece(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,s=-1,i=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&s==-1?s=a:r[a].Hidden==1&&i==-1&&(i=a);i>s||(ge(e,135),ge(e,158,Qle(s)),ge(e,136))}}function tce(e,t){var r=ma();return ge(r,131),ge(r,128,Zle()),ge(r,153,Kle(e.Workbook&&e.Workbook.WBProps||null)),ece(r,e),Jle(r,e),ge(r,132),r.end()}function rce(e,t,r){return t.slice(-4)===".bin"?Yle(e,r):Hle(e,r)}function ace(e,t,r,a,s,i,o,l){return t.slice(-4)===".bin"?vle(e,a,r,s,i,o,l):Xie(e,a,r,s,i,o,l)}function nce(e,t,r,a,s,i,o,l){return t.slice(-4)===".bin"?Ile(e,a,r,s,i):Cle(e,a,r,s,i)}function sce(e,t,r,a,s,i,o,l){return t.slice(-4)===".bin"?ose():lse()}function ice(e,t,r,a,s,i,o,l){return t.slice(-4)===".bin"?sse():ise()}function oce(e,t,r,a){return t.slice(-4)===".bin"?rne(e,r,a):zae(e,r,a)}function lce(e,t,r){return bk(e,r)}function cce(e,t,r){return t.slice(-4)===".bin"?cae(e,r):iae(e,r)}function dce(e,t,r){return t.slice(-4)===".bin"?ese(e,r):Vne(e,r)}function uce(e,t,r){return t.slice(-4)===".bin"?Wne(e):Bne(e)}function fce(e,t,r,a){return r.slice(-4)===".bin"?Hne(e,t,r,a):void 0}function hce(e,t,r){return t.slice(-4)===".bin"?Mne(e,t,r):Lne(e,t,r)}function mce(e,t,r){return(t.slice(-4)===".bin"?tce:Bk)(e)}function xce(e,t,r,a,s){return(t.slice(-4)===".bin"?Tle:Dk)(e,r,a,s)}function pce(e,t,r){return(t.slice(-4)===".bin"?fne:vk)(e,r)}function gce(e,t,r){return(t.slice(-4)===".bin"?fae:dk)(e,r)}function vce(e,t,r){return(t.slice(-4)===".bin"?tse:Nk)(e)}function yce(e){return(e.slice(-4)===".bin"?$ne:wk)()}var Uk=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Wk=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Qa(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var s=e.match(Uk),i,o,l,c;if(s)for(c=0;c!=s.length;++c)i=s[c].match(Wk),(o=i[1].indexOf(":"))===-1?a[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(o+1),a[l]=i[2].slice(1,i[2].length-1));return a}function bce(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(Uk),s,i,o,l;if(a)for(l=0;l!=a.length;++l)s=a[l].match(Wk),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),r[o]=s[2].slice(1,s[2].length-1));return r}var Ql;function wce(e,t){var r=Ql[e]||dt(e);return r==="General"?_i(t):qa(r,t)}function jce(e,t,r,a){var s=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=$t(a);break;case"i2":case"int":s=parseInt(a,10);break;case"r4":case"float":s=parseFloat(a);break;case"date":case"dateTime.tz":s=Lt(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[dt(t)]=s}function Nce(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||cs[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Gc(e.v):e.w=_i(e.v):e.w=wce(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var a=Ql[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&ol(a)){var s=ri(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function _ce(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=Rae[a.Pattern]||a.Pattern)}e[t.ID]=t}function Sce(e,t,r,a,s,i,o,l,c,d){var u="General",f=a.StyleID,h={};d=d||{};var m=[],x=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&o&&(f=o.StyleID);i[f]!==void 0&&(i[f].nf&&(u=i[f].nf),i[f].Interior&&m.push(i[f].Interior),!!i[f].Parent);)f=i[f].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=$t(e);break;case"String":a.t="s",a.r=ww(dt(e)),a.v=e.indexOf("<")>-1?dt(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(Lt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),a.v!==a.v?a.v=dt(e):a.v<60&&(a.v=a.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=R4[e],d.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=ww(t||e));break}if(Nce(a,u,d),d.cellFormula!==!1)if(a.Formula){var p=dt(a.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),a.f=ho(p,s),delete a.Formula,a.ArrayRange=="RC"?a.F=ho("RC:RC",s):a.ArrayRange&&(a.F=ho(a.ArrayRange,s),c.push([ft(a.F),a.F]))}else for(x=0;x<c.length;++x)s.r>=c[x][0].s.r&&s.r<=c[x][0].e.r&&s.c>=c[x][0].s.c&&s.c<=c[x][0].e.c&&(a.F=c[x][1]);d.cellStyles&&(m.forEach(function(g){!h.patternType&&g.patternType&&(h.patternType=g.patternType)}),a.s=h),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function kce(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Eh(e,t){var r=t||{};ll();var a=Fl(og(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=Ot(a));var s=a.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=Bt(r);return o.type="string",Ho.to_workbook(a,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(oe){s.indexOf("<"+oe)>=0&&(i=!0)}),i)return ude(a,r);Ql={"General Number":"General","General Date":Me[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Me[15],"Short Date":Me[14],"Long Time":Me[19],"Medium Time":Me[18],"Short Time":Me[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Me[2],Standard:Me[4],Percent:Me[10],Scientific:Me[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],d,u={},f=[],h=r.dense?[]:{},m="",x={},p={},g=Qa('<Data ss:Type="String">'),y=0,w=0,v=0,_={s:{r:2e6,c:2e6},e:{r:0,c:0}},b={},j={},N="",k=0,S=[],E={},P={},C=0,T=[],M=[],A={},F=[],H,V=!1,B=[],L=[],ee={},I=0,K=0,z={Sheets:[],WBProps:{date1904:!1}},W={};Xc.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var re="";l=Xc.exec(a);)switch(l[3]=(re=l[3]).toLowerCase()){case"data":if(re=="data"){if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?Sce(a.slice(y,l.index),N,g,c[c.length-1][0]=="comment"?A:x,{c:w,r:v},b,F[w],p,B,r):(N="",g=Qa(l[0]),y=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(M.length>0&&(x.c=M),(!r.sheetRows||r.sheetRows>v)&&x.v!==void 0&&(r.dense?(h[v]||(h[v]=[]),h[v][w]=x):h[Kt(w)+or(v)]=x),x.HRef&&(x.l={Target:dt(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(I=w+(parseInt(x.MergeAcross,10)|0),K=v+(parseInt(x.MergeDown,10)|0),S.push({s:{c:w,r:v},e:{c:I,r:K}})),!r.sheetStubs)x.MergeAcross?w=I+1:++w;else if(x.MergeAcross||x.MergeDown){for(var xe=w;xe<=I;++xe)for(var me=v;me<=K;++me)(xe>w||me>v)&&(r.dense?(h[me]||(h[me]=[]),h[me][xe]={t:"z"}):h[Kt(xe)+or(me)]={t:"z"});w=I+1}else++w;else x=bce(l[0]),x.Index&&(w=+x.Index-1),w<_.s.c&&(_.s.c=w),w>_.e.c&&(_.e.c=w),l[0].slice(-2)==="/>"&&++w,M=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(v<_.s.r&&(_.s.r=v),v>_.e.r&&(_.e.r=v),l[0].slice(-2)==="/>"&&(p=Qa(l[0]),p.Index&&(v=+p.Index-1)),w=0,++v):(p=Qa(l[0]),p.Index&&(v=+p.Index-1),ee={},(p.AutoFitHeight=="0"||p.Height)&&(ee.hpx=parseInt(p.Height,10),ee.hpt=ed(ee.hpx),L[v]=ee),p.Hidden=="1"&&(ee.hidden=!0,L[v]=ee));break;case"worksheet":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));f.push(m),_.s.r<=_.e.r&&_.s.c<=_.e.c&&(h["!ref"]=Xe(_),r.sheetRows&&r.sheetRows<=_.e.r&&(h["!fullref"]=h["!ref"],_.e.r=r.sheetRows-1,h["!ref"]=Xe(_))),S.length&&(h["!merges"]=S),F.length>0&&(h["!cols"]=F),L.length>0&&(h["!rows"]=L),u[m]=h}else _={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=w=0,c.push([l[3],!1]),d=Qa(l[0]),m=dt(d.Name),h=r.dense?[]:{},S=[],B=[],L=[],W={name:m,Hidden:0},z.Sheets.push(W);break;case"table":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),F=[],V=!1}break;case"style":l[1]==="/"?_ce(b,j,r):j=Qa(l[0]);break;case"numberformat":j.nf=dt(Qa(l[0]).Format||"General"),Ql[j.nf]&&(j.nf=Ql[j.nf]);for(var Q=0;Q!=392&&Me[Q]!=j.nf;++Q);if(Q==392){for(Q=57;Q!=392;++Q)if(Me[Q]==null){qn(j.nf,Q);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(H=Qa(l[0]),H.Hidden&&(H.hidden=!0,delete H.Hidden),H.Width&&(H.wpx=parseInt(H.Width,10)),!V&&H.wpx>10){V=!0,Kr=pk;for(var q=0;q<F.length;++q)F[q]&&_s(F[q])}V&&_s(H),F[H.Index-1||F.length]=H;for(var se=0;se<+H.Span;++se)F[F.length]=Bt(H);break;case"namedrange":if(l[1]==="/")break;z.Names||(z.Names=[]);var D=Be(l[0]),ve={Name:D.Name,Ref:ho(D.RefersTo.slice(1),{r:0,c:0})};z.Sheets.length>0&&(ve.Sheet=z.Sheets.length-1),z.Names.push(ve);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?N+=a.slice(k,l.index):k=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;j.Interior=Qa(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?Yee(E,re,a.slice(C,l.index)):C=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));kce(A),M.push(A)}else c.push([l[3],!1]),d=Qa(l[0]),A={a:d.Author};break;case"autofilter":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var we=Qa(l[0]);h["!autofilter"]={ref:ho(we.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return cj(a,r);var Ae=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ae=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ae=!1}break;case"excelworkbook":switch(l[3]){case"date1904":z.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ae=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:Ae=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(a.slice(C,l.index)){case"SheetHidden":W.Hidden=1;break;case"SheetVeryHidden":W.Hidden=2;break}else C=l.index+l[0].length;break;case"header":h["!margins"]||ui(h["!margins"]={},"xlml"),isNaN(+Be(l[0]).Margin)||(h["!margins"].header=+Be(l[0]).Margin);break;case"footer":h["!margins"]||ui(h["!margins"]={},"xlml"),isNaN(+Be(l[0]).Margin)||(h["!margins"].footer=+Be(l[0]).Margin);break;case"pagemargins":var ce=Be(l[0]);h["!margins"]||ui(h["!margins"]={},"xlml"),isNaN(+ce.Top)||(h["!margins"].top=+ce.Top),isNaN(+ce.Left)||(h["!margins"].left=+ce.Left),isNaN(+ce.Right)||(h["!margins"].right=+ce.Right),isNaN(+ce.Bottom)||(h["!margins"].bottom=+ce.Bottom);break;case"displayrighttoleft":z.Views||(z.Views=[]),z.Views[0]||(z.Views[0]={}),z.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ae=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ae=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ae=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ae=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ae=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ae=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ae=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ae=!1}break;case"smarttags":break;default:Ae=!1;break}if(Ae||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?jce(P,re,T,a.slice(C,l.index)):(T=l,C=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var he={};return!r.bookSheets&&!r.bookProps&&(he.Sheets=u),he.SheetNames=f,he.Workbook=z,he.SSF=Bt(Me),he.Props=E,he.Custprops=P,he}function Ex(e,t){switch(Pg(t=t||{}),t.type||"base64"){case"base64":return Eh(Pa(e),t);case"binary":case"buffer":case"file":return Eh(e,t);case"array":return Eh(Is(e),t)}}function Ece(e,t){var r=[];return e.Props&&r.push(Jee(e.Props,t)),e.Custprops&&r.push(Zee(e.Props,e.Custprops)),r.join("")}function Ace(){return""}function Tce(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,s){var i=[];i.push(_e("NumberFormat",null,{"ss:Format":St(Me[a.numFmtId])}));var o={"ss:ID":"s"+(21+s)};r.push(_e("Style",i.join(""),o))}),_e("Styles",r.join(""))}function Hk(e){return _e("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Sg(e.Ref,{r:0,c:0})})}function Oce(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var s=t[a];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(Hk(s)))}return _e("Names",r.join(""))}function Pce(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var s=a.Workbook.Names,i=[],o=0;o<s.length;++o){var l=s[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||i.push(Hk(l)))}return i.join("")}function Cce(e,t,r,a){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(_e("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(_e("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(_e("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)s.push(_e("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(a.Workbook.Sheets[i]&&!a.Workbook.Sheets[i].Hidden);++i);i==r&&s.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push($r("ProtectContents","True")),e["!protect"].objects&&s.push($r("ProtectObjects","True")),e["!protect"].scenarios&&s.push($r("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push($r("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push($r("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":_e("WorksheetOptions",s.join(""),{xmlns:wa.x})}function Fce(e){return e.map(function(t){var r=eee(t.t||""),a=_e("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return _e("Comment",a,{"ss:Author":t.a})}).join("")}function Ice(e,t,r,a,s,i,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+St(Sg(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=qt(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=St(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=St(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],u=0;u!=d.length;++u)d[u].s.c!=o.c||d[u].s.r!=o.r||(d[u].e.c>d[u].s.c&&(l["ss:MergeAcross"]=d[u].e.c-d[u].s.c),d[u].e.r>d[u].s.r&&(l["ss:MergeDown"]=d[u].e.r-d[u].s.r));var f="",h="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=cs[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Me[14]);break;case"s":f="String",h=QQ(e.v||"");break}var m=Rs(a.cellXfs,e,a);l["ss:StyleID"]="s"+(21+m),l["ss:Index"]=o.c+1;var x=e.v!=null?h:"",p=e.t=="z"?"":'<Data ss:Type="'+f+'">'+x+"</Data>";return(e.c||[]).length>0&&(p+=Fce(e.c)),_e("Cell",p,l)}function Dce(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=zo(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Rce(e,t,r,a){if(!e["!ref"])return"";var s=ft(e["!ref"]),i=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(g,y){_s(g);var w=!!g.width,v=R0(y,g),_={"ss:Index":y+1};w&&(_["ss:Width"]=Zc(v.width)),g.hidden&&(_["ss:Hidden"]="1"),l.push(_e("Column",null,_))});for(var c=Array.isArray(e),d=s.s.r;d<=s.e.r;++d){for(var u=[Dce(d,(e["!rows"]||[])[d])],f=s.s.c;f<=s.e.c;++f){var h=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>f)&&!(i[o].s.r>d)&&!(i[o].e.c<f)&&!(i[o].e.r<d)){(i[o].s.c!=f||i[o].s.r!=d)&&(h=!0);break}if(!h){var m={r:d,c:f},x=Le(m),p=c?(e[d]||[])[f]:e[x];u.push(Ice(p,x,e,t,r,a,m))}}u.push("</Row>"),u.length>2&&l.push(u.join(""))}return l.join("")}function Mce(e,t,r){var a=[],s=r.SheetNames[e],i=r.Sheets[s],o=i?Pce(i,t,e,r):"";return o.length>0&&a.push("<Names>"+o+"</Names>"),o=i?Rce(i,t,e,r):"",o.length>0&&a.push("<Table>"+o+"</Table>"),a.push(Cce(i,t,e,r)),a.join("")}function $ce(e,t){t||(t={}),e.SSF||(e.SSF=Bt(Me)),e.SSF&&(ll(),T0(e.SSF),t.revssf=P0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Rs(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Ece(e,t)),r.push(Ace()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(_e("Worksheet",Mce(a,t,e),{"ss:Name":St(e.SheetNames[a])}));return r[2]=Tce(e,t),r[3]=Oce(e),lr+_e("Workbook",r.join(""),{xmlns:wa.ss,"xmlns:o":wa.o,"xmlns:x":wa.x,"xmlns:ss":wa.ss,"xmlns:dt":wa.dt,"xmlns:html":wa.html})}function Lce(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=Oee(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=Pee(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Bce=[60,1084,2066,2165,2175];function Uce(e,t,r,a,s){var i=a,o=[],l=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(l)}o.push(l),r.l+=i;for(var c=Hn(r,r.l),d=Ax[c],u=0;d!=null&&Bce.indexOf(c)>-1;)i=Hn(r,r.l+2),u=r.l+4,c==2066?u+=4:(c==2165||c==2175)&&(u+=12),l=r.slice(u,r.l+4+i),o.push(l),r.l+=4+i,d=Ax[c=Hn(r,r.l)];var f=Ar(o);Rr(f,0);var h=0;f.lens=[];for(var m=0;m<o.length;++m)f.lens.push(h),h+=o[m].length;if(f.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+a;return t.f(f,f.length,s)}function hn(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Me[a])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||cs[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Gc(e.v):e.w=_i(e.v):e.w=qa(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&a&&e.t=="n"&&ol(Me[a]||String(a))){var s=ri(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Qd(e,t,r){return{v:e,ixfe:t,t:r}}function Wce(e,t){var r={opts:{}},a={},s=t.dense?[]:{},i={},o={},l=null,c=[],d="",u={},f,h="",m,x,p,g,y={},w=[],v,_,b=[],j=[],N={Sheets:[],WBProps:{date1904:!1},Views:[{}]},k={},S=function(Qe){return Qe<8?li[Qe]:Qe<64&&j[Qe-8]||li[Qe]},E=function(Qe,zt,ca){var tr=zt.XF.data;if(!(!tr||!tr.patternType||!ca||!ca.cellStyles)){zt.s={},zt.s.patternType=tr.patternType;var Fn;(Fn=Jc(S(tr.icvFore)))&&(zt.s.fgColor={rgb:Fn}),(Fn=Jc(S(tr.icvBack)))&&(zt.s.bgColor={rgb:Fn})}},P=function(Qe,zt,ca){if(!(ee>1)&&!(ca.sheetRows&&Qe.r>=ca.sheetRows)){if(ca.cellStyles&&zt.XF&&zt.XF.data&&E(Qe,zt,ca),delete zt.ixfe,delete zt.XF,f=Qe,h=Le(Qe),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Qe.r<o.s.r&&(o.s.r=Qe.r),Qe.c<o.s.c&&(o.s.c=Qe.c),Qe.r+1>o.e.r&&(o.e.r=Qe.r+1),Qe.c+1>o.e.c&&(o.e.c=Qe.c+1),ca.cellFormula&&zt.f){for(var tr=0;tr<w.length;++tr)if(!(w[tr][0].s.c>Qe.c||w[tr][0].s.r>Qe.r)&&!(w[tr][0].e.c<Qe.c||w[tr][0].e.r<Qe.r)){zt.F=Xe(w[tr][0]),(w[tr][0].s.c!=Qe.c||w[tr][0].s.r!=Qe.r)&&delete zt.f,zt.f&&(zt.f=""+Vr(w[tr][1],o,Qe,B,C));break}}ca.dense?(s[Qe.r]||(s[Qe.r]=[]),s[Qe.r][Qe.c]=zt):s[h]=zt}},C={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(C.password=t.password);var T,M=[],A=[],F=[],H=[],V=!1,B=[];B.SheetNames=C.snames,B.sharedf=C.sharedf,B.arrayf=C.arrayf,B.names=[],B.XTI=[];var L=0,ee=0,I=0,K=[],z=[],W;C.codepage=1200,nn(1200);for(var re=!1;e.l<e.length-1;){var xe=e.l,me=e.read_shift(2);if(me===0&&L===10)break;var Q=e.l===e.length?0:e.read_shift(2),q=Ax[me];if(q&&q.f){if(t.bookSheets&&L===133&&me!==133)break;if(L=me,q.r===2||q.r==12){var se=e.read_shift(2);if(Q-=2,!C.enc&&se!==me&&((se&255)<<8|se>>8)!==me)throw new Error("rt mismatch: "+se+"!="+me);q.r==12&&(e.l+=10,Q-=10)}var D={};if(me===10?D=q.f(e,Q,C):D=Uce(me,q,e,Q,C),ee==0&&[9,521,1033,2057].indexOf(L)===-1)continue;switch(me){case 34:r.opts.Date1904=N.WBProps.date1904=D;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(C.enc||(e.l=0),C.enc=D,!t.password)throw new Error("File is password-protected");if(D.valid==null)throw new Error("Encryption scheme unsupported");if(!D.valid)throw new Error("Password is incorrect");break;case 92:C.lastuser=D;break;case 66:var ve=Number(D);switch(ve){case 21010:ve=1200;break;case 32768:ve=1e4;break;case 32769:ve=1252;break}nn(C.codepage=ve),re=!0;break;case 317:C.rrtabid=D;break;case 25:C.winlocked=D;break;case 439:r.opts.RefreshAll=D;break;case 12:r.opts.CalcCount=D;break;case 16:r.opts.CalcDelta=D;break;case 17:r.opts.CalcIter=D;break;case 13:r.opts.CalcMode=D;break;case 14:r.opts.CalcPrecision=D;break;case 95:r.opts.CalcSaveRecalc=D;break;case 15:C.CalcRefMode=D;break;case 2211:r.opts.FullCalc=D;break;case 129:D.fDialog&&(s["!type"]="dialog"),D.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),D.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:b.push(D);break;case 430:B.push([D]),B[B.length-1].XTI=[];break;case 35:case 547:B[B.length-1].push(D);break;case 24:case 536:W={Name:D.Name,Ref:Vr(D.rgce,o,null,B,C)},D.itab>0&&(W.Sheet=D.itab-1),B.names.push(W),B[0]||(B[0]=[],B[0].XTI=[]),B[B.length-1].push(D),D.Name=="_xlnm._FilterDatabase"&&D.itab>0&&D.rgce&&D.rgce[0]&&D.rgce[0][0]&&D.rgce[0][0][0]=="PtgArea3d"&&(z[D.itab-1]={ref:Xe(D.rgce[0][0][1][2])});break;case 22:C.ExternCount=D;break;case 23:B.length==0&&(B[0]=[],B[0].XTI=[]),B[B.length-1].XTI=B[B.length-1].XTI.concat(D),B.XTI=B.XTI.concat(D);break;case 2196:if(C.biff<8)break;W!=null&&(W.Comment=D[1]);break;case 18:s["!protect"]=D;break;case 19:D!==0&&C.WTF&&console.error("Password verifier: "+D);break;case 133:i[D.pos]=D,C.snames.push(D.name);break;case 10:{if(--ee)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=Xe(o),t.sheetRows&&t.sheetRows<=o.e.r){var we=o.e.r;o.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Xe(o),o.e.r=we}o.e.r++,o.e.c++}M.length>0&&(s["!merges"]=M),A.length>0&&(s["!objects"]=A),F.length>0&&(s["!cols"]=F),H.length>0&&(s["!rows"]=H),N.Sheets.push(k)}d===""?u=s:a[d]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(C.biff===8&&(C.biff={9:2,521:3,1033:4}[me]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[D.BIFFVer]||8),C.biffguess=D.BIFFVer==0,D.BIFFVer==0&&D.dt==4096&&(C.biff=5,re=!0,nn(C.codepage=28591)),C.biff==8&&D.BIFFVer==0&&D.dt==16&&(C.biff=2),ee++)break;if(s=t.dense?[]:{},C.biff<8&&!re&&(re=!0,nn(C.codepage=t.codepage||1252)),C.biff<5||D.BIFFVer==0&&D.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var Ae={pos:e.l-Q,name:d};i[Ae.pos]=Ae,C.snames.push(d)}else d=(i[xe]||{name:""}).name;D.dt==32&&(s["!type"]="chart"),D.dt==64&&(s["!type"]="macro"),M=[],A=[],C.arrayf=w=[],F=[],H=[],V=!1,k={Hidden:(i[xe]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[D.r]||[])[D.c]:s[Le({c:D.c,r:D.r})])&&++D.c,v={ixfe:D.ixfe,XF:b[D.ixfe]||{},v:D.val,t:"n"},I>0&&(v.z=K[v.ixfe>>8&63]),hn(v,t,r.opts.Date1904),P({c:D.c,r:D.r},v,t);break;case 5:case 517:v={ixfe:D.ixfe,XF:b[D.ixfe],v:D.val,t:D.t},I>0&&(v.z=K[v.ixfe>>8&63]),hn(v,t,r.opts.Date1904),P({c:D.c,r:D.r},v,t);break;case 638:v={ixfe:D.ixfe,XF:b[D.ixfe],v:D.rknum,t:"n"},I>0&&(v.z=K[v.ixfe>>8&63]),hn(v,t,r.opts.Date1904),P({c:D.c,r:D.r},v,t);break;case 189:for(var ce=D.c;ce<=D.C;++ce){var he=D.rkrec[ce-D.c][0];v={ixfe:he,XF:b[he],v:D.rkrec[ce-D.c][1],t:"n"},I>0&&(v.z=K[v.ixfe>>8&63]),hn(v,t,r.opts.Date1904),P({c:ce,r:D.r},v,t)}break;case 6:case 518:case 1030:{if(D.val=="String"){l=D;break}if(v=Qd(D.val,D.cell.ixfe,D.tt),v.XF=b[v.ixfe],t.cellFormula){var oe=D.formula;if(oe&&oe[0]&&oe[0][0]&&oe[0][0][0]=="PtgExp"){var Ve=oe[0][0][1][0],ct=oe[0][0][1][1],nt=Le({r:Ve,c:ct});y[nt]?v.f=""+Vr(D.formula,o,D.cell,B,C):v.F=((t.dense?(s[Ve]||[])[ct]:s[nt])||{}).F}else v.f=""+Vr(D.formula,o,D.cell,B,C)}I>0&&(v.z=K[v.ixfe>>8&63]),hn(v,t,r.opts.Date1904),P(D.cell,v,t),l=D}break;case 7:case 519:if(l)l.val=D,v=Qd(D,l.cell.ixfe,"s"),v.XF=b[v.ixfe],t.cellFormula&&(v.f=""+Vr(l.formula,o,l.cell,B,C)),I>0&&(v.z=K[v.ixfe>>8&63]),hn(v,t,r.opts.Date1904),P(l.cell,v,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(D);var At=Le(D[0].s);if(m=t.dense?(s[D[0].s.r]||[])[D[0].s.c]:s[At],t.cellFormula&&m){if(!l||!At||!m)break;m.f=""+Vr(D[1],o,D[0],B,C),m.F=Xe(D[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!l)break;y[Le(l.cell)]=D[0],m=t.dense?(s[l.cell.r]||[])[l.cell.c]:s[Le(l.cell)],(m||{}).f=""+Vr(D[0],o,f,B,C)}}break;case 253:v=Qd(c[D.isst].t,D.ixfe,"s"),c[D.isst].h&&(v.h=c[D.isst].h),v.XF=b[v.ixfe],I>0&&(v.z=K[v.ixfe>>8&63]),hn(v,t,r.opts.Date1904),P({c:D.c,r:D.r},v,t);break;case 513:t.sheetStubs&&(v={ixfe:D.ixfe,XF:b[D.ixfe],t:"z"},I>0&&(v.z=K[v.ixfe>>8&63]),hn(v,t,r.opts.Date1904),P({c:D.c,r:D.r},v,t));break;case 190:if(t.sheetStubs)for(var Xt=D.c;Xt<=D.C;++Xt){var er=D.ixfe[Xt-D.c];v={ixfe:er,XF:b[er],t:"z"},I>0&&(v.z=K[v.ixfe>>8&63]),hn(v,t,r.opts.Date1904),P({c:Xt,r:D.r},v,t)}break;case 214:case 516:case 4:v=Qd(D.val,D.ixfe,"s"),v.XF=b[v.ixfe],I>0&&(v.z=K[v.ixfe>>8&63]),hn(v,t,r.opts.Date1904),P({c:D.c,r:D.r},v,t);break;case 0:case 512:ee===1&&(o=D);break;case 252:c=D;break;case 1054:if(C.biff==4){K[I++]=D[1];for(var ea=0;ea<I+163&&Me[ea]!=D[1];++ea);ea>=163&&qn(D[1],I+163)}else qn(D[1],D[0]);break;case 30:{K[I++]=D;for(var la=0;la<I+163&&Me[la]!=D;++la);la>=163&&qn(D,I+163)}break;case 229:M=M.concat(D);break;case 93:A[D.cmo[0]]=C.lastobj=D;break;case 438:C.lastobj.TxO=D;break;case 127:C.lastobj.ImData=D;break;case 440:for(g=D[0].s.r;g<=D[0].e.r;++g)for(p=D[0].s.c;p<=D[0].e.c;++p)m=t.dense?(s[g]||[])[p]:s[Le({c:p,r:g})],m&&(m.l=D[1]);break;case 2048:for(g=D[0].s.r;g<=D[0].e.r;++g)for(p=D[0].s.c;p<=D[0].e.c;++p)m=t.dense?(s[g]||[])[p]:s[Le({c:p,r:g})],m&&m.l&&(m.l.Tooltip=D[1]);break;case 28:{if(C.biff<=5&&C.biff>=2)break;m=t.dense?(s[D[0].r]||[])[D[0].c]:s[Le(D[0])];var Ms=A[D[2]];m||(t.dense?(s[D[0].r]||(s[D[0].r]=[]),m=s[D[0].r][D[0].c]={t:"z"}):m=s[Le(D[0])]={t:"z"},o.e.r=Math.max(o.e.r,D[0].r),o.s.r=Math.min(o.s.r,D[0].r),o.e.c=Math.max(o.e.c,D[0].c),o.s.c=Math.min(o.s.c,D[0].c)),m.c||(m.c=[]),x={a:D[1],t:Ms.TxO.t},m.c.push(x)}break;case 2173:Tne(b[D.ixfe],D.ext);break;case 125:{if(!C.cellStyles)break;for(;D.e>=D.s;)F[D.e--]={width:D.w/256,level:D.level||0,hidden:!!(D.flags&1)},V||(V=!0,jg(D.w/256)),_s(F[D.e+1])}break;case 520:{var Fr={};D.level!=null&&(H[D.r]=Fr,Fr.level=D.level),D.hidden&&(H[D.r]=Fr,Fr.hidden=!0),D.hpt&&(H[D.r]=Fr,Fr.hpt=D.hpt,Fr.hpx=zo(D.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||ui(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[me]]=D;break;case 161:s["!margins"]||ui(s["!margins"]={}),s["!margins"].header=D.header,s["!margins"].footer=D.footer;break;case 574:D.RTL&&(N.Views[0].RTL=!0);break;case 146:j=D;break;case 2198:T=D;break;case 140:_=D;break;case 442:d?k.CodeName=D||k.name:N.WBProps.CodeName=D||"ThisWorkbook";break}}else q||console.error("Missing Info for XLS Record 0x"+me.toString(16)),e.l+=Q}return r.SheetNames=Qt(i).sort(function(Ca,Qe){return Number(Ca)-Number(Qe)}).map(function(Ca){return i[Ca].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&z.forEach(function(Ca,Qe){r.Sheets[r.SheetNames[Qe]]["!autofilter"]=Ca}),r.Strings=c,r.SSF=Bt(Me),C.enc&&(r.Encryption=C.enc),T&&(r.Themes=T),r.Metadata={},_!==void 0&&(r.Metadata.Country=_),B.names.length>0&&(N.Names=B.names),r.Workbook=N,r}var ec={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Hce(e,t,r){var a=Fe.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var s=Lw(a,wx,ec.DSI);for(var i in s)t[i]=s[i]}catch(d){if(r.WTF)throw d}var o=Fe.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=Lw(o,jx,ec.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(W4(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function zce(e,t){var r=[],a=[],s=[],i=0,o,l=xw(wx,"n"),c=xw(jx,"n");if(e.Props)for(o=Qt(e.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?a:s).push([o[i],e.Props[o[i]]]);if(e.Custprops)for(o=Qt(e.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?a:s).push([o[i],e.Custprops[o[i]]]);var d=[];for(i=0;i<s.length;++i)X4.indexOf(s[i][0])>-1||U4.indexOf(s[i][0])>-1||s[i][1]!=null&&d.push(s[i]);a.length&&Fe.utils.cfb_add(t,"/SummaryInformation",Bw(a,ec.SI,c,jx)),(r.length||d.length)&&Fe.utils.cfb_add(t,"/DocumentSummaryInformation",Bw(r,ec.DSI,l,wx,d.length?d:null,ec.UDI))}function zk(e,t){t||(t={}),Pg(t),Zp(),t.codepage&&Jp(t.codepage);var r,a;if(e.FullPaths){if(Fe.find(e,"/encryption"))throw new Error("File is password-protected");r=Fe.find(e,"!CompObj"),a=Fe.find(e,"/Workbook")||Fe.find(e,"/Book")}else{switch(t.type){case"base64":e=_a(Pa(e));break;case"binary":e=_a(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Rr(e,0),a={content:e}}var s,i;if(r&&Lce(r),t.bookProps&&!t.bookSheets)s={};else{var o=rt?"buffer":"array";if(a&&a.content)s=Wce(a.content,t);else if((i=Fe.find(e,"PerfectOffice_MAIN"))&&i.content)s=di.to_workbook(i.content,(t.type=o,t));else if((i=Fe.find(e,"NativeContent_MAIN"))&&i.content)s=di.to_workbook(i.content,(t.type=o,t));else throw(i=Fe.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Fe.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=ase(e))}var l={};return e.FullPaths&&Hce(e,l,t),s.Props=s.Custprops=l,t.bookFiles&&(s.cfb=e),s}function Vce(e,t){var r=t||{},a=Fe.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Fe.utils.cfb_add(a,s,Vk(e,r)),r.biff==8&&(e.Props||e.Custprops)&&zce(e,a),r.biff==8&&e.vbaraw&&nse(a,Fe.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var td={0:{f:xoe},1:{f:Noe},2:{f:Woe},3:{f:Poe},4:{f:Eoe},5:{f:Loe},6:{f:Koe},7:{f:Doe},8:{f:ele},9:{f:Qoe},10:{f:Joe},11:{f:Zoe},12:{f:Soe},13:{f:zoe},14:{f:Foe},15:{f:Toe},16:{f:Rk},17:{f:Xoe},18:{f:Moe},19:{f:fg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Xle},40:{},42:{},43:{f:Kae},44:{f:Vae},45:{f:Yae},46:{f:Zae},47:{f:Jae},48:{},49:{f:vee},50:{},51:{f:Cne},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:ik},62:{f:Goe},63:{f:Une},64:{f:ple},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Yr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:fle},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:woe},148:{f:voe,p:16},151:{f:ile},152:{},153:{f:Gle},154:{},155:{},156:{f:zle},157:{},158:{},159:{T:1,f:lae},160:{T:-1},161:{T:1,f:Wi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:tle},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:One},336:{T:-1},337:{f:Dne,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:bx},357:{},358:{},359:{},360:{T:1},361:{},362:{f:sk},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:ole},427:{f:lle},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:dle},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:boe},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:nle},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:bx},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Zne},633:{T:1},634:{T:-1},635:{T:1,f:Yne},636:{T:-1},637:{f:jee},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Fle},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:gle},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Ax={6:{f:Sh},10:{f:us},12:{f:fr},13:{f:fr},14:{f:rr},15:{f:rr},16:{f:qr},17:{f:rr},18:{f:rr},19:{f:fr},20:{f:Gw},21:{f:Gw},23:{f:sk},24:{f:qw},25:{f:rr},26:{},27:{},28:{f:gre},29:{},34:{f:rr},35:{f:Kw},38:{f:qr},39:{f:qr},40:{f:qr},41:{f:qr},42:{f:rr},43:{f:rr},47:{f:Tae},49:{f:zte},51:{f:fr},60:{},61:{f:Lte},64:{f:rr},65:{f:Hte},66:{f:fr},77:{},80:{},81:{},82:{},85:{f:fr},89:{},90:{},91:{},92:{f:Ate},93:{f:bre},94:{},95:{f:rr},96:{},97:{},99:{f:rr},125:{f:ik},128:{f:sre},129:{f:Ote},130:{f:fr},131:{f:rr},132:{f:rr},133:{f:Pte},134:{},140:{f:Are},141:{f:fr},144:{},146:{f:Pre},151:{},152:{},153:{},154:{},155:{},156:{f:fr},157:{},158:{},160:{f:$re},161:{f:Ire},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:tre},190:{f:rre},193:{f:us},197:{},198:{},199:{},200:{},201:{},202:{f:rr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:fr},220:{},221:{f:rr},222:{},224:{f:nre},225:{f:Ete},226:{f:us},227:{},229:{f:vre},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Fte},253:{f:Gte},255:{f:Dte},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Y4},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:rr},353:{f:us},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:dre},431:{f:rr},432:{},433:{},434:{},437:{},438:{f:Nre},439:{f:rr},440:{f:_re},441:{},442:{f:wd},443:{},444:{f:fr},445:{},446:{},448:{f:us},449:{f:$te,r:2},450:{f:us},512:{f:Hw},513:{f:Mre},515:{f:lre},516:{f:qte},517:{f:Vw},519:{f:Lre},520:{f:Rte},523:{},545:{f:Xw},549:{f:Ww},566:{},574:{f:Ute},638:{f:ere},659:{},1048:{},1054:{f:Yte},1084:{},1212:{f:mre},2048:{f:kre},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Yd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:us},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Cre,r:12},2173:{f:Ane,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:rr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:hre,r:12},2197:{},2198:{f:jne,r:12},2199:{},2200:{},2201:{},2202:{f:xre,r:12},2203:{f:us},2204:{},2205:{},2206:{},2207:{},2211:{f:Mte},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:fr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Dre},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Ore},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Hw},1:{},2:{f:zre},3:{f:Wre},4:{f:Ure},5:{f:Vw},7:{f:Gre},8:{},9:{f:Yd},11:{},22:{f:fr},30:{f:Zte},31:{},32:{},33:{f:Xw},36:{},37:{f:Ww},50:{f:Kre},62:{},52:{},67:{},68:{f:fr},69:{},86:{},126:{},127:{f:Bre},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:qre},223:{},234:{},354:{},421:{},518:{f:Sh},521:{f:Yd},536:{f:qw},547:{f:Kw},561:{},579:{},1030:{f:Sh},1033:{f:Yd},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Se(e,t,r,a){var s=t;if(!isNaN(s)){var i=a||(r||[]).length||0,o=e.next(4);o.write_shift(2,s),o.write_shift(2,i),i>0&&cg(r)&&e.push(r)}}function Gce(e,t,r,a){var s=(r||[]).length||0;if(s<=8224)return Se(e,t,r,s);var i=t;if(!isNaN(i)){for(var o=r.parts||[],l=0,c=0,d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;var u=e.next(4);for(u.write_shift(2,i),u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d;c<s;){for(u=e.next(4),u.write_shift(2,60),d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d}}}function Sd(e,t,r){return e||(e=de(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Kce(e,t,r,a){var s=de(9);return Sd(s,e,t),J4(r,a||"b",s),s}function qce(e,t,r){var a=de(8+2*r.length);return Sd(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function Xce(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?Nr(Lt(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?Se(e,2,Vre(r,a,s)):Se(e,3,Hre(r,a,s));return;case"b":case"e":Se(e,5,Kce(r,a,t.v,t.t));return;case"s":case"str":Se(e,4,qce(r,a,(t.v||"").slice(0,255)));return}Se(e,1,Sd(null,r,a))}function Yce(e,t,r,a){var s=Array.isArray(t),i=ft(t["!ref"]||"A1"),o,l="",c=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=Xe(i)}for(var d=i.s.r;d<=i.e.r;++d){l=or(d);for(var u=i.s.c;u<=i.e.c;++u){d===i.s.r&&(c[u]=Kt(u)),o=c[u]+l;var f=s?(t[d]||[])[u]:t[o];f&&Xce(e,f,d,u)}}}function Jce(e,t){for(var r=t||{},a=ma(),s=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(s=i);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Se(a,r.biff==4?1033:r.biff==3?521:9,yg(e,16,r)),Yce(a,e.Sheets[e.SheetNames[s]],s,r),Se(a,10),a.end()}function Zce(e,t,r){Se(e,49,Vte({sz:12,name:"Arial"},r))}function Qce(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&Se(e,1054,Jte(s,t[s],r))})}function ede(e,t){var r=de(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Se(e,2151,r),r=de(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),rk(ft(t["!ref"]||"A1"),r),r.write_shift(4,4),Se(e,2152,r)}function tde(e,t){for(var r=0;r<16;++r)Se(e,224,zw({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){Se(e,224,zw(a,0,t))})}function rde(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];Se(e,440,Sre(a)),a[1].Tooltip&&Se(e,2048,Ere(a))}delete t["!links"]}function ade(e,t){if(t){var r=0;t.forEach(function(a,s){++r<=256&&a&&Se(e,125,Fre(R0(s,a),s))})}}function nde(e,t,r,a,s){var i=16+Rs(s.cellXfs,t,s);if(t.v==null&&!t.bf){Se(e,513,Ai(r,a,i));return}if(t.bf)Se(e,6,Oie(t,r,a,s,i));else switch(t.t){case"d":case"n":var o=t.t=="d"?Nr(Lt(t.v)):t.v;Se(e,515,cre(r,a,o,i));break;case"b":case"e":Se(e,517,ore(r,a,t.v,i,s,t.t));break;case"s":case"str":if(s.bookSST){var l=Eg(s.Strings,t.v,s.revStrings);Se(e,253,Kte(r,a,l,i))}else Se(e,516,Xte(r,a,(t.v||"").slice(0,255),i,s));break;default:Se(e,513,Ai(r,a,i))}}function sde(e,t,r){var a=ma(),s=r.SheetNames[e],i=r.Sheets[s]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(i),d=t.biff==8,u,f="",h=[],m=ft(i["!ref"]||"A1"),x=d?65536:16384;if(m.e.c>255||m.e.r>=x){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,x-1)}Se(a,2057,yg(r,16,t)),Se(a,13,Ua(1)),Se(a,12,Ua(100)),Se(a,15,ra(!0)),Se(a,17,ra(!1)),Se(a,16,ki(.001)),Se(a,95,ra(!0)),Se(a,42,ra(!1)),Se(a,43,ra(!1)),Se(a,130,Ua(1)),Se(a,128,ire()),Se(a,131,ra(!1)),Se(a,132,ra(!1)),d&&ade(a,i["!cols"]),Se(a,512,Qte(m,t)),d&&(i["!links"]=[]);for(var p=m.s.r;p<=m.e.r;++p){f=or(p);for(var g=m.s.c;g<=m.e.c;++g){p===m.s.r&&(h[g]=Kt(g)),u=h[g]+f;var y=c?(i[p]||[])[g]:i[u];y&&(nde(a,y,p,g,t),d&&y.l&&i["!links"].push([u,y.l]))}}var w=l.CodeName||l.name||s;return d&&Se(a,574,Wte((o.Views||[])[0])),d&&(i["!merges"]||[]).length&&Se(a,229,yre(i["!merges"])),d&&rde(a,i),Se(a,442,Z4(w)),d&&ede(a,i),Se(a,10),a.end()}function ide(e,t,r){var a=ma(),s=(e||{}).Workbook||{},i=s.Sheets||[],o=s.WBProps||{},l=r.biff==8,c=r.biff==5;if(Se(a,2057,yg(e,5,r)),r.bookType=="xla"&&Se(a,135),Se(a,225,l?Ua(1200):null),Se(a,193,ote(2)),c&&Se(a,191),c&&Se(a,192),Se(a,226),Se(a,92,Tte("SheetJS",r)),Se(a,66,Ua(l?1200:1252)),l&&Se(a,353,Ua(0)),l&&Se(a,448),Se(a,317,Rre(e.SheetNames.length)),l&&e.vbaraw&&Se(a,211),l&&e.vbaraw){var d=o.CodeName||"ThisWorkbook";Se(a,442,Z4(d))}Se(a,156,Ua(17)),Se(a,25,ra(!1)),Se(a,18,ra(!1)),Se(a,19,Ua(0)),l&&Se(a,431,ra(!1)),l&&Se(a,444,Ua(0)),Se(a,61,Bte()),Se(a,64,ra(!1)),Se(a,141,Ua(0)),Se(a,34,ra($le(e)=="true")),Se(a,14,ra(!0)),l&&Se(a,439,ra(!1)),Se(a,218,Ua(0)),Zce(a,e,r),Qce(a,e.SSF,r),tde(a,r),l&&Se(a,352,ra(!1));var u=a.end(),f=ma();l&&Se(f,140,Tre()),l&&r.Strings&&Gce(f,252,Ite(r.Strings)),Se(f,10);var h=f.end(),m=ma(),x=0,p=0;for(p=0;p<e.SheetNames.length;++p)x+=(l?12:11)+(l?2:1)*e.SheetNames[p].length;var g=u.length+x+h.length;for(p=0;p<e.SheetNames.length;++p){var y=i[p]||{};Se(m,133,Cte({pos:g,hs:y.Hidden||0,dt:0,name:e.SheetNames[p]},r)),g+=t[p].length}var w=m.end();if(x!=w.length)throw new Error("BS8 "+x+" != "+w.length);var v=[];return u.length&&v.push(u),w.length&&v.push(w),h.length&&v.push(h),Ar(v)}function ode(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=Bt(Me)),e&&e.SSF&&(ll(),T0(e.SSF),r.revssf=P0(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Cg(r),r.cellXfs=[],Rs(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)a[a.length]=sde(s,r,e);return a.unshift(ide(e,a,r)),Ar(a)}function Vk(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var s=pa(a["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return ode(e,t);case 4:case 3:case 2:return Jce(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function sj(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),o=s.index,l=i&&i.index||e.length,c=VQ(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,u=0,f=0,h=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(o=0;o<c.length;++o){var p=c[o].trim(),g=p.slice(0,3).toLowerCase();if(g=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}u=0;continue}if(!(g!="<td"&&g!="<th")){var y=p.split(/<\/t[dh]>/i);for(l=0;l<y.length;++l){var w=y[l].trim();if(w.match(/<t[dh]/i)){for(var v=w,_=0;v.charAt(0)=="<"&&(_=v.indexOf(">"))>-1;)v=v.slice(_+1);for(var b=0;b<x.length;++b){var j=x[b];j.s.c==u&&j.s.r<d&&d<=j.e.r&&(u=j.e.c+1,b=-1)}var N=Be(w.slice(0,w.indexOf(">")));h=N.colspan?+N.colspan:1,((f=+N.rowspan)>1||h>1)&&x.push({s:{r:d,c:u},e:{r:d+(f||1)-1,c:u+h-1}});var k=N.t||N["data-t"]||"";if(!v.length){u+=h;continue}if(v=x4(v),m.s.r>d&&(m.s.r=d),m.e.r<d&&(m.e.r=d),m.s.c>u&&(m.s.c=u),m.e.c<u&&(m.e.c=u),!v.length){u+=h;continue}var S={t:"s",v};r.raw||!v.trim().length||k=="s"||(v==="TRUE"?S={t:"b",v:!0}:v==="FALSE"?S={t:"b",v:!1}:isNaN(ln(v))?isNaN(Wo(v).getDate())||(S={t:"d",v:Lt(v)},r.cellDates||(S={t:"n",v:Nr(S.v)}),S.z=r.dateNF||Me[14]):S={t:"n",v:ln(v)}),r.dense?(a[d]||(a[d]=[]),a[d][u]=S):a[Le({r:d,c:u})]=S,u+=h}}}}return a["!ref"]=Xe(m),x.length&&(a["!merges"]=x),a}function lde(e,t,r,a){for(var s=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,d=0;d<s.length;++d)if(!(s[d].s.r>r||s[d].s.c>o)&&!(s[d].e.r<r||s[d].e.c<o)){if(s[d].s.r<r||s[d].s.c<o){l=-1;break}l=s[d].e.r-s[d].s.r+1,c=s[d].e.c-s[d].s.c+1;break}if(!(l<0)){var u=Le({r,c:o}),f=a.dense?(e[r]||[])[o]:e[u],h=f&&f.v!=null&&(f.h||ig(f.w||(rs(f),f.w)||""))||"",m={};l>1&&(m.rowspan=l),c>1&&(m.colspan=c),a.editable?h='<span contenteditable="true">'+h+"</span>":f&&(m["data-t"]=f&&f.t||"z",f.v!=null&&(m["data-v"]=f.v),f.z!=null&&(m["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),m.id=(a.id||"sjs")+"-"+u,i.push(_e("td",h,m))}}var x="<tr>";return x+i.join("")+"</tr>"}var cde='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',dde="</body></html>";function ude(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ds(sj(r[0],t),t);var a=Dg();return r.forEach(function(s,i){Rg(a,sj(s,t),"Sheet"+(i+1))}),a}function fde(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Gk(e,t){var r=t||{},a=r.header!=null?r.header:cde,s=r.footer!=null?r.footer:dde,i=[a],o=pa(e["!ref"]);r.dense=Array.isArray(e),i.push(fde(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)i.push(lde(e,o,l,r));return i.push("</table>"+s),i.join("")}function Kk(e,t,r){var a=r||{},s=0,i=0;if(a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var o=typeof a.origin=="string"?qt(a.origin):a.origin;s=o.r,i=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(a.sheetRows||1e7,l.length),d={s:{r:0,c:0},e:{r:s,c:i}};if(e["!ref"]){var u=pa(e["!ref"]);d.s.r=Math.min(d.s.r,u.s.r),d.s.c=Math.min(d.s.c,u.s.c),d.e.r=Math.max(d.e.r,u.e.r),d.e.c=Math.max(d.e.c,u.e.c),s==-1&&(d.e.r=s=u.e.r+1)}var f=[],h=0,m=e["!rows"]||(e["!rows"]=[]),x=0,p=0,g=0,y=0,w=0,v=0;for(e["!cols"]||(e["!cols"]=[]);x<l.length&&p<c;++x){var _=l[x];if(ij(_)){if(a.display)continue;m[p]={hidden:!0}}var b=_.children;for(g=y=0;g<b.length;++g){var j=b[g];if(!(a.display&&ij(j))){var N=j.hasAttribute("data-v")?j.getAttribute("data-v"):j.hasAttribute("v")?j.getAttribute("v"):x4(j.innerHTML),k=j.getAttribute("data-z")||j.getAttribute("z");for(h=0;h<f.length;++h){var S=f[h];S.s.c==y+i&&S.s.r<p+s&&p+s<=S.e.r&&(y=S.e.c+1-i,h=-1)}v=+j.getAttribute("colspan")||1,((w=+j.getAttribute("rowspan")||1)>1||v>1)&&f.push({s:{r:p+s,c:y+i},e:{r:p+s+(w||1)-1,c:y+i+(v||1)-1}});var E={t:"s",v:N},P=j.getAttribute("data-t")||j.getAttribute("t")||"";N!=null&&(N.length==0?E.t=P||"z":a.raw||N.trim().length==0||P=="s"||(N==="TRUE"?E={t:"b",v:!0}:N==="FALSE"?E={t:"b",v:!1}:isNaN(ln(N))?isNaN(Wo(N).getDate())||(E={t:"d",v:Lt(N)},a.cellDates||(E={t:"n",v:Nr(E.v)}),E.z=a.dateNF||Me[14]):E={t:"n",v:ln(N)})),E.z===void 0&&k!=null&&(E.z=k);var C="",T=j.getElementsByTagName("A");if(T&&T.length)for(var M=0;M<T.length&&!(T[M].hasAttribute("href")&&(C=T[M].getAttribute("href"),C.charAt(0)!="#"));++M);C&&C.charAt(0)!="#"&&(E.l={Target:C}),a.dense?(e[p+s]||(e[p+s]=[]),e[p+s][y+i]=E):e[Le({c:y+i,r:p+s})]=E,d.e.c<y+i&&(d.e.c=y+i),y+=v}}++p}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),d.e.r=Math.max(d.e.r,p-1+s),e["!ref"]=Xe(d),p>=c&&(e["!fullref"]=Xe((d.e.r=l.length-x+p-1+s,d))),e}function qk(e,t){var r=t||{},a=r.dense?[]:{};return Kk(a,e,t)}function hde(e,t){return Ds(qk(e,t),t)}function ij(e){var t="",r=mde(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function mde(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function xde(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=dt(t.replace(/<[^>]*>/g,""));return[r]}var oj={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Xk(e,t){var r=t||{},a=og(e),s=[],i,o,l={name:""},c="",d=0,u,f,h={},m=[],x=r.dense?[]:{},p,g,y={value:""},w="",v=0,_=[],b=-1,j=-1,N={s:{r:1e6,c:1e7},e:{r:0,c:0}},k=0,S={},E=[],P={},C=0,T=0,M=[],A=1,F=1,H=[],V={Names:[]},B={},L=["",""],ee=[],I={},K="",z=0,W=!1,re=!1,xe=0;for(Xc.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=Xc.exec(a);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"工作表":p[1]==="/"?(N.e.c>=N.s.c&&N.e.r>=N.s.r?x["!ref"]=Xe(N):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=N.e.r&&(x["!fullref"]=x["!ref"],N.e.r=r.sheetRows-1,x["!ref"]=Xe(N)),E.length&&(x["!merges"]=E),M.length&&(x["!rows"]=M),u.name=u.名称||u.name,typeof JSON<"u"&&JSON.stringify(u),m.push(u.name),h[u.name]=x,re=!1):p[0].charAt(p[0].length-2)!=="/"&&(u=Be(p[0],!1),b=j=-1,N.s.r=N.s.c=1e7,N.e.r=N.e.c=0,x=r.dense?[]:{},E=[],M=[],re=!0);break;case"table-row-group":p[1]==="/"?--k:++k;break;case"table-row":case"行":if(p[1]==="/"){b+=A,A=1;break}if(f=Be(p[0],!1),f.行号?b=f.行号-1:b==-1&&(b=0),A=+f["number-rows-repeated"]||1,A<10)for(xe=0;xe<A;++xe)k>0&&(M[b+xe]={level:k});j=-1;break;case"covered-table-cell":p[1]!=="/"&&++j,r.sheetStubs&&(r.dense?(x[b]||(x[b]=[]),x[b][j]={t:"z"}):x[Le({r:b,c:j})]={t:"z"}),w="",_=[];break;case"table-cell":case"数据":if(p[0].charAt(p[0].length-2)==="/")++j,y=Be(p[0],!1),F=parseInt(y["number-columns-repeated"]||"1",10),g={t:"z",v:null},y.formula&&r.cellFormula!=!1&&(g.f=rj(dt(y.formula))),(y.数据类型||y["value-type"])=="string"&&(g.t="s",g.v=dt(y["string-value"]||""),r.dense?(x[b]||(x[b]=[]),x[b][j]=g):x[Le({r:b,c:j})]=g),j+=F-1;else if(p[1]!=="/"){++j,w="",v=0,_=[],F=1;var me=A?b+A-1:b;if(j>N.e.c&&(N.e.c=j),j<N.s.c&&(N.s.c=j),b<N.s.r&&(N.s.r=b),me>N.e.r&&(N.e.r=me),y=Be(p[0],!1),ee=[],I={},g={t:y.数据类型||y["value-type"],v:null},r.cellFormula)if(y.formula&&(y.formula=dt(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(C=parseInt(y["number-matrix-rows-spanned"],10)||0,T=parseInt(y["number-matrix-columns-spanned"],10)||0,P={s:{r:b,c:j},e:{r:b+C-1,c:j+T-1}},g.F=Xe(P),H.push([P,g.F])),y.formula)g.f=rj(y.formula);else for(xe=0;xe<H.length;++xe)b>=H[xe][0].s.r&&b<=H[xe][0].e.r&&j>=H[xe][0].s.c&&j<=H[xe][0].e.c&&(g.F=H[xe][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(C=parseInt(y["number-rows-spanned"],10)||0,T=parseInt(y["number-columns-spanned"],10)||0,P={s:{r:b,c:j},e:{r:b+C-1,c:j+T-1}},E.push(P)),y["number-columns-repeated"]&&(F=parseInt(y["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=$t(y["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(y.value);break;case"percentage":g.t="n",g.v=parseFloat(y.value);break;case"currency":g.t="n",g.v=parseFloat(y.value);break;case"date":g.t="d",g.v=Lt(y["date-value"]),r.cellDates||(g.t="n",g.v=Nr(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=WQ(y["time-value"])/86400,r.cellDates&&(g.t="d",g.v=C0(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(y.数据数值);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",y["string-value"]!=null&&(w=dt(y["string-value"]),_=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(W=!1,g.t==="s"&&(g.v=w||"",_.length&&(g.R=_),W=v==0),B.Target&&(g.l=B),ee.length>0&&(g.c=ee,ee=[]),w&&r.cellText!==!1&&(g.w=w),W&&(g.t="z",delete g.v),(!W||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=b))for(var Q=0;Q<A;++Q){if(F=parseInt(y["number-columns-repeated"]||"1",10),r.dense)for(x[b+Q]||(x[b+Q]=[]),x[b+Q][j]=Q==0?g:Bt(g);--F>0;)x[b+Q][j+F]=Bt(g);else for(x[Le({r:b+Q,c:j})]=g;--F>0;)x[Le({r:b+Q,c:j+F})]=Bt(g);N.e.c<=j&&(N.e.c=j)}F=parseInt(y["number-columns-repeated"]||"1",10),j+=F-1,F=0,g={},w="",_=[]}B={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((i=s.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((i=s.pop())[0]!==p[3])throw"Bad state: "+i;I.t=w,_.length&&(I.R=_),I.a=K,ee.push(I)}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!1]);K="",z=0,w="",v=0,_=[];break;case"creator":p[1]==="/"?K=a.slice(z,p.index):z=p.index+p[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((i=s.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!1]);w="",v=0,_=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(S[l.name]=c,(i=s.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&(c="",l=Be(p[0],!1),s.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=Be(p[0],!1),c+=oj[p[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=Be(p[0],!1),c+=oj[p[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=a.slice(d,p.index);break}else d=p.index+p[0].length;break;case"named-range":o=Be(p[0],!1),L=kh(o["cell-range-address"]);var q={Name:o.name,Ref:L[0]+"!"+L[1]};re&&(q.Sheet=m.length),V.Names.push(q);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(p[1]==="/"&&(!y||!y["string-value"])){var se=xde(a.slice(v,p.index));w=(w.length>0?w+`
`:"")+se[0]}else Be(p[0],!1),v=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{L=kh(Be(p[0])["target-range-address"]),h[L[0]]["!autofilter"]={ref:L[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(B=Be(p[0],!1),!B.href)break;B.Target=dt(B.href),delete B.href,B.Target.charAt(0)=="#"&&B.Target.indexOf(".")>-1?(L=kh(B.Target.slice(1)),B.Target="#"+L[0]+"!"+L[1]):B.Target.match(/^\.\.[\\\/]/)&&(B.Target=B.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(p)}}var D={Sheets:h,SheetNames:m,Workbook:V};return r.bookSheets&&delete D.Sheets,D}function lj(e,t){t=t||{},Ba(e,"META-INF/manifest.xml")&&Wee(ur(e,"META-INF/manifest.xml"),t);var r=Sa(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=Xk(Ot(r),t);return Ba(e,"meta.xml")&&(a.Props=L4(ur(e,"meta.xml"))),a}function cj(e,t){return Xk(e,t)}var pde=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+qc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return lr+t}}(),dj=function(){var e=function(i){return St(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(i,o,l){var c=[];c.push('      <table:table table:name="'+St(o.SheetNames[l])+`" table:style-name="ta1">
`);var d=0,u=0,f=pa(i["!ref"]||"A1"),h=i["!merges"]||[],m=0,x=Array.isArray(i);if(i["!cols"])for(u=0;u<=f.e.c;++u)c.push("        <table:table-column"+(i["!cols"][u]?' table:style-name="co'+i["!cols"][u].ods+'"':"")+`></table:table-column>
`);var p="",g=i["!rows"]||[];for(d=0;d<f.s.r;++d)p=g[d]?' table:style-name="ro'+g[d].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;d<=f.e.r;++d){for(p=g[d]?' table:style-name="ro'+g[d].ods+'"':"",c.push("        <table:table-row"+p+`>
`),u=0;u<f.s.c;++u)c.push(t);for(;u<=f.e.c;++u){var y=!1,w={},v="";for(m=0;m!=h.length;++m)if(!(h[m].s.c>u)&&!(h[m].s.r>d)&&!(h[m].e.c<u)&&!(h[m].e.r<d)){(h[m].s.c!=u||h[m].s.r!=d)&&(y=!0),w["table:number-columns-spanned"]=h[m].e.c-h[m].s.c+1,w["table:number-rows-spanned"]=h[m].e.r-h[m].s.r+1;break}if(y){c.push(r);continue}var _=Le({r:d,c:u}),b=x?(i[d]||[])[u]:i[_];if(b&&b.f&&(w["table:formula"]=St(Rie(b.f)),b.F&&b.F.slice(0,_.length)==_)){var j=pa(b.F);w["table:number-matrix-columns-spanned"]=j.e.c-j.s.c+1,w["table:number-matrix-rows-spanned"]=j.e.r-j.s.r+1}if(!b){c.push(t);continue}switch(b.t){case"b":v=b.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=b.v?"true":"false";break;case"n":v=b.w||String(b.v||0),w["office:value-type"]="float",w["office:value"]=b.v||0;break;case"s":case"str":v=b.v==null?"":b.v,w["office:value-type"]="string";break;case"d":v=b.w||Lt(b.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=Lt(b.v).toISOString(),w["table:style-name"]="ce1";break;default:c.push(t);continue}var N=e(v);if(b.l&&b.l.Target){var k=b.l.Target;k=k.charAt(0)=="#"?"#"+Mie(k.slice(1)):k,k.charAt(0)!="#"&&!k.match(/^\w+:/)&&(k="../"+k),N=_e("text:a",N,{"xlink:href":k.replace(/&/g,"&amp;")})}c.push("          "+_e("table:table-cell",_e("text:p",N,{}),w)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var u=0;u<d["!cols"].length;++u)if(d["!cols"][u]){var f=d["!cols"][u];if(f.width==null&&f.wpx==null&&f.wch==null)continue;_s(f),f.ods=l;var h=d["!cols"][u].wpx+"px";i.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),i.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var u=0;u<d["!rows"].length;++u)if(d["!rows"][u]){d["!rows"][u].ods=c;var f=d["!rows"][u].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,l){var c=[lr],d=qc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=qc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+d+u+`>
`),c.push($4().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+d+`>
`),s(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)c.push(a(o.Sheets[o.SheetNames[f]],o,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function Yk(e,t){if(t.bookType=="fods")return dj(e,t);var r=ag(),a="",s=[],i=[];return a="mimetype",Ye(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",Ye(r,a,dj(e,t)),s.push([a,"text/xml"]),i.push([a,"ContentFile"]),a="styles.xml",Ye(r,a,pde(e,t)),s.push([a,"text/xml"]),i.push([a,"StylesFile"]),a="meta.xml",Ye(r,a,lr+$4()),s.push([a,"text/xml"]),i.push([a,"MetadataFile"]),a="manifest.rdf",Ye(r,a,Vee(i)),s.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",Ye(r,a,Hee(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ti(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Tx(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Ot(Is(e))}function gde(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):_a(bn(e))}function vde(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function ks(e){var t=e.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(s){r.set(s,a),a+=s.length}),r}function uj(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function yde(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,s=t+13;s>=t;--s)a=a*256+e[s];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function bde(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var i=0;s>=1;++i,s/=256)e[t+i]=s&255;e[t+15]|=r>=0?0:128}function rd(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function Nt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Zt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function mt(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],s=rd(e,r),i=s&7;s=Math.floor(s/8);var o=0,l;if(s==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=rd(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(a))}var d={data:l,type:i};t[s]==null?t[s]=[d]:t[s].push(d)}return t}function Ir(e){var t=[];return e.forEach(function(r,a){r.forEach(function(s){s.data&&(t.push(Nt(a*8+s.type)),s.type==2&&t.push(Nt(s.data.length)),t.push(s.data))})}),ks(t)}function Og(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function $a(e){for(var t,r=[],a=[0];a[0]<e.length;){var s=rd(e,a),i=mt(e.slice(a[0],a[0]+s));a[0]+=s;var o={id:Zt(i[1][0].data),messages:[]};i[2].forEach(function(l){var c=mt(l.data),d=Zt(c[3][0].data);o.messages.push({meta:c,data:e.slice(a[0],a[0]+d)}),a[0]+=d}),(t=i[3])!=null&&t[0]&&(o.merge=Zt(i[3][0].data)>>>0>0),r.push(o)}return r}function Xi(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:Nt(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:Nt(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:Nt(o.data.length)}],a[2].push({data:Ir(o.meta),type:2})});var i=Ir(a);t.push(Nt(i.length)),t.push(i),s.forEach(function(o){return t.push(o)})}),ks(t)}function wde(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=rd(t,r),s=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}s.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,d=0;if(i==1?(d=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[ks(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(d>=c)for(s.push(s[0].slice(-c)),d-=c;d>=s[s.length-1].length;)s.push(s[s.length-1]),d-=s[s.length-1].length;s.push(s[0].slice(-c,-c+d))}}var u=ks(s);if(u.length!=a)throw new Error("Unexpected length: ".concat(u.length," != ").concat(a));return u}function La(e){for(var t=[],r=0;r<e.length;){var a=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(wde(a,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return ks(t)}function Yi(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var i=Nt(a),o=i.length;t.push(i),a<=60?(o++,t.push(new Uint8Array([a-1<<2]))):a<=256?(o+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(o+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(o+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(o+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),o+=a,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,r+=a}return ks(t)}function jde(e,t,r,a){var s=Ti(e),i=s.getUint32(4,!0),o=(a>1?12:8)+uj(i&(a>1?3470:398))*4,l=-1,c=-1,d=NaN,u=new Date(2001,0,1);i&512&&(l=s.getUint32(o,!0),o+=4),o+=uj(i&(a>1?12288:4096))*4,i&16&&(c=s.getUint32(o,!0),o+=4),i&32&&(d=s.getFloat64(o,!0),o+=8),i&64&&(u.setTime(u.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:d};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:d>0};break;case 7:f={t:"n",v:d/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(d))f={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function Nde(e,t,r){var a=Ti(e),s=a.getUint32(8,!0),i=12,o=-1,l=-1,c=NaN,d=NaN,u=new Date(2001,0,1);s&1&&(c=yde(e,i),i+=16),s&2&&(d=a.getFloat64(i,!0),i+=8),s&4&&(u.setTime(u.getTime()+a.getFloat64(i,!0)*1e3),i+=8),s&8&&(l=a.getUint32(i,!0),i+=4),s&16&&(o=a.getUint32(i,!0),i+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:d>0};break;case 7:f={t:"n",v:d/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return f}function Ah(e,t){var r=new Uint8Array(32),a=Ti(r),s=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,bde(r,s,e.v),i|=1,s+=16;break;case"b":r[1]=6,a.setFloat64(s,e.v?1:0,!0),i|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(s,t.indexOf(e.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,i,!0),r.slice(0,s)}function Th(e,t){var r=new Uint8Array(32),a=Ti(r),s=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(s,e.v,!0),i|=32,s+=8;break;case"b":r[2]=6,a.setFloat64(s,e.v?1:0,!0),i|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(s,t.indexOf(e.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,i,!0),r.slice(0,s)}function _de(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return jde(e,t,r,e[0]);case 5:return Nde(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function zr(e){var t=mt(e);return rd(t[1][0].data)}function fj(e,t){var r=mt(t.data),a=Zt(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(o){var l=mt(o.data),c=Zt(l[1][0].data)>>>0;switch(a){case 1:i[c]=Tx(l[3][0].data);break;case 8:{var d=e[zr(l[9][0].data)][0],u=mt(d.data),f=e[zr(u[1][0].data)][0],h=Zt(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var m=mt(f.data);i[c]=m[3].map(function(x){return Tx(x.data)}).join("")}break}}),i}function Sde(e,t){var r,a,s,i,o,l,c,d,u,f,h,m,x,p,g=mt(e),y=Zt(g[1][0].data)>>>0,w=Zt(g[2][0].data)>>>0,v=((a=(r=g[8])==null?void 0:r[0])==null?void 0:a.data)&&Zt(g[8][0].data)>0||!1,_,b;if((i=(s=g[7])==null?void 0:s[0])!=null&&i.data&&t!=0)_=(l=(o=g[7])==null?void 0:o[0])==null?void 0:l.data,b=(d=(c=g[6])==null?void 0:c[0])==null?void 0:d.data;else if((f=(u=g[4])==null?void 0:u[0])!=null&&f.data&&t!=1)_=(m=(h=g[4])==null?void 0:h[0])==null?void 0:m.data,b=(p=(x=g[3])==null?void 0:x[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var j=v?4:1,N=Ti(_),k=[],S=0;S<_.length/2;++S){var E=N.getUint16(S*2,!0);E<65535&&k.push([S,E])}if(k.length!=w)throw"Expected ".concat(w," cells, found ").concat(k.length);var P=[];for(S=0;S<k.length-1;++S)P[k[S][0]]=b.subarray(k[S][1]*j,k[S+1][1]*j);return k.length>=1&&(P[k[k.length-1][0]]=b.subarray(k[k.length-1][1]*j)),{R:y,cells:P}}function kde(e,t){var r,a=mt(t.data),s=(r=a==null?void 0:a[7])!=null&&r[0]?Zt(a[7][0].data)>>>0>0?1:0:-1,i=Og(a[5],function(o){return Sde(o,s)});return{nrows:Zt(a[4][0].data)>>>0,data:i.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,d){if(o[l.R][d])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(d));o[l.R][d]=c}),o},[])}}function Ede(e,t,r){var a,s=mt(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Zt(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(Zt(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Xe(i);var o=mt(s[4][0].data),l=fj(e,e[zr(o[4][0].data)][0]),c=(a=o[17])!=null&&a[0]?fj(e,e[zr(o[17][0].data)][0]):[],d=mt(o[3][0].data),u=0;d[1].forEach(function(f){var h=mt(f.data),m=e[zr(h[2][0].data)][0],x=Zt(m.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var p=kde(e,m);p.data.forEach(function(g,y){g.forEach(function(w,v){var _=Le({r:u+y,c:v}),b=_de(w,l,c);b&&(r[_]=b)})}),u+=p.nrows})}function Ade(e,t){var r=mt(t.data),a={"!ref":"A1"},s=e[zr(r[2][0].data)],i=Zt(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return Ede(e,s[0],a),a}function Tde(e,t){var r,a=mt(t.data),s={name:(r=a[1])!=null&&r[0]?Tx(a[1][0].data):"",sheets:[]},i=Og(a[2],zr);return i.forEach(function(o){e[o].forEach(function(l){var c=Zt(l.meta[1][0].data);c==6e3&&s.sheets.push(Ade(e,l))})}),s}function Ode(e,t){var r=Dg(),a=mt(t.data),s=Og(a[1],zr);if(s.forEach(function(i){e[i].forEach(function(o){var l=Zt(o.meta[1][0].data);if(l==2){var c=Tde(e,o);c.sheets.forEach(function(d,u){Rg(r,d,u==0?c.name:c.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Oh(e){var t,r,a,s,i={},o=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var d;try{d=La(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var u;try{u=$a(d)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){i[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var l=((s=(a=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:s[0].data)&&Zt(i[1][0].meta[1][0].data)==1&&i[1][0];if(l||o.forEach(function(c){i[c].forEach(function(d){var u=Zt(d.meta[1][0].data)>>>0;if(u==1)if(!l)l=d;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return Ode(i,l)}function Pde(e,t,r){var a,s,i,o;if(!((a=e[6])!=null&&a[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(i=e[8])==null?void 0:i[0])==null?void 0:o.data)&&Zt(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,d=Ti(e[7][0].data),u=0,f=[],h=Ti(e[4][0].data),m=0,x=[],p=0;p<t.length;++p){if(t[p]==null){d.setUint16(p*2,65535,!0),h.setUint16(p*2,65535);continue}d.setUint16(p*2,u,!0),h.setUint16(p*2,m,!0);var g,y;switch(typeof t[p]){case"string":g=Ah({t:"s",v:t[p]},r),y=Th({t:"s",v:t[p]},r);break;case"number":g=Ah({t:"n",v:t[p]},r),y=Th({t:"n",v:t[p]},r);break;case"boolean":g=Ah({t:"b",v:t[p]},r),y=Th({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}f.push(g),u+=g.length,x.push(y),m+=y.length,++c}for(e[2][0].data=Nt(c);p<e[7][0].data.length/2;++p)d.setUint16(p*2,65535,!0),h.setUint16(p*2,65535,!0);return e[6][0].data=ks(f),e[3][0].data=ks(x),c}function Cde(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=pa(r["!ref"]);a.s.r=a.s.c=0;var s=!1;a.e.c>9&&(s=!0,a.e.c=9),a.e.r>49&&(s=!0,a.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Xe(a)));var i=_f(r,{range:a,header:1}),o=["~Sh33tJ5~"];i.forEach(function(K){return K.forEach(function(z){typeof z=="string"&&o.push(z)})});var l={},c=[],d=Fe.read(t.numbers,{type:"base64"});d.FileIndex.map(function(K,z){return[K,d.FullPaths[z]]}).forEach(function(K){var z=K[0],W=K[1];if(z.type==2&&z.name.match(/\.iwa/)){var re=z.content,xe=La(re),me=$a(xe);me.forEach(function(Q){c.push(Q.id),l[Q.id]={deps:[],location:W,type:Zt(Q.messages[0].meta[1][0].data)}})}}),c.sort(function(K,z){return K-z});var u=c.filter(function(K){return K>1}).map(function(K){return[K,Nt(K)]});d.FileIndex.map(function(K,z){return[K,d.FullPaths[z]]}).forEach(function(K){var z=K[0];if(K[1],!!z.name.match(/\.iwa/)){var W=$a(La(z.content));W.forEach(function(re){re.messages.forEach(function(xe){u.forEach(function(me){re.messages.some(function(Q){return Zt(Q.meta[1][0].data)!=11006&&vde(Q.data,me[1])})&&l[me[0]].deps.push(re.id)})})})}});for(var f=Fe.find(d,l[1].location),h=$a(La(f.content)),m,x=0;x<h.length;++x){var p=h[x];p.id==1&&(m=p)}var g=zr(mt(m.messages[0].data)[1][0].data);for(f=Fe.find(d,l[g].location),h=$a(La(f.content)),x=0;x<h.length;++x)p=h[x],p.id==g&&(m=p);for(g=zr(mt(m.messages[0].data)[2][0].data),f=Fe.find(d,l[g].location),h=$a(La(f.content)),x=0;x<h.length;++x)p=h[x],p.id==g&&(m=p);for(g=zr(mt(m.messages[0].data)[2][0].data),f=Fe.find(d,l[g].location),h=$a(La(f.content)),x=0;x<h.length;++x)p=h[x],p.id==g&&(m=p);var y=mt(m.messages[0].data);{y[6][0].data=Nt(a.e.r+1),y[7][0].data=Nt(a.e.c+1);var w=zr(y[46][0].data),v=Fe.find(d,l[w].location),_=$a(La(v.content));{for(var b=0;b<_.length&&_[b].id!=w;++b);if(_[b].id!=w)throw"Bad ColumnRowUIDMapArchive";var j=mt(_[b].messages[0].data);j[1]=[],j[2]=[],j[3]=[];for(var N=0;N<=a.e.c;++N){var k=[];k[1]=k[2]=[{type:0,data:Nt(N+420690)}],j[1].push({type:2,data:Ir(k)}),j[2].push({type:0,data:Nt(N)}),j[3].push({type:0,data:Nt(N)})}j[4]=[],j[5]=[],j[6]=[];for(var S=0;S<=a.e.r;++S)k=[],k[1]=k[2]=[{type:0,data:Nt(S+726270)}],j[4].push({type:2,data:Ir(k)}),j[5].push({type:0,data:Nt(S)}),j[6].push({type:0,data:Nt(S)});_[b].messages[0].data=Ir(j)}v.content=Yi(Xi(_)),v.size=v.content.length,delete y[46];var E=mt(y[4][0].data);{E[7][0].data=Nt(a.e.r+1);var P=mt(E[1][0].data),C=zr(P[2][0].data);v=Fe.find(d,l[C].location),_=$a(La(v.content));{if(_[0].id!=C)throw"Bad HeaderStorageBucket";var T=mt(_[0].messages[0].data);for(S=0;S<i.length;++S){var M=mt(T[2][0].data);M[1][0].data=Nt(S),M[4][0].data=Nt(i[S].length),T[2][S]={type:T[2][0].type,data:Ir(M)}}_[0].messages[0].data=Ir(T)}v.content=Yi(Xi(_)),v.size=v.content.length;var A=zr(E[2][0].data);v=Fe.find(d,l[A].location),_=$a(La(v.content));{if(_[0].id!=A)throw"Bad HeaderStorageBucket";for(T=mt(_[0].messages[0].data),N=0;N<=a.e.c;++N)M=mt(T[2][0].data),M[1][0].data=Nt(N),M[4][0].data=Nt(a.e.r+1),T[2][N]={type:T[2][0].type,data:Ir(M)};_[0].messages[0].data=Ir(T)}v.content=Yi(Xi(_)),v.size=v.content.length;var F=zr(E[4][0].data);(function(){for(var K=Fe.find(d,l[F].location),z=$a(La(K.content)),W,re=0;re<z.length;++re){var xe=z[re];xe.id==F&&(W=xe)}var me=mt(W.messages[0].data);{me[3]=[];var Q=[];o.forEach(function(D,ve){Q[1]=[{type:0,data:Nt(ve)}],Q[2]=[{type:0,data:Nt(1)}],Q[3]=[{type:2,data:gde(D)}],me[3].push({type:2,data:Ir(Q)})})}W.messages[0].data=Ir(me);var q=Xi(z),se=Yi(q);K.content=se,K.size=K.content.length})();var H=mt(E[3][0].data);{var V=H[1][0];delete H[2];var B=mt(V.data);{var L=zr(B[2][0].data);(function(){for(var K=Fe.find(d,l[L].location),z=$a(La(K.content)),W,re=0;re<z.length;++re){var xe=z[re];xe.id==L&&(W=xe)}var me=mt(W.messages[0].data);{delete me[6],delete H[7];var Q=new Uint8Array(me[5][0].data);me[5]=[];for(var q=0,se=0;se<=a.e.r;++se){var D=mt(Q);q+=Pde(D,i[se],o),D[1][0].data=Nt(se),me[5].push({data:Ir(D),type:2})}me[1]=[{type:0,data:Nt(a.e.c+1)}],me[2]=[{type:0,data:Nt(a.e.r+1)}],me[3]=[{type:0,data:Nt(q)}],me[4]=[{type:0,data:Nt(a.e.r+1)}]}W.messages[0].data=Ir(me);var ve=Xi(z),we=Yi(ve);K.content=we,K.size=K.content.length})()}V.data=Ir(B)}E[3][0].data=Ir(H)}y[4][0].data=Ir(E)}m.messages[0].data=Ir(y);var ee=Xi(h),I=Yi(ee);return f.content=I,f.size=f.content.length,d}function Jk(e){return function(r){for(var a=0;a!=e.length;++a){var s=e[a];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Pg(e){Jk([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Cg(e){Jk([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Fde(e){return st.WS.indexOf(e)>-1?"sheet":e==st.CS?"chart":e==st.DS?"dialog":e==st.MS?"macro":e&&e.length?e:"sheet"}function Ide(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,Fde(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Dde(e,t,r,a,s,i,o,l,c,d,u,f){try{i[a]=Yl(Sa(e,r,!0),t);var h=ur(e,t),m;switch(l){case"sheet":m=ace(h,t,s,c,i[a],d,u,f);break;case"chart":if(m=nce(h,t,s,c,i[a],d,u,f),!m||!m["!drawel"])break;var x=Dl(m["!drawel"].Target,t),p=Yc(x),g=zne(Sa(e,x,!0),Yl(Sa(e,p,!0),x)),y=Dl(g,x),w=Yc(y);m=Ple(Sa(e,y,!0),y,c,Yl(Sa(e,w,!0),y),d,m);break;case"macro":m=sce(h,t,s,c,i[a],d,u,f);break;case"dialog":m=ice(h,t,s,c,i[a],d,u,f);break;default:throw new Error("Unrecognized sheet type "+l)}o[a]=m;var v=[];i&&i[a]&&Qt(i[a]).forEach(function(_){var b="";if(i[a][_].Type==st.CMNT){b=Dl(i[a][_].Target,t);var j=dce(ur(e,b,!0),b,c);if(!j||!j.length)return;Jw(m,j,!1)}i[a][_].Type==st.TCMNT&&(b=Dl(i[a][_].Target,t),v=v.concat(Gne(ur(e,b,!0),c)))}),v&&v.length&&Jw(m,v,!0,c.people||[])}catch(_){if(c.WTF)throw _}}function Ra(e){return e.charAt(0)=="/"?e.slice(1):e}function Rde(e,t){if(ll(),t=t||{},Pg(t),Ba(e,"META-INF/manifest.xml")||Ba(e,"objectdata.xml"))return lj(e,t);if(Ba(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Oh<"u"){if(e.FileIndex)return Oh(e);var r=Fe.utils.cfb_new();return vw(e).forEach(function(M){Ye(r,M,KQ(e,M))}),Oh(r)}throw new Error("Unsupported NUMBERS file")}if(!Ba(e,"[Content_Types].xml"))throw Ba(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ba(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=vw(e),s=Bee(Sa(e,"[Content_Types].xml")),i=!1,o,l;if(s.workbooks.length===0&&(l="xl/workbook.xml",ur(e,l,!0)&&s.workbooks.push(l)),s.workbooks.length===0){if(l="xl/workbook.bin",!ur(e,l,!0))throw new Error("Could not find workbook");s.workbooks.push(l),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},d={};if(!t.bookSheets&&!t.bookProps){if(Jl=[],s.sst)try{Jl=cce(ur(e,Ra(s.sst)),s.sst,t)}catch(M){if(t.WTF)throw M}t.cellStyles&&s.themes.length&&(c=lce(Sa(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(d=oce(ur(e,Ra(s.style)),s.style,c,t))}s.links.map(function(M){try{var A=Yl(Sa(e,Yc(Ra(M))),M);return fce(ur(e,Ra(M)),A,M,t)}catch{}});var u=rce(ur(e,Ra(s.workbooks[0])),s.workbooks[0],t),f={},h="";s.coreprops.length&&(h=ur(e,Ra(s.coreprops[0]),!0),h&&(f=L4(h)),s.extprops.length!==0&&(h=ur(e,Ra(s.extprops[0]),!0),h&&Kee(h,f,t)));var m={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(h=Sa(e,Ra(s.custprops[0]),!0),h&&(m=Xee(h,t)));var x={};if((t.bookSheets||t.bookProps)&&(u.Sheets?o=u.Sheets.map(function(A){return A.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),t.bookProps&&(x.Props=f,x.Custprops=m),t.bookSheets&&typeof o<"u"&&(x.SheetNames=o),t.bookSheets?x.SheetNames:t.bookProps))return x;o={};var p={};t.bookDeps&&s.calcchain&&(p=uce(ur(e,Ra(s.calcchain)),s.calcchain));var g=0,y={},w,v;{var _=u.Sheets;f.Worksheets=_.length,f.SheetNames=[];for(var b=0;b!=_.length;++b)f.SheetNames[b]=_[b].name}var j=i?"bin":"xml",N=s.workbooks[0].lastIndexOf("/"),k=(s.workbooks[0].slice(0,N+1)+"_rels/"+s.workbooks[0].slice(N+1)+".rels").replace(/^\//,"");Ba(e,k)||(k="xl/_rels/workbook."+j+".rels");var S=Yl(Sa(e,k,!0),k.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=hce(ur(e,Ra(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=qne(ur(e,Ra(s.people[0])),t)),S&&(S=Ide(S,u.Sheets));var E=ur(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=f.Worksheets;++g){var P="sheet";if(S&&S[g]?(w="xl/"+S[g][1].replace(/[\/]?xl\//,""),Ba(e,w)||(w=S[g][1]),Ba(e,w)||(w=k.replace(/_rels\/.*$/,"")+S[g][1]),P=S[g][2]):(w="xl/worksheets/sheet"+(g+1-E)+"."+j,w=w.replace(/sheet0\./,"sheet.")),v=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(f.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var C=!1,T=0;T!=t.sheets.length;++T)typeof t.sheets[T]=="number"&&t.sheets[T]==g&&(C=1),typeof t.sheets[T]=="string"&&t.sheets[T].toLowerCase()==f.SheetNames[g].toLowerCase()&&(C=1);if(!C)continue e}}Dde(e,w,v,f.SheetNames[g],g,y,o,P,t,u,c,d)}return x={Directory:s,Workbook:u,Props:f,Custprops:m,Deps:p,Sheets:o,SheetNames:f.SheetNames,Strings:Jl,Styles:d,Themes:c,SSF:Bt(Me)},t&&t.bookFiles&&(e.files?(x.keys=a,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(M,A){M=M.replace(/^Root Entry[\/]/,""),x.keys.push(M),x.files[M]=e.FileIndex[A]}))),t&&t.bookVBA&&(s.vba.length>0?x.vbaraw=ur(e,Ra(s.vba[0]),!0):s.defaults&&s.defaults.bin===rse&&(x.vbaraw=ur(e,"xl/vbaProject.bin",!0))),x}function Mde(e,t){var r=t||{},a="Workbook",s=Fe.find(e,a);try{if(a="/!DataSpaces/Version",s=Fe.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(hae(s.content),a="/!DataSpaces/DataSpaceMap",s=Fe.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=xae(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Fe.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=pae(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Fe.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);vae(s.content)}catch{}if(a="/EncryptionInfo",s=Fe.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=yae(s.content);if(a="/EncryptedPackage",s=Fe.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],s.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function $de(e,t){return t.bookType=="ods"?Yk(e,t):t.bookType=="numbers"?Cde(e,t):t.bookType=="xlsb"?Lde(e,t):Bde(e,t)}function Lde(e,t){so=1024,e&&!e.SSF&&(e.SSF=Bt(Me)),e&&e.SSF&&(ll(),T0(e.SSF),t.revssf=P0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Zl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=_k.indexOf(t.bookType)>-1,s=gg();Cg(t=t||{});var i=ag(),o="",l=0;if(t.cellXfs=[],Rs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Ye(i,o,B4(e.Props,t)),s.coreprops.push(o),_t(t.rels,2,o,st.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Ye(i,o,H4(e.Props)),s.extprops.push(o),_t(t.rels,3,o,st.EXT_PROPS),e.Custprops!==e.Props&&Qt(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Ye(i,o,z4(e.Custprops)),s.custprops.push(o),_t(t.rels,4,o,st.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var u={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Ye(i,o,xce(l-1,o,t,e,u)),s.sheets.push(o),_t(t.wbrels,-1,"worksheets/sheet"+l+"."+r,st.WS[0])}if(f){var m=f["!comments"],x=!1,p="";m&&m.length>0&&(p="xl/comments"+l+"."+r,Ye(i,p,vce(m,p)),s.comments.push(p),_t(u,-1,"../comments"+l+"."+r,st.CMNT),x=!0),f["!legacy"]&&x&&Ye(i,"xl/drawings/vmlDrawing"+l+".vml",jk(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}u["!id"].rId1&&Ye(i,Yc(o),fo(u))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Ye(i,o,gce(t.Strings,o,t)),s.strs.push(o),_t(t.wbrels,-1,"sharedStrings."+r,st.SST)),o="xl/workbook."+r,Ye(i,o,mce(e,o)),s.workbooks.push(o),_t(t.rels,1,o,st.WB),o="xl/theme/theme1.xml",Ye(i,o,Ng(e.Themes,t)),s.themes.push(o),_t(t.wbrels,-1,"theme/theme1.xml",st.THEME),o="xl/styles."+r,Ye(i,o,pce(e,o,t)),s.styles.push(o),_t(t.wbrels,-1,"styles."+r,st.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",Ye(i,o,e.vbaraw),s.vba.push(o),_t(t.wbrels,-1,"vbaProject.bin",st.VBA)),o="xl/metadata."+r,Ye(i,o,yce(o)),s.metadata.push(o),_t(t.wbrels,-1,"metadata."+r,st.XLMETA),Ye(i,"[Content_Types].xml",M4(s,t)),Ye(i,"_rels/.rels",fo(t.rels)),Ye(i,"xl/_rels/workbook."+r+".rels",fo(t.wbrels)),delete t.revssf,delete t.ssf,i}function Bde(e,t){so=1024,e&&!e.SSF&&(e.SSF=Bt(Me)),e&&e.SSF&&(ll(),T0(e.SSF),t.revssf=P0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Zl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=_k.indexOf(t.bookType)>-1,s=gg();Cg(t=t||{});var i=ag(),o="",l=0;if(t.cellXfs=[],Rs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Ye(i,o,B4(e.Props,t)),s.coreprops.push(o),_t(t.rels,2,o,st.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Ye(i,o,H4(e.Props)),s.extprops.push(o),_t(t.rels,3,o,st.EXT_PROPS),e.Custprops!==e.Props&&Qt(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Ye(i,o,z4(e.Custprops)),s.custprops.push(o),_t(t.rels,4,o,st.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],m=(h||{})["!type"]||"sheet";switch(m){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Ye(i,o,Dk(l-1,t,e,f)),s.sheets.push(o),_t(t.wbrels,-1,"worksheets/sheet"+l+"."+r,st.WS[0])}if(h){var x=h["!comments"],p=!1,g="";if(x&&x.length>0){var y=!1;x.forEach(function(w){w[1].forEach(function(v){v.T==!0&&(y=!0)})}),y&&(g="xl/threadedComments/threadedComment"+l+"."+r,Ye(i,g,Kne(x,u,t)),s.threadedcomments.push(g),_t(f,-1,"../threadedComments/threadedComment"+l+"."+r,st.TCMNT)),g="xl/comments"+l+"."+r,Ye(i,g,Nk(x)),s.comments.push(g),_t(f,-1,"../comments"+l+"."+r,st.CMNT),p=!0}h["!legacy"]&&p&&Ye(i,"xl/drawings/vmlDrawing"+l+".vml",jk(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Ye(i,Yc(o),fo(f))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Ye(i,o,dk(t.Strings,t)),s.strs.push(o),_t(t.wbrels,-1,"sharedStrings."+r,st.SST)),o="xl/workbook."+r,Ye(i,o,Bk(e)),s.workbooks.push(o),_t(t.rels,1,o,st.WB),o="xl/theme/theme1.xml",Ye(i,o,Ng(e.Themes,t)),s.themes.push(o),_t(t.wbrels,-1,"theme/theme1.xml",st.THEME),o="xl/styles."+r,Ye(i,o,vk(e,t)),s.styles.push(o),_t(t.wbrels,-1,"styles."+r,st.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",Ye(i,o,e.vbaraw),s.vba.push(o),_t(t.wbrels,-1,"vbaProject.bin",st.VBA)),o="xl/metadata."+r,Ye(i,o,wk()),s.metadata.push(o),_t(t.wbrels,-1,"metadata."+r,st.XLMETA),u.length>1&&(o="xl/persons/person.xml",Ye(i,o,Xne(u)),s.people.push(o),_t(t.wbrels,-1,"persons/person.xml",st.PEOPLE)),Ye(i,"[Content_Types].xml",M4(s,t)),Ye(i,"_rels/.rels",fo(t.rels)),Ye(i,"xl/_rels/workbook."+r+".rels",fo(t.wbrels)),delete t.revssf,delete t.ssf,i}function Fg(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Pa(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Ude(e,t){return Fe.find(e,"EncryptedPackage")?Mde(e,t):zk(e,t)}function Wde(e,t){var r,a=e,s=t||{};return s.type||(s.type=rt&&Buffer.isBuffer(e)?"buffer":"base64"),r=f4(a,s),Rde(r,s)}function Zk(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Ex(e.slice(r),t);default:break e}return Ho.to_workbook(e,t)}function Hde(e,t){var r="",a=Fg(e,t);switch(t.type){case"base64":r=Pa(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Si(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=Ot(r)),t.type="binary",Zk(r,t)}function zde(e,t){var r=e;return t.type=="base64"&&(r=Pa(r)),r=zc.utils.decode(1200,r.slice(2),"str"),t.type="binary",Zk(r,t)}function Vde(e){return e.match(/[^\x00-\x7F]/)?bn(e):e}function Ph(e,t,r,a){return a?(r.type="string",Ho.to_workbook(e,r)):Ho.to_workbook(t,r)}function Ox(e,t){Zp();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Ox(new Uint8Array(e),(r=Bt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),mo={},r.dateNF&&(mo.dateNF=r.dateNF),r.type||(r.type=rt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=rt?"buffer":"binary",a=LQ(e),typeof Uint8Array<"u"&&!rt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,a=Vde(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=Bt(r),r.type="array",Ox(Qp(a),r)}switch((s=Fg(a,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return Ude(Fe.read(a,r),r);break;case 9:if(s[1]<=8)return zk(a,r);break;case 60:return Ex(a,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return Yre(a,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return lk.to_workbook(a,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?Wde(a,r):Ph(e,a,r,i);case 239:return s[3]===60?Ex(a,r):Ph(e,a,r,i);case 255:if(s[1]===254)return zde(a,r);if(s[1]===0&&s[2]===2&&s[3]===0)return di.to_workbook(a,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return di.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return kx.to_workbook(a,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return xk.to_workbook(a,r);break;case 10:case 13:case 32:return Hde(a,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Xre.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?kx.to_workbook(a,r):Ph(e,a,r,i)}function Qk(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return vd(t.file,Fe.write(e,{type:rt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Fe.write(e,t)}function Gde(e,t){var r=Bt(t||{}),a=$de(e,r);return Kde(a,r)}function Kde(e,t){var r={},a=rt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?Fe.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(A0(s))}return t.password&&typeof encrypt_agile<"u"?Qk(encrypt_agile(s,t.password),t):t.type==="file"?vd(t.file,s):t.type=="string"?Ot(s):s}function qde(e,t){var r=t||{},a=Vce(e,r);return Qk(a,r)}function xn(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return Vc(bn(a));case"binary":return bn(a);case"string":return e;case"file":return vd(t.file,a,"utf8");case"buffer":return rt?os(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):xn(a,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Xde(e,t){switch(t.type){case"base64":return Vc(e);case"binary":return e;case"string":return e;case"file":return vd(t.file,e,"binary");case"buffer":return rt?os(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function eu(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?Vc(r):t.type=="string"?Ot(r):r;case"file":return vd(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function e3(e,t){Zp(),Ule(e);var r=Bt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=e3(e,r);return r.type="array",A0(a)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return xn($ce(e,r),r);case"slk":case"sylk":return xn(ok.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return xn(Gk(e.Sheets[e.SheetNames[s]],r),r);case"txt":return Xde(r3(e.Sheets[e.SheetNames[s]],r),r);case"csv":return xn(Ig(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return xn(lk.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return eu(kx.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return xn(Ho.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return xn(xk.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return xn(ck.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return xn(Yk(e,r),r);case"wk1":return eu(di.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return eu(di.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),eu(Vk(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),qde(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Gde(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Yde(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function t3(e,t,r){var a={};return a.type="file",a.file=t,Yde(a),e3(e,a)}function Jde(e,t,r,a,s,i,o,l){var c=or(r),d=l.defval,u=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,h=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!o||e[r])for(var m=t.s.c;m<=t.e.c;++m){var x=o?e[r][m]:e[a[m]+c];if(x===void 0||x.t===void 0){if(d===void 0)continue;i[m]!=null&&(h[i[m]]=d);continue}var p=x.v;switch(x.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(i[m]!=null){if(p==null)if(x.t=="e"&&p===null)h[i[m]]=null;else if(d!==void 0)h[i[m]]=d;else if(u&&p===null)h[i[m]]=null;else continue;else h[i[m]]=u&&(x.t!=="n"||x.t==="n"&&l.rawNumbers!==!1)?p:rs(x,p,l);p!=null&&(f=!1)}}return{row:h,isempty:f}}function _f(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,s=1,i=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},u=d.range!=null?d.range:e["!ref"];switch(d.header===1?a=1:d.header==="A"?a=2:Array.isArray(d.header)?a=3:d.header==null&&(a=0),typeof u){case"string":c=ft(u);break;case"number":c=ft(e["!ref"]),c.s.r=u;break;default:c=u}a>0&&(s=0);var f=or(c.s.r),h=[],m=[],x=0,p=0,g=Array.isArray(e),y=c.s.r,w=0,v={};g&&!e[y]&&(e[y]=[]);var _=d.skipHidden&&e["!cols"]||[],b=d.skipHidden&&e["!rows"]||[];for(w=c.s.c;w<=c.e.c;++w)if(!(_[w]||{}).hidden)switch(h[w]=Kt(w),r=g?e[y][w]:e[h[w]+f],a){case 1:i[w]=w-c.s.c;break;case 2:i[w]=h[w];break;case 3:i[w]=d.header[w-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=rs(r,null,d),p=v[o]||0,!p)v[o]=1;else{do l=o+"_"+p++;while(v[l]);v[o]=p,v[l]=1}i[w]=l}for(y=c.s.r+s;y<=c.e.r;++y)if(!(b[y]||{}).hidden){var j=Jde(e,c,y,h,a,i,g,d);(j.isempty===!1||(a===1?d.blankrows!==!1:d.blankrows))&&(m[x++]=j.row)}return m.length=x,m}var hj=/"/g;function Zde(e,t,r,a,s,i,o,l){for(var c=!0,d=[],u="",f=or(r),h=t.s.c;h<=t.e.c;++h)if(a[h]){var m=l.dense?(e[r]||[])[h]:e[a[h]+f];if(m==null)u="";else if(m.v!=null){c=!1,u=""+(l.rawNumbers&&m.t=="n"?m.v:rs(m,null,l));for(var x=0,p=0;x!==u.length;++x)if((p=u.charCodeAt(x))===s||p===i||p===34||l.forceQuotes){u='"'+u.replace(hj,'""')+'"';break}u=="ID"&&(u='"ID"')}else m.f!=null&&!m.F?(c=!1,u="="+m.f,u.indexOf(",")>=0&&(u='"'+u.replace(hj,'""')+'"')):u="";d.push(u)}return l.blankrows===!1&&c?null:d.join(o)}function Ig(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var s=ft(e["!ref"]),i=a.FS!==void 0?a.FS:",",o=i.charCodeAt(0),l=a.RS!==void 0?a.RS:`
`,c=l.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),u="",f=[];a.dense=Array.isArray(e);for(var h=a.skipHidden&&e["!cols"]||[],m=a.skipHidden&&e["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(h[x]||{}).hidden||(f[x]=Kt(x));for(var p=0,g=s.s.r;g<=s.e.r;++g)(m[g]||{}).hidden||(u=Zde(e,s,g,f,o,c,i,a),u!=null&&(a.strip&&(u=u.replace(d,"")),(u||a.blankrows!==!1)&&r.push((p++?l:"")+u)));return delete a.dense,r.join("")}function r3(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Ig(e,t);return r}function Qde(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var s=ft(e["!ref"]),i="",o=[],l,c=[],d=Array.isArray(e);for(l=s.s.c;l<=s.e.c;++l)o[l]=Kt(l);for(var u=s.s.r;u<=s.e.r;++u)for(i=or(u),l=s.s.c;l<=s.e.c;++l)if(t=o[l]+i,r=d?(e[u]||[])[l]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}c[c.length]=t+"="+a}return c}function a3(e,t,r){var a=r||{},s=+!a.skipHeader,i=e||{},o=0,l=0;if(i&&a.origin!=null)if(typeof a.origin=="number")o=a.origin;else{var c=typeof a.origin=="string"?qt(a.origin):a.origin;o=c.r,l=c.c}var d,u={s:{c:0,r:0},e:{c:l,r:o+t.length-1+s}};if(i["!ref"]){var f=ft(i["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),o==-1&&(o=f.e.r+1,u.e.r=o+t.length-1+s)}else o==-1&&(o=0,u.e.r=t.length-1+s);var h=a.header||[],m=0;t.forEach(function(p,g){Qt(p).forEach(function(y){(m=h.indexOf(y))==-1&&(h[m=h.length]=y);var w=p[y],v="z",_="",b=Le({c:l+m,r:o+g+s});d=ad(i,b),w&&typeof w=="object"&&!(w instanceof Date)?i[b]=w:(typeof w=="number"?v="n":typeof w=="boolean"?v="b":typeof w=="string"?v="s":w instanceof Date?(v="d",a.cellDates||(v="n",w=Nr(w)),_=a.dateNF||Me[14]):w===null&&a.nullError&&(v="e",w=0),d?(d.t=v,d.v=w,delete d.w,delete d.R,_&&(d.z=_)):i[b]=d={t:v,v:w},_&&(d.z=_))})}),u.e.c=Math.max(u.e.c,l+h.length-1);var x=or(o);if(s)for(m=0;m<h.length;++m)i[Kt(m+l)+x]={t:"s",v:h[m]};return i["!ref"]=Xe(u),i}function eue(e,t){return a3(null,e,t)}function ad(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=qt(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?ad(e,Le(t)):ad(e,Le({r:t,c:r||0}))}function tue(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Dg(){return{SheetNames:[],Sheets:{}}}function Rg(e,t,r,a){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var o=i&&i[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=o+s)!=-1;++s);}if(Lk(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function rue(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=tue(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function aue(e,t){return e.z=t,e}function n3(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function nue(e,t,r){return n3(e,"#"+t,r)}function sue(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function iue(e,t,r,a){for(var s=typeof t!="string"?t:ft(t),i=typeof t=="string"?t:Xe(t),o=s.s.r;o<=s.e.r;++o)for(var l=s.s.c;l<=s.e.c;++l){var c=ad(e,o,l);c.t="n",c.F=i,delete c.v,o==s.s.r&&l==s.s.c&&(c.f=r,a&&(c.D=!0))}return e}var ai={encode_col:Kt,encode_row:or,encode_cell:Le,encode_range:Xe,decode_col:ug,decode_row:dg,split_cell:gee,decode_cell:qt,decode_range:pa,format_cell:rs,sheet_add_aoa:O4,sheet_add_json:a3,sheet_add_dom:Kk,aoa_to_sheet:cl,json_to_sheet:eue,table_to_sheet:qk,table_to_book:hde,sheet_to_csv:Ig,sheet_to_txt:r3,sheet_to_json:_f,sheet_to_html:Gk,sheet_to_formulae:Qde,sheet_to_row_object_array:_f,sheet_get_cell:ad,book_new:Dg,book_append_sheet:Rg,book_set_sheet_visibility:rue,cell_set_number_format:aue,cell_set_hyperlink:n3,cell_set_internal_link:nue,cell_add_comment:sue,sheet_set_array_formula:iue,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const oue=({isOpen:e,onClose:t,onImport:r,projectIdeas:a})=>{const[s,i]=O.useState("import"),[o,l]=O.useState(!1),[c,d]=O.useState(null),[u,f]=O.useState(null),[h,m]=O.useState([]),x=O.useRef(null);if(!e)return null;const p=w=>{var b;const v=(b=w.target.files)==null?void 0:b[0];if(!v)return;l(!0),d(null),f(null),m([]);const _=new FileReader;_.onload=j=>{var N;try{const k=(N=j.target)==null?void 0:N.result,S=Ox(k,{type:"binary"}),E=S.SheetNames[0],P=S.Sheets[E],T=ai.sheet_to_json(P).map(M=>{const A=M.objectives?M.objectives.split(",").map(B=>B.trim()):[],F=M.materials?M.materials.split(",").map(B=>B.trim()):[],H=M.steps?M.steps.split(",").map(B=>B.trim()):[],V=M.tags?M.tags.split(",").map(B=>B.trim()):[];return{title:M.title||"",description:M.description||"",category:M.category||"stem",difficulty:M.difficulty||"beginner",duration:M.duration||"",subject:M.subject||"",image:M.image||"",objectives:A,materials:F,steps:H,tags:V}});m(T),f(`تم تحليل ${T.length} فكرة مشروع بنجاح. اضغط على "استيراد" للمتابعة.`)}catch(k){console.error("Error parsing Excel file:",k),d("حدث خطأ أثناء تحليل ملف Excel. تأكد من أن الملف بالتنسيق الصحيح.")}finally{l(!1)}},_.onerror=()=>{d("حدث خطأ أثناء قراءة الملف."),l(!1)},_.readAsBinaryString(v)},g=async()=>{if(h.length===0){d("لا توجد بيانات للاستيراد.");return}l(!0),d(null),f(null);try{await r(h),f(`تم استيراد ${h.length} فكرة مشروع بنجاح.`),m([]),x.current&&(x.current.value="")}catch(w){console.error("Error importing ideas:",w),d(w instanceof Error?w.message:"حدث خطأ أثناء استيراد الأفكار.")}finally{l(!1)}},y=()=>{l(!0),d(null),f(null);try{const w=a.map(b=>{var j,N,k,S;return{title:b.title,description:b.description,category:b.category,difficulty:b.difficulty,duration:b.duration,subject:b.subject,image:b.image,objectives:(j=b.objectives)==null?void 0:j.join(", "),materials:(N=b.materials)==null?void 0:N.join(", "),steps:(k=b.steps)==null?void 0:k.join(", "),tags:(S=b.tags)==null?void 0:S.join(", ")}}),v=ai.json_to_sheet(w),_=ai.book_new();ai.book_append_sheet(_,v,"أفكار المشاريع"),t3(_,"project_ideas.xlsx"),f("تم تصدير أفكار المشاريع بنجاح.")}catch(w){console.error("Error exporting ideas:",w),d("حدث خطأ أثناء تصدير الأفكار.")}finally{l(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-2xl",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(nu,{className:"w-6 h-6 text-blue-600"}),"استيراد وتصدير أفكار المشاريع"]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Pt,{className:"w-5 h-5 text-gray-600"})})]}),n.jsxs("div",{className:"flex border-b border-gray-200 mb-6",children:[n.jsx("button",{onClick:()=>i("import"),className:`px-4 py-2 font-medium text-sm border-b-2 ${s==="import"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"استيراد من Excel"}),n.jsx("button",{onClick:()=>i("export"),className:`px-4 py-2 font-medium text-sm border-b-2 ${s==="export"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"تصدير إلى Excel"})]}),c&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(pt,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:c})]}),u&&n.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(ze,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:u})]}),s==="import"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(En,{className:"w-5 h-5 text-blue-500 mt-1"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-blue-800 mb-1",children:"تنسيق ملف الاستيراد"}),n.jsxs("p",{className:"text-sm text-blue-700",children:["يجب أن يحتوي ملف Excel على الأعمدة التالية: title, description, category, difficulty, duration, subject, image, objectives, materials, steps, tags.",n.jsx("br",{}),"للحقول التي تحتوي على قائمة (objectives, materials, steps, tags)، يجب فصل العناصر بفاصلة."]})]})]}),n.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-8 text-center",children:[n.jsx(nu,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),n.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"اختر ملف Excel"}),n.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"اسحب وأفلت الملف هنا أو اضغط لاختيار ملف"}),n.jsx("input",{type:"file",ref:x,onChange:p,accept:".xlsx, .xls",className:"hidden"}),n.jsx("button",{type:"button",onClick:()=>{var w;return(w=x.current)==null?void 0:w.click()},disabled:o,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"اختيار ملف"})]}),h.length>0&&n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"ملخص البيانات المستوردة"}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsxs("p",{className:"text-gray-700",children:["عدد الأفكار: ",h.length]}),n.jsx("div",{className:"mt-2 max-h-40 overflow-y-auto",children:n.jsx("ul",{className:"space-y-1",children:h.map((w,v)=>n.jsx("li",{className:"text-sm text-gray-600",children:w.title},v))})})]})]}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{type:"button",onClick:g,disabled:o||h.length===0,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:o?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري المعالجة..."]}):n.jsxs(n.Fragment,{children:[n.jsx(xi,{className:"w-5 h-5"}),"استيراد"]})})]})]}),s==="export"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(En,{className:"w-5 h-5 text-blue-500 mt-1"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-blue-800 mb-1",children:"معلومات التصدير"}),n.jsxs("p",{className:"text-sm text-blue-700",children:["سيتم تصدير جميع أفكار المشاريع (",a.length," فكرة) إلى ملف Excel.",n.jsx("br",{}),"يمكنك تعديل الملف وإعادة استيراده لتحديث الأفكار."]})]})]}),n.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-8 text-center",children:[n.jsx(nu,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),n.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"تصدير أفكار المشاريع"}),n.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"اضغط على الزر أدناه لتصدير جميع أفكار المشاريع إلى ملف Excel"}),n.jsx("button",{type:"button",onClick:y,disabled:o||a.length===0,className:"px-6 py-3 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors flex items-center gap-2 mx-auto disabled:opacity-50 disabled:cursor-not-allowed",children:o?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري التصدير..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Tr,{className:"w-5 h-5"}),"تصدير إلى Excel"]})})]}),n.jsx("div",{className:"flex justify-end",children:n.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إغلاق"})})]})]})})},lue=()=>{const{projectIdeas:e,loading:t,error:r,fetchProjectIdeas:a,addIdea:s,editIdea:i,removeIdea:o,incrementViews:l,incrementDownloads:c,approveIdea:d,rejectIdea:u}=Ux(),[f,h]=O.useState("all"),[m,x]=O.useState("all"),[p,g]=O.useState("all"),[y,w]=O.useState(""),[v,_]=O.useState(!1),[b,j]=O.useState(!1),[N,k]=O.useState(!1),[S,E]=O.useState(!1),[P,C]=O.useState(!1),[T,M]=O.useState(null),[A,F]=O.useState(null),[H,V]=O.useState(null),[B,L]=O.useState(""),[ee,I]=O.useState(!1),[K,z]=O.useState(!1),[W,re]=O.useState(!1),[xe,me]=O.useState(!1),[Q,q]=O.useState(null),[se,D]=O.useState(null),[ve,we]=O.useState(!1),[Ae,ce]=O.useState(null),[he,oe]=O.useState(null),Ve=[{id:"all",name:"جميع الفئات"},{id:"stem",name:"ستيم"},{id:"entrepreneurship",name:"ريادة الأعمال"},{id:"volunteer",name:"التطوع"},{id:"ethics",name:"الأخلاق"}],ct=[{id:"all",name:"جميع المستويات"},{id:"beginner",name:"مبتدئ"},{id:"intermediate",name:"متوسط"},{id:"advanced",name:"متقدم"}],nt=[{id:"all",name:"جميع الحالات",color:"bg-gray-100 text-gray-800"},{id:"pending",name:"قيد المراجعة",color:"bg-yellow-100 text-yellow-800"},{id:"approved",name:"موافق عليها",color:"bg-green-100 text-green-800"},{id:"rejected",name:"مرفوضة",color:"bg-red-100 text-red-800"}],At=e.filter(je=>{const fn=f==="all"||je.category===f,ds=m==="all"||je.difficulty===m,Ed=p==="all"||je.status===p,Ad=je.title.toLowerCase().includes(y.toLowerCase())||je.description.toLowerCase().includes(y.toLowerCase());return fn&&ds&&Ed&&Ad}),Xt=async je=>{await s(je)},er=async je=>{T&&await i(T.id,je)},ea=async()=>{if(A){I(!0);try{await o(A.id),k(!1)}catch(je){console.error("Error deleting idea:",je)}finally{I(!1),F(null)}}},la=async je=>{z(!0);try{await d(je),await a()}catch(fn){console.error("Error approving idea:",fn)}finally{z(!1)}},Ms=async()=>{if(!(!H||!B)){re(!0);try{await u(H.id,B),C(!1),await a()}catch(je){console.error("Error rejecting idea:",je)}finally{re(!1),V(null),L("")}}},Fr=async je=>{for(const fn of je)await s(fn)},Ca=async()=>{me(!0),q(null),D(null);try{const je=await B6();q(`تم حذف ${je} فكرة مكررة بنجاح`),await a()}catch(je){console.error("Error cleaning up duplicates:",je),D("حدث خطأ أثناء حذف الأفكار المكررة")}finally{me(!1)}},Qe=async()=>{we(!0),ce(null),oe(null);try{const je=e.filter(ds=>ds.status!=="approved");if(je.length===0){ce("لا توجد أفكار في انتظار الموافقة"),we(!1);return}let fn=0;for(const ds of je)await i(ds.id,{status:"approved"}),fn++;await a(),ce(`تمت الموافقة على ${fn} فكرة بنجاح`)}catch(je){console.error("Error approving pending ideas:",je),oe("حدث خطأ أثناء الموافقة على الأفكار")}finally{we(!1)}},zt=je=>{switch(je){case"beginner":return"bg-green-100 text-green-800";case"intermediate":return"bg-yellow-100 text-yellow-800";case"advanced":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},ca=je=>{switch(je){case"beginner":return"مبتدئ";case"intermediate":return"متوسط";case"advanced":return"متقدم";default:return je}},tr=je=>{switch(je){case"stem":return"ستيم";case"entrepreneurship":return"ريادة الأعمال";case"volunteer":return"التطوع";case"ethics":return"الأخلاق";default:return je}},Fn=je=>{switch(je){case"pending":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},kd=je=>{switch(je){case"pending":return"قيد المراجعة";case"approved":return"موافق عليها";case"rejected":return"مرفوضة";default:return je}};return t?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(pt,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:r})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(xa,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"إدارة أفكار المشاريع"}),n.jsx("p",{className:"opacity-90",children:"إضافة وتعديل وحذف أفكار المشاريع"})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:()=>E(!0),className:"bg-white bg-opacity-20 text-white px-6 py-3 rounded-xl font-medium hover:bg-opacity-30 transition-all duration-200 flex items-center gap-2",children:[n.jsx(nu,{className:"w-5 h-5"}),"استيراد / تصدير"]}),n.jsxs("button",{onClick:Ca,disabled:xe,className:"bg-white bg-opacity-20 text-white px-6 py-3 rounded-xl font-medium hover:bg-opacity-30 transition-all duration-200 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(Wj,{className:"w-5 h-5"}),xe?"جاري الحذف...":"حذف المكرر"]}),n.jsxs("button",{onClick:Qe,disabled:ve,className:"bg-white bg-opacity-20 text-white px-6 py-3 rounded-xl font-medium hover:bg-opacity-30 transition-all duration-200 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(ze,{className:"w-5 h-5"}),ve?"جاري الموافقة...":"الموافقة على الكل"]}),n.jsxs("button",{onClick:()=>{M(null),j(!0)},className:"bg-white text-blue-600 px-6 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(gt,{className:"w-5 h-5"}),"إضافة فكرة جديدة"]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.length}),n.jsx("div",{className:"text-sm opacity-80",children:"فكرة مشروع"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.filter(je=>je.status==="pending").length}),n.jsx("div",{className:"text-sm opacity-80",children:"قيد المراجعة"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.filter(je=>je.status==="approved").length}),n.jsx("div",{className:"text-sm opacity-80",children:"موافق عليها"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.filter(je=>je.status==="rejected").length}),n.jsx("div",{className:"text-sm opacity-80",children:"مرفوضة"})]})]})]}),Q&&n.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg flex items-center gap-2",children:[n.jsx(ze,{className:"w-5 h-5 flex-shrink-0"}),n.jsx("p",{children:Q})]}),se&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center gap-2",children:[n.jsx(pt,{className:"w-5 h-5 flex-shrink-0"}),n.jsx("p",{children:se})]}),Ae&&n.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg flex items-center gap-2",children:[n.jsx(ze,{className:"w-5 h-5 flex-shrink-0"}),n.jsx("p",{children:Ae})]}),he&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center gap-2",children:[n.jsx(pt,{className:"w-5 h-5 flex-shrink-0"}),n.jsx("p",{children:he})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 mb-6",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ut,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"البحث في أفكار المشاريع...",value:y,onChange:je=>w(je.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("button",{onClick:()=>_(!v),className:"lg:hidden flex items-center gap-2 px-4 py-3 bg-gray-100 rounded-xl hover:bg-gray-200 transition-colors",children:[n.jsx(Ko,{className:"w-5 h-5"}),"الفلاتر"]})]}),n.jsxs("div",{className:`space-y-4 ${v?"block":"hidden lg:block"}`,children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:"حالة الفكرة"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:nt.map(je=>n.jsx("button",{onClick:()=>g(je.id),className:`px-4 py-2 rounded-xl transition-all ${p===je.id?je.color:"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:je.name},je.id))})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:"الفئات"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:Ve.map(je=>n.jsx("button",{onClick:()=>h(je.id),className:`px-4 py-2 rounded-xl transition-all ${f===je.id?"bg-blue-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:je.name},je.id))})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:"مستوى الصعوبة"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:ct.map(je=>n.jsx("button",{onClick:()=>x(je.id),className:`px-4 py-2 rounded-xl transition-all ${m===je.id?"bg-blue-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:je.name},je.id))})]})]})]}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:["عرض ",At.length," من أصل ",e.length," فكرة"]})}),n.jsx("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"العنوان"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الفئة"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الصعوبة"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الحالة"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المشاهدات"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"التنزيلات"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"تاريخ الإنشاء"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الإجراءات"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:At.map(je=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-md overflow-hidden",children:n.jsx("img",{src:je.image||"https://images.pexels.com/photos/3184465/pexels-photo-3184465.jpeg?auto=compress&cs=tinysrgb&w=150",alt:je.title,className:"h-10 w-10 object-cover"})}),n.jsxs("div",{className:"mr-4",children:[n.jsx("div",{className:"text-sm font-medium text-gray-900",children:je.title}),n.jsx("div",{className:"text-sm text-gray-500 line-clamp-1",children:je.description})]})]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800",children:tr(je.category)})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${zt(je.difficulty)}`,children:ca(je.difficulty)})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${Fn(je.status)}`,children:kd(je.status)})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:je.views}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:je.downloads}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:je.created_at?Ze(je.created_at):"غير محدد"}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:n.jsxs("div",{className:"flex items-center gap-2",children:[je.status==="pending"&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>la(je.id),disabled:K,className:"p-1 text-green-600 hover:text-green-900 hover:bg-green-50 rounded transition-colors",title:"موافقة",children:n.jsx(ze,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>{V(je),C(!0)},className:"p-1 text-red-600 hover:text-red-900 hover:bg-red-50 rounded transition-colors",title:"رفض",children:n.jsx(Mr,{className:"w-5 h-5"})})]}),n.jsx("button",{onClick:()=>{M(je),j(!0)},className:"p-1 text-indigo-600 hover:text-indigo-900 hover:bg-indigo-50 rounded transition-colors",title:"تعديل",children:n.jsx(Oa,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>{F(je),k(!0)},className:"p-1 text-red-600 hover:text-red-900 hover:bg-red-50 rounded transition-colors",title:"حذف",children:n.jsx(ir,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>l(je.id),className:"p-1 text-blue-600 hover:text-blue-900 hover:bg-blue-50 rounded transition-colors",title:"عرض",children:n.jsx(sr,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>c(je.id),className:"p-1 text-green-600 hover:text-green-900 hover:bg-green-50 rounded transition-colors",title:"تنزيل",children:n.jsx(Tr,{className:"w-5 h-5"})})]})})]},je.id))})]})})}),At.length===0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12 bg-white rounded-2xl shadow-lg",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(xa,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"لا توجد أفكار مشاريع"}),n.jsx("p",{className:"text-gray-600 mb-4",children:e.length===0?"لم يتم إضافة أي أفكار مشاريع بعد":"لم يتم العثور على أفكار مشاريع تطابق معايير البحث"}),n.jsxs("div",{className:"flex justify-center gap-4",children:[n.jsxs("button",{onClick:()=>{M(null),j(!0)},className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2",children:[n.jsx(gt,{className:"w-4 h-4"}),"إضافة فكرة جديدة"]}),e.length>0&&n.jsx("button",{onClick:()=>{h("all"),x("all"),g("all"),w("")},className:"px-6 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إعادة تعيين الفلاتر"})]})]}),n.jsx(t2,{isOpen:b,onClose:()=>j(!1),onSubmit:T?er:Xt,editingIdea:T}),n.jsx(iQ,{isOpen:N,onClose:()=>k(!1),onConfirm:ea,title:(A==null?void 0:A.title)||"",isDeleting:ee}),n.jsx(oue,{isOpen:S,onClose:()=>E(!1),onImport:Fr,projectIdeas:e}),P&&H&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(Mr,{className:"w-6 h-6 text-red-600"}),"رفض فكرة المشروع"]}),n.jsx("button",{onClick:()=>C(!1),className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Mr,{className:"w-5 h-5 text-gray-600"})})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("p",{className:"text-gray-700 mb-4",children:"أنت على وشك رفض فكرة المشروع التالية:"}),n.jsxs("p",{className:"font-semibold text-gray-800 mb-4",children:['"',H.title,'"']}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"سبب الرفض (سيتم إرساله للمستخدم)"}),n.jsx("textarea",{value:B,onChange:je=>L(je.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"اشرح سبب رفض هذه الفكرة...",required:!0})]})]}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{onClick:()=>C(!1),className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{onClick:Ms,disabled:W||!B.trim(),className:"px-6 py-3 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:W?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الرفض..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Mr,{className:"w-5 h-5"}),"تأكيد الرفض"]})})]})]})})]})},cue=({isOpen:e,onClose:t,onSubmit:r,editingVideo:a})=>{var _;const[s,i]=O.useState({title:"",description:"",type:"video",category:"",author:"",duration:"",difficulty:"beginner",thumbnail:"",contentUrl:"",videoUrl:"",watchUrl:"",embedUrl:"",tags:[],featured:!1}),[o,l]=O.useState(""),[c,d]=O.useState(!1),[u,f]=O.useState(null),[h,m]=O.useState(null);O.useEffect(()=>{var b;i(a?{...a,tags:(b=a.tags)!=null&&b.length?a.tags:[]}:{title:"",description:"",type:"video",category:"",author:"",duration:"",difficulty:"beginner",thumbnail:"",contentUrl:"",videoUrl:"",watchUrl:"",embedUrl:"",tags:[],featured:!1}),l(""),f(null),m(null)},[a,e]);const x=[{id:"project-management",name:"إدارة المشاريع"},{id:"programming",name:"البرمجة"},{id:"design",name:"التصميم"},{id:"entrepreneurship",name:"ريادة الأعمال"},{id:"stem",name:"ستيم"},{id:"soft-skills",name:"المهارات الناعمة"},{id:"education",name:"التعليم"},{id:"intellectual-property",name:"الملكية الفكرية"}],p=[{id:"beginner",name:"مبتدئ"},{id:"intermediate",name:"متوسط"},{id:"advanced",name:"متقدم"}],g=(b,j)=>{if(i(N=>({...N,[b]:j})),b==="videoUrl"&&j)try{if(j.includes("youtube.com")||j.includes("youtu.be")){if(j.includes("embed")){const N=j.split("/").pop();N&&i(k=>({...k,watchUrl:`https://www.youtube.com/watch?v=${N}`,embedUrl:j}))}else if(j.includes("watch")){const k=new URL(j).searchParams.get("v");k&&i(S=>({...S,watchUrl:j,embedUrl:`https://www.youtube.com/embed/${k}`}))}}}catch(N){console.error("Error parsing video URL:",N)}},y=()=>{o.trim()&&(i(b=>({...b,tags:[...b.tags||[],o.trim()]})),l(""))},w=b=>{i(j=>{var N;return{...j,tags:(N=j.tags)==null?void 0:N.filter((k,S)=>S!==b)}})},v=async b=>{if(b.preventDefault(),!s.title||!s.description||!s.category||!s.author){f("يرجى ملء جميع الحقول المطلوبة");return}if(s.videoUrl&&(!s.watchUrl||!s.embedUrl))try{if(s.videoUrl.includes("youtube.com")||s.videoUrl.includes("youtu.be")){if(s.videoUrl.includes("embed")&&!s.watchUrl){const j=s.videoUrl.split("/").pop();j&&(s.watchUrl=`https://www.youtube.com/watch?v=${j}`)}else if(s.videoUrl.includes("watch")&&!s.embedUrl){const N=new URL(s.videoUrl).searchParams.get("v");N&&(s.embedUrl=`https://www.youtube.com/embed/${N}`)}}}catch(j){console.error("Error deriving video URLs:",j)}d(!0),f(null),m(null);try{await r(s),m("تم حفظ الفيديو بنجاح"),setTimeout(()=>{t()},1500)}catch(j){console.error("Error submitting video:",j),f(j instanceof Error?j.message:"حدث خطأ في حفظ الفيديو")}finally{d(!1)}};return e?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(jr,{className:"w-6 h-6 text-emerald-600"}),a?"تعديل فيديو تعليمي":"إضافة فيديو تعليمي جديد"]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Pt,{className:"w-5 h-5 text-gray-600"})})]}),u&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(pt,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:u})]}),h&&n.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(ze,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:h})]}),n.jsxs("form",{onSubmit:v,className:"space-y-6",children:[n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"عنوان الفيديو *"}),n.jsx("input",{type:"text",value:s.title,onChange:b=>g("title",b.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"أدخل عنوان الفيديو",required:!0})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"وصف الفيديو *"}),n.jsx("textarea",{value:s.description,onChange:b=>g("description",b.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"اكتب وصفاً شاملاً للفيديو ومحتواه",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الفئة *"}),n.jsxs("div",{className:"relative",children:[n.jsx(wt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsxs("select",{value:s.category,onChange:b=>g("category",b.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",required:!0,children:[n.jsx("option",{value:"",children:"اختر الفئة"}),x.map(b=>n.jsx("option",{value:b.id,children:b.name},b.id))]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المؤلف *"}),n.jsxs("div",{className:"relative",children:[n.jsx(xr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:s.author,onChange:b=>g("author",b.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"اسم المؤلف أو المقدم",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المدة"}),n.jsxs("div",{className:"relative",children:[n.jsx(jt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:s.duration,onChange:b=>g("duration",b.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"مثال: 15 دقيقة"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"مستوى الصعوبة"}),n.jsxs("div",{className:"relative",children:[n.jsx(d6,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("select",{value:s.difficulty||"beginner",onChange:b=>g("difficulty",b.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",children:p.map(b=>n.jsx("option",{value:b.id,children:b.name},b.id))})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رابط الصورة المصغرة"}),n.jsxs("div",{className:"relative",children:[n.jsx(ld,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"url",value:s.thumbnail||"",onChange:b=>g("thumbnail",b.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"أدخل رابط الصورة المصغرة"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رابط الفيديو *"}),n.jsxs("div",{className:"relative",children:[n.jsx(ou,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"url",value:s.videoUrl||"",onChange:b=>g("videoUrl",b.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"أدخل رابط الفيديو (مثال: https://www.youtube.com/watch?v=...)",required:!0})]}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"يمكنك إدخال رابط المشاهدة العادي أو رابط التضمين"})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الكلمات المفتاحية"}),n.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:(_=s.tags)==null?void 0:_.map((b,j)=>n.jsxs("div",{className:"flex items-center gap-1 px-3 py-1 bg-emerald-100 text-emerald-800 rounded-full",children:[n.jsx("span",{children:b}),n.jsx("button",{type:"button",onClick:()=>w(j),className:"w-4 h-4 rounded-full flex items-center justify-center hover:bg-emerald-200",children:n.jsx(Pt,{className:"w-3 h-3"})})]},j))}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(cd,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:o,onChange:b=>l(b.target.value),onKeyPress:b=>b.key==="Enter"&&(b.preventDefault(),y()),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"أضف كلمة مفتاحية"})]}),n.jsx("button",{type:"button",onClick:y,className:"px-4 py-3 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors",children:"إضافة"})]})]}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",id:"featured",checked:s.featured||!1,onChange:b=>g("featured",b.target.checked),className:"w-4 h-4 text-emerald-600 border-gray-300 rounded focus:ring-emerald-500"}),n.jsx("label",{htmlFor:"featured",className:"ml-2 block text-sm text-gray-900",children:"عرض كفيديو مميز"})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[n.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{type:"submit",disabled:c,className:"px-6 py-3 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:c?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الحفظ..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Zn,{className:"w-5 h-5"}),a?"حفظ التغييرات":"إضافة الفيديو"]})})]})]})]})}):null},due=({isOpen:e,onClose:t,onConfirm:r,title:a,isDeleting:s})=>e?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(pt,{className:"w-6 h-6 text-red-600"}),"تأكيد الحذف"]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Pt,{className:"w-5 h-5 text-gray-600"})})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("p",{className:"text-gray-700",children:"هل أنت متأكد من حذف الفيديو التالي؟"}),n.jsxs("p",{className:"font-semibold text-gray-800 mt-2",children:['"',a,'"']}),n.jsx("p",{className:"text-red-600 text-sm mt-4",children:"هذا الإجراء لا يمكن التراجع عنه."})]}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{onClick:r,disabled:s,className:"px-6 py-3 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:s?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الحذف..."]}):n.jsxs(n.Fragment,{children:[n.jsx(ir,{className:"w-5 h-5"}),"تأكيد الحذف"]})})]})]})}):null,uue=()=>{const{resources:e,loading:t,error:r,fetchResources:a,createResource:s,updateResource:i,deleteResource:o,cleanupDuplicateResources:l}=Wx(),[c,d]=O.useState([]),[u,f]=O.useState(""),[h,m]=O.useState("all"),[x,p]=O.useState(!1),[g,y]=O.useState(null),[w,v]=O.useState(!1),[_,b]=O.useState(null),[j,N]=O.useState(!1),[k,S]=O.useState(null),[E,P]=O.useState(!1),[C,T]=O.useState(null),[M,A]=O.useState(null);O.useEffect(()=>{if(e){const W=e.filter(re=>re.type==="video");d(W)}},[e]),O.useEffect(()=>{a("video")},[]);const F=[{id:"all",name:"جميع الفئات"},{id:"project-management",name:"إدارة المشاريع"},{id:"programming",name:"البرمجة"},{id:"design",name:"التصميم"},{id:"entrepreneurship",name:"ريادة الأعمال"},{id:"stem",name:"ستيم"},{id:"soft-skills",name:"المهارات الناعمة"},{id:"education",name:"التعليم"},{id:"intellectual-property",name:"الملكية الفكرية"}],H=c.filter(W=>{const re=h==="all"||W.category===h,xe=W.title.toLowerCase().includes(u.toLowerCase())||W.description.toLowerCase().includes(u.toLowerCase())||W.author.toLowerCase().includes(u.toLowerCase());return re&&xe}),V=async W=>{try{await s({...W,type:"video"}),S("تم إضافة الفيديو بنجاح"),setTimeout(()=>S(null),3e3);return}catch(re){throw console.error("Error adding video:",re),re}},B=async W=>{if(g)try{await i(g.id,{...W,type:"video"}),S("تم تحديث الفيديو بنجاح"),setTimeout(()=>S(null),3e3);return}catch(re){throw console.error("Error updating video:",re),re}},L=async()=>{if(_){N(!0);try{await o(_.id),v(!1),S("تم حذف الفيديو بنجاح"),setTimeout(()=>S(null),3e3)}catch(W){console.error("Error deleting video:",W)}finally{N(!1),b(null)}}},ee=async()=>{P(!0),T(null),A(null);try{const W=await l();T(`تم حذف ${W} مورد تعليمي مكرر بنجاح`),await a("video")}catch(W){console.error("Error cleaning up duplicates:",W),A("حدث خطأ أثناء حذف الموارد المكررة")}finally{P(!1)}},I=W=>{switch(W){case"beginner":return"bg-green-100 text-green-800";case"intermediate":return"bg-yellow-100 text-yellow-800";case"advanced":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},K=W=>{switch(W){case"beginner":return"مبتدئ";case"intermediate":return"متوسط";case"advanced":return"متقدم";default:return W||"غير محدد"}},z=W=>{const re=F.find(xe=>xe.id===W);return re?re.name:W};return t&&c.length===0?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-emerald-500"})}):r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(pt,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:r})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-emerald-600 to-teal-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(jr,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"إدارة الفيديوهات التعليمية"}),n.jsx("p",{className:"opacity-90",children:"إضافة وتعديل وحذف الفيديوهات التعليمية"})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:ee,disabled:E,className:"bg-white bg-opacity-20 text-white px-6 py-3 rounded-xl font-medium hover:bg-opacity-30 transition-all duration-200 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(Wj,{className:"w-5 h-5"}),E?"جاري الحذف...":"حذف المكرر"]}),n.jsxs("button",{onClick:()=>{y(null),p(!0)},className:"bg-white text-emerald-600 px-6 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(gt,{className:"w-5 h-5"}),"إضافة فيديو جديد"]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:c.length}),n.jsx("div",{className:"text-sm opacity-80",children:"فيديو تعليمي"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:c.filter(W=>W.featured).length}),n.jsx("div",{className:"text-sm opacity-80",children:"فيديو مميز"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:c.reduce((W,re)=>W+re.views,0).toLocaleString()}),n.jsx("div",{className:"text-sm opacity-80",children:"إجمالي المشاهدات"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:F.length-1}),n.jsx("div",{className:"text-sm opacity-80",children:"فئة"})]})]})]}),k&&n.jsxs(te.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-green-50 border border-green-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(ze,{className:"w-6 h-6 text-green-500 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-green-800 mb-1",children:"تمت العملية بنجاح"}),n.jsx("p",{className:"text-green-700",children:k})]})]}),C&&n.jsxs(te.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-green-50 border border-green-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(ze,{className:"w-6 h-6 text-green-500 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-green-800 mb-1",children:"تم حذف العناصر المكررة بنجاح"}),n.jsx("p",{className:"text-green-700",children:C})]})]}),M&&n.jsxs(te.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-red-50 border border-red-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(pt,{className:"w-6 h-6 text-red-500 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-red-800 mb-1",children:"حدث خطأ"}),n.jsx("p",{className:"text-red-700",children:M})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsx("div",{className:"flex flex-col lg:flex-row gap-4 mb-6",children:n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ut,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"البحث في الفيديوهات...",value:u,onChange:W=>f(W.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:"الفئات"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:F.map(W=>n.jsx("button",{onClick:()=>m(W.id),className:`px-4 py-2 rounded-xl transition-all ${h===W.id?"bg-emerald-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:W.name},W.id))})]})]}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:["عرض ",H.length," من أصل ",c.length," فيديو"]})}),n.jsx("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الفيديو"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الفئة"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المؤلف"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المستوى"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المشاهدات"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"تاريخ الإضافة"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الإجراءات"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:H.map(W=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"flex-shrink-0 h-10 w-16 rounded-md overflow-hidden",children:n.jsx("img",{src:W.thumbnail||"https://images.pexels.com/photos/3183150/pexels-photo-3183150.jpeg?auto=compress&cs=tinysrgb&w=150",alt:W.title,className:"h-10 w-16 object-cover"})}),n.jsxs("div",{className:"mr-4",children:[n.jsx("div",{className:"text-sm font-medium text-gray-900",children:W.title}),n.jsx("div",{className:"text-sm text-gray-500 line-clamp-1",children:W.description})]})]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-emerald-100 text-emerald-800",children:z(W.category)})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:W.author}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${I(W.difficulty)}`,children:K(W.difficulty)})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:W.views.toLocaleString()}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Ze(W.createdAt)}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>{y(W),p(!0)},className:"p-1 text-indigo-600 hover:text-indigo-900 hover:bg-indigo-50 rounded transition-colors",title:"تعديل",children:n.jsx(Oa,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>{b(W),v(!0)},className:"p-1 text-red-600 hover:text-red-900 hover:bg-red-50 rounded transition-colors",title:"حذف",children:n.jsx(ir,{className:"w-5 h-5"})}),n.jsx("a",{href:W.watchUrl||W.contentUrl||"#",target:"_blank",rel:"noopener noreferrer",className:"p-1 text-blue-600 hover:text-blue-900 hover:bg-blue-50 rounded transition-colors",title:"عرض",children:n.jsx(pi,{className:"w-5 h-5"})})]})})]},W.id))})]})})}),H.length===0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12 bg-white rounded-2xl shadow-lg",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(jr,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"لا توجد فيديوهات"}),n.jsx("p",{className:"text-gray-600 mb-4",children:c.length===0?"لم يتم إضافة أي فيديوهات تعليمية بعد":"لم يتم العثور على فيديوهات تطابق معايير البحث"}),n.jsxs("div",{className:"flex justify-center gap-4",children:[n.jsxs("button",{onClick:()=>{y(null),p(!0)},className:"px-6 py-2 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors flex items-center gap-2",children:[n.jsx(gt,{className:"w-4 h-4"}),"إضافة فيديو جديد"]}),c.length>0&&n.jsx("button",{onClick:()=>{m("all"),f("")},className:"px-6 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إعادة تعيين الفلاتر"})]})]}),n.jsx(cue,{isOpen:x,onClose:()=>p(!1),onSubmit:g?B:V,editingVideo:g}),n.jsx(due,{isOpen:w,onClose:()=>v(!1),onConfirm:L,title:(_==null?void 0:_.title)||"",isDeleting:j})]})},fue=({isOpen:e,onClose:t,registration:r})=>{const{t:a}=yt();return!e||!r?null:n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(xr,{className:"w-6 h-6 text-blue-600"}),r.fullName]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Pt,{className:"w-5 h-5 text-gray-600"})})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-6",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:a("summerProgram.enrollmentForm.email")}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Ta,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:r.email})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:a("summerProgram.enrollmentForm.phone")}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Pr,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:r.phone})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:a("summerProgram.enrollmentForm.parentPhone")}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Pr,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:r.parentPhone})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:a("summerProgram.enrollmentForm.city")}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Of,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:r.city})]})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:a("summerProgram.enrollmentForm.idNumber")}),n.jsx("span",{className:"text-gray-800",children:r.idNumber})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:a("summerProgram.enrollmentForm.school")}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(gn,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:r.school})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:a("summerProgram.enrollmentForm.grade")}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(js,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:r.grade})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:a("summerProgram.enrollmentForm.educationAdministration")}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(jn,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:r.educationAdministration})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:a("summerProgram.admin.table.status")}),n.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${r.status==="approved"?"bg-green-100 text-green-800":r.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:r.status==="approved"?a("summerProgram.admin.statuses.approved"):r.status==="rejected"?a("summerProgram.admin.statuses.rejected"):a("summerProgram.admin.statuses.pending")})]})]})]}),n.jsxs("div",{className:"space-y-6 mb-6",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:a("summerProgram.enrollmentForm.interests")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:r.interests.map(s=>n.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:s},s))})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:a("summerProgram.enrollmentForm.howDidYouHear")}),n.jsx("p",{className:"text-gray-800",children:r.howDidYouHear})]}),r.hasParticipatedBefore&&r.previousProjects&&n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:a("summerProgram.enrollmentForm.previousProjects")}),n.jsx("p",{className:"text-gray-800 whitespace-pre-line",children:r.previousProjects})]}),r.notes&&n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:a("summerProgram.enrollmentForm.notes")}),n.jsx("p",{className:"text-gray-800 whitespace-pre-line",children:r.notes})]})]}),n.jsx("div",{className:"border-t border-gray-200 pt-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"text-sm text-gray-500",children:[a("summerProgram.admin.table.submittedAt"),": ",Ze(r.createdAt.toString())]}),n.jsx("div",{className:"flex gap-2",children:n.jsx("button",{onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:a("common.close")})})]})})]})})},Ch=({isOpen:e,onClose:t,onConfirm:r,title:a,message:s,confirmText:i,confirmColor:o,icon:l,isProcessing:c})=>{const{t:d}=yt();return e?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[l,a]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Pt,{className:"w-5 h-5 text-gray-600"})})]}),n.jsx("div",{className:"mb-6",children:n.jsx("p",{className:"text-gray-700",children:s})}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:d("common.cancel")}),n.jsx("button",{onClick:r,disabled:c,className:`px-6 py-3 ${o} text-white rounded-xl hover:opacity-90 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed`,children:c?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),d("common.loading")]}):n.jsxs(n.Fragment,{children:[l,i]})})]})]})}):null},hue=()=>{const{t:e}=yt(),[t,r]=O.useState([]),[a,s]=O.useState(!0),[i,o]=O.useState(null),[l,c]=O.useState(""),[d,u]=O.useState("all"),[f,h]=O.useState("all"),[m,x]=O.useState("all"),[p,g]=O.useState("all"),[y,w]=O.useState(null),[v,_]=O.useState(!1),[b,j]=O.useState(!1),[N,k]=O.useState(!1),[S,E]=O.useState(!1),[P,C]=O.useState(null),[T,M]=O.useState(!1),[A,F]=O.useState(null),[H,V]=O.useState(null);O.useEffect(()=>{B()},[]);const B=async()=>{try{s(!0),o(null);const q=await z6();r(q)}catch(q){console.error("Error fetching summer program registrations:",q),o(q instanceof Error?q.message:"Failed to load registrations")}finally{s(!1)}},L=["all",...new Set(t.map(q=>q.city))],ee=["all",...new Set(t.map(q=>q.grade))],I=["all",...new Set(t.map(q=>q.educationAdministration))],K=t.filter(q=>{const se=d==="all"||q.status===d,D=f==="all"||q.city===f,ve=m==="all"||q.grade===m,we=p==="all"||q.educationAdministration===p,Ae=q.fullName.toLowerCase().includes(l.toLowerCase())||q.email.toLowerCase().includes(l.toLowerCase())||q.phone.includes(l)||q.school.toLowerCase().includes(l.toLowerCase());return se&&D&&ve&&we&&Ae}),z={total:t.length,pending:t.filter(q=>q.status==="pending").length,approved:t.filter(q=>q.status==="approved").length,rejected:t.filter(q=>q.status==="rejected").length},W=q=>{w(q),_(!0)},re=async()=>{if(P){M(!0),V(null);try{await Gg(P,{status:"approved"}),await B(),j(!1),F(e("summerProgram.admin.approveSuccess")),setTimeout(()=>{F(null)},3e3)}catch(q){console.error("Error approving registration:",q),V(e("summerProgram.admin.approveError"))}finally{M(!1),C(null)}}},xe=async()=>{if(P){M(!0),V(null);try{await Gg(P,{status:"rejected"}),await B(),k(!1),F(e("summerProgram.admin.rejectSuccess")),setTimeout(()=>{F(null)},3e3)}catch(q){console.error("Error rejecting registration:",q),V(e("summerProgram.admin.rejectError"))}finally{M(!1),C(null)}}},me=async()=>{if(P){M(!0),V(null);try{await G6(P),await B(),E(!1),F(e("summerProgram.admin.deleteSuccess")),setTimeout(()=>{F(null)},3e3)}catch(q){console.error("Error deleting registration:",q),V(e("summerProgram.admin.deleteError"))}finally{M(!1),C(null)}}},Q=()=>{try{const q=K.map(ve=>({[e("summerProgram.admin.table.name")]:ve.fullName,[e("summerProgram.admin.table.email")]:ve.email,[e("summerProgram.admin.table.phone")]:ve.phone,[e("summerProgram.enrollmentForm.parentPhone")]:ve.parentPhone,[e("summerProgram.admin.table.city")]:ve.city,[e("summerProgram.enrollmentForm.idNumber")]:ve.idNumber,[e("summerProgram.enrollmentForm.school")]:ve.school,[e("summerProgram.admin.table.grade")]:ve.grade,[e("summerProgram.admin.table.educationAdministration")]:ve.educationAdministration,[e("summerProgram.enrollmentForm.hasParticipatedBefore")]:ve.hasParticipatedBefore?e("summerProgram.enrollmentForm.yes"):e("summerProgram.enrollmentForm.no"),[e("summerProgram.enrollmentForm.previousProjects")]:ve.previousProjects||"",[e("summerProgram.enrollmentForm.interests")]:ve.interests.join(", "),[e("summerProgram.enrollmentForm.howDidYouHear")]:ve.howDidYouHear,[e("summerProgram.enrollmentForm.notes")]:ve.notes||"",[e("summerProgram.admin.table.status")]:ve.status==="approved"?e("summerProgram.admin.statuses.approved"):ve.status==="rejected"?e("summerProgram.admin.statuses.rejected"):e("summerProgram.admin.statuses.pending"),[e("summerProgram.admin.table.submittedAt")]:Ze(ve.createdAt.toString())})),se=ai.json_to_sheet(q),D=ai.book_new();ai.book_append_sheet(D,se,"Registrations"),t3(D,"summer_program_registrations.xlsx"),F(e("summerProgram.admin.exportSuccess")),setTimeout(()=>{F(null)},3e3)}catch(q){console.error("Error exporting to Excel:",q),V(e("summerProgram.admin.exportError"))}};return a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):i?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(AlertCircle,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:i})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(tt,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("summerProgram.admin.title")}),n.jsx("p",{className:"opacity-90",children:e("summerProgram.admin.subtitle")})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:z.total}),n.jsx("div",{className:"text-sm opacity-80",children:e("summerProgram.admin.stats.totalRegistrations")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:z.pending}),n.jsx("div",{className:"text-sm opacity-80",children:e("summerProgram.admin.stats.pendingReview")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:z.approved}),n.jsx("div",{className:"text-sm opacity-80",children:e("summerProgram.admin.stats.approved")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:z.rejected}),n.jsx("div",{className:"text-sm opacity-80",children:e("summerProgram.admin.stats.rejected")})]})]})]}),A&&n.jsxs(te.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-green-50 border border-green-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(ze,{className:"w-6 h-6 text-green-500 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-green-800 mb-1",children:e("common.success")}),n.jsx("p",{className:"text-green-700",children:A})]})]}),H&&n.jsxs(te.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-red-50 border border-red-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(AlertCircle,{className:"w-6 h-6 text-red-500 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-red-800 mb-1",children:e("common.error")}),n.jsx("p",{className:"text-red-700",children:H})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 mb-6",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ut,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("summerProgram.admin.searchPlaceholder"),value:l,onChange:q=>c(q.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("button",{onClick:Q,className:"px-6 py-3 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors flex items-center gap-2",children:[n.jsx(Tr,{className:"w-5 h-5"}),e("summerProgram.admin.actions.export")]})]}),n.jsxs("div",{className:"grid md:grid-cols-4 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("summerProgram.admin.filters.status")}),n.jsxs("select",{value:d,onChange:q=>u(q.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:e("summerProgram.admin.statuses.all")}),n.jsx("option",{value:"pending",children:e("summerProgram.admin.statuses.pending")}),n.jsx("option",{value:"approved",children:e("summerProgram.admin.statuses.approved")}),n.jsx("option",{value:"rejected",children:e("summerProgram.admin.statuses.rejected")})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("summerProgram.admin.filters.city")}),n.jsxs("select",{value:f,onChange:q=>h(q.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:e("common.all")}),L.filter(q=>q!=="all").map(q=>n.jsx("option",{value:q,children:q},q))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("summerProgram.admin.filters.grade")}),n.jsxs("select",{value:m,onChange:q=>x(q.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:e("common.all")}),ee.filter(q=>q!=="all").map(q=>n.jsx("option",{value:q,children:q},q))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("summerProgram.admin.filters.educationAdministration")}),n.jsxs("select",{value:p,onChange:q=>g(q.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:e("common.all")}),I.filter(q=>q!=="all").map(q=>n.jsx("option",{value:q,children:q},q))]})]})]})]}),n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e("summerProgram.admin.table.name")}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e("summerProgram.admin.table.email")}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e("summerProgram.admin.table.phone")}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e("summerProgram.admin.table.city")}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e("summerProgram.admin.table.grade")}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e("summerProgram.admin.table.educationAdministration")}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e("summerProgram.admin.table.status")}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e("summerProgram.admin.table.submittedAt")}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e("summerProgram.admin.table.actions")})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:K.map(q=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:n.jsx(xr,{className:"h-6 w-6 text-blue-600"})}),n.jsx("div",{className:"mr-4",children:n.jsx("div",{className:"text-sm font-medium text-gray-900",children:q.fullName})})]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm text-gray-900",children:q.email})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm text-gray-900",children:q.phone})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm text-gray-900",children:q.city})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm text-gray-900",children:q.grade})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm text-gray-900",children:q.educationAdministration})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${q.status==="approved"?"bg-green-100 text-green-800":q.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:q.status==="approved"?e("summerProgram.admin.statuses.approved"):q.status==="rejected"?e("summerProgram.admin.statuses.rejected"):e("summerProgram.admin.statuses.pending")})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Ze(q.createdAt.toString())}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>W(q),className:"p-1 text-blue-600 hover:text-blue-900 hover:bg-blue-50 rounded transition-colors",title:e("summerProgram.admin.actions.view"),children:n.jsx(sr,{className:"w-5 h-5"})}),q.status==="pending"&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>{C(q.id),j(!0)},className:"p-1 text-green-600 hover:text-green-900 hover:bg-green-50 rounded transition-colors",title:e("summerProgram.admin.actions.approve"),children:n.jsx(ze,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>{C(q.id),k(!0)},className:"p-1 text-red-600 hover:text-red-900 hover:bg-red-50 rounded transition-colors",title:e("summerProgram.admin.actions.reject"),children:n.jsx(Mr,{className:"w-5 h-5"})})]}),n.jsx("button",{onClick:()=>{C(q.id),E(!0)},className:"p-1 text-red-600 hover:text-red-900 hover:bg-red-50 rounded transition-colors",title:e("summerProgram.admin.actions.delete"),children:n.jsx(ir,{className:"w-5 h-5"})})]})})]},q.id))})]})})}),K.length===0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12 bg-white rounded-2xl shadow-lg",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(br,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("summerProgram.admin.noRegistrations")}),n.jsx("p",{className:"text-gray-600 mb-4",children:t.length===0?e("summerProgram.admin.noRegistrations"):e("summerProgram.admin.noRegistrationsMatch")}),t.length>0&&n.jsx("button",{onClick:()=>{u("all"),h("all"),x("all"),g("all"),c("")},className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:e("common.resetFilters")})]}),n.jsx(fue,{isOpen:v,onClose:()=>_(!1),registration:y}),n.jsx(Ch,{isOpen:b,onClose:()=>j(!1),onConfirm:re,title:e("summerProgram.admin.approveConfirmation"),message:e("summerProgram.admin.approveConfirmation"),confirmText:e("summerProgram.admin.actions.approve"),confirmColor:"bg-green-500 hover:bg-green-600",icon:n.jsx(ze,{className:"w-5 h-5"}),isProcessing:T}),n.jsx(Ch,{isOpen:N,onClose:()=>k(!1),onConfirm:xe,title:e("summerProgram.admin.rejectConfirmation"),message:e("summerProgram.admin.rejectConfirmation"),confirmText:e("summerProgram.admin.actions.reject"),confirmColor:"bg-red-500 hover:bg-red-600",icon:n.jsx(Mr,{className:"w-5 h-5"}),isProcessing:T}),n.jsx(Ch,{isOpen:S,onClose:()=>E(!1),onConfirm:me,title:e("summerProgram.admin.deleteConfirmation"),message:e("summerProgram.admin.deleteConfirmation"),confirmText:e("summerProgram.admin.actions.delete"),confirmColor:"bg-red-500 hover:bg-red-600",icon:n.jsx(ir,{className:"w-5 h-5"}),isProcessing:T})]})},mue=[{id:"all",name:"الكل",icon:ut},{id:"projects",name:"المشاريع",icon:br},{id:"ideas",name:"أفكار المشاريع",icon:xa},{id:"resources",name:"المصادر التعليمية",icon:wt},{id:"store",name:"المتجر",icon:Br},{id:"consultants",name:"المستشارين",icon:lt}],xue=()=>{const{t:e}=yt(),t=Dx(),a=new URLSearchParams(t.search).get("q")||"",[s,i]=O.useState("all"),[o,l]=O.useState(!0),[c,d]=O.useState(null),{projects:u}=Ci(),{storeItems:f}=Df(),{resources:h}=Wx(),{consultants:m}=As(),{projectIdeas:x}=Ux();O.useEffect(()=>{u&&f&&h&&m&&x&&l(!1)},[u,f,h,m,x]);const p=u.filter(E=>E.title.toLowerCase().includes(a.toLowerCase())||E.description.toLowerCase().includes(a.toLowerCase())),g=x.filter(E=>{var P;return E.title.toLowerCase().includes(a.toLowerCase())||E.description.toLowerCase().includes(a.toLowerCase())||((P=E.tags)==null?void 0:P.some(C=>C.toLowerCase().includes(a.toLowerCase())))}),y=h.filter(E=>E.title.toLowerCase().includes(a.toLowerCase())||E.description.toLowerCase().includes(a.toLowerCase())||E.tags.some(P=>P.toLowerCase().includes(a.toLowerCase()))),w=f.filter(E=>{var P;return E.name.toLowerCase().includes(a.toLowerCase())||E.description.toLowerCase().includes(a.toLowerCase())||((P=E.tags)==null?void 0:P.some(C=>C.toLowerCase().includes(a.toLowerCase())))}),v=m.filter(E=>E.name.toLowerCase().includes(a.toLowerCase())||E.title.toLowerCase().includes(a.toLowerCase())||E.specialties.some(P=>P.toLowerCase().includes(a.toLowerCase()))),b=(()=>{switch(s){case"projects":return{projects:p,ideas:[],resources:[],storeItems:[],consultants:[]};case"ideas":return{projects:[],ideas:g,resources:[],storeItems:[],consultants:[]};case"resources":return{projects:[],ideas:[],resources:y,storeItems:[],consultants:[]};case"store":return{projects:[],ideas:[],resources:[],storeItems:w,consultants:[]};case"consultants":return{projects:[],ideas:[],resources:[],storeItems:[],consultants:v};default:return{projects:p,ideas:g,resources:y,storeItems:w,consultants:v}}})(),j=b.projects.length+b.ideas.length+b.resources.length+b.storeItems.length+b.consultants.length,N=E=>{switch(E){case"stem":return"العلوم والتقنية";case"entrepreneurship":return"ريادة الأعمال";case"volunteer":return"التطوع";case"ethics":return"الأخلاق";default:return E}},k=E=>{switch(E){case"beginner":return"مبتدئ";case"intermediate":return"متوسط";case"advanced":return"متقدم";default:return E}},S=E=>{switch(E){case"beginner":return"bg-green-100 text-green-800";case"intermediate":return"bg-yellow-100 text-yellow-800";case"advanced":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return o?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):c?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(pt,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:c})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(ut,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"نتائج البحث"}),n.jsxs("p",{className:"opacity-90",children:['نتائج البحث عن: "',a,'"']})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:j}),n.jsx("div",{className:"text-sm opacity-80",children:"إجمالي النتائج"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:b.projects.length}),n.jsx("div",{className:"text-sm opacity-80",children:"مشروع"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:b.ideas.length}),n.jsx("div",{className:"text-sm opacity-80",children:"فكرة مشروع"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:b.resources.length+b.storeItems.length+b.consultants.length}),n.jsx("div",{className:"text-sm opacity-80",children:"نتائج أخرى"})]})]})]}),n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:n.jsx("div",{className:"flex flex-wrap gap-2",children:mue.map(E=>n.jsxs("button",{onClick:()=>i(E.id),className:`flex items-center gap-2 px-4 py-2 rounded-xl transition-all ${s===E.id?"bg-blue-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[n.jsx(E.icon,{className:"w-4 h-4"}),E.name]},E.id))})}),n.jsxs("div",{className:"space-y-8",children:[(s==="all"||s==="projects")&&b.projects.length>0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(br,{className:"w-5 h-5 text-blue-600"}),"المشاريع (",b.projects.length,")"]}),n.jsx(Ee,{to:"/projects",className:"text-blue-600 hover:text-blue-800 text-sm",children:"عرض الكل"})]}),n.jsxs("div",{className:"space-y-4",children:[b.projects.slice(0,5).map(E=>n.jsx(Ee,{to:`/projects/${E.id}`,className:"block border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-2",children:E.title}),n.jsx("p",{className:"text-gray-600 line-clamp-2",children:E.description}),n.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-500",children:[n.jsxs("span",{children:["الحالة: ",E.status==="active"?"نشط":E.status==="completed"?"مكتمل":E.status==="draft"?"مسودة":"مؤرشف"]}),n.jsxs("span",{children:["التقدم: ",E.progress,"/10"]}),E.due_date&&n.jsxs("span",{children:["تاريخ الاستحقاق: ",Ze(E.due_date)]})]})]}),n.jsx("div",{className:"flex flex-col items-end",children:n.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium",children:"مشروع"})})]})},E.id)),b.projects.length>5&&n.jsx("div",{className:"text-center mt-4",children:n.jsxs(Ee,{to:`/projects?search=${encodeURIComponent(a)}`,className:"text-blue-600 hover:text-blue-800 font-medium",children:["عرض المزيد من المشاريع (",b.projects.length-5,")"]})})]})]}),(s==="all"||s==="ideas")&&b.ideas.length>0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(xa,{className:"w-5 h-5 text-yellow-600"}),"أفكار المشاريع (",b.ideas.length,")"]}),n.jsx(Ee,{to:"/project-ideas",className:"text-blue-600 hover:text-blue-800 text-sm",children:"عرض الكل"})]}),n.jsxs("div",{className:"space-y-4",children:[b.ideas.slice(0,5).map(E=>n.jsx("div",{className:"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-2",children:E.title}),n.jsx("p",{className:"text-gray-600 line-clamp-2",children:E.description}),n.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-lg",children:N(E.category)}),n.jsx("span",{className:`px-2 py-1 text-xs rounded-lg ${S(E.difficulty)}`,children:k(E.difficulty)}),E.tags&&E.tags.slice(0,2).map((P,C)=>n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["#",P]},C))]})]}),n.jsx("div",{className:"flex flex-col items-end",children:n.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs font-medium",children:"فكرة مشروع"})})]})},E.id)),b.ideas.length>5&&n.jsx("div",{className:"text-center mt-4",children:n.jsxs(Ee,{to:"/project-ideas",className:"text-blue-600 hover:text-blue-800 font-medium",children:["عرض المزيد من أفكار المشاريع (",b.ideas.length-5,")"]})})]})]}),(s==="all"||s==="resources")&&b.resources.length>0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.4},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(wt,{className:"w-5 h-5 text-emerald-600"}),"المصادر التعليمية (",b.resources.length,")"]}),n.jsx(Ee,{to:"/resources",className:"text-blue-600 hover:text-blue-800 text-sm",children:"عرض الكل"})]}),n.jsxs("div",{className:"space-y-4",children:[b.resources.slice(0,5).map(E=>n.jsx("div",{className:"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:n.jsxs("div",{className:"flex items-start gap-4",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0",children:n.jsx("img",{src:E.thumbnail||"https://images.pexels.com/photos/3184465/pexels-photo-3184465.jpeg?auto=compress&cs=tinysrgb&w=150",alt:E.title,className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center justify-between mb-1",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:E.title}),n.jsx("span",{className:"px-3 py-1 bg-emerald-100 text-emerald-800 rounded-full text-xs font-medium",children:E.type==="video"?"فيديو":E.type==="article"?"مقالة":E.type==="course"?"دورة":E.type==="template"?"قالب":E.type==="podcast"?"بودكاست":"مصدر تعليمي"})]}),n.jsx("p",{className:"text-gray-600 line-clamp-2",children:E.description}),n.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-500",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(at,{className:"w-3 h-3 text-yellow-400 fill-current"}),n.jsx("span",{children:E.rating})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(sr,{className:"w-3 h-3"}),n.jsxs("span",{children:[E.views," مشاهدة"]})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(jt,{className:"w-3 h-3"}),n.jsx("span",{children:E.duration||"15 دقيقة"})]})]})]})]})},E.id)),b.resources.length>5&&n.jsx("div",{className:"text-center mt-4",children:n.jsxs(Ee,{to:"/resources",className:"text-blue-600 hover:text-blue-800 font-medium",children:["عرض المزيد من المصادر التعليمية (",b.resources.length-5,")"]})})]})]}),(s==="all"||s==="store")&&b.storeItems.length>0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.5},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(Br,{className:"w-5 h-5 text-purple-600"}),"المتجر (",b.storeItems.length,")"]}),n.jsx(Ee,{to:"/store",className:"text-blue-600 hover:text-blue-800 text-sm",children:"عرض الكل"})]}),n.jsxs("div",{className:"space-y-4",children:[b.storeItems.slice(0,5).map(E=>n.jsx("div",{className:"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:n.jsxs("div",{className:"flex items-start gap-4",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0",children:n.jsx("img",{src:E.image,alt:E.name,className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center justify-between mb-1",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:E.name}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"text-xl font-bold text-purple-600",children:[E.price," ر.س"]}),E.originalPrice&&n.jsxs("span",{className:"text-sm text-gray-400 line-through",children:[E.originalPrice," ر.س"]})]})]}),n.jsx("p",{className:"text-gray-600 line-clamp-2",children:E.description}),n.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-500",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(at,{className:"w-3 h-3 text-yellow-400 fill-current"}),n.jsxs("span",{children:[E.rating," (",E.reviews," تقييم)"]})]}),n.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${E.inStock?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:E.inStock?"متوفر":"غير متوفر"})]})]})]})},E.id)),b.storeItems.length>5&&n.jsx("div",{className:"text-center mt-4",children:n.jsxs(Ee,{to:"/store",className:"text-blue-600 hover:text-blue-800 font-medium",children:["عرض المزيد من المنتجات (",b.storeItems.length-5,")"]})})]})]}),(s==="all"||s==="consultants")&&b.consultants.length>0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.6},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(lt,{className:"w-5 h-5 text-emerald-600"}),"المستشارين (",b.consultants.length,")"]}),n.jsx(Ee,{to:"/search",className:"text-blue-600 hover:text-blue-800 text-sm",children:"عرض الكل"})]}),n.jsxs("div",{className:"space-y-4",children:[b.consultants.slice(0,5).map(E=>n.jsx("div",{className:"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:n.jsxs("div",{className:"flex items-start gap-4",children:[n.jsx("div",{className:"w-16 h-16 rounded-full overflow-hidden flex-shrink-0",children:n.jsx("img",{src:E.avatar,alt:E.name,className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center justify-between mb-1",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:E.name}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsxs("span",{children:[E.rating," (",E.reviews," تقييم)"]})]})]}),n.jsx("p",{className:"text-gray-600",children:E.title}),n.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[E.specialties.slice(0,3).map((P,C)=>n.jsx("span",{className:"px-2 py-1 bg-emerald-100 text-emerald-800 text-xs rounded-lg",children:P},C)),E.specialties.length>3&&n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["+",E.specialties.length-3]})]})]})]})},E.id)),b.consultants.length>5&&n.jsx("div",{className:"text-center mt-4",children:n.jsxs(Ee,{to:"/search",className:"text-blue-600 hover:text-blue-800 font-medium",children:["عرض المزيد من المستشارين (",b.consultants.length-5,")"]})})]})]}),j===0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-lg p-8 text-center",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(ut,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"لم يتم العثور على نتائج"}),n.jsxs("p",{className:"text-gray-600 mb-4",children:['لم يتم العثور على نتائج تطابق "',a,'"']}),n.jsx("p",{className:"text-gray-500 text-sm mb-6",children:"حاول تغيير كلمات البحث أو البحث في فئة محددة"}),n.jsx("div",{className:"flex justify-center gap-4",children:n.jsx(Ee,{to:"/",className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:"العودة للرئيسية"})})]})]}),!1]})},ht=({children:e,allowedRoles:t=[]})=>{const{user:r,loading:a}=vt();return a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):r?r.status==="pending"?n.jsx(Ks,{to:"/pending-activation"}):t.length>0&&!t.includes(r.role)?n.jsx(Ks,{to:"/"}):n.jsx(mE,{children:e}):n.jsx(Ks,{to:"/login"})},pue=()=>{const{user:e}=vt();return n.jsxs(I3,{children:[n.jsx(ot,{path:"/login",element:e?n.jsx(Ks,{to:"/"}):n.jsx(xE,{})}),n.jsx(ot,{path:"/register",element:e?n.jsx(Ks,{to:"/"}):n.jsx(pE,{})}),n.jsx(ot,{path:"/pending-activation",element:e?e.status!=="pending"?n.jsx(Ks,{to:"/"}):n.jsx(vE,{}):n.jsx(Ks,{to:"/login"})}),n.jsx(ot,{path:"/summer-program-enrollment",element:n.jsx(yE,{})}),n.jsx(ot,{path:"/",element:n.jsx(ht,{children:n.jsx(gE,{})})}),n.jsx(ot,{path:"/search-results",element:n.jsx(ht,{children:n.jsx(xue,{})})}),n.jsx(ot,{path:"/project-ideas",element:n.jsx(ht,{children:n.jsx(ME,{})})}),n.jsx(ot,{path:"/projects",element:n.jsx(ht,{children:n.jsx(EE,{})})}),n.jsx(ot,{path:"/projects/:id",element:n.jsx(ht,{children:n.jsx(IE,{})})}),n.jsx(ot,{path:"/projects/new",element:n.jsx(ht,{children:n.jsx(DE,{})})}),n.jsx(ot,{path:"/projects/:id/edit",element:n.jsx(ht,{children:n.jsx(RE,{})})}),n.jsx(ot,{path:"/gallery",element:n.jsx(ht,{children:n.jsx(UE,{})})}),n.jsx(ot,{path:"/store",element:n.jsx(ht,{children:n.jsx(VE,{})})}),n.jsx(ot,{path:"/cart",element:n.jsx(ht,{children:n.jsx(GE,{})})}),n.jsx(ot,{path:"/checkout",element:n.jsx(ht,{children:n.jsx(KE,{})})}),n.jsx(ot,{path:"/ai-assistant",element:n.jsx(ht,{children:n.jsx(JE,{})})}),n.jsx(ot,{path:"/resources",element:n.jsx(ht,{children:n.jsx(ZE,{})})}),n.jsx(ot,{path:"/intellectual-property",element:n.jsx(ht,{children:n.jsx(eA,{})})}),n.jsx(ot,{path:"/consultations",element:n.jsx(ht,{children:n.jsx(NE,{})})}),n.jsx(ot,{path:"/my-consultations",element:n.jsx(ht,{children:n.jsx(_E,{})})}),n.jsx(ot,{path:"/create-consultation-request",element:n.jsx(ht,{children:n.jsx(SE,{})})}),n.jsx(ot,{path:"/consultant-dashboard",element:n.jsx(ht,{allowedRoles:["consultant"],children:n.jsx(eQ,{})})}),n.jsx(ot,{path:"/consultation-requests",element:n.jsx(ht,{allowedRoles:["consultant"],children:n.jsx(tQ,{})})}),n.jsx(ot,{path:"/consultant-schedule",element:n.jsx(ht,{allowedRoles:["consultant"],children:n.jsx(rQ,{})})}),n.jsx(ot,{path:"/consultant-profile",element:n.jsx(ht,{allowedRoles:["consultant"],children:n.jsx(aQ,{})})}),n.jsx(ot,{path:"/reviews",element:n.jsx(ht,{allowedRoles:["consultant"],children:n.jsx(nQ,{})})}),n.jsx(ot,{path:"/search",element:n.jsx(ht,{children:n.jsx(JZ,{})})}),n.jsx(ot,{path:"/favorites",element:n.jsx(ht,{children:n.jsx(QZ,{})})}),n.jsx(ot,{path:"/students",element:n.jsx(ht,{allowedRoles:["teacher","school","admin"],children:n.jsx(Qg,{})})}),n.jsx(ot,{path:"/reports",element:n.jsx(ht,{allowedRoles:["teacher","school","admin"],children:n.jsx(YZ,{})})}),n.jsx(ot,{path:"/admin-dashboard",element:n.jsx(ht,{allowedRoles:["admin"],children:n.jsx(sQ,{})})}),n.jsx(ot,{path:"/admin/manage-project-ideas",element:n.jsx(ht,{allowedRoles:["admin"],children:n.jsx(lue,{})})}),n.jsx(ot,{path:"/admin/manage-videos",element:n.jsx(ht,{allowedRoles:["admin"],children:n.jsx(uue,{})})}),n.jsx(ot,{path:"/admin/summer-program-registrations",element:n.jsx(ht,{allowedRoles:["admin"],children:n.jsx(hue,{})})}),n.jsx(ot,{path:"/users",element:n.jsx(ht,{allowedRoles:["admin","school"],children:n.jsx(Qg,{})})}),n.jsx(ot,{path:"/settings",element:n.jsx(ht,{children:n.jsx(kE,{})})})]})};function gue(){const{i18n:e}=yt();return O.useEffect(()=>{document.documentElement.dir=e.language==="ar"?"rtl":"ltr",document.documentElement.lang=e.language},[e.language]),n.jsx(K6,{children:n.jsx(q6,{children:n.jsx(F3,{children:n.jsx("div",{className:"min-h-screen bg-gray-50",children:n.jsx(pue,{})})})})})}const He=e=>typeof e=="string",El=()=>{let e,t;const r=new Promise((a,s)=>{e=a,t=s});return r.resolve=e,r.reject=t,r},mj=e=>e==null?"":""+e,vue=(e,t,r)=>{e.forEach(a=>{t[a]&&(r[a]=t[a])})},yue=/###/g,xj=e=>e&&e.indexOf("###")>-1?e.replace(yue,"."):e,pj=e=>!e||He(e),tc=(e,t,r)=>{const a=He(t)?t.split("."):t;let s=0;for(;s<a.length-1;){if(pj(e))return{};const i=xj(a[s]);!e[i]&&r&&(e[i]=new r),Object.prototype.hasOwnProperty.call(e,i)?e=e[i]:e={},++s}return pj(e)?{}:{obj:e,k:xj(a[s])}},gj=(e,t,r)=>{const{obj:a,k:s}=tc(e,t,Object);if(a!==void 0||t.length===1){a[s]=r;return}let i=t[t.length-1],o=t.slice(0,t.length-1),l=tc(e,o,Object);for(;l.obj===void 0&&o.length;)i=`${o[o.length-1]}.${i}`,o=o.slice(0,o.length-1),l=tc(e,o,Object),l&&l.obj&&typeof l.obj[`${l.k}.${i}`]<"u"&&(l.obj=void 0);l.obj[`${l.k}.${i}`]=r},bue=(e,t,r,a)=>{const{obj:s,k:i}=tc(e,t,Object);s[i]=s[i]||[],s[i].push(r)},Sf=(e,t)=>{const{obj:r,k:a}=tc(e,t);if(r)return r[a]},wue=(e,t,r)=>{const a=Sf(e,r);return a!==void 0?a:Sf(t,r)},s3=(e,t,r)=>{for(const a in t)a!=="__proto__"&&a!=="constructor"&&(a in e?He(e[a])||e[a]instanceof String||He(t[a])||t[a]instanceof String?r&&(e[a]=t[a]):s3(e[a],t[a],r):e[a]=t[a]);return e},Ji=e=>e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var jue={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const Nue=e=>He(e)?e.replace(/[&<>"'\/]/g,t=>jue[t]):e;class _ue{constructor(t){this.capacity=t,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(t){const r=this.regExpMap.get(t);if(r!==void 0)return r;const a=new RegExp(t);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(t,a),this.regExpQueue.push(t),a}}const Sue=[" ",",","?","!",";"],kue=new _ue(20),Eue=(e,t,r)=>{t=t||"",r=r||"";const a=Sue.filter(o=>t.indexOf(o)<0&&r.indexOf(o)<0);if(a.length===0)return!0;const s=kue.getRegExp(`(${a.map(o=>o==="?"?"\\?":o).join("|")})`);let i=!s.test(e);if(!i){const o=e.indexOf(r);o>0&&!s.test(e.substring(0,o))&&(i=!0)}return i},Px=function(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!e)return;if(e[t])return e[t];const a=t.split(r);let s=e;for(let i=0;i<a.length;){if(!s||typeof s!="object")return;let o,l="";for(let c=i;c<a.length;++c)if(c!==i&&(l+=r),l+=a[c],o=s[l],o!==void 0){if(["string","number","boolean"].indexOf(typeof o)>-1&&c<a.length-1)continue;i+=c-i+1;break}s=o}return s},kf=e=>e&&e.replace("_","-"),Aue={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,t){console&&console[e]&&console[e].apply(console,t)}};class Ef{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(t,r)}init(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=r.prefix||"i18next:",this.logger=t||Aue,this.options=r,this.debug=r.debug}log(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return this.forward(r,"log","",!0)}warn(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return this.forward(r,"warn","",!0)}error(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return this.forward(r,"error","")}deprecate(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return this.forward(r,"warn","WARNING DEPRECATED: ",!0)}forward(t,r,a,s){return s&&!this.debug?null:(He(t[0])&&(t[0]=`${a}${this.prefix} ${t[0]}`),this.logger[r](t))}create(t){return new Ef(this.logger,{prefix:`${this.prefix}:${t}:`,...this.options})}clone(t){return t=t||this.options,t.prefix=t.prefix||this.prefix,new Ef(this.logger,t)}}var wn=new Ef;class M0{constructor(){this.observers={}}on(t,r){return t.split(" ").forEach(a=>{this.observers[a]||(this.observers[a]=new Map);const s=this.observers[a].get(r)||0;this.observers[a].set(r,s+1)}),this}off(t,r){if(this.observers[t]){if(!r){delete this.observers[t];return}this.observers[t].delete(r)}}emit(t){for(var r=arguments.length,a=new Array(r>1?r-1:0),s=1;s<r;s++)a[s-1]=arguments[s];this.observers[t]&&Array.from(this.observers[t].entries()).forEach(o=>{let[l,c]=o;for(let d=0;d<c;d++)l(...a)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(o=>{let[l,c]=o;for(let d=0;d<c;d++)l.apply(l,[t,...a])})}}class vj extends M0{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=t||{},this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}removeNamespaces(t){const r=this.options.ns.indexOf(t);r>-1&&this.options.ns.splice(r,1)}getResource(t,r,a){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const i=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator,o=s.ignoreJSONStructure!==void 0?s.ignoreJSONStructure:this.options.ignoreJSONStructure;let l;t.indexOf(".")>-1?l=t.split("."):(l=[t,r],a&&(Array.isArray(a)?l.push(...a):He(a)&&i?l.push(...a.split(i)):l.push(a)));const c=Sf(this.data,l);return!c&&!r&&!a&&t.indexOf(".")>-1&&(t=l[0],r=l[1],a=l.slice(2).join(".")),c||!o||!He(a)?c:Px(this.data&&this.data[t]&&this.data[t][r],a,i)}addResource(t,r,a,s){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1};const o=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator;let l=[t,r];a&&(l=l.concat(o?a.split(o):a)),t.indexOf(".")>-1&&(l=t.split("."),s=r,r=l[1]),this.addNamespaces(r),gj(this.data,l,s),i.silent||this.emit("added",t,r,a,s)}addResources(t,r,a){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(const i in a)(He(a[i])||Array.isArray(a[i]))&&this.addResource(t,r,i,a[i],{silent:!0});s.silent||this.emit("added",t,r,a)}addResourceBundle(t,r,a,s,i){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},l=[t,r];t.indexOf(".")>-1&&(l=t.split("."),s=a,a=r,r=l[1]),this.addNamespaces(r);let c=Sf(this.data,l)||{};o.skipCopy||(a=JSON.parse(JSON.stringify(a))),s?s3(c,a,i):c={...c,...a},gj(this.data,l,c),o.silent||this.emit("added",t,r,a)}removeResourceBundle(t,r){this.hasResourceBundle(t,r)&&delete this.data[t][r],this.removeNamespaces(r),this.emit("removed",t,r)}hasResourceBundle(t,r){return this.getResource(t,r)!==void 0}getResourceBundle(t,r){return r||(r=this.options.defaultNS),this.options.compatibilityAPI==="v1"?{...this.getResource(t,r)}:this.getResource(t,r)}getDataByLanguage(t){return this.data[t]}hasLanguageSomeTranslations(t){const r=this.getDataByLanguage(t);return!!(r&&Object.keys(r)||[]).find(s=>r[s]&&Object.keys(r[s]).length>0)}toJSON(){return this.data}}var i3={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,t,r,a,s){return e.forEach(i=>{this.processors[i]&&(t=this.processors[i].process(t,r,a,s))}),t}};const yj={};class Af extends M0{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),vue(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,this),this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=wn.create("translator")}changeLanguage(t){t&&(this.language=t)}exists(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(t==null)return!1;const a=this.resolve(t,r);return a&&a.res!==void 0}extractFromKey(t,r){let a=r.nsSeparator!==void 0?r.nsSeparator:this.options.nsSeparator;a===void 0&&(a=":");const s=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator;let i=r.ns||this.options.defaultNS||[];const o=a&&t.indexOf(a)>-1,l=!this.options.userDefinedKeySeparator&&!r.keySeparator&&!this.options.userDefinedNsSeparator&&!r.nsSeparator&&!Eue(t,a,s);if(o&&!l){const c=t.match(this.interpolator.nestingRegexp);if(c&&c.length>0)return{key:t,namespaces:He(i)?[i]:i};const d=t.split(a);(a!==s||a===s&&this.options.ns.indexOf(d[0])>-1)&&(i=d.shift()),t=d.join(s)}return{key:t,namespaces:He(i)?[i]:i}}translate(t,r,a){if(typeof r!="object"&&this.options.overloadTranslationOptionHandler&&(r=this.options.overloadTranslationOptionHandler(arguments)),typeof r=="object"&&(r={...r}),r||(r={}),t==null)return"";Array.isArray(t)||(t=[String(t)]);const s=r.returnDetails!==void 0?r.returnDetails:this.options.returnDetails,i=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator,{key:o,namespaces:l}=this.extractFromKey(t[t.length-1],r),c=l[l.length-1],d=r.lng||this.language,u=r.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(d&&d.toLowerCase()==="cimode"){if(u){const _=r.nsSeparator||this.options.nsSeparator;return s?{res:`${c}${_}${o}`,usedKey:o,exactUsedKey:o,usedLng:d,usedNS:c,usedParams:this.getUsedParamsDetails(r)}:`${c}${_}${o}`}return s?{res:o,usedKey:o,exactUsedKey:o,usedLng:d,usedNS:c,usedParams:this.getUsedParamsDetails(r)}:o}const f=this.resolve(t,r);let h=f&&f.res;const m=f&&f.usedKey||o,x=f&&f.exactUsedKey||o,p=Object.prototype.toString.apply(h),g=["[object Number]","[object Function]","[object RegExp]"],y=r.joinArrays!==void 0?r.joinArrays:this.options.joinArrays,w=!this.i18nFormat||this.i18nFormat.handleAsObject,v=!He(h)&&typeof h!="boolean"&&typeof h!="number";if(w&&h&&v&&g.indexOf(p)<0&&!(He(y)&&Array.isArray(h))){if(!r.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const _=this.options.returnedObjectHandler?this.options.returnedObjectHandler(m,h,{...r,ns:l}):`key '${o} (${this.language})' returned an object instead of string.`;return s?(f.res=_,f.usedParams=this.getUsedParamsDetails(r),f):_}if(i){const _=Array.isArray(h),b=_?[]:{},j=_?x:m;for(const N in h)if(Object.prototype.hasOwnProperty.call(h,N)){const k=`${j}${i}${N}`;b[N]=this.translate(k,{...r,joinArrays:!1,ns:l}),b[N]===k&&(b[N]=h[N])}h=b}}else if(w&&He(y)&&Array.isArray(h))h=h.join(y),h&&(h=this.extendTranslation(h,t,r,a));else{let _=!1,b=!1;const j=r.count!==void 0&&!He(r.count),N=Af.hasDefaultValue(r),k=j?this.pluralResolver.getSuffix(d,r.count,r):"",S=r.ordinal&&j?this.pluralResolver.getSuffix(d,r.count,{ordinal:!1}):"",E=j&&!r.ordinal&&r.count===0&&this.pluralResolver.shouldUseIntlApi(),P=E&&r[`defaultValue${this.options.pluralSeparator}zero`]||r[`defaultValue${k}`]||r[`defaultValue${S}`]||r.defaultValue;!this.isValidLookup(h)&&N&&(_=!0,h=P),this.isValidLookup(h)||(b=!0,h=o);const T=(r.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&b?void 0:h,M=N&&P!==h&&this.options.updateMissing;if(b||_||M){if(this.logger.log(M?"updateKey":"missingKey",d,c,o,M?P:h),i){const V=this.resolve(o,{...r,keySeparator:!1});V&&V.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let A=[];const F=this.languageUtils.getFallbackCodes(this.options.fallbackLng,r.lng||this.language);if(this.options.saveMissingTo==="fallback"&&F&&F[0])for(let V=0;V<F.length;V++)A.push(F[V]);else this.options.saveMissingTo==="all"?A=this.languageUtils.toResolveHierarchy(r.lng||this.language):A.push(r.lng||this.language);const H=(V,B,L)=>{const ee=N&&L!==h?L:T;this.options.missingKeyHandler?this.options.missingKeyHandler(V,c,B,ee,M,r):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(V,c,B,ee,M,r),this.emit("missingKey",V,c,B,h)};this.options.saveMissing&&(this.options.saveMissingPlurals&&j?A.forEach(V=>{const B=this.pluralResolver.getSuffixes(V,r);E&&r[`defaultValue${this.options.pluralSeparator}zero`]&&B.indexOf(`${this.options.pluralSeparator}zero`)<0&&B.push(`${this.options.pluralSeparator}zero`),B.forEach(L=>{H([V],o+L,r[`defaultValue${L}`]||P)})}):H(A,o,P))}h=this.extendTranslation(h,t,r,f,a),b&&h===o&&this.options.appendNamespaceToMissingKey&&(h=`${c}:${o}`),(b||_)&&this.options.parseMissingKeyHandler&&(this.options.compatibilityAPI!=="v1"?h=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${c}:${o}`:o,_?h:void 0):h=this.options.parseMissingKeyHandler(h))}return s?(f.res=h,f.usedParams=this.getUsedParamsDetails(r),f):h}extendTranslation(t,r,a,s,i){var o=this;if(this.i18nFormat&&this.i18nFormat.parse)t=this.i18nFormat.parse(t,{...this.options.interpolation.defaultVariables,...a},a.lng||this.language||s.usedLng,s.usedNS,s.usedKey,{resolved:s});else if(!a.skipInterpolation){a.interpolation&&this.interpolator.init({...a,interpolation:{...this.options.interpolation,...a.interpolation}});const d=He(t)&&(a&&a.interpolation&&a.interpolation.skipOnVariables!==void 0?a.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let u;if(d){const h=t.match(this.interpolator.nestingRegexp);u=h&&h.length}let f=a.replace&&!He(a.replace)?a.replace:a;if(this.options.interpolation.defaultVariables&&(f={...this.options.interpolation.defaultVariables,...f}),t=this.interpolator.interpolate(t,f,a.lng||this.language||s.usedLng,a),d){const h=t.match(this.interpolator.nestingRegexp),m=h&&h.length;u<m&&(a.nest=!1)}!a.lng&&this.options.compatibilityAPI!=="v1"&&s&&s.res&&(a.lng=this.language||s.usedLng),a.nest!==!1&&(t=this.interpolator.nest(t,function(){for(var h=arguments.length,m=new Array(h),x=0;x<h;x++)m[x]=arguments[x];return i&&i[0]===m[0]&&!a.context?(o.logger.warn(`It seems you are nesting recursively key: ${m[0]} in key: ${r[0]}`),null):o.translate(...m,r)},a)),a.interpolation&&this.interpolator.reset()}const l=a.postProcess||this.options.postProcess,c=He(l)?[l]:l;return t!=null&&c&&c.length&&a.applyPostProcessor!==!1&&(t=i3.handle(c,t,r,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...s,usedParams:this.getUsedParamsDetails(a)},...a}:a,this)),t}resolve(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a,s,i,o,l;return He(t)&&(t=[t]),t.forEach(c=>{if(this.isValidLookup(a))return;const d=this.extractFromKey(c,r),u=d.key;s=u;let f=d.namespaces;this.options.fallbackNS&&(f=f.concat(this.options.fallbackNS));const h=r.count!==void 0&&!He(r.count),m=h&&!r.ordinal&&r.count===0&&this.pluralResolver.shouldUseIntlApi(),x=r.context!==void 0&&(He(r.context)||typeof r.context=="number")&&r.context!=="",p=r.lngs?r.lngs:this.languageUtils.toResolveHierarchy(r.lng||this.language,r.fallbackLng);f.forEach(g=>{this.isValidLookup(a)||(l=g,!yj[`${p[0]}-${g}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(l)&&(yj[`${p[0]}-${g}`]=!0,this.logger.warn(`key "${s}" for languages "${p.join(", ")}" won't get resolved as namespace "${l}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),p.forEach(y=>{if(this.isValidLookup(a))return;o=y;const w=[u];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(w,u,y,g,r);else{let _;h&&(_=this.pluralResolver.getSuffix(y,r.count,r));const b=`${this.options.pluralSeparator}zero`,j=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(h&&(w.push(u+_),r.ordinal&&_.indexOf(j)===0&&w.push(u+_.replace(j,this.options.pluralSeparator)),m&&w.push(u+b)),x){const N=`${u}${this.options.contextSeparator}${r.context}`;w.push(N),h&&(w.push(N+_),r.ordinal&&_.indexOf(j)===0&&w.push(N+_.replace(j,this.options.pluralSeparator)),m&&w.push(N+b))}}let v;for(;v=w.pop();)this.isValidLookup(a)||(i=v,a=this.getResource(y,g,v,r))}))})}),{res:a,usedKey:s,exactUsedKey:i,usedLng:o,usedNS:l}}isValidLookup(t){return t!==void 0&&!(!this.options.returnNull&&t===null)&&!(!this.options.returnEmptyString&&t==="")}getResource(t,r,a){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(t,r,a,s):this.resourceStore.getResource(t,r,a,s)}getUsedParamsDetails(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],a=t.replace&&!He(t.replace);let s=a?t.replace:t;if(a&&typeof t.count<"u"&&(s.count=t.count),this.options.interpolation.defaultVariables&&(s={...this.options.interpolation.defaultVariables,...s}),!a){s={...s};for(const i of r)delete s[i]}return s}static hasDefaultValue(t){const r="defaultValue";for(const a in t)if(Object.prototype.hasOwnProperty.call(t,a)&&r===a.substring(0,r.length)&&t[a]!==void 0)return!0;return!1}}const Fh=e=>e.charAt(0).toUpperCase()+e.slice(1);class bj{constructor(t){this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=wn.create("languageUtils")}getScriptPartFromCode(t){if(t=kf(t),!t||t.indexOf("-")<0)return null;const r=t.split("-");return r.length===2||(r.pop(),r[r.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(r.join("-"))}getLanguagePartFromCode(t){if(t=kf(t),!t||t.indexOf("-")<0)return t;const r=t.split("-");return this.formatLanguageCode(r[0])}formatLanguageCode(t){if(He(t)&&t.indexOf("-")>-1){if(typeof Intl<"u"&&typeof Intl.getCanonicalLocales<"u")try{let s=Intl.getCanonicalLocales(t)[0];if(s&&this.options.lowerCaseLng&&(s=s.toLowerCase()),s)return s}catch{}const r=["hans","hant","latn","cyrl","cans","mong","arab"];let a=t.split("-");return this.options.lowerCaseLng?a=a.map(s=>s.toLowerCase()):a.length===2?(a[0]=a[0].toLowerCase(),a[1]=a[1].toUpperCase(),r.indexOf(a[1].toLowerCase())>-1&&(a[1]=Fh(a[1].toLowerCase()))):a.length===3&&(a[0]=a[0].toLowerCase(),a[1].length===2&&(a[1]=a[1].toUpperCase()),a[0]!=="sgn"&&a[2].length===2&&(a[2]=a[2].toUpperCase()),r.indexOf(a[1].toLowerCase())>-1&&(a[1]=Fh(a[1].toLowerCase())),r.indexOf(a[2].toLowerCase())>-1&&(a[2]=Fh(a[2].toLowerCase()))),a.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}isSupportedCode(t){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}getBestMatchFromCodes(t){if(!t)return null;let r;return t.forEach(a=>{if(r)return;const s=this.formatLanguageCode(a);(!this.options.supportedLngs||this.isSupportedCode(s))&&(r=s)}),!r&&this.options.supportedLngs&&t.forEach(a=>{if(r)return;const s=this.getLanguagePartFromCode(a);if(this.isSupportedCode(s))return r=s;r=this.options.supportedLngs.find(i=>{if(i===s)return i;if(!(i.indexOf("-")<0&&s.indexOf("-")<0)&&(i.indexOf("-")>0&&s.indexOf("-")<0&&i.substring(0,i.indexOf("-"))===s||i.indexOf(s)===0&&s.length>1))return i})}),r||(r=this.getFallbackCodes(this.options.fallbackLng)[0]),r}getFallbackCodes(t,r){if(!t)return[];if(typeof t=="function"&&(t=t(r)),He(t)&&(t=[t]),Array.isArray(t))return t;if(!r)return t.default||[];let a=t[r];return a||(a=t[this.getScriptPartFromCode(r)]),a||(a=t[this.formatLanguageCode(r)]),a||(a=t[this.getLanguagePartFromCode(r)]),a||(a=t.default),a||[]}toResolveHierarchy(t,r){const a=this.getFallbackCodes(r||this.options.fallbackLng||[],t),s=[],i=o=>{o&&(this.isSupportedCode(o)?s.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return He(t)&&(t.indexOf("-")>-1||t.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&i(this.formatLanguageCode(t)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&i(this.getScriptPartFromCode(t)),this.options.load!=="currentOnly"&&i(this.getLanguagePartFromCode(t))):He(t)&&i(this.formatLanguageCode(t)),a.forEach(o=>{s.indexOf(o)<0&&i(this.formatLanguageCode(o))}),s}}let Tue=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],Oue={1:e=>+(e>1),2:e=>+(e!=1),3:e=>0,4:e=>e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2,5:e=>e==0?0:e==1?1:e==2?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5,6:e=>e==1?0:e>=2&&e<=4?1:2,7:e=>e==1?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2,8:e=>e==1?0:e==2?1:e!=8&&e!=11?2:3,9:e=>+(e>=2),10:e=>e==1?0:e==2?1:e<7?2:e<11?3:4,11:e=>e==1||e==11?0:e==2||e==12?1:e>2&&e<20?2:3,12:e=>+(e%10!=1||e%100==11),13:e=>+(e!==0),14:e=>e==1?0:e==2?1:e==3?2:3,15:e=>e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2,16:e=>e%10==1&&e%100!=11?0:e!==0?1:2,17:e=>e==1||e%10==1&&e%100!=11?0:1,18:e=>e==0?0:e==1?1:2,19:e=>e==1?0:e==0||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3,20:e=>e==1?0:e==0||e%100>0&&e%100<20?1:2,21:e=>e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0,22:e=>e==1?0:e==2?1:(e<0||e>10)&&e%10==0?2:3};const Pue=["v1","v2","v3"],Cue=["v4"],wj={zero:0,one:1,two:2,few:3,many:4,other:5},Fue=()=>{const e={};return Tue.forEach(t=>{t.lngs.forEach(r=>{e[r]={numbers:t.nr,plurals:Oue[t.fc]}})}),e};class Iue{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=t,this.options=r,this.logger=wn.create("pluralResolver"),(!this.options.compatibilityJSON||Cue.includes(this.options.compatibilityJSON))&&(typeof Intl>"u"||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=Fue(),this.pluralRulesCache={}}addRule(t,r){this.rules[t]=r}clearCache(){this.pluralRulesCache={}}getRule(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.shouldUseIntlApi()){const a=kf(t==="dev"?"en":t),s=r.ordinal?"ordinal":"cardinal",i=JSON.stringify({cleanedCode:a,type:s});if(i in this.pluralRulesCache)return this.pluralRulesCache[i];let o;try{o=new Intl.PluralRules(a,{type:s})}catch{if(!t.match(/-|_/))return;const c=this.languageUtils.getLanguagePartFromCode(t);o=this.getRule(c,r)}return this.pluralRulesCache[i]=o,o}return this.rules[t]||this.rules[this.languageUtils.getLanguagePartFromCode(t)]}needsPlural(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const a=this.getRule(t,r);return this.shouldUseIntlApi()?a&&a.resolvedOptions().pluralCategories.length>1:a&&a.numbers.length>1}getPluralFormsOfKey(t,r){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(t,a).map(s=>`${r}${s}`)}getSuffixes(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const a=this.getRule(t,r);return a?this.shouldUseIntlApi()?a.resolvedOptions().pluralCategories.sort((s,i)=>wj[s]-wj[i]).map(s=>`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${s}`):a.numbers.map(s=>this.getSuffix(t,s,r)):[]}getSuffix(t,r){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=this.getRule(t,a);return s?this.shouldUseIntlApi()?`${this.options.prepend}${a.ordinal?`ordinal${this.options.prepend}`:""}${s.select(r)}`:this.getSuffixRetroCompatible(s,r):(this.logger.warn(`no plural rule found for: ${t}`),"")}getSuffixRetroCompatible(t,r){const a=t.noAbs?t.plurals(r):t.plurals(Math.abs(r));let s=t.numbers[a];this.options.simplifyPluralSuffix&&t.numbers.length===2&&t.numbers[0]===1&&(s===2?s="plural":s===1&&(s=""));const i=()=>this.options.prepend&&s.toString()?this.options.prepend+s.toString():s.toString();return this.options.compatibilityJSON==="v1"?s===1?"":typeof s=="number"?`_plural_${s.toString()}`:i():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&t.numbers.length===2&&t.numbers[0]===1?i():this.options.prepend&&a.toString()?this.options.prepend+a.toString():a.toString()}shouldUseIntlApi(){return!Pue.includes(this.options.compatibilityJSON)}}const jj=function(e,t,r){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,i=wue(e,t,r);return!i&&s&&He(r)&&(i=Px(e,r,a),i===void 0&&(i=Px(t,r,a))),i},Ih=e=>e.replace(/\$/g,"$$$$");class Due{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=wn.create("interpolator"),this.options=t,this.format=t.interpolation&&t.interpolation.format||(r=>r),this.init(t)}init(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};t.interpolation||(t.interpolation={escapeValue:!0});const{escape:r,escapeValue:a,useRawValueToEscape:s,prefix:i,prefixEscaped:o,suffix:l,suffixEscaped:c,formatSeparator:d,unescapeSuffix:u,unescapePrefix:f,nestingPrefix:h,nestingPrefixEscaped:m,nestingSuffix:x,nestingSuffixEscaped:p,nestingOptionsSeparator:g,maxReplaces:y,alwaysFormat:w}=t.interpolation;this.escape=r!==void 0?r:Nue,this.escapeValue=a!==void 0?a:!0,this.useRawValueToEscape=s!==void 0?s:!1,this.prefix=i?Ji(i):o||"{{",this.suffix=l?Ji(l):c||"}}",this.formatSeparator=d||",",this.unescapePrefix=u?"":f||"-",this.unescapeSuffix=this.unescapePrefix?"":u||"",this.nestingPrefix=h?Ji(h):m||Ji("$t("),this.nestingSuffix=x?Ji(x):p||Ji(")"),this.nestingOptionsSeparator=g||",",this.maxReplaces=y||1e3,this.alwaysFormat=w!==void 0?w:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const t=(r,a)=>r&&r.source===a?(r.lastIndex=0,r):new RegExp(a,"g");this.regexp=t(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=t(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=t(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(t,r,a,s){let i,o,l;const c=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},d=m=>{if(m.indexOf(this.formatSeparator)<0){const y=jj(r,c,m,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(y,void 0,a,{...s,...r,interpolationkey:m}):y}const x=m.split(this.formatSeparator),p=x.shift().trim(),g=x.join(this.formatSeparator).trim();return this.format(jj(r,c,p,this.options.keySeparator,this.options.ignoreJSONStructure),g,a,{...s,...r,interpolationkey:p})};this.resetRegExp();const u=s&&s.missingInterpolationHandler||this.options.missingInterpolationHandler,f=s&&s.interpolation&&s.interpolation.skipOnVariables!==void 0?s.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:m=>Ih(m)},{regex:this.regexp,safeValue:m=>this.escapeValue?Ih(this.escape(m)):Ih(m)}].forEach(m=>{for(l=0;i=m.regex.exec(t);){const x=i[1].trim();if(o=d(x),o===void 0)if(typeof u=="function"){const g=u(t,i,s);o=He(g)?g:""}else if(s&&Object.prototype.hasOwnProperty.call(s,x))o="";else if(f){o=i[0];continue}else this.logger.warn(`missed to pass in variable ${x} for interpolating ${t}`),o="";else!He(o)&&!this.useRawValueToEscape&&(o=mj(o));const p=m.safeValue(o);if(t=t.replace(i[0],p),f?(m.regex.lastIndex+=o.length,m.regex.lastIndex-=i[0].length):m.regex.lastIndex=0,l++,l>=this.maxReplaces)break}}),t}nest(t,r){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s,i,o;const l=(c,d)=>{const u=this.nestingOptionsSeparator;if(c.indexOf(u)<0)return c;const f=c.split(new RegExp(`${u}[ ]*{`));let h=`{${f[1]}`;c=f[0],h=this.interpolate(h,o);const m=h.match(/'/g),x=h.match(/"/g);(m&&m.length%2===0&&!x||x.length%2!==0)&&(h=h.replace(/'/g,'"'));try{o=JSON.parse(h),d&&(o={...d,...o})}catch(p){return this.logger.warn(`failed parsing options string in nesting for key ${c}`,p),`${c}${u}${h}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,c};for(;s=this.nestingRegexp.exec(t);){let c=[];o={...a},o=o.replace&&!He(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;let d=!1;if(s[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(s[1])){const u=s[1].split(this.formatSeparator).map(f=>f.trim());s[1]=u.shift(),c=u,d=!0}if(i=r(l.call(this,s[1].trim(),o),o),i&&s[0]===t&&!He(i))return i;He(i)||(i=mj(i)),i||(this.logger.warn(`missed to resolve ${s[1]} for nesting ${t}`),i=""),d&&(i=c.reduce((u,f)=>this.format(u,f,a.lng,{...a,interpolationkey:s[1].trim()}),i.trim())),t=t.replace(s[0],i),this.regexp.lastIndex=0}return t}}const Rue=e=>{let t=e.toLowerCase().trim();const r={};if(e.indexOf("(")>-1){const a=e.split("(");t=a[0].toLowerCase().trim();const s=a[1].substring(0,a[1].length-1);t==="currency"&&s.indexOf(":")<0?r.currency||(r.currency=s.trim()):t==="relativetime"&&s.indexOf(":")<0?r.range||(r.range=s.trim()):s.split(";").forEach(o=>{if(o){const[l,...c]=o.split(":"),d=c.join(":").trim().replace(/^'+|'+$/g,""),u=l.trim();r[u]||(r[u]=d),d==="false"&&(r[u]=!1),d==="true"&&(r[u]=!0),isNaN(d)||(r[u]=parseInt(d,10))}})}return{formatName:t,formatOptions:r}},Zi=e=>{const t={};return(r,a,s)=>{let i=s;s&&s.interpolationkey&&s.formatParams&&s.formatParams[s.interpolationkey]&&s[s.interpolationkey]&&(i={...i,[s.interpolationkey]:void 0});const o=a+JSON.stringify(i);let l=t[o];return l||(l=e(kf(a),s),t[o]=l),l(r)}};class Mue{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=wn.create("formatter"),this.options=t,this.formats={number:Zi((r,a)=>{const s=new Intl.NumberFormat(r,{...a});return i=>s.format(i)}),currency:Zi((r,a)=>{const s=new Intl.NumberFormat(r,{...a,style:"currency"});return i=>s.format(i)}),datetime:Zi((r,a)=>{const s=new Intl.DateTimeFormat(r,{...a});return i=>s.format(i)}),relativetime:Zi((r,a)=>{const s=new Intl.RelativeTimeFormat(r,{...a});return i=>s.format(i,a.range||"day")}),list:Zi((r,a)=>{const s=new Intl.ListFormat(r,{...a});return i=>s.format(i)})},this.init(t)}init(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};this.formatSeparator=r.interpolation.formatSeparator||","}add(t,r){this.formats[t.toLowerCase().trim()]=r}addCached(t,r){this.formats[t.toLowerCase().trim()]=Zi(r)}format(t,r,a){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const i=r.split(this.formatSeparator);if(i.length>1&&i[0].indexOf("(")>1&&i[0].indexOf(")")<0&&i.find(l=>l.indexOf(")")>-1)){const l=i.findIndex(c=>c.indexOf(")")>-1);i[0]=[i[0],...i.splice(1,l)].join(this.formatSeparator)}return i.reduce((l,c)=>{const{formatName:d,formatOptions:u}=Rue(c);if(this.formats[d]){let f=l;try{const h=s&&s.formatParams&&s.formatParams[s.interpolationkey]||{},m=h.locale||h.lng||s.locale||s.lng||a;f=this.formats[d](l,m,{...u,...s,...h})}catch(h){this.logger.warn(h)}return f}else this.logger.warn(`there was no format function for ${d}`);return l},t)}}const $ue=(e,t)=>{e.pending[t]!==void 0&&(delete e.pending[t],e.pendingCount--)};class Lue extends M0{constructor(t,r,a){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=t,this.store=r,this.services=a,this.languageUtils=a.languageUtils,this.options=s,this.logger=wn.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=s.maxParallelReads||10,this.readingCalls=0,this.maxRetries=s.maxRetries>=0?s.maxRetries:5,this.retryTimeout=s.retryTimeout>=1?s.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(a,s.backend,s)}queueLoad(t,r,a,s){const i={},o={},l={},c={};return t.forEach(d=>{let u=!0;r.forEach(f=>{const h=`${d}|${f}`;!a.reload&&this.store.hasResourceBundle(d,f)?this.state[h]=2:this.state[h]<0||(this.state[h]===1?o[h]===void 0&&(o[h]=!0):(this.state[h]=1,u=!1,o[h]===void 0&&(o[h]=!0),i[h]===void 0&&(i[h]=!0),c[f]===void 0&&(c[f]=!0)))}),u||(l[d]=!0)}),(Object.keys(i).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:s}),{toLoad:Object.keys(i),pending:Object.keys(o),toLoadLanguages:Object.keys(l),toLoadNamespaces:Object.keys(c)}}loaded(t,r,a){const s=t.split("|"),i=s[0],o=s[1];r&&this.emit("failedLoading",i,o,r),!r&&a&&this.store.addResourceBundle(i,o,a,void 0,void 0,{skipCopy:!0}),this.state[t]=r?-1:2,r&&a&&(this.state[t]=0);const l={};this.queue.forEach(c=>{bue(c.loaded,[i],o),$ue(c,t),r&&c.errors.push(r),c.pendingCount===0&&!c.done&&(Object.keys(c.loaded).forEach(d=>{l[d]||(l[d]={});const u=c.loaded[d];u.length&&u.forEach(f=>{l[d][f]===void 0&&(l[d][f]=!0)})}),c.done=!0,c.errors.length?c.callback(c.errors):c.callback())}),this.emit("loaded",l),this.queue=this.queue.filter(c=>!c.done)}read(t,r,a){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,o=arguments.length>5?arguments[5]:void 0;if(!t.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:t,ns:r,fcName:a,tried:s,wait:i,callback:o});return}this.readingCalls++;const l=(d,u)=>{if(this.readingCalls--,this.waitingReads.length>0){const f=this.waitingReads.shift();this.read(f.lng,f.ns,f.fcName,f.tried,f.wait,f.callback)}if(d&&u&&s<this.maxRetries){setTimeout(()=>{this.read.call(this,t,r,a,s+1,i*2,o)},i);return}o(d,u)},c=this.backend[a].bind(this.backend);if(c.length===2){try{const d=c(t,r);d&&typeof d.then=="function"?d.then(u=>l(null,u)).catch(l):l(null,d)}catch(d){l(d)}return}return c(t,r,l)}prepareLoading(t,r){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),s&&s();He(t)&&(t=this.languageUtils.toResolveHierarchy(t)),He(r)&&(r=[r]);const i=this.queueLoad(t,r,a,s);if(!i.toLoad.length)return i.pending.length||s(),null;i.toLoad.forEach(o=>{this.loadOne(o)})}load(t,r,a){this.prepareLoading(t,r,{},a)}reload(t,r,a){this.prepareLoading(t,r,{reload:!0},a)}loadOne(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const a=t.split("|"),s=a[0],i=a[1];this.read(s,i,"read",void 0,void 0,(o,l)=>{o&&this.logger.warn(`${r}loading namespace ${i} for language ${s} failed`,o),!o&&l&&this.logger.log(`${r}loaded namespace ${i} for language ${s}`,l),this.loaded(t,o,l)})}saveMissing(t,r,a,s,i){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(r)){this.logger.warn(`did not save key "${a}" as the namespace "${r}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(a==null||a==="")){if(this.backend&&this.backend.create){const c={...o,isUpdate:i},d=this.backend.create.bind(this.backend);if(d.length<6)try{let u;d.length===5?u=d(t,r,a,s,c):u=d(t,r,a,s),u&&typeof u.then=="function"?u.then(f=>l(null,f)).catch(l):l(null,u)}catch(u){l(u)}else d(t,r,a,s,l,c)}!t||!t[0]||this.store.addResource(t[0],r,a,s)}}}const Nj=()=>({debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:e=>{let t={};if(typeof e[1]=="object"&&(t=e[1]),He(e[1])&&(t.defaultValue=e[1]),He(e[2])&&(t.tDescription=e[2]),typeof e[2]=="object"||typeof e[3]=="object"){const r=e[3]||e[2];Object.keys(r).forEach(a=>{t[a]=r[a]})}return t},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),_j=e=>(He(e.ns)&&(e.ns=[e.ns]),He(e.fallbackLng)&&(e.fallbackLng=[e.fallbackLng]),He(e.fallbackNS)&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs&&e.supportedLngs.indexOf("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),e),tu=()=>{},Bue=e=>{Object.getOwnPropertyNames(Object.getPrototypeOf(e)).forEach(r=>{typeof e[r]=="function"&&(e[r]=e[r].bind(e))})};class nd extends M0{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;if(super(),this.options=_j(t),this.services={},this.logger=wn,this.modules={external:[]},Bue(this),r&&!this.isInitialized&&!t.isClone){if(!this.options.initImmediate)return this.init(t,r),this;setTimeout(()=>{this.init(t,r)},0)}}init(){var t=this;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,typeof r=="function"&&(a=r,r={}),!r.defaultNS&&r.defaultNS!==!1&&r.ns&&(He(r.ns)?r.defaultNS=r.ns:r.ns.indexOf("translation")<0&&(r.defaultNS=r.ns[0]));const s=Nj();this.options={...s,...this.options,..._j(r)},this.options.compatibilityAPI!=="v1"&&(this.options.interpolation={...s.interpolation,...this.options.interpolation}),r.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=r.keySeparator),r.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=r.nsSeparator);const i=u=>u?typeof u=="function"?new u:u:null;if(!this.options.isClone){this.modules.logger?wn.init(i(this.modules.logger),this.options):wn.init(null,this.options);let u;this.modules.formatter?u=this.modules.formatter:typeof Intl<"u"&&(u=Mue);const f=new bj(this.options);this.store=new vj(this.options.resources,this.options);const h=this.services;h.logger=wn,h.resourceStore=this.store,h.languageUtils=f,h.pluralResolver=new Iue(f,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),u&&(!this.options.interpolation.format||this.options.interpolation.format===s.interpolation.format)&&(h.formatter=i(u),h.formatter.init(h,this.options),this.options.interpolation.format=h.formatter.format.bind(h.formatter)),h.interpolator=new Due(this.options),h.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},h.backendConnector=new Lue(i(this.modules.backend),h.resourceStore,h,this.options),h.backendConnector.on("*",function(m){for(var x=arguments.length,p=new Array(x>1?x-1:0),g=1;g<x;g++)p[g-1]=arguments[g];t.emit(m,...p)}),this.modules.languageDetector&&(h.languageDetector=i(this.modules.languageDetector),h.languageDetector.init&&h.languageDetector.init(h,this.options.detection,this.options)),this.modules.i18nFormat&&(h.i18nFormat=i(this.modules.i18nFormat),h.i18nFormat.init&&h.i18nFormat.init(this)),this.translator=new Af(this.services,this.options),this.translator.on("*",function(m){for(var x=arguments.length,p=new Array(x>1?x-1:0),g=1;g<x;g++)p[g-1]=arguments[g];t.emit(m,...p)}),this.modules.external.forEach(m=>{m.init&&m.init(this)})}if(this.format=this.options.interpolation.format,a||(a=tu),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const u=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);u.length>0&&u[0]!=="dev"&&(this.options.lng=u[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(u=>{this[u]=function(){return t.store[u](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(u=>{this[u]=function(){return t.store[u](...arguments),t}});const c=El(),d=()=>{const u=(f,h)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),c.resolve(h),a(f,h)};if(this.languages&&this.options.compatibilityAPI!=="v1"&&!this.isInitialized)return u(null,this.t.bind(this));this.changeLanguage(this.options.lng,u)};return this.options.resources||!this.options.initImmediate?d():setTimeout(d,0),c}loadResources(t){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:tu;const s=He(t)?t:this.language;if(typeof t=="function"&&(a=t),!this.options.resources||this.options.partialBundledLanguages){if(s&&s.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return a();const i=[],o=l=>{if(!l||l==="cimode")return;this.services.languageUtils.toResolveHierarchy(l).forEach(d=>{d!=="cimode"&&i.indexOf(d)<0&&i.push(d)})};s?o(s):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(c=>o(c)),this.options.preload&&this.options.preload.forEach(l=>o(l)),this.services.backendConnector.load(i,this.options.ns,l=>{!l&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),a(l)})}else a(null)}reloadResources(t,r,a){const s=El();return typeof t=="function"&&(a=t,t=void 0),typeof r=="function"&&(a=r,r=void 0),t||(t=this.languages),r||(r=this.options.ns),a||(a=tu),this.services.backendConnector.reload(t,r,i=>{s.resolve(),a(i)}),s}use(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return t.type==="backend"&&(this.modules.backend=t),(t.type==="logger"||t.log&&t.warn&&t.error)&&(this.modules.logger=t),t.type==="languageDetector"&&(this.modules.languageDetector=t),t.type==="i18nFormat"&&(this.modules.i18nFormat=t),t.type==="postProcessor"&&i3.addPostProcessor(t),t.type==="formatter"&&(this.modules.formatter=t),t.type==="3rdParty"&&this.modules.external.push(t),this}setResolvedLanguage(t){if(!(!t||!this.languages)&&!(["cimode","dev"].indexOf(t)>-1))for(let r=0;r<this.languages.length;r++){const a=this.languages[r];if(!(["cimode","dev"].indexOf(a)>-1)&&this.store.hasLanguageSomeTranslations(a)){this.resolvedLanguage=a;break}}}changeLanguage(t,r){var a=this;this.isLanguageChangingTo=t;const s=El();this.emit("languageChanging",t);const i=c=>{this.language=c,this.languages=this.services.languageUtils.toResolveHierarchy(c),this.resolvedLanguage=void 0,this.setResolvedLanguage(c)},o=(c,d)=>{d?(i(d),this.translator.changeLanguage(d),this.isLanguageChangingTo=void 0,this.emit("languageChanged",d),this.logger.log("languageChanged",d)):this.isLanguageChangingTo=void 0,s.resolve(function(){return a.t(...arguments)}),r&&r(c,function(){return a.t(...arguments)})},l=c=>{!t&&!c&&this.services.languageDetector&&(c=[]);const d=He(c)?c:this.services.languageUtils.getBestMatchFromCodes(c);d&&(this.language||i(d),this.translator.language||this.translator.changeLanguage(d),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(d)),this.loadResources(d,u=>{o(u,d)})};return!t&&this.services.languageDetector&&!this.services.languageDetector.async?l(this.services.languageDetector.detect()):!t&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(l):this.services.languageDetector.detect(l):l(t),s}getFixedT(t,r,a){var s=this;const i=function(o,l){let c;if(typeof l!="object"){for(var d=arguments.length,u=new Array(d>2?d-2:0),f=2;f<d;f++)u[f-2]=arguments[f];c=s.options.overloadTranslationOptionHandler([o,l].concat(u))}else c={...l};c.lng=c.lng||i.lng,c.lngs=c.lngs||i.lngs,c.ns=c.ns||i.ns,c.keyPrefix!==""&&(c.keyPrefix=c.keyPrefix||a||i.keyPrefix);const h=s.options.keySeparator||".";let m;return c.keyPrefix&&Array.isArray(o)?m=o.map(x=>`${c.keyPrefix}${h}${x}`):m=c.keyPrefix?`${c.keyPrefix}${h}${o}`:o,s.t(m,c)};return He(t)?i.lng=t:i.lngs=t,i.ns=r,i.keyPrefix=a,i}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(t){this.options.defaultNS=t}hasLoadedNamespace(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const a=r.lng||this.resolvedLanguage||this.languages[0],s=this.options?this.options.fallbackLng:!1,i=this.languages[this.languages.length-1];if(a.toLowerCase()==="cimode")return!0;const o=(l,c)=>{const d=this.services.backendConnector.state[`${l}|${c}`];return d===-1||d===0||d===2};if(r.precheck){const l=r.precheck(this,o);if(l!==void 0)return l}return!!(this.hasResourceBundle(a,t)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(a,t)&&(!s||o(i,t)))}loadNamespaces(t,r){const a=El();return this.options.ns?(He(t)&&(t=[t]),t.forEach(s=>{this.options.ns.indexOf(s)<0&&this.options.ns.push(s)}),this.loadResources(s=>{a.resolve(),r&&r(s)}),a):(r&&r(),Promise.resolve())}loadLanguages(t,r){const a=El();He(t)&&(t=[t]);const s=this.options.preload||[],i=t.filter(o=>s.indexOf(o)<0&&this.services.languageUtils.isSupportedCode(o));return i.length?(this.options.preload=s.concat(i),this.loadResources(o=>{a.resolve(),r&&r(o)}),a):(r&&r(),Promise.resolve())}dir(t){if(t||(t=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!t)return"rtl";const r=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],a=this.services&&this.services.languageUtils||new bj(Nj());return r.indexOf(a.getLanguagePartFromCode(t))>-1||t.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;return new nd(t,r)}cloneInstance(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:tu;const a=t.forkResourceStore;a&&delete t.forkResourceStore;const s={...this.options,...t,isClone:!0},i=new nd(s);return(t.debug!==void 0||t.prefix!==void 0)&&(i.logger=i.logger.clone(t)),["store","services","language"].forEach(l=>{i[l]=this[l]}),i.services={...this.services},i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},a&&(i.store=new vj(this.store.data,s),i.services.resourceStore=i.store),i.translator=new Af(i.services,s),i.translator.on("*",function(l){for(var c=arguments.length,d=new Array(c>1?c-1:0),u=1;u<c;u++)d[u-1]=arguments[u];i.emit(l,...d)}),i.init(s,r),i.translator.options=s,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Qr=nd.createInstance();Qr.createInstance=nd.createInstance;Qr.createInstance;Qr.dir;Qr.init;Qr.loadResources;Qr.reloadResources;Qr.use;Qr.changeLanguage;Qr.getFixedT;Qr.t;Qr.exists;Qr.setDefaultNamespace;Qr.hasLoadedNamespace;Qr.loadNamespaces;Qr.loadLanguages;function Cx(e){"@babel/helpers - typeof";return Cx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cx(e)}function o3(){return typeof XMLHttpRequest=="function"||(typeof XMLHttpRequest>"u"?"undefined":Cx(XMLHttpRequest))==="object"}function Uue(e){return!!e&&typeof e.then=="function"}function Wue(e){return Uue(e)?e:Promise.resolve(e)}function Hue(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Fx={exports:{}},ru={exports:{}},Sj;function zue(){return Sj||(Sj=1,function(e,t){var r=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof Mn<"u"&&Mn,a=function(){function i(){this.fetch=!1,this.DOMException=r.DOMException}return i.prototype=r,new i}();(function(i){(function(o){var l=typeof i<"u"&&i||typeof self<"u"&&self||typeof l<"u"&&l,c={searchParams:"URLSearchParams"in l,iterable:"Symbol"in l&&"iterator"in Symbol,blob:"FileReader"in l&&"Blob"in l&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in l,arrayBuffer:"ArrayBuffer"in l};function d(A){return A&&DataView.prototype.isPrototypeOf(A)}if(c.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],f=ArrayBuffer.isView||function(A){return A&&u.indexOf(Object.prototype.toString.call(A))>-1};function h(A){if(typeof A!="string"&&(A=String(A)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(A)||A==="")throw new TypeError('Invalid character in header field name: "'+A+'"');return A.toLowerCase()}function m(A){return typeof A!="string"&&(A=String(A)),A}function x(A){var F={next:function(){var H=A.shift();return{done:H===void 0,value:H}}};return c.iterable&&(F[Symbol.iterator]=function(){return F}),F}function p(A){this.map={},A instanceof p?A.forEach(function(F,H){this.append(H,F)},this):Array.isArray(A)?A.forEach(function(F){this.append(F[0],F[1])},this):A&&Object.getOwnPropertyNames(A).forEach(function(F){this.append(F,A[F])},this)}p.prototype.append=function(A,F){A=h(A),F=m(F);var H=this.map[A];this.map[A]=H?H+", "+F:F},p.prototype.delete=function(A){delete this.map[h(A)]},p.prototype.get=function(A){return A=h(A),this.has(A)?this.map[A]:null},p.prototype.has=function(A){return this.map.hasOwnProperty(h(A))},p.prototype.set=function(A,F){this.map[h(A)]=m(F)},p.prototype.forEach=function(A,F){for(var H in this.map)this.map.hasOwnProperty(H)&&A.call(F,this.map[H],H,this)},p.prototype.keys=function(){var A=[];return this.forEach(function(F,H){A.push(H)}),x(A)},p.prototype.values=function(){var A=[];return this.forEach(function(F){A.push(F)}),x(A)},p.prototype.entries=function(){var A=[];return this.forEach(function(F,H){A.push([H,F])}),x(A)},c.iterable&&(p.prototype[Symbol.iterator]=p.prototype.entries);function g(A){if(A.bodyUsed)return Promise.reject(new TypeError("Already read"));A.bodyUsed=!0}function y(A){return new Promise(function(F,H){A.onload=function(){F(A.result)},A.onerror=function(){H(A.error)}})}function w(A){var F=new FileReader,H=y(F);return F.readAsArrayBuffer(A),H}function v(A){var F=new FileReader,H=y(F);return F.readAsText(A),H}function _(A){for(var F=new Uint8Array(A),H=new Array(F.length),V=0;V<F.length;V++)H[V]=String.fromCharCode(F[V]);return H.join("")}function b(A){if(A.slice)return A.slice(0);var F=new Uint8Array(A.byteLength);return F.set(new Uint8Array(A)),F.buffer}function j(){return this.bodyUsed=!1,this._initBody=function(A){this.bodyUsed=this.bodyUsed,this._bodyInit=A,A?typeof A=="string"?this._bodyText=A:c.blob&&Blob.prototype.isPrototypeOf(A)?this._bodyBlob=A:c.formData&&FormData.prototype.isPrototypeOf(A)?this._bodyFormData=A:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(A)?this._bodyText=A.toString():c.arrayBuffer&&c.blob&&d(A)?(this._bodyArrayBuffer=b(A.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(A)||f(A))?this._bodyArrayBuffer=b(A):this._bodyText=A=Object.prototype.toString.call(A):this._bodyText="",this.headers.get("content-type")||(typeof A=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(A)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var A=g(this);if(A)return A;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var A=g(this);return A||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else return this.blob().then(w)}),this.text=function(){var A=g(this);if(A)return A;if(this._bodyBlob)return v(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(_(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(E)}),this.json=function(){return this.text().then(JSON.parse)},this}var N=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function k(A){var F=A.toUpperCase();return N.indexOf(F)>-1?F:A}function S(A,F){if(!(this instanceof S))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');F=F||{};var H=F.body;if(A instanceof S){if(A.bodyUsed)throw new TypeError("Already read");this.url=A.url,this.credentials=A.credentials,F.headers||(this.headers=new p(A.headers)),this.method=A.method,this.mode=A.mode,this.signal=A.signal,!H&&A._bodyInit!=null&&(H=A._bodyInit,A.bodyUsed=!0)}else this.url=String(A);if(this.credentials=F.credentials||this.credentials||"same-origin",(F.headers||!this.headers)&&(this.headers=new p(F.headers)),this.method=k(F.method||this.method||"GET"),this.mode=F.mode||this.mode||null,this.signal=F.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&H)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(H),(this.method==="GET"||this.method==="HEAD")&&(F.cache==="no-store"||F.cache==="no-cache")){var V=/([?&])_=[^&]*/;if(V.test(this.url))this.url=this.url.replace(V,"$1_="+new Date().getTime());else{var B=/\?/;this.url+=(B.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}S.prototype.clone=function(){return new S(this,{body:this._bodyInit})};function E(A){var F=new FormData;return A.trim().split("&").forEach(function(H){if(H){var V=H.split("="),B=V.shift().replace(/\+/g," "),L=V.join("=").replace(/\+/g," ");F.append(decodeURIComponent(B),decodeURIComponent(L))}}),F}function P(A){var F=new p,H=A.replace(/\r?\n[\t ]+/g," ");return H.split("\r").map(function(V){return V.indexOf(`
`)===0?V.substr(1,V.length):V}).forEach(function(V){var B=V.split(":"),L=B.shift().trim();if(L){var ee=B.join(":").trim();F.append(L,ee)}}),F}j.call(S.prototype);function C(A,F){if(!(this instanceof C))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');F||(F={}),this.type="default",this.status=F.status===void 0?200:F.status,this.ok=this.status>=200&&this.status<300,this.statusText=F.statusText===void 0?"":""+F.statusText,this.headers=new p(F.headers),this.url=F.url||"",this._initBody(A)}j.call(C.prototype),C.prototype.clone=function(){return new C(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},C.error=function(){var A=new C(null,{status:0,statusText:""});return A.type="error",A};var T=[301,302,303,307,308];C.redirect=function(A,F){if(T.indexOf(F)===-1)throw new RangeError("Invalid status code");return new C(null,{status:F,headers:{location:A}})},o.DOMException=l.DOMException;try{new o.DOMException}catch{o.DOMException=function(F,H){this.message=F,this.name=H;var V=Error(F);this.stack=V.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function M(A,F){return new Promise(function(H,V){var B=new S(A,F);if(B.signal&&B.signal.aborted)return V(new o.DOMException("Aborted","AbortError"));var L=new XMLHttpRequest;function ee(){L.abort()}L.onload=function(){var K={status:L.status,statusText:L.statusText,headers:P(L.getAllResponseHeaders()||"")};K.url="responseURL"in L?L.responseURL:K.headers.get("X-Request-URL");var z="response"in L?L.response:L.responseText;setTimeout(function(){H(new C(z,K))},0)},L.onerror=function(){setTimeout(function(){V(new TypeError("Network request failed"))},0)},L.ontimeout=function(){setTimeout(function(){V(new TypeError("Network request failed"))},0)},L.onabort=function(){setTimeout(function(){V(new o.DOMException("Aborted","AbortError"))},0)};function I(K){try{return K===""&&l.location.href?l.location.href:K}catch{return K}}L.open(B.method,I(B.url),!0),B.credentials==="include"?L.withCredentials=!0:B.credentials==="omit"&&(L.withCredentials=!1),"responseType"in L&&(c.blob?L.responseType="blob":c.arrayBuffer&&B.headers.get("Content-Type")&&B.headers.get("Content-Type").indexOf("application/octet-stream")!==-1&&(L.responseType="arraybuffer")),F&&typeof F.headers=="object"&&!(F.headers instanceof p)?Object.getOwnPropertyNames(F.headers).forEach(function(K){L.setRequestHeader(K,m(F.headers[K]))}):B.headers.forEach(function(K,z){L.setRequestHeader(z,K)}),B.signal&&(B.signal.addEventListener("abort",ee),L.onreadystatechange=function(){L.readyState===4&&B.signal.removeEventListener("abort",ee)}),L.send(typeof B._bodyInit>"u"?null:B._bodyInit)})}return M.polyfill=!0,l.fetch||(l.fetch=M,l.Headers=p,l.Request=S,l.Response=C),o.Headers=p,o.Request=S,o.Response=C,o.fetch=M,o})({})})(a),a.fetch.ponyfill=!0,delete a.fetch.polyfill;var s=r.fetch?r:a;t=s.fetch,t.default=s.fetch,t.fetch=s.fetch,t.Headers=s.Headers,t.Request=s.Request,t.Response=s.Response,e.exports=t}(ru,ru.exports)),ru.exports}(function(e,t){var r=typeof fetch=="function"?fetch:void 0;if(typeof Mn<"u"&&Mn.fetch?r=Mn.fetch:typeof window<"u"&&window.fetch&&(r=window.fetch),typeof Hue<"u"&&typeof window>"u"){var a=r||zue();a.default&&(a=a.default),t.default=a,e.exports=t.default}})(Fx,Fx.exports);var l3=Fx.exports;const c3=kt(l3),kj=u6({__proto__:null,default:c3},[l3]);function Ej(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Aj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ej(Object(r),!0).forEach(function(a){Vue(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ej(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Vue(e,t,r){return(t=Gue(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gue(e){var t=Kue(e,"string");return Oi(t)=="symbol"?t:t+""}function Kue(e,t){if(Oi(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Oi(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Oi(e){"@babel/helpers - typeof";return Oi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oi(e)}var Es=typeof fetch=="function"?fetch:void 0;typeof global<"u"&&global.fetch?Es=global.fetch:typeof window<"u"&&window.fetch&&(Es=window.fetch);var sd;o3()&&(typeof global<"u"&&global.XMLHttpRequest?sd=global.XMLHttpRequest:typeof window<"u"&&window.XMLHttpRequest&&(sd=window.XMLHttpRequest));var Tf;typeof ActiveXObject=="function"&&(typeof global<"u"&&global.ActiveXObject?Tf=global.ActiveXObject:typeof window<"u"&&window.ActiveXObject&&(Tf=window.ActiveXObject));!Es&&kj&&!sd&&!Tf&&(Es=c3||kj);typeof Es!="function"&&(Es=void 0);var Ix=function(t,r){if(r&&Oi(r)==="object"){var a="";for(var s in r)a+="&"+encodeURIComponent(s)+"="+encodeURIComponent(r[s]);if(!a)return t;t=t+(t.indexOf("?")!==-1?"&":"?")+a.slice(1)}return t},Tj=function(t,r,a,s){var i=function(c){if(!c.ok)return a(c.statusText||"Error",{status:c.status});c.text().then(function(d){a(null,{status:c.status,data:d})}).catch(a)};if(s){var o=s(t,r);if(o instanceof Promise){o.then(i).catch(a);return}}typeof fetch=="function"?fetch(t,r).then(i).catch(a):Es(t,r).then(i).catch(a)},Oj=!1,que=function(t,r,a,s){t.queryStringParams&&(r=Ix(r,t.queryStringParams));var i=Aj({},typeof t.customHeaders=="function"?t.customHeaders():t.customHeaders);typeof window>"u"&&typeof global<"u"&&typeof global.process<"u"&&global.process.versions&&global.process.versions.node&&(i["User-Agent"]="i18next-http-backend (node/".concat(global.process.version,"; ").concat(global.process.platform," ").concat(global.process.arch,")")),a&&(i["Content-Type"]="application/json");var o=typeof t.requestOptions=="function"?t.requestOptions(a):t.requestOptions,l=Aj({method:a?"POST":"GET",body:a?t.stringify(a):void 0,headers:i},Oj?{}:o),c=typeof t.alternateFetch=="function"&&t.alternateFetch.length>=1?t.alternateFetch:void 0;try{Tj(r,l,s,c)}catch(d){if(!o||Object.keys(o).length===0||!d.message||d.message.indexOf("not implemented")<0)return s(d);try{Object.keys(o).forEach(function(u){delete l[u]}),Tj(r,l,s,c),Oj=!0}catch(u){s(u)}}},Xue=function(t,r,a,s){a&&Oi(a)==="object"&&(a=Ix("",a).slice(1)),t.queryStringParams&&(r=Ix(r,t.queryStringParams));try{var i;sd?i=new sd:i=new Tf("MSXML2.XMLHTTP.3.0"),i.open(a?"POST":"GET",r,1),t.crossDomain||i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.withCredentials=!!t.withCredentials,a&&i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.overrideMimeType&&i.overrideMimeType("application/json");var o=t.customHeaders;if(o=typeof o=="function"?o():o,o)for(var l in o)i.setRequestHeader(l,o[l]);i.onreadystatechange=function(){i.readyState>3&&s(i.status>=400?i.statusText:null,{status:i.status,data:i.responseText})},i.send(a)}catch(c){console&&console.log(c)}},Yue=function(t,r,a,s){if(typeof a=="function"&&(s=a,a=void 0),s=s||function(){},Es&&r.indexOf("file:")!==0)return que(t,r,a,s);if(o3()||typeof ActiveXObject=="function")return Xue(t,r,a,s);s(new Error("No fetch and no xhr implementation found!"))};function Vo(e){"@babel/helpers - typeof";return Vo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vo(e)}function Pj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Dh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Pj(Object(r),!0).forEach(function(a){d3(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pj(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Jue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zue(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,u3(a.key),a)}}function Que(e,t,r){return t&&Zue(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function d3(e,t,r){return(t=u3(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u3(e){var t=efe(e,"string");return Vo(t)=="symbol"?t:t+""}function efe(e,t){if(Vo(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Vo(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var tfe=function(){return{loadPath:"/locales/{{lng}}/{{ns}}.json",addPath:"/locales/add/{{lng}}/{{ns}}",parse:function(r){return JSON.parse(r)},stringify:JSON.stringify,parsePayload:function(r,a,s){return d3({},a,s||"")},parseLoadPayload:function(r,a){},request:Yue,reloadInterval:typeof window<"u"?!1:60*60*1e3,customHeaders:{},queryStringParams:{},crossDomain:!1,withCredentials:!1,overrideMimeType:!1,requestOptions:{mode:"cors",credentials:"same-origin",cache:"default"}}},f3=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Jue(this,e),this.services=t,this.options=r,this.allOptions=a,this.type="backend",this.init(t,r,a)}return Que(e,[{key:"init",value:function(r){var a=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this.services=r,this.options=Dh(Dh(Dh({},tfe()),this.options||{}),s),this.allOptions=i,this.services&&this.options.reloadInterval){var o=setInterval(function(){return a.reload()},this.options.reloadInterval);Vo(o)==="object"&&typeof o.unref=="function"&&o.unref()}}},{key:"readMulti",value:function(r,a,s){this._readAny(r,r,a,a,s)}},{key:"read",value:function(r,a,s){this._readAny([r],r,[a],a,s)}},{key:"_readAny",value:function(r,a,s,i,o){var l=this,c=this.options.loadPath;typeof this.options.loadPath=="function"&&(c=this.options.loadPath(r,s)),c=Wue(c),c.then(function(d){if(!d)return o(null,{});var u=l.services.interpolator.interpolate(d,{lng:r.join("+"),ns:s.join("+")});l.loadUrl(u,o,a,i)})}},{key:"loadUrl",value:function(r,a,s,i){var o=this,l=typeof s=="string"?[s]:s,c=typeof i=="string"?[i]:i,d=this.options.parseLoadPayload(l,c);this.options.request(this.options,r,d,function(u,f){if(f&&(f.status>=500&&f.status<600||!f.status))return a("failed loading "+r+"; status code: "+f.status,!0);if(f&&f.status>=400&&f.status<500)return a("failed loading "+r+"; status code: "+f.status,!1);if(!f&&u&&u.message){var h=u.message.toLowerCase(),m=["failed","fetch","network","load"].find(function(g){return h.indexOf(g)>-1});if(m)return a("failed loading "+r+": "+u.message,!0)}if(u)return a(u,!1);var x,p;try{typeof f.data=="string"?x=o.options.parse(f.data,s,i):x=f.data}catch{p="failed parsing "+r+" to json"}if(p)return a(p,!1);a(null,x)})}},{key:"create",value:function(r,a,s,i,o){var l=this;if(this.options.addPath){typeof r=="string"&&(r=[r]);var c=this.options.parsePayload(a,s,i),d=0,u=[],f=[];r.forEach(function(h){var m=l.options.addPath;typeof l.options.addPath=="function"&&(m=l.options.addPath(h,a));var x=l.services.interpolator.interpolate(m,{lng:h,ns:a});l.options.request(l.options,x,c,function(p,g){d+=1,u.push(p),f.push(g),d===r.length&&typeof o=="function"&&o(u,f)})})}}},{key:"reload",value:function(){var r=this,a=this.services,s=a.backendConnector,i=a.languageUtils,o=a.logger,l=s.language;if(!(l&&l.toLowerCase()==="cimode")){var c=[],d=function(f){var h=i.toResolveHierarchy(f);h.forEach(function(m){c.indexOf(m)<0&&c.push(m)})};d(l),this.allOptions.preload&&this.allOptions.preload.forEach(function(u){return d(u)}),c.forEach(function(u){r.allOptions.ns.forEach(function(f){s.read(u,f,"read",null,null,function(h,m){h&&o.warn("loading namespace ".concat(f," for language ").concat(u," failed"),h),!h&&m&&o.log("loaded namespace ".concat(f," for language ").concat(u),m),s.loaded("".concat(u,"|").concat(f),h,m)})})})}}}])}();f3.type="backend";function rfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function id(e){"@babel/helpers - typeof";return id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},id(e)}function afe(e,t){if(id(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(id(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function nfe(e){var t=afe(e,"string");return id(t)=="symbol"?t:t+""}function sfe(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,nfe(a.key),a)}}function ife(e,t,r){return t&&sfe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var h3=[],ofe=h3.forEach,lfe=h3.slice;function cfe(e){return ofe.call(lfe.call(arguments,1),function(t){if(t)for(var r in t)e[r]===void 0&&(e[r]=t[r])}),e}var Cj=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,dfe=function(t,r,a){var s=a||{};s.path=s.path||"/";var i=encodeURIComponent(r),o="".concat(t,"=").concat(i);if(s.maxAge>0){var l=s.maxAge-0;if(Number.isNaN(l))throw new Error("maxAge should be a Number");o+="; Max-Age=".concat(Math.floor(l))}if(s.domain){if(!Cj.test(s.domain))throw new TypeError("option domain is invalid");o+="; Domain=".concat(s.domain)}if(s.path){if(!Cj.test(s.path))throw new TypeError("option path is invalid");o+="; Path=".concat(s.path)}if(s.expires){if(typeof s.expires.toUTCString!="function")throw new TypeError("option expires is invalid");o+="; Expires=".concat(s.expires.toUTCString())}if(s.httpOnly&&(o+="; HttpOnly"),s.secure&&(o+="; Secure"),s.sameSite){var c=typeof s.sameSite=="string"?s.sameSite.toLowerCase():s.sameSite;switch(c){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return o},Fj={create:function(t,r,a,s){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};a&&(i.expires=new Date,i.expires.setTime(i.expires.getTime()+a*60*1e3)),s&&(i.domain=s),document.cookie=dfe(t,encodeURIComponent(r),i)},read:function(t){for(var r="".concat(t,"="),a=document.cookie.split(";"),s=0;s<a.length;s++){for(var i=a[s];i.charAt(0)===" ";)i=i.substring(1,i.length);if(i.indexOf(r)===0)return i.substring(r.length,i.length)}return null},remove:function(t){this.create(t,"",-1)}},ufe={name:"cookie",lookup:function(t){var r;if(t.lookupCookie&&typeof document<"u"){var a=Fj.read(t.lookupCookie);a&&(r=a)}return r},cacheUserLanguage:function(t,r){r.lookupCookie&&typeof document<"u"&&Fj.create(r.lookupCookie,t,r.cookieMinutes,r.cookieDomain,r.cookieOptions)}},ffe={name:"querystring",lookup:function(t){var r;if(typeof window<"u"){var a=window.location.search;!window.location.search&&window.location.hash&&window.location.hash.indexOf("?")>-1&&(a=window.location.hash.substring(window.location.hash.indexOf("?")));for(var s=a.substring(1),i=s.split("&"),o=0;o<i.length;o++){var l=i[o].indexOf("=");if(l>0){var c=i[o].substring(0,l);c===t.lookupQuerystring&&(r=i[o].substring(l+1))}}}return r}},Al=null,Ij=function(){if(Al!==null)return Al;try{Al=window!=="undefined"&&window.localStorage!==null;var t="i18next.translate.boo";window.localStorage.setItem(t,"foo"),window.localStorage.removeItem(t)}catch{Al=!1}return Al},hfe={name:"localStorage",lookup:function(t){var r;if(t.lookupLocalStorage&&Ij()){var a=window.localStorage.getItem(t.lookupLocalStorage);a&&(r=a)}return r},cacheUserLanguage:function(t,r){r.lookupLocalStorage&&Ij()&&window.localStorage.setItem(r.lookupLocalStorage,t)}},Tl=null,Dj=function(){if(Tl!==null)return Tl;try{Tl=window!=="undefined"&&window.sessionStorage!==null;var t="i18next.translate.boo";window.sessionStorage.setItem(t,"foo"),window.sessionStorage.removeItem(t)}catch{Tl=!1}return Tl},mfe={name:"sessionStorage",lookup:function(t){var r;if(t.lookupSessionStorage&&Dj()){var a=window.sessionStorage.getItem(t.lookupSessionStorage);a&&(r=a)}return r},cacheUserLanguage:function(t,r){r.lookupSessionStorage&&Dj()&&window.sessionStorage.setItem(r.lookupSessionStorage,t)}},xfe={name:"navigator",lookup:function(t){var r=[];if(typeof navigator<"u"){if(navigator.languages)for(var a=0;a<navigator.languages.length;a++)r.push(navigator.languages[a]);navigator.userLanguage&&r.push(navigator.userLanguage),navigator.language&&r.push(navigator.language)}return r.length>0?r:void 0}},pfe={name:"htmlTag",lookup:function(t){var r,a=t.htmlTag||(typeof document<"u"?document.documentElement:null);return a&&typeof a.getAttribute=="function"&&(r=a.getAttribute("lang")),r}},gfe={name:"path",lookup:function(t){var r;if(typeof window<"u"){var a=window.location.pathname.match(/\/([a-zA-Z-]*)/g);if(a instanceof Array)if(typeof t.lookupFromPathIndex=="number"){if(typeof a[t.lookupFromPathIndex]!="string")return;r=a[t.lookupFromPathIndex].replace("/","")}else r=a[0].replace("/","")}return r}},vfe={name:"subdomain",lookup:function(t){var r=typeof t.lookupFromSubdomainIndex=="number"?t.lookupFromSubdomainIndex+1:1,a=typeof window<"u"&&window.location&&window.location.hostname&&window.location.hostname.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i);if(a)return a[r]}},m3=!1;try{document.cookie,m3=!0}catch{}var x3=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];m3||x3.splice(1,1);function yfe(){return{order:x3,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:function(t){return t}}}var p3=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};rfe(this,e),this.type="languageDetector",this.detectors={},this.init(t,r)}return ife(e,[{key:"init",value:function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=r||{languageUtils:{}},this.options=cfe(a,this.options||{},yfe()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=function(i){return i.replace("-","_")}),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=s,this.addDetector(ufe),this.addDetector(ffe),this.addDetector(hfe),this.addDetector(mfe),this.addDetector(xfe),this.addDetector(pfe),this.addDetector(gfe),this.addDetector(vfe)}},{key:"addDetector",value:function(r){return this.detectors[r.name]=r,this}},{key:"detect",value:function(r){var a=this;r||(r=this.options.order);var s=[];return r.forEach(function(i){if(a.detectors[i]){var o=a.detectors[i].lookup(a.options);o&&typeof o=="string"&&(o=[o]),o&&(s=s.concat(o))}}),s=s.map(function(i){return a.options.convertDetectedLanguage(i)}),this.services.languageUtils.getBestMatchFromCodes?s:s.length>0?s[0]:null}},{key:"cacheUserLanguage",value:function(r,a){var s=this;a||(a=this.options.caches),a&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(r)>-1||a.forEach(function(i){s.detectors[i]&&s.detectors[i].cacheUserLanguage(r,s.options)}))}}])}();p3.type="languageDetector";Qr.use(f3).use(p3).use(oE).init({fallbackLng:"ar",supportedLngs:["ar","en"],debug:!1,interpolation:{escapeValue:!1},detection:{order:["localStorage","navigator"],caches:["localStorage"]},backend:{loadPath:"/locales/{{lng}}/{{ns}}.json"},ns:["translation"],defaultNS:"translation",react:{useSuspense:!1,wait:!0,bindI18n:"languageChanged loaded"}});Vj(document.getElementById("root")).render(n.jsx(O.StrictMode,{children:n.jsx(gue,{})}));
